
 //js/merged.js

 //js/egret.min_cc7ab31a.js
var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i};if("undefined"==typeof global)var global=window;if("undefined"==typeof __global)var __global=global;var __define=this&&this.__define||function(t,e,i,r){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:i,set:r})},egret;!function(t){t.$hashCount=1;var e=function(){function e(){this.$hashCode=t.$hashCount++}return Object.defineProperty(e.prototype,"hashCode",{get:function(){return this.$hashCode},enumerable:!0,configurable:!0}),e}();t.HashObject=e,__reflect(e.prototype,"egret.HashObject",["egret.IHashObject"])}(egret||(egret={}));var egret;!function(t){var e=[],i=function(i){function r(t){void 0===t&&(t=null);var e=i.call(this)||this;return e.$EventDispatcher={0:t?t:e,1:{},2:{},3:0},e}return __extends(r,i),r.prototype.$getEventMap=function(t){var e=this.$EventDispatcher,i=t?e[2]:e[1];return i},r.prototype.addEventListener=function(t,e,i,r,n){this.$addListener(t,e,i,r,n)},r.prototype.once=function(t,e,i,r,n){this.$addListener(t,e,i,r,n,!0)},r.prototype.$addListener=function(t,e,i,r,n,a){var o=this.$EventDispatcher,s=r?o[2]:o[1],h=s[t];h?0!==o[3]&&(s[t]=h=h.concat()):h=s[t]=[],this.$insertEventBin(h,t,e,i,r,n,a)},r.prototype.$insertEventBin=function(t,e,i,r,n,a,o){a=0|+a;for(var s=-1,h=t.length,c=0;h>c;c++){var l=t[c];if(l.listener==i&&l.thisObject==r&&l.target==this)return!1;-1==s&&l.priority<a&&(s=c)}var u={type:e,listener:i,thisObject:r,priority:a,target:this,useCapture:n,dispatchOnce:!!o};return-1!==s?t.splice(s,0,u):t.push(u),!0},r.prototype.removeEventListener=function(t,e,i,r){var n=this.$EventDispatcher,a=r?n[2]:n[1],o=a[t];o&&(0!==n[3]&&(a[t]=o=o.concat()),this.$removeEventBin(o,e,i),0==o.length&&(a[t]=null))},r.prototype.$removeEventBin=function(t,e,i){for(var r=t.length,n=0;r>n;n++){var a=t[n];if(a.listener==e&&a.thisObject==i&&a.target==this)return t.splice(n,1),!0}return!1},r.prototype.hasEventListener=function(t){var e=this.$EventDispatcher;return!(!e[1][t]&&!e[2][t])},r.prototype.willTrigger=function(t){return this.hasEventListener(t)},r.prototype.dispatchEvent=function(t){return t.$currentTarget=this.$EventDispatcher[0],t.$setTarget(t.$currentTarget),this.$notifyListener(t,!1)},r.prototype.$notifyListener=function(t,i){var r=this.$EventDispatcher,n=i?r[2]:r[1],a=n[t.$type];if(!a)return!0;var o=a.length;if(0==o)return!0;var s=e;r[3]++;for(var h=0;o>h;h++){var c=a[h];if(c.listener.call(c.thisObject,t),c.dispatchOnce&&s.push(c),t.$isPropagationImmediateStopped)break}for(r[3]--;s.length;){var c=s.pop();c.target.removeEventListener(c.type,c.listener,c.thisObject,c.useCapture)}return!t.$isDefaultPrevented},r.prototype.dispatchEventWith=function(e,i,r,n){if(i||this.hasEventListener(e)){var a=t.Event.create(t.Event,e,i,n);a.data=r;var o=this.dispatchEvent(a);return t.Event.release(a),o}return!0},r}(t.HashObject);t.EventDispatcher=i,__reflect(i.prototype,"egret.EventDispatcher",["egret.IEventDispatcher"])}(egret||(egret={}));var egret;!function(t){function e(t){return t%=360,t>180?t-=360:-180>t&&(t+=360),t}var i=function(i){function r(){var e=i.call(this)||this;return e.$children=null,e.$name="",e.$parent=null,e.$stage=null,e.$nestLevel=0,e.$useTranslate=!1,e.$matrix=new t.Matrix,e.$matrixDirty=!1,e.$x=0,e.$y=0,e.$scaleX=1,e.$scaleY=1,e.$rotation=0,e.$skewX=0,e.$skewXdeg=0,e.$skewY=0,e.$skewYdeg=0,e.$explicitWidth=0/0,e.$explicitHeight=0/0,e.$anchorOffsetX=0,e.$anchorOffsetY=0,e.$visible=!0,e.$displayList=null,e.$cacheAsBitmap=!1,e.$cacheDirty=!1,e.$alpha=1,e.$touchEnabled=r.defaultTouchEnabled,e.$scrollRect=null,e.$blendMode=0,e.$maskedObject=null,e.$mask=null,e.$maskRect=null,e.$parentDisplayList=null,e.$renderNode=null,e.$renderDirty=!1,e.$renderMode=null,e._tint=0,e.$tintRGB=0,e.$sortDirty=!1,e._zIndex=0,e.$lastSortedIndex=0,e._sortableChildren=!1,t.nativeRender&&e.createNativeDisplayObject(),e.tint=16777215,e}return __extends(r,i),r.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(0)},Object.defineProperty(r.prototype,"name",{get:function(){return this.$name},set:function(t){this.$name=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"parent",{get:function(){return this.$parent},enumerable:!0,configurable:!0}),r.prototype.$setParent=function(t){this.$parent=t},r.prototype.$onAddToStage=function(e,i){var r=this;r.$stage=e,r.$nestLevel=i,r.$hasAddToStage=!0,t.Sprite.$EVENT_ADD_TO_STAGE_LIST.push(r)},r.prototype.$onRemoveFromStage=function(){var e=this;e.$nestLevel=0,t.Sprite.$EVENT_REMOVE_FROM_STAGE_LIST.push(e)},r.prototype.$updateUseTransform=function(){var t=this;1==t.$scaleX&&1==t.$scaleY&&0==t.$skewX&&0==t.$skewY?t.$useTranslate=!1:t.$useTranslate=!0},Object.defineProperty(r.prototype,"stage",{get:function(){return this.$stage},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"matrix",{get:function(){return this.$getMatrix().clone()},set:function(t){this.$setMatrix(t)},enumerable:!0,configurable:!0}),r.prototype.$getMatrix=function(){var t=this;return t.$matrixDirty&&(t.$matrixDirty=!1,t.$matrix.$updateScaleAndRotation(t.$scaleX,t.$scaleY,t.$skewX,t.$skewY)),t.$matrix.tx=t.$x,t.$matrix.ty=t.$y,t.$matrix},r.prototype.$setMatrix=function(i,r){void 0===r&&(r=!0);var n=this,a=n.$matrix;a.a=i.a,a.b=i.b,a.c=i.c,a.d=i.d,n.$x=i.tx,n.$y=i.ty,n.$matrixDirty=!1,1==a.a&&0==a.b&&0==a.c&&1==a.d?n.$useTranslate=!1:n.$useTranslate=!0,r&&(n.$scaleX=a.$getScaleX(),n.$scaleY=a.$getScaleY(),n.$skewX=i.$getSkewX(),n.$skewY=i.$getSkewY(),n.$skewXdeg=e(180*n.$skewX/Math.PI),n.$skewYdeg=e(180*n.$skewY/Math.PI),n.$rotation=e(180*n.$skewY/Math.PI)),t.nativeRender&&n.$nativeDisplayObject.setMatrix(i.a,i.b,i.c,i.d,i.tx,i.ty)},r.prototype.$getConcatenatedMatrix=function(){var e=this,i=e.$concatenatedMatrix;i||(i=e.$concatenatedMatrix=new t.Matrix),e.$parent?e.$parent.$getConcatenatedMatrix().$preMultiplyInto(e.$getMatrix(),i):i.copyFrom(e.$getMatrix());var r=e.$anchorOffsetX,n=e.$anchorOffsetY,a=e.$scrollRect;return a?i.$preMultiplyInto(t.$TempMatrix.setTo(1,0,0,1,-a.x-r,-a.y-n),i):(0!=r||0!=n)&&i.$preMultiplyInto(t.$TempMatrix.setTo(1,0,0,1,-r,-n),i),e.$concatenatedMatrix},r.prototype.$getInvertedConcatenatedMatrix=function(){var e=this;return e.$invertedConcatenatedMatrix||(e.$invertedConcatenatedMatrix=new t.Matrix),e.$getConcatenatedMatrix().$invertInto(e.$invertedConcatenatedMatrix),e.$invertedConcatenatedMatrix},Object.defineProperty(r.prototype,"x",{get:function(){return this.$getX()},set:function(t){this.$setX(t)},enumerable:!0,configurable:!0}),r.prototype.$getX=function(){return this.$x},r.prototype.$setX=function(e){var i=this;if(i.$x==e)return!1;if(i.$x=e,t.nativeRender)i.$nativeDisplayObject.setX(e);else{var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}return!0},Object.defineProperty(r.prototype,"y",{get:function(){return this.$getY()},set:function(t){this.$setY(t)},enumerable:!0,configurable:!0}),r.prototype.$getY=function(){return this.$y},r.prototype.$setY=function(e){var i=this;if(i.$y==e)return!1;if(i.$y=e,t.nativeRender)i.$nativeDisplayObject.setY(e);else{var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}return!0},Object.defineProperty(r.prototype,"scaleX",{get:function(){return this.$getScaleX()},set:function(t){this.$setScaleX(t)},enumerable:!0,configurable:!0}),r.prototype.$getScaleX=function(){return this.$scaleX},r.prototype.$setScaleX=function(e){var i=this;if(i.$scaleX!=e)if(i.$scaleX=e,i.$matrixDirty=!0,i.$updateUseTransform(),t.nativeRender)i.$nativeDisplayObject.setScaleX(e);else{var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"scaleY",{get:function(){return this.$getScaleY()},set:function(t){this.$setScaleY(t)},enumerable:!0,configurable:!0}),r.prototype.$getScaleY=function(){return this.$scaleY},r.prototype.$setScaleY=function(e){var i=this;if(i.$scaleY!=e)if(i.$scaleY=e,i.$matrixDirty=!0,i.$updateUseTransform(),t.nativeRender)i.$nativeDisplayObject.setScaleY(e);else{var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"rotation",{get:function(){return this.$getRotation()},set:function(t){this.$setRotation(t)},enumerable:!0,configurable:!0}),r.prototype.$getRotation=function(){return this.$rotation},r.prototype.$setRotation=function(i){i=e(i);var r=this;if(i!=r.$rotation){var n=i-r.$rotation,a=n/180*Math.PI;if(r.$skewX+=a,r.$skewY+=a,r.$rotation=i,r.$matrixDirty=!0,r.$updateUseTransform(),t.nativeRender)r.$nativeDisplayObject.setRotation(i);else{var o=r.$parent;o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp());var s=r.$maskedObject;s&&!s.$cacheDirty&&(s.$cacheDirty=!0,s.$cacheDirtyUp())}}},Object.defineProperty(r.prototype,"skewX",{get:function(){return this.$skewXdeg},set:function(t){this.$setSkewX(t)},enumerable:!0,configurable:!0}),r.prototype.$setSkewX=function(i){var r=this;if(i!=r.$skewXdeg)if(r.$skewXdeg=i,i=e(i),i=i/180*Math.PI,r.$skewX=i,r.$matrixDirty=!0,r.$updateUseTransform(),t.nativeRender)r.$nativeDisplayObject.setSkewX(r.$skewXdeg);else{var n=r.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=r.$maskedObject;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"skewY",{get:function(){return this.$skewYdeg},set:function(t){this.$setSkewY(t)},enumerable:!0,configurable:!0}),r.prototype.$setSkewY=function(i){var r=this;if(i!=r.$skewYdeg)if(r.$skewYdeg=i,i=e(i),i=(i+r.$rotation)/180*Math.PI,r.$skewY=i,r.$matrixDirty=!0,r.$updateUseTransform(),t.nativeRender)r.$nativeDisplayObject.setSkewY(r.$skewYdeg);else{var n=r.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=r.$maskedObject;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"width",{get:function(){return this.$getWidth()},set:function(t){this.$setWidth(t)},enumerable:!0,configurable:!0}),r.prototype.$getWidth=function(){var t=this;return isNaN(t.$explicitWidth)?t.$getOriginalBounds().width:t.$explicitWidth},r.prototype.$setWidth=function(t){t=isNaN(t)?0/0:t,this.$explicitWidth!=t&&(this.$explicitWidth=t)},Object.defineProperty(r.prototype,"height",{get:function(){return this.$getHeight()},set:function(t){this.$setHeight(t)},enumerable:!0,configurable:!0}),r.prototype.$getHeight=function(){var t=this;return isNaN(t.$explicitHeight)?t.$getOriginalBounds().height:t.$explicitHeight},r.prototype.$setHeight=function(t){t=isNaN(t)?0/0:t,this.$explicitHeight!=t&&(this.$explicitHeight=t)},Object.defineProperty(r.prototype,"measuredWidth",{get:function(){return this.$getOriginalBounds().width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"measuredHeight",{get:function(){return this.$getOriginalBounds().height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"anchorOffsetX",{get:function(){return this.$anchorOffsetX},set:function(t){this.$setAnchorOffsetX(t)},enumerable:!0,configurable:!0}),r.prototype.$setAnchorOffsetX=function(e){var i=this;if(i.$anchorOffsetX!=e)if(i.$anchorOffsetX=e,t.nativeRender)i.$nativeDisplayObject.setAnchorOffsetX(e);else{var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"anchorOffsetY",{get:function(){return this.$anchorOffsetY},set:function(t){this.$setAnchorOffsetY(t)},enumerable:!0,configurable:!0}),r.prototype.$setAnchorOffsetY=function(e){var i=this;if(i.$anchorOffsetY!=e)if(i.$anchorOffsetY=e,t.nativeRender)i.$nativeDisplayObject.setAnchorOffsetY(e);else{var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"visible",{get:function(){return this.$visible},set:function(t){this.$setVisible(t)},enumerable:!0,configurable:!0}),r.prototype.$setVisible=function(e){var i=this;if(i.$visible!=e)if(i.$visible=e,t.nativeRender)i.$nativeDisplayObject.setVisible(e);else{i.$updateRenderMode();var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"cacheAsBitmap",{get:function(){return this.$cacheAsBitmap},set:function(e){var i=this;i.$cacheAsBitmap=e,t.nativeRender?i.$nativeDisplayObject.setCacheAsBitmap(e):i.$setHasDisplayList(e)},enumerable:!0,configurable:!0}),r.prototype.$setHasDisplayList=function(e){var i=this,r=!!i.$displayList;if(r!=e)if(e){var n=t.sys.DisplayList.create(i);n&&(i.$displayList=n,i.$cacheDirty=!0)}else i.$displayList=null},r.prototype.$cacheDirtyUp=function(){var t=this.$parent;t&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp())},Object.defineProperty(r.prototype,"alpha",{get:function(){return this.$alpha},set:function(t){this.$setAlpha(t)},enumerable:!0,configurable:!0}),r.prototype.$setAlpha=function(e){var i=this;if(i.$alpha!=e)if(i.$alpha=e,t.nativeRender)i.$nativeDisplayObject.setAlpha(e);else{i.$updateRenderMode();var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"touchEnabled",{get:function(){return this.$getTouchEnabled()},set:function(t){this.$setTouchEnabled(t)},enumerable:!0,configurable:!0}),r.prototype.$getTouchEnabled=function(){return this.$touchEnabled},r.prototype.$setTouchEnabled=function(t){this.$touchEnabled=!!t},Object.defineProperty(r.prototype,"scrollRect",{get:function(){return this.$scrollRect},set:function(t){this.$setScrollRect(t)},enumerable:!0,configurable:!0}),r.prototype.$setScrollRect=function(e){var i=this;if(!e&&!i.$scrollRect)return void i.$updateRenderMode();if(e?(i.$scrollRect||(i.$scrollRect=new t.Rectangle),i.$scrollRect.copyFrom(e),t.nativeRender&&i.$nativeDisplayObject.setScrollRect(e.x,e.y,e.width,e.height)):(i.$scrollRect=null,t.nativeRender&&i.$nativeDisplayObject.setScrollRect(0,0,0,0)),!t.nativeRender){i.$updateRenderMode();var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"blendMode",{get:function(){return t.sys.numberToBlendMode(this.$blendMode)},set:function(e){var i=this,r=t.sys.blendModeToNumber(e);if(i.$blendMode!=r)if(i.$blendMode=r,t.nativeRender)i.$nativeDisplayObject.setBlendMode(r);else{i.$updateRenderMode();var n=i.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=i.$maskedObject;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp())}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"mask",{get:function(){var t=this;return t.$mask?t.$mask:t.$maskRect},set:function(e){var i=this;if(e!==i){if(e)if(e instanceof r){if(e==i.$mask)return;e.$maskedObject&&(e.$maskedObject.mask=null),e.$maskedObject=i,i.$mask=e,t.nativeRender||e.$updateRenderMode(),i.$maskRect&&(t.nativeRender&&i.$nativeDisplayObject.setMaskRect(0,0,0,0),i.$maskRect=null),t.nativeRender&&i.$nativeDisplayObject.setMask(e.$nativeDisplayObject.id)}else i.$maskRect||(i.$maskRect=new t.Rectangle),i.$maskRect.copyFrom(e),t.nativeRender&&i.$nativeDisplayObject.setMaskRect(e.x,e.y,e.width,e.height),i.$mask&&(i.$mask.$maskedObject=null,t.nativeRender||i.$mask.$updateRenderMode()),i.mask&&(t.nativeRender&&i.$nativeDisplayObject.setMask(-1),i.$mask=null);else i.$mask&&(i.$mask.$maskedObject=null,t.nativeRender||i.$mask.$updateRenderMode()),i.mask&&(t.nativeRender&&i.$nativeDisplayObject.setMask(-1),i.$mask=null),i.$maskRect&&(t.nativeRender&&i.$nativeDisplayObject.setMaskRect(0,0,0,0),i.$maskRect=null);t.nativeRender||i.$updateRenderMode()}},enumerable:!0,configurable:!0}),r.prototype.$setMaskRect=function(e){var i=this;(e||i.$maskRect)&&(e?(i.$maskRect||(i.$maskRect=new t.Rectangle),i.$maskRect.copyFrom(e)):i.$maskRect=null)},Object.defineProperty(r.prototype,"filters",{get:function(){return this.$filters},set:function(e){var i=this,r=i.$filters;if(r||e){if(e&&e.length?(e=e.concat(),i.$filters=e,t.nativeRender&&i.$nativeDisplayObject.setFilters(e)):(i.$filters=e,t.nativeRender&&i.$nativeDisplayObject.setFilters(null)),!t.nativeRender){i.$updateRenderMode();var n=i.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=i.$maskedObject;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp())}}else if(i.$filters=e,t.nativeRender)i.$nativeDisplayObject.setFilters(null);else{i.$updateRenderMode();var n=i.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=i.$maskedObject;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp())}},enumerable:!0,configurable:!0}),r.prototype.getTransformedBounds=function(t,e){return t=t||this,this.$getTransformedBounds(t,e)},r.prototype.getBounds=function(t,e){void 0===e&&(e=!0);var i=this;return t=i.$getTransformedBounds(i,t),e&&(0!=i.$anchorOffsetX&&(t.x-=i.$anchorOffsetX),0!=i.$anchorOffsetY&&(t.y-=i.$anchorOffsetY)),t},r.prototype.$getTransformedBounds=function(e,i){var r=this,n=r.$getOriginalBounds();if(i||(i=new t.Rectangle),i.copyFrom(n),e==r)return i;var a;if(e){a=t.$TempMatrix;var o=e.$getInvertedConcatenatedMatrix();o.$preMultiplyInto(r.$getConcatenatedMatrix(),a)}else a=r.$getConcatenatedMatrix();return a.$transformBounds(i),i},r.prototype.globalToLocal=function(e,i,r){if(void 0===e&&(e=0),void 0===i&&(i=0),t.nativeRender){egret_native.updateNativeRender();var n=egret_native.nrGlobalToLocal(this.$nativeDisplayObject.id,e,i),a=n.split(","),o=parseFloat(a[0]),s=parseFloat(a[1]);return r?r.setTo(o,s):r=new t.Point(o,s),r}var h=this.$getInvertedConcatenatedMatrix();return h.transformPoint(e,i,r)},r.prototype.localToGlobal=function(e,i,r){if(void 0===e&&(e=0),void 0===i&&(i=0),t.nativeRender){egret_native.updateNativeRender();var n=egret_native.nrLocalToGlobal(this.$nativeDisplayObject.id,e,i),a=n.split(","),o=parseFloat(a[0]),s=parseFloat(a[1]);return r?r.setTo(o,s):r=new t.Point(o,s),r}var h=this.$getConcatenatedMatrix();return h.transformPoint(e,i,r)},r.prototype.$getOriginalBounds=function(){var t=this,e=t.$getContentBounds();t.$measureChildBounds(e);var i=t.$measureFiltersOffset(!1);return i&&(e.x+=i.minX,e.y+=i.minY,e.width+=-i.minX+i.maxX,e.height+=-i.minY+i.maxY),e},r.prototype.$measureChildBounds=function(t){},r.prototype.$getContentBounds=function(){var e=t.$TempRectangle;return e.setEmpty(),this.$measureContentBounds(e),e},r.prototype.$measureContentBounds=function(t){},r.prototype.$getRenderNode=function(){var t=this,e=t.$renderNode;return e?(t.$renderDirty&&(e.cleanBeforeRender(),t.$updateRenderNode(),t.$renderDirty=!1,e=t.$renderNode),e):null},r.prototype.$updateRenderMode=function(){var t=this;!t.$visible||t.$alpha<=0||t.$maskedObject?t.$renderMode=1:t.filters&&t.filters.length>0?t.$renderMode=2:0!==t.$blendMode||t.$mask&&t.$mask.$stage?t.$renderMode=3:t.$scrollRect||t.$maskRect?t.$renderMode=4:t.$renderMode=null},r.prototype.$measureFiltersOffset=function(e){for(var i=this,r=0,n=0,a=0,o=0;i;){var s=i.$filters;if(s&&s.length)for(var h=s.length,c=0;h>c;c++){var l=s[c];if("blur"==l.type){var u=l.blurX,p=l.blurY;r-=u,n-=p,a+=u,o+=p}else if("glow"==l.type){var u=l.blurX,p=l.blurY;r-=u,n-=p,a+=u,o+=p;var d=l.distance||0,f=l.angle||0,g=0,$=0;0!=d&&(g=d*t.NumberUtils.cos(f),g=g>0?Math.ceil(g):Math.floor(g),$=d*t.NumberUtils.sin(f),$=$>0?Math.ceil($):Math.floor($),r+=g,a+=g,n+=$,o+=$)}else if("custom"==l.type){var y=l.padding;r-=y,n-=y,a+=y,o+=y}}i=e?i.$parent:null}return r=Math.min(r,0),n=Math.min(n,0),a=Math.max(a,0),o=Math.max(o,0),{minX:r,minY:n,maxX:a,maxY:o}},r.prototype.$getConcatenatedMatrixAt=function(e,i){var r=e.$getInvertedConcatenatedMatrix();if(0!==r.a&&0!==r.d||0!==r.b&&0!==r.c)r.$preMultiplyInto(i,i);else{var n=this,a=e.$nestLevel;for(i.identity();n.$nestLevel>a;){var o=n.$scrollRect;o&&i.concat(t.$TempMatrix.setTo(1,0,0,1,-o.x,-o.y)),i.concat(n.$getMatrix()),n=n.$parent}}},r.prototype.$updateRenderNode=function(){},r.prototype.$hitTest=function(e,i){var r=this;if(!t.nativeRender&&!r.$renderNode||!r.$visible||0==r.$scaleX||0==r.$scaleY)return null;var n=r.$getInvertedConcatenatedMatrix();if(0==n.a&&0==n.b&&0==n.c&&0==n.d)return null;var a=r.$getContentBounds(),o=n.a*e+n.c*i+n.tx,s=n.b*e+n.d*i+n.ty;if(a.contains(o,s)){if(!r.$children){var h=r.$scrollRect?r.$scrollRect:r.$maskRect;if(h&&!h.contains(o,s))return null;if(r.$mask&&!r.$mask.$hitTest(e,i))return null}return r}return null},r.prototype.hitTestPoint=function(e,i,r){var n=this;if(r){var a=n.$getInvertedConcatenatedMatrix(),o=a.a*e+a.c*i+a.tx,s=a.b*e+a.d*i+a.ty,h=void 0;if(t.nativeRender){var c=t.sys.customHitTestBuffer;c.resize(3,3),egret_native.forHitTest=!0,egret_native.activateBuffer(c),egret_native.updateNativeRender(),egret_native.nrRenderDisplayObject2(n.$nativeDisplayObject.id,1-o,1-s,!0);try{h=new Uint8Array(4),egret_native.nrGetPixels(1,1,1,1,h)}catch(l){throw new Error(t.sys.tr(1039))}return egret_native.activateBuffer(null),egret_native.forHitTest=!1,0===h[3]?!1:!0}var u=n.$displayList;if(u){var c=u.renderBuffer;try{h=c.getPixels(o-u.offsetX,s-u.offsetY)}catch(l){throw new Error(t.sys.tr(1039))}}else{var c=t.sys.customHitTestBuffer;c.resize(3,3);var p=t.Matrix.create();p.identity(),p.translate(1-o,1-s),t.sys.systemRenderer.render(this,c,p,!0),t.Matrix.release(p);try{h=c.getPixels(1,1)}catch(l){throw new Error(t.sys.tr(1039))}}return 0===h[3]?!1:!0}if(0==n.$scaleX||0==n.$scaleY)return!1;var a=n.$getInvertedConcatenatedMatrix(),d=n.getBounds(null,!1),o=a.a*e+a.c*i+a.tx,s=a.b*e+a.d*i+a.ty;if(d.contains(o,s)){var f=n.$scrollRect?n.$scrollRect:n.$maskRect;return f&&!f.contains(o,s)?!1:!0}return!1},r.prototype.$addListener=function(e,n,a,o,s,h){i.prototype.$addListener.call(this,e,n,a,o,s,h);var c=e==t.Event.ENTER_FRAME;if(c||e==t.Event.RENDER){var l=c?r.$enterFrameCallBackList:r.$renderCallBackList;-1==l.indexOf(this)&&l.push(this)}},r.prototype.removeEventListener=function(e,n,a,o){i.prototype.removeEventListener.call(this,e,n,a,o);var s=e==t.Event.ENTER_FRAME;if((s||e==t.Event.RENDER)&&!this.hasEventListener(e)){var h=s?r.$enterFrameCallBackList:r.$renderCallBackList,c=h.indexOf(this);-1!==c&&h.splice(c,1)}},r.prototype.dispatchEvent=function(t){if(!t.$bubbles)return i.prototype.dispatchEvent.call(this,t);var e=this.$getPropagationList(this),r=.5*e.length;return t.$setTarget(this),this.$dispatchPropagationEvent(t,e,r),!t.$isDefaultPrevented},r.prototype.$getPropagationList=function(t){for(var e=[];t;)e.push(t),t=t.$parent;var i=e.concat();return i.reverse(),e=i.concat(e)},r.prototype.$dispatchPropagationEvent=function(t,e,i){for(var r=e.length,n=i-1,a=0;r>a;a++){var o=e[a];if(t.$currentTarget=o,n>a?t.$eventPhase=1:a==i||a==n?t.$eventPhase=2:t.$eventPhase=3,o.$notifyListener(t,i>a),t.$isPropagationStopped||t.$isPropagationImmediateStopped)return}},r.prototype.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e.$parent}return!1},Object.defineProperty(r.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e,t.nativeRender?this.$nativeDisplayObject.setTint&&this.$nativeDisplayObject.setTint(e):this.$tintRGB=(e>>16)+(65280&e)+((255&e)<<16)},enumerable:!0,configurable:!0}),r.prototype.sortChildren=function(){this.$sortDirty=!1},Object.defineProperty(r.prototype,"zIndex",{get:function(){return this._zIndex},set:function(e){this._zIndex=e,t.nativeRender?this.$nativeDisplayObject.setZIndex&&this.$nativeDisplayObject.setZIndex(e):this.parent&&(this.parent.$sortDirty=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"sortableChildren",{get:function(){return this._sortableChildren},set:function(t){this._sortableChildren=t,this.$nativeDisplayObject&&this.$nativeDisplayObject.setSortableChildren&&this.$nativeDisplayObject.setSortableChildren(t)},enumerable:!0,configurable:!0}),r.defaultTouchEnabled=!1,r.$enterFrameCallBackList=[],r.$renderCallBackList=[],r}(t.EventDispatcher);t.DisplayObject=i,__reflect(i.prototype,"egret.DisplayObject")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.type=null,i.$id=null,i.paddingTop=0,i.paddingBottom=0,i.paddingLeft=0,i.paddingRight=0,i.$uniforms={},t.nativeRender&&egret_native.NativeDisplayObject.createFilter(i),i}return __extends(i,e),i.prototype.$toJson=function(){return""},i.prototype.updatePadding=function(){},i.prototype.onPropertyChange=function(){var e=this;e.updatePadding(),t.nativeRender&&(egret_native.NativeDisplayObject.setFilterPadding(e.$id,e.paddingTop,e.paddingBottom,e.paddingLeft,e.paddingRight),egret_native.NativeDisplayObject.setDataToFilter(e))},i}(t.HashObject);t.Filter=e,__reflect(e.prototype,"egret.Filter")}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$language="en_US"}(egret||(egret={})),function(t){var e;!function(e){function i(e){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];var n=t.$locale_strings[t.$language][e];if(!n)return"{"+e+"}";for(var a=i.length,o=0;a>o;o++)n=n.replace("{"+o+"}",i[o]);return n}e.tr=i}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(i){var r=e.call(this)||this;return r._bitmapX=0,r._bitmapY=0,r._textureMap=t.createMap(),r.$texture=i,r._bitmapX=i.$bitmapX-i.$offsetX,r._bitmapY=i.$bitmapY-i.$offsetY,r}return __extends(i,e),i.prototype.getTexture=function(t){return this._textureMap[t]},i.prototype.createTexture=function(e,i,r,n,a,o,s,h,c){void 0===o&&(o=0),void 0===s&&(s=0),void 0===h&&(h=o+n),void 0===c&&(c=s+a);var l=new t.Texture;return l.disposeBitmapData=!1,l.$bitmapData=this.$texture.$bitmapData,l.$initData(this._bitmapX+i,this._bitmapY+r,n,a,o,s,h,c,this.$texture.$sourceWidth,this.$texture.$sourceHeight),this._textureMap[e]=l,l},i.prototype.dispose=function(){this.$texture&&this.$texture.dispose()},i}(t.HashObject);t.SpriteSheet=e,__reflect(e.prototype,"egret.SpriteSheet")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i,r,n){var a=t.call(this)||this;return a.$eventPhase=2,a.$currentTarget=null,a.$target=null,a.$isDefaultPrevented=!1,a.$isPropagationStopped=!1,a.$isPropagationImmediateStopped=!1,a.$type=e,a.$bubbles=!!i,a.$cancelable=!!r,a.data=n,a}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.$type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bubbles",{get:function(){return this.$bubbles},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cancelable",{get:function(){return this.$cancelable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventPhase",{get:function(){return this.$eventPhase},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTarget",{get:function(){return this.$currentTarget},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this.$target},enumerable:!0,configurable:!0}),e.prototype.$setTarget=function(t){return this.$target=t,!0},e.prototype.isDefaultPrevented=function(){return this.$isDefaultPrevented},e.prototype.preventDefault=function(){this.$cancelable&&(this.$isDefaultPrevented=!0)},e.prototype.stopPropagation=function(){this.$bubbles&&(this.$isPropagationStopped=!0)},e.prototype.stopImmediatePropagation=function(){this.$bubbles&&(this.$isPropagationImmediateStopped=!0)},e.prototype.clean=function(){this.data=this.$currentTarget=null,this.$setTarget(null)},e.dispatchEvent=function(t,i,r,n){void 0===r&&(r=!1);var a=e.create(e,i,r),o=e._getPropertyData(e);void 0!=n&&(o.data=n);var s=t.dispatchEvent(a);return e.release(a),s},e._getPropertyData=function(t){var e=t._props;return e||(e=t._props={}),e},e.create=function(t,e,i,r){var n,a=t.hasOwnProperty("eventPool");if(a&&(n=t.eventPool),n||(n=t.eventPool=[]),n.length){var o=n.pop();return o.$type=e,o.$bubbles=!!i,o.$cancelable=!!r,o.$isDefaultPrevented=!1,o.$isPropagationStopped=!1,o.$isPropagationImmediateStopped=!1,o.$eventPhase=2,o}return new t(e,i,r)},e.release=function(t){t.clean();var e=Object.getPrototypeOf(t).constructor;e.eventPool.push(t)},e.ADDED_TO_STAGE="addedToStage",e.REMOVED_FROM_STAGE="removedFromStage",e.ADDED="added",e.REMOVED="removed",e.ENTER_FRAME="enterFrame",e.RENDER="render",e.RESIZE="resize",e.CHANGE="change",e.CHANGING="changing",e.COMPLETE="complete",e.LOOP_COMPLETE="loopComplete",e.FOCUS_IN="focusIn",e.FOCUS_OUT="focusOut",e.ENDED="ended",e.ACTIVATE="activate",e.DEACTIVATE="deactivate",e.CLOSE="close",e.CONNECT="connect",e.LEAVE_STAGE="leaveStage",e.SOUND_COMPLETE="soundComplete",e}(t.HashObject);t.Event=e,__reflect(e.prototype,"egret.Event")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.$touchChildren=!0,t.$children=[],t}return __extends(i,e),Object.defineProperty(i.prototype,"numChildren",{get:function(){return this.$children.length},enumerable:!0,configurable:!0}),i.prototype.setChildrenSortMode=function(e){t.nativeRender&&this.$nativeDisplayObject.setChildrenSortMode&&this.$nativeDisplayObject.setChildrenSortMode(e)},i.prototype.addChild=function(t){var e=this.$children.length;return t.$parent==this&&e--,this.$doAddChild(t,e)},i.prototype.addChildAt=function(t,e){return e=0|+e,(0>e||e>=this.$children.length)&&(e=this.$children.length,t.$parent==this&&e--),this.$doAddChild(t,e)},i.prototype.$doAddChild=function(e,r,n){void 0===n&&(n=!0);var a=this,o=e.$parent;if(o==a)return a.doSetChildIndex(e,r),e;o&&o.removeChild(e),a.$children.splice(r,0,e),e.$setParent(a),t.nativeRender&&a.$nativeDisplayObject.addChildAt(e.$nativeDisplayObject.id,r);var s=a.$stage;if(s&&e.$onAddToStage(s,a.$nestLevel+1),n&&e.dispatchEventWith(t.Event.ADDED,!0),s)for(var h=i.$EVENT_ADD_TO_STAGE_LIST;h.length;){var c=h.shift();c.$stage&&n&&c.dispatchEventWith(t.Event.ADDED_TO_STAGE)}if(!t.nativeRender&&(e.$maskedObject&&e.$maskedObject.$updateRenderMode(),!a.$cacheDirty)){a.$cacheDirty=!0;var l=a.$parent;l&&!l.$cacheDirty&&(l.$cacheDirty=!0,l.$cacheDirtyUp());var u=a.$maskedObject;u&&!u.$cacheDirty&&(u.$cacheDirty=!0,u.$cacheDirtyUp())}return this.$childAdded(e,r),e},i.prototype.contains=function(t){for(;t;){if(t==this)return!0;t=t.$parent}return!1},i.prototype.getChildAt=function(t){return t=0|+t,t>=0&&t<this.$children.length?this.$children[t]:null},i.prototype.getChildIndex=function(t){return this.$children.indexOf(t)},i.prototype.getChildByName=function(t){for(var e,i=this.$children,r=i.length,n=0;r>n;n++)if(e=i[n],e.name==t)return e;return null},i.prototype.removeChild=function(t){var e=this.$children.indexOf(t);return e>=0?this.$doRemoveChild(e):null},i.prototype.removeChildAt=function(t){return t=0|+t,t>=0&&t<this.$children.length?this.$doRemoveChild(t):null},i.prototype.$doRemoveChild=function(e,r){void 0===r&&(r=!0),e=0|+e;var n=this,a=this.$children,o=a[e];if(this.$childRemoved(o,e),r&&o.dispatchEventWith(t.Event.REMOVED,!0),this.$stage){o.$onRemoveFromStage();for(var s=i.$EVENT_REMOVE_FROM_STAGE_LIST;s.length>0;){var h=s.shift();r&&h.$hasAddToStage&&(h.$hasAddToStage=!1,h.dispatchEventWith(t.Event.REMOVED_FROM_STAGE)),h.$hasAddToStage=!1,h.$stage=null}}this.$displayList||this.$parentDisplayList;o.$setParent(null);var c=a.indexOf(o);if(-1!=c&&a.splice(c,1),t.nativeRender)n.$nativeDisplayObject.removeChild(o.$nativeDisplayObject.id);else if(o.$maskedObject&&o.$maskedObject.$updateRenderMode(),!n.$cacheDirty){n.$cacheDirty=!0;var l=n.$parent;l&&!l.$cacheDirty&&(l.$cacheDirty=!0,l.$cacheDirtyUp());
var u=n.$maskedObject;u&&!u.$cacheDirty&&(u.$cacheDirty=!0,u.$cacheDirtyUp())}return o},i.prototype.setChildIndex=function(t,e){e=0|+e,(0>e||e>=this.$children.length)&&(e=this.$children.length-1),this.doSetChildIndex(t,e)},i.prototype.doSetChildIndex=function(e,i){var r=this,n=this.$children.indexOf(e);if(n!=i)if(this.$childRemoved(e,n),this.$children.splice(n,1),this.$children.splice(i,0,e),this.$childAdded(e,i),t.nativeRender)this.$nativeDisplayObject.removeChild(e.$nativeDisplayObject.id),this.$nativeDisplayObject.addChildAt(e.$nativeDisplayObject.id,i);else if(!r.$cacheDirty){r.$cacheDirty=!0;var a=r.$parent;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp());var o=r.$maskedObject;o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp())}},i.prototype.swapChildrenAt=function(t,e){t=0|+t,e=0|+e,t>=0&&t<this.$children.length&&e>=0&&e<this.$children.length&&this.doSwapChildrenAt(t,e)},i.prototype.swapChildren=function(t,e){var i=this.$children.indexOf(t),r=this.$children.indexOf(e);-1==i||-1==r||this.doSwapChildrenAt(i,r)},i.prototype.doSwapChildrenAt=function(e,i){var r=this;if(e>i){var n=i;i=e,e=n}else if(e==i)return;var a=this.$children,o=a[e],s=a[i];if(this.$childRemoved(o,e),this.$childRemoved(s,i),a[e]=s,a[i]=o,this.$childAdded(s,e),this.$childAdded(o,i),t.nativeRender)this.$nativeDisplayObject.swapChild(e,i);else if(!r.$cacheDirty){r.$cacheDirty=!0;var h=r.$parent;h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp());var c=r.$maskedObject;c&&!c.$cacheDirty&&(c.$cacheDirty=!0,c.$cacheDirtyUp())}},i.prototype.removeChildren=function(){for(var t=this.$children,e=t.length-1;e>=0;e--)this.$doRemoveChild(e)},i.prototype.$childAdded=function(t,e){},i.prototype.$childRemoved=function(t,e){},i.prototype.$onAddToStage=function(t,i){e.prototype.$onAddToStage.call(this,t,i);var r=this.$children,n=r.length;i++;for(var a=0;n>a;a++){var o=this.$children[a];o.$onAddToStage(t,i),o.$maskedObject&&o.$maskedObject.$updateRenderMode()}},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);for(var t=this.$children,i=t.length,r=0;i>r;r++){var n=t[r];n.$onRemoveFromStage()}},i.prototype.$measureChildBounds=function(e){var i=this.$children,r=i.length;if(0!=r){for(var n=0,a=0,o=0,s=0,h=!1,c=-1;r>c;c++){var l=void 0;-1==c?l=e:(i[c].getBounds(t.$TempRectangle),i[c].$getMatrix().$transformBounds(t.$TempRectangle),l=t.$TempRectangle),l.isEmpty()||(h?(n=Math.min(n,l.x),a=Math.max(a,l.x+l.width),o=Math.min(o,l.y),s=Math.max(s,l.y+l.height)):(h=!0,n=l.x,a=n+l.width,o=l.y,s=o+l.height))}e.setTo(n,o,a-n,s-o)}},Object.defineProperty(i.prototype,"touchChildren",{get:function(){return this.$getTouchChildren()},set:function(t){this.$setTouchChildren(!!t)},enumerable:!0,configurable:!0}),i.prototype.$getTouchChildren=function(){return this.$touchChildren},i.prototype.$setTouchChildren=function(t){return this.$touchChildren==t?!1:(this.$touchChildren=t,!0)},i.prototype.$hitTest=function(t,i){if(!this.$visible)return null;var r=this.$getInvertedConcatenatedMatrix(),n=r.a*t+r.c*i+r.tx,a=r.b*t+r.d*i+r.ty,o=this.$scrollRect?this.$scrollRect:this.$maskRect;if(o&&!o.contains(n,a))return null;if(this.$mask&&!this.$mask.$hitTest(t,i))return null;for(var s=this.$children,h=!1,c=null,l=s.length-1;l>=0;l--){var u=s[l];if(!u.$maskedObject&&(c=u.$hitTest(t,i))){if(h=!0,c.$touchEnabled)break;c=null}}return c?this.$touchChildren?c:this:h?this:e.prototype.$hitTest.call(this,t,i)},i.prototype._sortChildrenFunc=function(t,e){return t.zIndex===e.zIndex?t.$lastSortedIndex-e.$lastSortedIndex:t.zIndex-e.zIndex},i.prototype.sortChildren=function(){if(e.prototype.sortChildren.call(this),this.$nativeDisplayObject&&this.$nativeDisplayObject.sortChildren)this.$nativeDisplayObject.sortChildren();else{this.$sortDirty=!1;for(var t=!1,i=this.$children,r=null,n=0,a=i.length;a>n;++n)r=i[n],r.$lastSortedIndex=n,t||0===r.zIndex||(t=!0);t&&i.length>1&&i.sort(this._sortChildrenFunc)}},i.$EVENT_ADD_TO_STAGE_LIST=[],i.$EVENT_REMOVE_FROM_STAGE_LIST=[],i}(t.DisplayObject);t.DisplayObjectContainer=e,__reflect(e.prototype,"egret.DisplayObjectContainer")}(egret||(egret={}));var egret;!function(t){var e=[],i=Math.PI/180,r=function(r){function n(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=r.call(this)||this;return i.x=t,i.y=e,i}return __extends(n,r),n.release=function(t){t&&e.push(t)},n.create=function(t,i){var r=e.pop();return r||(r=new n),r.setTo(t,i)},Object.defineProperty(n.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),n.prototype.setTo=function(t,e){return this.x=t,this.y=e,this},n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.equals=function(t){return this.x==t.x&&this.y==t.y},n.distance=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},n.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y)},n.interpolate=function(t,e,i){var r=1-i;return new n(t.x*i+e.x*r,t.y*i+e.y*r)},n.prototype.normalize=function(t){if(0!=this.x||0!=this.y){var e=t/this.length;this.x*=e,this.y*=e}},n.prototype.offset=function(t,e){this.x+=t,this.y+=e},n.polar=function(e,r){return new n(e*t.NumberUtils.cos(r/i),e*t.NumberUtils.sin(r/i))},n.prototype.subtract=function(t){return new n(this.x-t.x,this.y-t.y)},n.prototype.toString=function(){return"(x="+this.x+", y="+this.y+")"},n}(t.HashObject);t.Point=r,__reflect(r.prototype,"egret.Point"),t.$TempPoint=new r}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(r){var n=e.call(this)||this;return n.$texture=null,n.$bitmapData=null,n.$bitmapX=0,n.$bitmapY=0,n.$bitmapWidth=0,n.$bitmapHeight=0,n.$offsetX=0,n.$offsetY=0,n.$textureWidth=0,n.$textureHeight=0,n.$sourceWidth=0,n.$sourceHeight=0,n.$smoothing=i.defaultSmoothing,n.$explicitBitmapWidth=0/0,n.$explicitBitmapHeight=0/0,n.$scale9Grid=null,n.$fillMode="scale",n._pixelHitTest=!1,n.$renderNode=new t.sys.NormalBitmapNode,n.$setTexture(r),r&&(n.$renderNode.rotated=r.$rotated),n}return __extends(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(1)},i.prototype.$onAddToStage=function(i,r){e.prototype.$onAddToStage.call(this,i,r);var n=this.$texture;n&&n.$bitmapData&&t.BitmapData.$addDisplayObject(this,n.$bitmapData)},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);var i=this.$texture;i&&t.BitmapData.$removeDisplayObject(this,i.$bitmapData)},Object.defineProperty(i.prototype,"texture",{get:function(){return this.$texture},set:function(t){var e=this;e.$setTexture(t),t&&e.$renderNode&&(e.$renderNode.rotated=t.$rotated)},enumerable:!0,configurable:!0}),i.prototype.$setTexture=function(e){var i=this,r=i.$texture;if(e==r)return!1;if(i.$texture=e,!e){r&&t.BitmapData.$removeDisplayObject(i,r.$bitmapData),i.setImageData(null,0,0,0,0,0,0,0,0,0,0),i.$renderDirty=!0;var n=i.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=i.$maskedObject;return a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp()),t.nativeRender&&this.setBitmapDataToWasm(null),!0}if(i.$refreshImageData(),i.$stage){if(r&&r.$bitmapData){var o=r.$bitmapData.hashCode,s=e.$bitmapData?e.$bitmapData.hashCode:-1;if(o==s){i.$renderDirty=!0;var h=i.$parent;h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp());var c=i.$maskedObject;return c&&!c.$cacheDirty&&(c.$cacheDirty=!0,c.$cacheDirtyUp()),!0}t.BitmapData.$removeDisplayObject(i,r.$bitmapData)}t.BitmapData.$addDisplayObject(i,e.$bitmapData)}i.$renderDirty=!0;var l=i.$parent;l&&!l.$cacheDirty&&(l.$cacheDirty=!0,l.$cacheDirtyUp());var u=i.$maskedObject;return u&&!u.$cacheDirty&&(u.$cacheDirty=!0,u.$cacheDirtyUp()),!0},i.prototype.$setBitmapData=function(t){this.$setTexture(t)},i.prototype.setBitmapDataToWasm=function(t){this.$nativeDisplayObject.setTexture(t)},i.prototype.$refreshImageData=function(){var e=this.$texture;e?(t.nativeRender&&this.setBitmapDataToWasm(e),this.setImageData(e.$bitmapData,e.$bitmapX,e.$bitmapY,e.$bitmapWidth,e.$bitmapHeight,e.$offsetX,e.$offsetY,e.$getTextureWidth(),e.$getTextureHeight(),e.$sourceWidth,e.$sourceHeight)):t.nativeRender&&this.setBitmapDataToWasm(null)},i.prototype.setImageData=function(t,e,i,r,n,a,o,s,h,c,l){this.$bitmapData=t,this.$bitmapX=e,this.$bitmapY=i,this.$bitmapWidth=r,this.$bitmapHeight=n,this.$offsetX=a,this.$offsetY=o,this.$textureWidth=s,this.$textureHeight=h,this.$sourceWidth=c,this.$sourceHeight=l},Object.defineProperty(i.prototype,"scale9Grid",{get:function(){return this.$scale9Grid},set:function(t){this.$setScale9Grid(t)},enumerable:!0,configurable:!0}),i.prototype.$setScale9Grid=function(e){var i=this;if(i.$scale9Grid=e,i.$renderDirty=!0,t.nativeRender)e?i.$nativeDisplayObject.setScale9Grid(e.x,e.y,e.width,e.height):i.$nativeDisplayObject.setScale9Grid(0,0,-1,-1);else{var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"fillMode",{get:function(){return this.$fillMode},set:function(t){this.$setFillMode(t)},enumerable:!0,configurable:!0}),i.prototype.$setFillMode=function(e){var i=this;if(e==i.$fillMode)return!1;if(i.$fillMode=e,t.nativeRender)i.$nativeDisplayObject.setBitmapFillMode(i.$fillMode);else{i.$renderDirty=!0;var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}return!0},Object.defineProperty(i.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(e){var i=this;if(e!=this.$smoothing&&(this.$smoothing=e,this.$renderNode.smoothing=e,!t.nativeRender)){var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},enumerable:!0,configurable:!0}),i.prototype.$setWidth=function(e){var i=this;if(0>e||e==i.$explicitBitmapWidth)return!1;if(i.$explicitBitmapWidth=e,i.$renderDirty=!0,t.nativeRender)i.$nativeDisplayObject.setWidth(e);else{var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}return!0},i.prototype.$setHeight=function(e){var i=this;if(0>e||e==i.$explicitBitmapHeight)return!1;if(i.$explicitBitmapHeight=e,i.$renderDirty=!0,t.nativeRender)i.$nativeDisplayObject.setHeight(e);else{var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}return!0},i.prototype.$getWidth=function(){return isNaN(this.$explicitBitmapWidth)?this.$getContentBounds().width:this.$explicitBitmapWidth},i.prototype.$getHeight=function(){return isNaN(this.$explicitBitmapHeight)?this.$getContentBounds().height:this.$explicitBitmapHeight},i.prototype.$measureContentBounds=function(t){if(this.$bitmapData){var e=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,i=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight;t.setTo(0,0,e,i)}else{var e=isNaN(this.$explicitBitmapWidth)?0:this.$explicitBitmapWidth,i=isNaN(this.$explicitBitmapHeight)?0:this.$explicitBitmapHeight;t.setTo(0,0,e,i)}},i.prototype.$updateRenderNode=function(){if(this.$texture){var e=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,i=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight,r=this.scale9Grid||this.$texture.scale9Grid;r?(this.$renderNode instanceof t.sys.NormalBitmapNode&&(this.$renderNode=new t.sys.BitmapNode),t.sys.BitmapNode.$updateTextureDataWithScale9Grid(this.$renderNode,this.$bitmapData,r,this.$bitmapX,this.$bitmapY,this.$bitmapWidth,this.$bitmapHeight,this.$offsetX,this.$offsetY,this.$textureWidth,this.$textureHeight,e,i,this.$sourceWidth,this.$sourceHeight,this.$smoothing)):(this.fillMode==t.BitmapFillMode.REPEAT&&this.$renderNode instanceof t.sys.NormalBitmapNode&&(this.$renderNode=new t.sys.BitmapNode),t.sys.BitmapNode.$updateTextureData(this.$renderNode,this.$bitmapData,this.$bitmapX,this.$bitmapY,this.$bitmapWidth,this.$bitmapHeight,this.$offsetX,this.$offsetY,this.$textureWidth,this.$textureHeight,e,i,this.$sourceWidth,this.$sourceHeight,this.$fillMode,this.$smoothing))}},Object.defineProperty(i.prototype,"pixelHitTest",{get:function(){return this._pixelHitTest},set:function(t){this._pixelHitTest=!!t},enumerable:!0,configurable:!0}),i.prototype.$hitTest=function(t,i){var r=e.prototype.$hitTest.call(this,t,i);if(r&&this._pixelHitTest){var n=this.hitTestPoint(t,i,!0);n||(r=null)}return r},i.defaultSmoothing=!0,i}(t.DisplayObject);t.Bitmap=e,__reflect(e.prototype,"egret.Bitmap")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i,r,n,a,o,s,h){void 0===e&&(e=16711680),void 0===i&&(i=1),void 0===r&&(r=6),void 0===n&&(n=6),void 0===a&&(a=2),void 0===o&&(o=1),void 0===s&&(s=!1),void 0===h&&(h=!1);var c=t.call(this)||this,l=c;return l.type="glow",l.$color=e,l.$blue=255&e,l.$green=(65280&e)>>8,l.$red=e>>16,l.$alpha=i,l.$blurX=r,l.$blurY=n,l.$strength=a,l.$quality=o,l.$inner=s,l.$knockout=h,l.$uniforms.color={x:c.$red/255,y:c.$green/255,z:c.$blue/255,w:1},l.$uniforms.alpha=i,l.$uniforms.blurX=r,l.$uniforms.blurY=n,l.$uniforms.strength=a,l.$uniforms.inner=s?1:0,l.$uniforms.knockout=h?0:1,l.$uniforms.dist=0,l.$uniforms.angle=0,l.$uniforms.hideObject=0,l.onPropertyChange(),c}return __extends(e,t),Object.defineProperty(e.prototype,"color",{get:function(){return this.$color},set:function(t){this.$color!=t&&(this.$color=t,this.$blue=255&t,this.$green=(65280&t)>>8,this.$red=t>>16,this.$uniforms.color.x=this.$red/255,this.$uniforms.color.y=this.$green/255,this.$uniforms.color.z=this.$blue/255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.$alpha},set:function(t){this.$alpha!=t&&(this.$alpha=t,this.$uniforms.alpha=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.$blurX},set:function(t){var e=this;e.$blurX!=t&&(e.$blurX=t,e.$uniforms.blurX=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.$blurY},set:function(t){var e=this;e.$blurY!=t&&(e.$blurY=t,e.$uniforms.blurY=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this.$strength},set:function(t){this.$strength!=t&&(this.$strength=t,this.$uniforms.strength=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.$quality},set:function(t){this.$quality!=t&&(this.$quality=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inner",{get:function(){return this.$inner},set:function(t){this.$inner!=t&&(this.$inner=t,this.$uniforms.inner=t?1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"knockout",{get:function(){return this.$knockout},set:function(t){this.$knockout!=t&&(this.$knockout=t,this.$uniforms.knockout=t?0:1)},enumerable:!0,configurable:!0}),e.prototype.$toJson=function(){return'{"color": '+this.$color+', "red": '+this.$red+', "green": '+this.$green+', "blue": '+this.$blue+', "alpha": '+this.$alpha+', "blurX": '+this.$blurX+', "blurY": '+this.blurY+', "strength": '+this.$strength+', "quality": '+this.$quality+', "inner": '+this.$inner+', "knockout": '+this.$knockout+"}"},e.prototype.updatePadding=function(){var t=this;t.paddingLeft=t.blurX,t.paddingRight=t.blurX,t.paddingTop=t.blurY,t.paddingBottom=t.blurY},e}(t.Filter);t.GlowFilter=e,__reflect(e.prototype,"egret.GlowFilter")}(egret||(egret={}));var egret;!function(t){t.$TextureScaleFactor=1;var e=function(e){function i(){var t=e.call(this)||this;return t.disposeBitmapData=!0,t.$bitmapX=0,t.$bitmapY=0,t.$bitmapWidth=0,t.$bitmapHeight=0,t.$offsetX=0,t.$offsetY=0,t.$textureWidth=0,t.$textureHeight=0,t.$sourceWidth=0,t.$sourceHeight=0,t.$bitmapData=null,t.$ktxData=null,t.$rotated=!1,t}return __extends(i,e),Object.defineProperty(i.prototype,"textureWidth",{get:function(){return this.$getTextureWidth()},enumerable:!0,configurable:!0}),i.prototype.$getTextureWidth=function(){return this.$textureWidth},Object.defineProperty(i.prototype,"textureHeight",{get:function(){return this.$getTextureHeight()},enumerable:!0,configurable:!0}),i.prototype.$getTextureHeight=function(){return this.$textureHeight},i.prototype.$getScaleBitmapWidth=function(){return this.$bitmapWidth*t.$TextureScaleFactor},i.prototype.$getScaleBitmapHeight=function(){return this.$bitmapHeight*t.$TextureScaleFactor},Object.defineProperty(i.prototype,"bitmapData",{get:function(){return this.$bitmapData},set:function(t){this.$ktxData=null,this._setBitmapData(t)},enumerable:!0,configurable:!0}),i.prototype._setBitmapData=function(e){this.$bitmapData=e;var i=t.$TextureScaleFactor,r=e.width*i,n=e.height*i;this.$initData(0,0,r,n,0,0,r,n,e.width,e.height)},Object.defineProperty(i.prototype,"ktxData",{get:function(){return this.$ktxData},set:function(t){this._setKtxData(t)},enumerable:!0,configurable:!0}),i.prototype._setKtxData=function(e){if(!e)return void t.error("ktx data is null");if(e!=this.$ktxData){var i=new t.KTXContainer(e,1);if(i.isInvalid)return void t.error("ktx data is invalid");this.$ktxData=e;var r=new t.BitmapData(e);r.format="ktx",i.uploadLevels(r,!1),this._setBitmapData(r)}},i.prototype.$initData=function(e,i,r,n,a,o,s,h,c,l,u){void 0===u&&(u=!1);var p=t.$TextureScaleFactor;this.$bitmapX=e/p,this.$bitmapY=i/p,this.$bitmapWidth=r/p,this.$bitmapHeight=n/p,this.$offsetX=a,this.$offsetY=o,this.$textureWidth=s,this.$textureHeight=h,this.$sourceWidth=c,this.$sourceHeight=l,this.$rotated=u,t.BitmapData.$invalidate(this.$bitmapData)},i.prototype.getPixel32=function(t,e){throw new Error},i.prototype.getPixels=function(t,e,i,r){throw void 0===i&&(i=1),void 0===r&&(r=1),new Error},i.prototype.toDataURL=function(t,e,i){throw new Error},i.prototype.saveToFile=function(t,e,i){throw new Error},i.prototype.dispose=function(){this.$bitmapData&&(this.disposeBitmapData&&this.$bitmapData.$dispose(),this.$bitmapData=null)},i}(t.HashObject);t.Texture=e,__reflect(e.prototype,"egret.Texture")}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.type=0,this.drawData=[],this.renderCount=0}return t.prototype.cleanBeforeRender=function(){this.drawData.length=0,this.renderCount=0},t.prototype.$getRenderCount=function(){return this.renderCount},t}();t.RenderNode=e,__reflect(e.prototype,"egret.sys.RenderNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.type=0,this.$commands=[],this.$data=[],this.commandPosition=0,this.dataPosition=0,this.$lastX=0,this.$lastY=0}return t.prototype.moveTo=function(t,e){this.$commands[this.commandPosition++]=1;var i=this.dataPosition;this.$data[i++]=t,this.$data[i++]=e,this.dataPosition=i},t.prototype.lineTo=function(t,e){this.$commands[this.commandPosition++]=2;var i=this.dataPosition;this.$data[i++]=t,this.$data[i++]=e,this.dataPosition=i},t.prototype.curveTo=function(t,e,i,r){this.$commands[this.commandPosition++]=3;var n=this.dataPosition;this.$data[n++]=t,this.$data[n++]=e,this.$data[n++]=i,this.$data[n++]=r,this.dataPosition=n},t.prototype.cubicCurveTo=function(t,e,i,r,n,a){this.$commands[this.commandPosition++]=4;var o=this.dataPosition;this.$data[o++]=t,this.$data[o++]=e,this.$data[o++]=i,this.$data[o++]=r,this.$data[o++]=n,this.$data[o++]=a,this.dataPosition=o},t.prototype.drawRect=function(t,e,i,r){var n=t+i,a=e+r;this.moveTo(t,e),this.lineTo(n,e),this.lineTo(n,a),this.lineTo(t,a),this.lineTo(t,e)},t.prototype.drawRoundRect=function(t,e,i,r,n,a){var o=.5*n|0,s=a?.5*a|0:o;if(!o||!s)return void this.drawRect(t,e,i,r);var h=.5*i,c=.5*r;if(o>h&&(o=h),s>c&&(s=c),h===o&&c===s)return void(o===s?this.drawCircle(t+o,e+s,o):this.drawEllipse(t,e,2*o,2*s));var l=t+i,u=e+r,p=t+o,d=l-o,f=e+s,g=u-s;this.moveTo(l,g),this.curveTo(l,u,d,u),this.lineTo(p,u),this.curveTo(t,u,t,g),this.lineTo(t,f),this.curveTo(t,e,p,e),this.lineTo(d,e),this.curveTo(l,e,l,f),this.lineTo(l,g)},t.prototype.drawCircle=function(t,e,i){this.arcToBezier(t,e,i,i,0,2*Math.PI)},t.prototype.drawEllipse=function(t,e,i,r){var n=.5*i,a=.5*r;t+=n,e+=a,this.arcToBezier(t,e,n,a,0,2*Math.PI)},t.prototype.drawArc=function(t,e,i,r,n,a){a?n>=r&&(n-=2*Math.PI):r>=n&&(n+=2*Math.PI),this.arcToBezier(t,e,i,i,r,n,a)},t.prototype.arcToBezier=function(t,e,i,r,n,a,o){var s=.5*Math.PI,h=n,c=h;o?(c+=-s-h%s,a>c&&(c=a)):(c+=s-h%s,c>a&&(c=a));var l=t+Math.cos(h)*i,u=e+Math.sin(h)*r;(this.$lastX!=l||this.$lastY!=u)&&this.moveTo(l,u);for(var p=Math.cos(h),d=Math.sin(h),f=0;4>f;f++){var g=c-h,$=4*Math.tan(g/4)/3,y=l-d*$*i,v=u+p*$*r;p=Math.cos(c),d=Math.sin(c),l=t+p*i,u=e+d*r;var m=l+d*$*i,b=u-p*$*r;if(this.cubicCurveTo(y,v,m,b,l,u),c===a)break;h=c,o?(c=h-s,a>c&&(c=a)):(c=h+s,c>a&&(c=a))}},t}();t.Path2D=e,__reflect(e.prototype,"egret.sys.Path2D")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){t.fontMapping={}}(egret||(egret={}));var egret;!function(t){function e(){var t=Object.create(null);return t.__v8__=void 0,delete t.__v8__,t}t.createMap=e}(egret||(egret={}));var egret;!function(t){function e(){return""}function i(t){throw new Error("#"+t)}function r(){}function n(){}t.getString=e,t.$error=i,t.$warn=r,t.$markCannotUse=n}(egret||(egret={}));var egret;!function(t){t.BitmapFillMode={REPEAT:"repeat",SCALE:"scale",CLIP:"clip"}}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$stageWidth=0,i.$stageHeight=0,i.$scaleMode=t.StageScaleMode.SHOW_ALL,i.$orientation=t.OrientationMode.AUTO,i.$maxTouches=99,i.$drawToSurfaceAutoClear=function(){this.$displayList&&this.$displayList.drawToSurface()},i.$drawToSurface=function(){this.$displayList&&this.$displayList.$stageRenderToSurface()},i.$resize=function(e,i){this.$stageWidth=e,this.$stageHeight=i,this.$displayList.renderBuffer.resize(e,i),this.dispatchEventWith(t.Event.RESIZE)},i.$stage=i,i.$nestLevel=1,i}return __extends(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(13)},Object.defineProperty(i.prototype,"frameRate",{get:function(){return t.ticker.$frameRate},set:function(e){t.ticker.$setFrameRate(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stageWidth",{get:function(){return this.$stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stageHeight",{get:function(){return this.$stageHeight},enumerable:!0,configurable:!0}),i.prototype.invalidate=function(){t.sys.$invalidateRenderFlag=!0},i.prototype.registerImplementation=function(e,i){t.registerImplementation(e,i)},i.prototype.getImplementation=function(e){return t.getImplementation(e)},Object.defineProperty(i.prototype,"scaleMode",{get:function(){return this.$scaleMode},set:function(t){this.$scaleMode!=t&&(this.$scaleMode=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"orientation",{get:function(){return this.$orientation},set:function(t){this.$orientation!=t&&(this.$orientation=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textureScaleFactor",{get:function(){return t.$TextureScaleFactor},set:function(e){t.$TextureScaleFactor=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxTouches",{get:function(){return this.$maxTouches},set:function(t){this.$maxTouches!=t&&(this.$maxTouches=t,this.$screen.updateMaxTouches())},enumerable:!0,configurable:!0}),i.prototype.setContentSize=function(t,e){this.$screen.setContentSize(t,e)},i}(t.DisplayObjectContainer);t.Stage=e,__reflect(e.prototype,"egret.Stage")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.NORMAL="normal",t.ADD="add",t.ERASE="erase",t}();t.BlendMode=e,__reflect(e.prototype,"egret.BlendMode")}(egret||(egret={})),function(t){var e;!function(t){function e(t){var e=n[t];return void 0===e?0:e}function i(t){var e=r[t];return void 0===e?"normal":e}for(var r=["normal","add","erase"],n={},a=r.length,o=0;a>o;o++){var s=r[o];n[s]=o}t.blendModeToNumber=e,t.numberToBlendMode=i}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){t.ChildrenSortMode={DEFAULT:"default",INCREASE_Y:"increaseY",DECREASE_Y:"decreaseY"}}(egret||(egret={}));var egret;!function(t){t.CapsStyle={NONE:"none",ROUND:"round",SQUARE:"square"}}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){}return e.compileProgram=function(i,r,n){var a=e.compileFragmentShader(i,n),o=e.compileVertexShader(i,r),s=i.createProgram();return i.attachShader(s,o),i.attachShader(s,a),i.linkProgram(s),i.getProgramParameter(s,i.LINK_STATUS)||t.$warn(1020),s},e.compileFragmentShader=function(t,i){return e._compileShader(t,i,t.FRAGMENT_SHADER)},e.compileVertexShader=function(t,i){return e._compileShader(t,i,t.VERTEX_SHADER)},e._compileShader=function(t,e,i){var r=t.createShader(i);return t.shaderSource(r,e),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:null},e.checkCanUseWebGL=function(){if(void 0==e.canUseWebGL)try{var t=document.createElement("canvas");e.canUseWebGL=!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(i){e.canUseWebGL=!1}return e.canUseWebGL},e.deleteWebGLTexture=function(e){if(e&&!e[t.engine_default_empty_texture]){var i=e[t.glContext];i&&i.deleteTexture(e)}},e.premultiplyTint=function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return i=i*e+.5|0,r=r*e+.5|0,n=n*e+.5|0,(255*e<<24)+(i<<16)+(r<<8)+n},e}();t.WebGLUtils=e,__reflect(e.prototype,"egret.WebGLUtils")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i,r){return void 0===i&&(i=!1),void 0===r&&(r=!1),t.call(this,e,i,r)||this}return __extends(e,t),e.FOCUS_IN="focusIn",e.FOCUS_OUT="focusOut",e}(t.Event);t.FocusEvent=e,__reflect(e.prototype,"egret.FocusEvent")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.PERMISSION_DENIED="permissionDenied",e.UNAVAILABLE="unavailable",e}(t.Event);t.GeolocationEvent=e,__reflect(e.prototype,"egret.GeolocationEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r){void 0===i&&(i=!1),void 0===r&&(r=!1);var n=e.call(this,t,i,r)||this;return n._status=0,n}return __extends(i,e),Object.defineProperty(i.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),i.dispatchHTTPStatusEvent=function(e,r){var n=t.Event.create(i,i.HTTP_STATUS);n._status=r;var a=e.dispatchEvent(n);return t.Event.release(n),a},i.HTTP_STATUS="httpStatus",i}(t.Event);t.HTTPStatusEvent=e,__reflect(e.prototype,"egret.HTTPStatusEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r){return void 0===i&&(i=!1),void 0===r&&(r=!1),e.call(this,t,i,r)||this}return __extends(i,e),i.dispatchIOErrorEvent=function(e){var r=t.Event.create(i,i.IO_ERROR),n=e.dispatchEvent(r);return t.Event.release(r),n},i.IO_ERROR="ioError",i}(t.Event);t.IOErrorEvent=e,__reflect(e.prototype,"egret.IOErrorEvent")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Event);t.MotionEvent=e,__reflect(e.prototype,"egret.MotionEvent")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Event);t.OrientationEvent=e,__reflect(e.prototype,"egret.OrientationEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r,n,a){void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===n&&(n=0),void 0===a&&(a=0);var o=e.call(this,t,i,r)||this;return o.bytesLoaded=0,o.bytesTotal=0,o.bytesLoaded=n,o.bytesTotal=a,o}return __extends(i,e),i.dispatchProgressEvent=function(e,r,n,a){void 0===n&&(n=0),void 0===a&&(a=0);var o=t.Event.create(i,r);o.bytesLoaded=n,o.bytesTotal=a;var s=e.dispatchEvent(o);return t.Event.release(o),s},i.PROGRESS="progress",i.SOCKET_DATA="socketData",i}(t.Event);t.ProgressEvent=e,__reflect(e.prototype,"egret.ProgressEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r){return void 0===i&&(i=!1),void 0===r&&(r=!1),e.call(this,t,i,r)||this}return __extends(i,e),i.dispatchStageOrientationEvent=function(e,r){var n=t.Event.create(i,r),a=e.dispatchEvent(n);return t.Event.release(n),a},i.ORIENTATION_CHANGE="orientationChange",i}(t.Event);t.StageOrientationEvent=e,__reflect(e.prototype,"egret.StageOrientationEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r,n){void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===n&&(n="");var a=e.call(this,t,i,r)||this;return a.text=n,a}return __extends(i,e),i.dispatchTextEvent=function(e,r,n){var a=t.Event.create(i,r);a.text=n;var o=e.dispatchEvent(a);return t.Event.release(a),o},i.LINK="link",i}(t.Event);t.TextEvent=e,__reflect(e.prototype,"egret.TextEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r){return e.call(this,t,i,r)||this}return __extends(i,e),i.prototype.updateAfterEvent=function(){t.sys.$requestRenderingFlag=!0},i.dispatchTimerEvent=function(e,r,n,a){var o=t.Event.create(i,r,n,a),s=e.dispatchEvent(o);return t.Event.release(o),s},i.TIMER="timer",i.TIMER_COMPLETE="timerComplete",i}(t.Event);t.TimerEvent=e,__reflect(e.prototype,"egret.TimerEvent")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t}();t.CompressedTextureData=e,__reflect(e.prototype,"egret.CompressedTextureData"),t.etc_alpha_mask="etc_alpha_mask",t.engine_default_empty_texture="engine_default_empty_texture",t.is_compressed_texture="is_compressed_texture",t.glContext="glContext",t.UNPACK_PREMULTIPLY_ALPHA_WEBGL="UNPACK_PREMULTIPLY_ALPHA_WEBGL";var i=function(e){function i(i){var r=e.call(this)||this;if(r.format="image",r.$deleteSource=!0,r.compressedTextureData=[],r.debugCompressedTextureURL="",r.etcAlphaMask=null,t.nativeRender){var n=new egret_native.NativeBitmapData;n.$init(),r.$nativeBitmapData=n}return r.source=i,r.source&&(r.width=+i.width,r.height=+i.height),r}return __extends(i,e),Object.defineProperty(i.prototype,"source",{get:function(){return this.$source},set:function(e){this.$source=e,t.nativeRender&&egret_native.NativeDisplayObject.setSourceToNativeBitmapData(this.$nativeBitmapData,e)},enumerable:!0,configurable:!0}),i.create=function(e,r,n){var a="";a="arraybuffer"===e?t.Base64Util.encode(r):r;var o="image/png";"/"===a.charAt(0)?o="image/jpeg":"R"===a.charAt(0)?o="image/gif":"i"===a.charAt(0)&&(o="image/png");var s=new Image;s.src="data:"+o+";base64,"+a,s.crossOrigin="*";var h=new i(s);return s.onload=function(){s.onload=void 0,h.source=s,h.height=s.height,h.width=s.width,n&&n(h)},h},i.prototype.$dispose=function(){"webgl"==t.Capabilities.renderMode&&this.webGLTexture&&(t.WebGLUtils.deleteWebGLTexture(this.webGLTexture),this.webGLTexture=null),this.source&&this.source.dispose&&this.source.dispose(),this.source&&this.source.src&&(this.source.src=""),this.source=null,this.clearCompressedTextureData(),this.debugCompressedTextureURL="",this.etcAlphaMask=null,t.nativeRender&&egret_native.NativeDisplayObject.disposeNativeBitmapData(this.$nativeBitmapData),i.$dispose(this)},i.$addDisplayObject=function(t,e){if(e){var r=e.hashCode;if(r){if(!i._displayList[r])return void(i._displayList[r]=[t]);var n=i._displayList[r];n.indexOf(t)<0&&n.push(t)}}},i.$removeDisplayObject=function(t,e){if(e){var r=e.hashCode;if(r&&i._displayList[r]){var n=i._displayList[r],a=n.indexOf(t);a>=0&&n.splice(a,1)}}},i.$invalidate=function(e){if(e){var r=e.hashCode;if(r&&i._displayList[r])for(var n=i._displayList[r],a=0;a<n.length;a++){n[a]instanceof t.Bitmap&&n[a].$refreshImageData();var o=n[a];
o.$renderDirty=!0;var s=o.$parent;s&&!s.$cacheDirty&&(s.$cacheDirty=!0,s.$cacheDirtyUp());var h=o.$maskedObject;h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp())}}},i.$dispose=function(e){if(e){var r=e.hashCode;if(r&&i._displayList[r]){for(var n=i._displayList[r],a=0,o=n;a<o.length;a++){var s=o[a];s instanceof t.Bitmap&&(s.$bitmapData=null),s.$renderDirty=!0;var h=s.$parent;h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp());var c=s.$maskedObject;c&&!c.$cacheDirty&&(c.$cacheDirty=!0,c.$cacheDirtyUp())}delete i._displayList[r]}}},i.prototype._getCompressedTextureData=function(t,e){var i=this.compressedTextureData[t];return i?i[e]:null},i.prototype.getCompressed2dTextureData=function(){return this._getCompressedTextureData(0,0)},i.prototype.hasCompressed2d=function(){return!!this.getCompressed2dTextureData()},i.prototype.clearCompressedTextureData=function(){this.compressedTextureData.length=0},i._displayList=t.createMap(),i}(t.HashObject);t.BitmapData=i,__reflect(i.prototype,"egret.BitmapData")}(egret||(egret={}));var egret;!function(t){var e=new t.Point,i=function(i){function r(t,e,r,n,a,o){var s=i.call(this,t,e,r)||this;return s.targetChanged=!0,s.touchDown=!1,s.$initTo(n,a,o),s}return __extends(r,i),r.prototype.$initTo=function(t,e,i){this.touchPointID=+i||0,this.$stageX=+t||0,this.$stageY=+e||0},Object.defineProperty(r.prototype,"stageX",{get:function(){return this.$stageX},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"stageY",{get:function(){return this.$stageY},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"localX",{get:function(){return this.targetChanged&&this.getLocalXY(),this._localX},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"localY",{get:function(){return this.targetChanged&&this.getLocalXY(),this._localY},enumerable:!0,configurable:!0}),r.prototype.getLocalXY=function(){this.targetChanged=!1;var t=this.$target.$getInvertedConcatenatedMatrix();t.transformPoint(this.$stageX,this.$stageY,e),this._localX=e.x,this._localY=e.y},r.prototype.$setTarget=function(t){return this.$target=t,this.targetChanged=!!t,!0},r.prototype.updateAfterEvent=function(){t.sys.$requestRenderingFlag=!0},r.dispatchTouchEvent=function(e,i,n,a,o,s,h,c){if(void 0===c&&(c=!1),!n&&!e.hasEventListener(i))return!0;var l=t.Event.create(r,i,n,a);l.$initTo(o,s,h),l.touchDown=c;var u=e.dispatchEvent(l);return t.Event.release(l),u},r.TOUCH_MOVE="touchMove",r.TOUCH_BEGIN="touchBegin",r.TOUCH_END="touchEnd",r.TOUCH_CANCEL="touchCancel",r.TOUCH_TAP="touchTap",r.TOUCH_RELEASE_OUTSIDE="touchReleaseOutside",r}(t.Event);t.TouchEvent=i,__reflect(i.prototype,"egret.TouchEvent")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(e){function n(t,n,a){void 0===t&&(t=4),void 0===n&&(n=4),void 0===a&&(a=1);var o=e.call(this)||this,s=o;return s.type="blur",s.$blurX=t,s.$blurY=n,s.$quality=a,s.blurXFilter=new i(t),s.blurYFilter=new r(n),s.onPropertyChange(),o}return __extends(n,e),Object.defineProperty(n.prototype,"blurX",{get:function(){return this.$blurX},set:function(t){var e=this;e.$blurX!=t&&(e.$blurX=t,e.blurXFilter.blurX=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"blurY",{get:function(){return this.$blurY},set:function(t){var e=this;e.$blurY!=t&&(e.$blurY=t,e.blurYFilter.blurY=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),n.prototype.$toJson=function(){return'{"blurX": '+this.$blurX+', "blurY": '+this.$blurY+', "quality": 1}'},n.prototype.updatePadding=function(){var t=this;t.paddingLeft=t.blurX,t.paddingRight=t.blurX,t.paddingTop=t.blurY,t.paddingBottom=t.blurY},n.prototype.onPropertyChange=function(){var e=this;e.updatePadding(),t.nativeRender&&(egret_native.NativeDisplayObject.setFilterPadding(e.blurXFilter.$id,0,0,e.paddingLeft,e.paddingRight),egret_native.NativeDisplayObject.setFilterPadding(e.blurYFilter.$id,e.paddingTop,e.paddingBottom,0,0),egret_native.NativeDisplayObject.setDataToFilter(e))},n}(t.Filter);t.BlurFilter=e,__reflect(e.prototype,"egret.BlurFilter");var i=function(e){function i(i){void 0===i&&(i=4);var r=e.call(this)||this;return t.nativeRender?r.type="blur":r.type="blurX",r.$uniforms.blur={x:i,y:0},r.onPropertyChange(),r}return __extends(i,e),Object.defineProperty(i.prototype,"blurX",{get:function(){return this.$uniforms.blur.x},set:function(t){this.$uniforms.blur.x=t},enumerable:!0,configurable:!0}),i}(t.Filter);__reflect(i.prototype,"BlurXFilter",["egret.IBlurXFilter"]);var r=function(e){function i(i){void 0===i&&(i=4);var r=e.call(this)||this;return t.nativeRender?r.type="blur":r.type="blurY",r.$uniforms.blur={x:0,y:i},r.onPropertyChange(),r}return __extends(i,e),Object.defineProperty(i.prototype,"blurY",{get:function(){return this.$uniforms.blur.y},set:function(t){this.$uniforms.blur.y=t},enumerable:!0,configurable:!0}),i}(t.Filter);__reflect(r.prototype,"BlurYFilter",["egret.IBlurYFilter"])}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i.$matrix=[],i.matrix2=[],i.type="colorTransform",i.$uniforms.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i.$uniforms.colorAdd={x:0,y:0,z:0,w:0},i.setMatrix(e),i.onPropertyChange(),i}return __extends(e,t),Object.defineProperty(e.prototype,"matrix",{get:function(){for(var t=0;20>t;t++)this.matrix2[t]=this.$matrix[t];return this.matrix2},set:function(t){this.setMatrix(t)},enumerable:!0,configurable:!0}),e.prototype.setMatrix=function(t){if(t)for(var e=0;20>e;e++)this.$matrix[e]=t[e];else for(var e=0;20>e;e++)this.$matrix[e]=0==e||6==e||12==e||18==e?1:0;for(var i=this.$matrix,r=this.$uniforms.matrix,n=this.$uniforms.colorAdd,e=0,a=0;e<i.length;e++)4===e?n.x=i[e]/255:9===e?n.y=i[e]/255:14===e?n.z=i[e]/255:19===e?n.w=i[e]/255:(r[a]=i[e],a++);this.onPropertyChange()},e.prototype.$toJson=function(){return'{"matrix": ['+this.$matrix.toString()+"]}"},e}(t.Filter);t.ColorMatrixFilter=e,__reflect(e.prototype,"egret.ColorMatrixFilter")}(egret||(egret={}));var egret;!function(t){var e,i={},r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=new Array(36),a=0,o=function(){for(var t=0;36>t;t++)8===t||13===t||18===t||23===t?n[t]="-":14===t?n[t]="4":(2>=a&&(a=33554432+16777216*Math.random()|0),e=15&a,a>>=4,n[t]=r[19===t?3&e|8:e]);return n.join("")},s=function(e){function r(t,r,n){void 0===n&&(n={});var a=e.call(this)||this;a.$padding=0,a.$vertexSrc=t,a.$fragmentSrc=r;var s=t+r;return i[s]||(i[s]=o()),a.$shaderKey=i[s],a.$uniforms=n,a.type="custom",a.onPropertyChange(),a}return __extends(r,e),Object.defineProperty(r.prototype,"padding",{get:function(){return this.$padding},set:function(t){var e=this;e.$padding!=t&&(e.$padding=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"uniforms",{get:function(){return this.$uniforms},enumerable:!0,configurable:!0}),r.prototype.onPropertyChange=function(){if(t.nativeRender){var e=this;egret_native.NativeDisplayObject.setFilterPadding(e.$id,e.$padding,e.$padding,e.$padding,e.$padding),egret_native.NativeDisplayObject.setDataToFilter(e)}},r}(t.Filter);t.CustomFilter=s,__reflect(s.prototype,"egret.CustomFilter")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r,n,a,o,s,h,c,l,u){void 0===t&&(t=4),void 0===i&&(i=45),void 0===r&&(r=0),void 0===n&&(n=1),void 0===a&&(a=4),void 0===o&&(o=4),void 0===s&&(s=1),void 0===h&&(h=1),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===u&&(u=!1);var p=e.call(this,r,n,a,o,s,h,c,l)||this,d=p;return d.$distance=t,d.$angle=i,d.$hideObject=u,d.$uniforms.dist=t,d.$uniforms.angle=i/180*Math.PI,d.$uniforms.hideObject=u?1:0,d.onPropertyChange(),p}return __extends(i,e),Object.defineProperty(i.prototype,"distance",{get:function(){return this.$distance},set:function(t){var e=this;e.$distance!=t&&(e.$distance=t,e.$uniforms.dist=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"angle",{get:function(){return this.$angle},set:function(t){var e=this;e.$angle!=t&&(e.$angle=t,e.$uniforms.angle=t/180*Math.PI,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hideObject",{get:function(){return this.$hideObject},set:function(t){this.$hideObject!=t&&(this.$hideObject=t,this.$uniforms.hideObject=t?1:0)},enumerable:!0,configurable:!0}),i.prototype.$toJson=function(){return'{"distance": '+this.$distance+', "angle": '+this.$angle+', "color": '+this.$color+', "red": '+this.$red+', "green": '+this.$green+', "blue": '+this.$blue+', "alpha": '+this.$alpha+', "blurX": '+this.$blurX+', "blurY": '+this.blurY+', "strength": '+this.$strength+', "quality": '+this.$quality+', "inner": '+this.$inner+', "knockout": '+this.$knockout+', "hideObject": '+this.$hideObject+"}"},i.prototype.updatePadding=function(){var e=this;e.paddingLeft=e.blurX,e.paddingRight=e.blurX,e.paddingTop=e.blurY,e.paddingBottom=e.blurY;var i=e.distance||0,r=e.angle||0,n=0,a=0;0!=i&&(n=i*t.NumberUtils.cos(r),n=n>0?Math.ceil(n):Math.floor(n),a=i*t.NumberUtils.sin(r),a=a>0?Math.ceil(a):Math.floor(a),e.paddingLeft+=n,e.paddingRight+=n,e.paddingTop+=a,e.paddingBottom+=a)},i}(t.GlowFilter);t.DropShadowFilter=e,__reflect(e.prototype,"egret.DropShadowFilter")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.LINEAR="linear",t.RADIAL="radial",t}();t.GradientType=e,__reflect(e.prototype,"egret.GradientType")}(egret||(egret={}));var egret;!function(t){function e(t){return t%=2*Math.PI,0>t&&(t+=2*Math.PI),t}function i(t,e){for(var i=[],n=0;e>n;n++){var a=r(t,n/e);a&&i.push(a)}return i}function r(e,i){var r=0,o=0,s=0,h=e.length;if(h/2==3){var c=e[r++],l=e[r++],u=e[r++],p=e[r++],d=e[r++],f=e[r++];o=n(c,u,d,i),s=n(l,p,f,i)}else if(h/2==4){var c=e[r++],l=e[r++],u=e[r++],p=e[r++],d=e[r++],f=e[r++],g=e[r++],$=e[r++];o=a(c,u,d,g,i),s=a(l,p,f,$,i)}return t.Point.create(o,s)}function n(t,e,i,r){var n=Math.pow(1-r,2)*t+2*r*(1-r)*e+Math.pow(r,2)*i;return n}function a(t,e,i,r,n){var a=Math.pow(1-n,3)*t+3*n*Math.pow(1-n,2)*e+3*(1-n)*Math.pow(n,2)*i+Math.pow(n,3)*r;return a}var o=function(r){function n(){var e=r.call(this)||this;return e.lastX=0,e.lastY=0,e.fillPath=null,e.strokePath=null,e.topLeftStrokeWidth=0,e.bottomRightStrokeWidth=0,e.minX=1/0,e.minY=1/0,e.maxX=-(1/0),e.maxY=-(1/0),e.includeLastPosition=!0,e.$renderNode=new t.sys.GraphicsNode,e}return __extends(n,r),n.prototype.$setTarget=function(e){this.$targetDisplay&&(this.$targetDisplay.$renderNode=null),e.$renderNode=this.$renderNode,this.$targetDisplay=e,this.$targetIsSprite=e instanceof t.Sprite},n.prototype.setStrokeWidth=function(t){switch(t){case 1:this.topLeftStrokeWidth=0,this.bottomRightStrokeWidth=1;break;case 3:this.topLeftStrokeWidth=1,this.bottomRightStrokeWidth=2;break;default:var e=0|Math.ceil(.5*t);this.topLeftStrokeWidth=e,this.bottomRightStrokeWidth=e}},n.prototype.beginFill=function(e,i){void 0===i&&(i=1),e=+e||0,i=+i||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setBeginFill(e,i),this.fillPath=this.$renderNode.beginFill(e,i,this.strokePath),this.$renderNode.drawData.length>1&&this.fillPath.moveTo(this.lastX,this.lastY)},n.prototype.beginGradientFill=function(e,i,r,n,a){void 0===a&&(a=null),t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setBeginGradientFill(e,i,r,n,a),this.fillPath=this.$renderNode.beginGradientFill(e,i,r,n,a,this.strokePath),this.$renderNode.drawData.length>1&&this.fillPath.moveTo(this.lastX,this.lastY)},n.prototype.endFill=function(){t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setEndFill(),this.fillPath=null},n.prototype.lineStyle=function(e,i,r,n,a,o,s,h,c){void 0===e&&(e=0/0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=!1),void 0===a&&(a="normal"),void 0===o&&(o=null),void 0===s&&(s=null),void 0===h&&(h=3),e=+e||0,i=+i||0,r=+r||0,h=+h||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setLineStyle(e,i,r,n,a,o,s,h),0>=e?(this.strokePath=null,this.setStrokeWidth(0)):(this.setStrokeWidth(e),this.strokePath=this.$renderNode.lineStyle(e,i,r,o,s,h,c),this.$renderNode.drawData.length>1&&this.strokePath.moveTo(this.lastX,this.lastY))},n.prototype.drawRect=function(e,i,r,n){e=+e||0,i=+i||0,r=+r||0,n=+n||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawRect(e,i,r,n);var a=this.fillPath,o=this.strokePath;a&&a.drawRect(e,i,r,n),o&&o.drawRect(e,i,r,n),this.extendBoundsByPoint(e+r,i+n),this.updatePosition(e,i),this.dirty()},n.prototype.drawRoundRect=function(e,i,r,n,a,o){e=+e||0,i=+i||0,r=+r||0,n=+n||0,a=+a||0,o=+o||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawRoundRect(e,i,r,n,a,o);var s=this.fillPath,h=this.strokePath;s&&s.drawRoundRect(e,i,r,n,a,o),h&&h.drawRoundRect(e,i,r,n,a,o);var c=.5*a|0,l=o?.5*o|0:c,u=e+r,p=i+n,d=p-l;this.extendBoundsByPoint(e,i),this.extendBoundsByPoint(u,p),this.updatePosition(u,d),this.dirty()},n.prototype.drawCircle=function(e,i,r){e=+e||0,i=+i||0,r=+r||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawCircle(e,i,r);var n=this.fillPath,a=this.strokePath;n&&n.drawCircle(e,i,r),a&&a.drawCircle(e,i,r),this.extendBoundsByPoint(e-r-1,i-r-1),this.extendBoundsByPoint(e+r+2,i+r+2),this.updatePosition(e+r,i),this.dirty()},n.prototype.drawEllipse=function(e,i,r,n){e=+e||0,i=+i||0,r=+r||0,n=+n||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawEllipse(e,i,r,n);var a=this.fillPath,o=this.strokePath;a&&a.drawEllipse(e,i,r,n),o&&o.drawEllipse(e,i,r,n),this.extendBoundsByPoint(e-1,i-1),this.extendBoundsByPoint(e+r+2,i+n+2),this.updatePosition(e+r,i+.5*n),this.dirty()},n.prototype.moveTo=function(e,i){e=+e||0,i=+i||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setMoveTo(e,i);var r=this.fillPath,n=this.strokePath;r&&r.moveTo(e,i),n&&n.moveTo(e,i),this.includeLastPosition=!1,this.lastX=e,this.lastY=i,this.dirty()},n.prototype.lineTo=function(e,i){e=+e||0,i=+i||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setLineTo(e,i);var r=this.fillPath,n=this.strokePath;r&&r.lineTo(e,i),n&&n.lineTo(e,i),this.updatePosition(e,i),this.dirty()},n.prototype.curveTo=function(e,r,n,a){e=+e||0,r=+r||0,n=+n||0,a=+a||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setCurveTo(e,r,n,a);var o=this.fillPath,s=this.strokePath;o&&o.curveTo(e,r,n,a),s&&s.curveTo(e,r,n,a);for(var h=this.lastX||0,c=this.lastY||0,l=i([h,c,e,r,n,a],50),u=0;u<l.length;u++){var p=l[u];this.extendBoundsByPoint(p.x,p.y),t.Point.release(p)}this.extendBoundsByPoint(n,a),this.updatePosition(n,a),this.dirty()},n.prototype.cubicCurveTo=function(e,r,n,a,o,s){e=+e||0,r=+r||0,n=+n||0,a=+a||0,o=+o||0,s=+s||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setCubicCurveTo(e,r,n,a,o,s);var h=this.fillPath,c=this.strokePath;h&&h.cubicCurveTo(e,r,n,a,o,s),c&&c.cubicCurveTo(e,r,n,a,o,s);for(var l=this.lastX||0,u=this.lastY||0,p=i([l,u,e,r,n,a,o,s],50),d=0;d<p.length;d++){var f=p[d];this.extendBoundsByPoint(f.x,f.y),t.Point.release(f)}this.extendBoundsByPoint(o,s),this.updatePosition(o,s),this.dirty()},n.prototype.drawArc=function(i,r,n,a,o,s){if(!(0>n||a===o)){i=+i||0,r=+r||0,n=+n||0,a=+a||0,o=+o||0,s=!!s,a=e(a),o=e(o),t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawArc(i,r,n,a,o,s);var h=this.fillPath,c=this.strokePath;h&&(h.$lastX=this.lastX,h.$lastY=this.lastY,h.drawArc(i,r,n,a,o,s)),c&&(c.$lastX=this.lastX,c.$lastY=this.lastY,c.drawArc(i,r,n,a,o,s)),s?this.arcBounds(i,r,n,o,a):this.arcBounds(i,r,n,a,o);var l=i+Math.cos(o)*n,u=r+Math.sin(o)*n;this.updatePosition(l,u),this.dirty()}},n.prototype.dirty=function(){var e=this;if(e.$renderNode.dirtyRender=!0,!t.nativeRender){var i=e.$targetDisplay;i.$cacheDirty=!0;var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},n.prototype.arcBounds=function(t,e,i,r,n){var a=Math.PI;if(Math.abs(r-n)<.01)return this.extendBoundsByPoint(t-i,e-i),void this.extendBoundsByPoint(t+i,e+i);r>n&&(n+=2*a);for(var o=Math.cos(r)*i,s=Math.cos(n)*i,h=Math.min(o,s),c=Math.max(o,s),l=Math.sin(r)*i,u=Math.sin(n)*i,p=Math.min(l,u),d=Math.max(l,u),f=r/(.5*a),g=n/(.5*a),$=Math.ceil(f);g>=$;$++)switch($%4){case 0:c=i;break;case 1:d=i;break;case 2:h=-i;break;case 3:p=-i}h=Math.floor(h),p=Math.floor(p),c=Math.ceil(c),d=Math.ceil(d),this.extendBoundsByPoint(h+t,p+e),this.extendBoundsByPoint(c+t,d+e)},n.prototype.clear=function(){t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setGraphicsClear(),this.$renderNode.clear(),this.updatePosition(0,0),this.minX=1/0,this.minY=1/0,this.maxX=-(1/0),this.maxY=-(1/0),this.dirty()},n.prototype.extendBoundsByPoint=function(t,e){this.extendBoundsByX(t),this.extendBoundsByY(e)},n.prototype.extendBoundsByX=function(t){this.minX=Math.min(this.minX,t-this.topLeftStrokeWidth),this.maxX=Math.max(this.maxX,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},n.prototype.extendBoundsByY=function(t){this.minY=Math.min(this.minY,t-this.topLeftStrokeWidth),this.maxY=Math.max(this.maxY,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},n.prototype.updateNodeBounds=function(){var t=this.$renderNode;t.x=this.minX,t.y=this.minY,t.width=Math.ceil(this.maxX-this.minX),t.height=Math.ceil(this.maxY-this.minY)},n.prototype.updatePosition=function(t,e){this.includeLastPosition||(this.extendBoundsByPoint(this.lastX,this.lastY),this.includeLastPosition=!0),this.lastX=t,this.lastY=e,this.extendBoundsByPoint(t,e)},n.prototype.$measureContentBounds=function(t){this.minX===1/0?t.setEmpty():t.setTo(this.minX,this.minY,this.maxX-this.minX,this.maxY-this.minY)},n.prototype.$hitTest=function(e,i){var r=this.$targetDisplay,n=r.$getInvertedConcatenatedMatrix(),a=n.a*e+n.c*i+n.tx,o=n.b*e+n.d*i+n.ty,s=t.sys.canvasHitTestBuffer;s.resize(3,3);var h=this.$renderNode,c=t.Matrix.create();c.identity(),c.translate(1-a,1-o),t.sys.canvasRenderer.drawNodeToBuffer(h,s,c,!0),t.Matrix.release(c);try{var l=s.getPixels(1,1);if(0===l[3])return null}catch(u){throw new Error(t.sys.tr(1039))}return r},n.prototype.$onRemoveFromStage=function(){this.$renderNode&&this.$renderNode.clean(),t.nativeRender&&egret_native.NativeDisplayObject.disposeGraphicData(this)},n}(t.HashObject);t.Graphics=o,__reflect(o.prototype,"egret.Graphics")}(egret||(egret={}));var egret;!function(t){var e=Math.PI,i=2*e,r=e/180,n=[],a=function(a){function o(t,e,i,r,n,o){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===o&&(o=0);var s=a.call(this)||this;return s.a=t,s.b=e,s.c=i,s.d=r,s.tx=n,s.ty=o,s}return __extends(o,a),o.release=function(t){t&&n.push(t)},o.create=function(){var t=n.pop();return t||(t=new o),t},o.prototype.clone=function(){return new o(this.a,this.b,this.c,this.d,this.tx,this.ty)},o.prototype.concat=function(t){var e=this.a*t.a,i=0,r=0,n=this.d*t.d,a=this.tx*t.a+t.tx,o=this.ty*t.d+t.ty;(0!==this.b||0!==this.c||0!==t.b||0!==t.c)&&(e+=this.b*t.c,n+=this.c*t.b,i+=this.a*t.b+this.b*t.d,r+=this.c*t.a+this.d*t.c,a+=this.ty*t.c,o+=this.tx*t.b),this.a=e,this.b=i,this.c=r,this.d=n,this.tx=a,this.ty=o},o.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},o.prototype.identity=function(){this.a=this.d=1,this.b=this.c=this.tx=this.ty=0},o.prototype.invert=function(){this.$invertInto(this)},o.prototype.$invertInto=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,a=this.tx,o=this.ty;if(0==i&&0==r)return t.b=t.c=0,void(0==e||0==n?t.a=t.d=t.tx=t.ty=0:(e=t.a=1/e,n=t.d=1/n,t.tx=-e*a,t.ty=-n*o));var s=e*n-i*r;if(0==s)return void t.identity();s=1/s;var h=t.a=n*s;i=t.b=-i*s,r=t.c=-r*s,n=t.d=e*s,t.tx=-(h*a+r*o),t.ty=-(i*a+n*o)},o.prototype.rotate=function(e){if(e=+e,0!==e){e/=r;var i=t.NumberUtils.cos(e),n=t.NumberUtils.sin(e),a=this.a,o=this.b,s=this.c,h=this.d,c=this.tx,l=this.ty;this.a=a*i-o*n,this.b=a*n+o*i,this.c=s*i-h*n,this.d=s*n+h*i,this.tx=c*i-l*n,this.ty=c*n+l*i}},o.prototype.scale=function(t,e){1!==t&&(this.a*=t,this.c*=t,this.tx*=t),1!==e&&(this.b*=e,this.d*=e,this.ty*=e)},o.prototype.setTo=function(t,e,i,r,n,a){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=a,this},o.prototype.transformPoint=function(e,i,r){var n=this.a*e+this.c*i+this.tx,a=this.b*e+this.d*i+this.ty;return r?(r.setTo(n,a),r):new t.Point(n,a)},o.prototype.translate=function(t,e){this.tx+=t,this.ty+=e},o.prototype.equals=function(t){return this.a==t.a&&this.b==t.b&&this.c==t.c&&this.d==t.d&&this.tx==t.tx&&this.ty==t.ty},o.prototype.prepend=function(t,e,i,r,n,a){var o=this.tx;if(1!=t||0!=e||0!=i||1!=r){var s=this.a,h=this.c;this.a=s*t+this.b*i,this.b=s*e+this.b*r,this.c=h*t+this.d*i,this.d=h*e+this.d*r}return this.tx=o*t+this.ty*i+n,this.ty=o*e+this.ty*r+a,this},o.prototype.append=function(t,e,i,r,n,a){var o=this.a,s=this.b,h=this.c,c=this.d;return(1!=t||0!=e||0!=i||1!=r)&&(this.a=t*o+e*h,this.b=t*s+e*c,this.c=i*o+r*h,this.d=i*s+r*c),this.tx=n*o+a*h+this.tx,this.ty=n*s+a*c+this.ty,this},o.prototype.deltaTransformPoint=function(e){var i=this,r=i.a*e.x+i.c*e.y,n=i.b*e.x+i.d*e.y;return new t.Point(r,n)},o.prototype.toString=function(){return"(a="+this.a+", b="+this.b+", c="+this.c+", d="+this.d+", tx="+this.tx+", ty="+this.ty+")"},o.prototype.createBox=function(e,i,n,a,o){void 0===n&&(n=0),void 0===a&&(a=0),void 0===o&&(o=0);var s=this;if(0!==n){n/=r;var h=t.NumberUtils.cos(n),c=t.NumberUtils.sin(n);s.a=h*e,s.b=c*i,s.c=-c*e,s.d=h*i}else s.a=e,s.b=0,s.c=0,s.d=i;s.tx=a,s.ty=o},o.prototype.createGradientBox=function(t,e,i,r,n){void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=0),this.createBox(t/1638.4,e/1638.4,i,r+t/2,n+e/2)},o.prototype.$transformBounds=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,a=this.tx,o=this.ty,s=t.x,h=t.y,c=s+t.width,l=h+t.height,u=e*s+r*h+a,p=i*s+n*h+o,d=e*c+r*h+a,f=i*c+n*h+o,g=e*c+r*l+a,$=i*c+n*l+o,y=e*s+r*l+a,v=i*s+n*l+o,m=0;u>d&&(m=u,u=d,d=m),g>y&&(m=g,g=y,y=m),t.x=Math.floor(g>u?u:g),t.width=Math.ceil((d>y?d:y)-t.x),p>f&&(m=p,p=f,f=m),$>v&&(m=$,$=v,v=m),t.y=Math.floor($>p?p:$),t.height=Math.ceil((f>v?f:v)-t.y)},o.prototype.getDeterminant=function(){return this.a*this.d-this.b*this.c},o.prototype.$getScaleX=function(){var t=this;if(0==t.b)return t.a;var e=Math.sqrt(t.a*t.a+t.b*t.b);return this.getDeterminant()<0?-e:e},o.prototype.$getScaleY=function(){var t=this;if(0==t.c)return t.d;var e=Math.sqrt(t.c*t.c+t.d*t.d);return this.getDeterminant()<0?-e:e},o.prototype.$getSkewX=function(){return this.d<0?Math.atan2(this.d,this.c)+e/2:Math.atan2(this.d,this.c)-e/2},o.prototype.$getSkewY=function(){return this.a<0?Math.atan2(this.b,this.a)-e:Math.atan2(this.b,this.a)},o.prototype.$updateScaleAndRotation=function(e,n,a,o){if(!(0!=a&&a!=i||0!=o&&o!=i))return this.a=e,this.b=this.c=0,void(this.d=n);a/=r,o/=r;var s=t.NumberUtils.cos(a),h=t.NumberUtils.sin(a);a==o?(this.a=s*e,this.b=h*e):(this.a=t.NumberUtils.cos(o)*e,this.b=t.NumberUtils.sin(o)*e),this.c=-h*n,this.d=s*n},o.prototype.$preMultiplyInto=function(t,e){var i=t.a*this.a,r=0,n=0,a=t.d*this.d,o=t.tx*this.a+this.tx,s=t.ty*this.d+this.ty;(0!==t.b||0!==t.c||0!==this.b||0!==this.c)&&(i+=t.b*this.c,a+=t.c*this.b,r+=t.a*this.b+t.b*this.d,n+=t.c*this.a+t.d*this.c,o+=t.ty*this.c,s+=t.tx*this.b),e.a=i,e.b=r,e.c=n,e.d=a,e.tx=o,e.ty=s},o}(t.HashObject);t.Matrix=a,__reflect(a.prototype,"egret.Matrix"),t.$TempMatrix=new a}(egret||(egret={}));var egret;!function(t){var e=[],i=function(i){function r(t,e,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=0);var a=i.call(this)||this;return a.x=t,a.y=e,a.width=r,a.height=n,a}return __extends(r,i),r.release=function(t){t&&e.push(t)},r.create=function(){var t=e.pop();return t||(t=new r),t},Object.defineProperty(r.prototype,"right",{get:function(){return this.x+this.width},set:function(t){this.width=t-this.x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){this.height=t-this.y},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"left",{get:function(){return this.x},set:function(t){this.width+=this.x-t,this.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y},set:function(t){this.height+=this.y-t,this.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"topLeft",{get:function(){return new t.Point(this.left,this.top)},set:function(t){this.top=t.y,this.left=t.x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottomRight",{get:function(){return new t.Point(this.right,this.bottom)},set:function(t){this.bottom=t.y,this.right=t.x},enumerable:!0,configurable:!0}),r.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},r.prototype.setTo=function(t,e,i,r){return this.x=t,this.y=e,this.width=i,this.height=r,this},r.prototype.contains=function(t,e){return this.x<=t&&this.x+this.width>=t&&this.y<=e&&this.y+this.height>=e},r.prototype.intersection=function(t){return this.clone().$intersectInPlace(t)},r.prototype.inflate=function(t,e){this.x-=t,this.width+=2*t,this.y-=e,this.height+=2*e},r.prototype.$intersectInPlace=function(t){var e=this.x,i=this.y,r=t.x,n=t.y,a=Math.max(e,r),o=Math.min(e+this.width,r+t.width);if(o>=a){var s=Math.max(i,n),h=Math.min(i+this.height,n+t.height);if(h>=s)return this.setTo(a,s,o-a,h-s),this}return this.setEmpty(),this},r.prototype.intersects=function(t){return Math.max(this.x,t.x)<=Math.min(this.right,t.right)&&Math.max(this.y,t.y)<=Math.min(this.bottom,t.bottom)},r.prototype.isEmpty=function(){return this.width<=0||this.height<=0},r.prototype.setEmpty=function(){this.x=0,this.y=0,this.width=0,this.height=0},r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.containsPoint=function(t){return this.x<=t.x&&this.x+this.width>=t.x&&this.y<=t.y&&this.y+this.height>=t.y?!0:!1},r.prototype.containsRect=function(t){var e=t.x+t.width,i=t.y+t.height,r=this.x+this.width,n=this.y+this.height;return t.x>=this.x&&t.x<r&&t.y>=this.y&&t.y<n&&e>this.x&&r>=e&&i>this.y&&n>=i},r.prototype.equals=function(t){return this===t?!0:this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height},r.prototype.inflatePoint=function(t){this.inflate(t.x,t.y)},r.prototype.offset=function(t,e){this.x+=t,this.y+=e},r.prototype.offsetPoint=function(t){this.offset(t.x,t.y)},r.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", width="+this.width+", height="+this.height+")"},r.prototype.union=function(t){var e=this.clone();if(t.isEmpty())return e;if(e.isEmpty())return e.copyFrom(t),e;var i=Math.min(e.x,t.x),r=Math.min(e.y,t.y);return e.setTo(i,r,Math.max(e.right,t.right)-i,Math.max(e.bottom,t.bottom)-r),e},r.prototype.$getBaseWidth=function(t){var e=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t));return e*this.width+i*this.height},r.prototype.$getBaseHeight=function(t){var e=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t));return i*this.width+e*this.height},r}(t.HashObject);t.Rectangle=i,__reflect(i.prototype,"egret.Rectangle"),t.$TempRectangle=new i}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.en_US=t.$locale_strings.en_US||{};var e=t.$locale_strings.en_US;e[1001]="Could not find Egret entry class: {0}",e[1002]="Egret entry class '{0}' must inherit from egret.DisplayObject.",e[1003]="Parameter {0} must be non-null.",e[1004]="An object cannot be added as a child to one of it's children (or children's children, etc.).",e[1005]="An object cannot be added as a child of itself.",e[1006]="The supplied DisplayObject must be a child of the caller.",e[1007]="An index specified for a parameter was out of range.",e[1008]="Instantiate singleton errorsingleton class {0} can not create multiple instances.",e[1009]='the Class {0} cannot use the property "{1}"',e[1010]='the property "{1}" of the Class "{0}" is readonly',e[1011]="Stream Error. URL: {0}",e[1012]="The type of parameter {0} must be Class.",e[1013]="Variable assignment is NaN, please see the code!",e[1014]='the constant "{1}" of the Class "{0}" is read-only',e[1015]="xml not found!",e[1016]="{0}has been obsoleted",e[1017]="The format of JSON file is incorrect: {0}\ndata: {1}",e[1018]="the scale9Grid is not correct",e[1019]="Network ab:{0}",e[1020]="Cannot initialize Shader",e[1021]="Current browser does not support webgl",e[1022]="{0} ArgumentError",e[1023]="This method is not available in the ScrollView!",e[1025]="end of the file",e[1026]="! EncodingError The code point {0} could not be encoded.",e[1027]="DecodingError",e[1028]=". called injection is not configured rule: {0}, please specify configuration during its initial years of injection rule, and then call the corresponding single case.",e[1029]="Function.prototype.bind - what is trying to be bound is not callable",e[1033]="Photos can not be used across domains toDataURL to convert base64",e[1034]='Music file decoding failed: "{0}", please use the standard conversion tool reconversion under mp3.',e[1035]="Native does not support this feature!",e[1036]="Sound has stopped, please recall Sound.play () to play the sound!",e[1037]="Non-load the correct blob!",e[1038]="XML format error!",e[1039]="Cross domains pictures can not get pixel information!",e[1040]="hitTestPoint can not detect crossOrigin images! Please check if the display object has crossOrigin elements.",e[1041]="{0} is deprecated, please use {1} replace",e[1042]="The parameters passed in the region needs is an integer in drawToTexture method. Otherwise, some browsers will draw abnormal.",e[1043]="Compile errors in {0}, the attribute name: {1}, the attribute value: {2}.",e[1044]="The current version of the Runtime does not support video playback, please use the latest version",e[1045]="The resource url is not found",e[1046]="BitmapText no corresponding characters: {0}, please check the configuration file",e[1047]="egret.localStorage.setItem save failed,key={0}&value={1}",e[1048]="Video loading failed",e[1049]="In the absence of sound is not allowed to play after loading",e[1050]="ExternalInterface calls the method without js registration: {0}",e[1051]="runtime only support webgl render mode",e[1052]="network request timeout{0}",e[3e3]="Theme configuration file failed to load: {0}",e[3001]="Cannot find the skin name which is configured in Theme: {0}",e[3002]='Index:"{0}" is out of the collection element index range',e[3003]="Cannot be available in this component. If this component is container, please continue to use",e[3004]="addChild(){0}addElement() replace",e[3005]="addChildAt(){0}addElementAt() replace",e[3006]="removeChild(){0}removeElement() replace",e[3007]="removeChildAt(){0}removeElementAt() replace",e[3008]="setChildIndex(){0}setElementIndex() replace",e[3009]="swapChildren(){0}swapElements() replace",e[3010]="swapChildrenAt(){0}swapElementsAt() replace",e[3011]='Index:"{0}" is out of the visual element index range',e[3012]="This method is not available in Scroller component!",e[3013]="UIStage is GUI root container, and only one such instant is in the display list",e[3014]="set fullscreen error",e[3100]="Current browser does not support WebSocket",e[3101]="Please connect Socket firstly",e[3102]="Please set the type of binary type",e[3200]="getResByUrl must be called after loadConfig",e[4e3]="An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)",e[4001]="Abstract class can not be instantiated!",e[4002]="Unnamed data!",e[4003]="Nonsupport version!",e[4500]="The platform does not support {0} adapter mode and has been automatically replaced with {1} mode, please modify your code adapter logic"}(egret||(egret={}));var egret;!function(t){t.JointStyle={BEVEL:"bevel",MITER:"miter",ROUND:"round"}}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.zh_CN=t.$locale_strings.zh_CN||{};var e=t.$locale_strings.zh_CN;e[1001]="Egret: {0}",e[1002]="Egret {0} egret.DisplayObject",e[1003]=" {0}  null",e[1004]="",e[1005]="",e[1006]=" DisplayObject ",e[1007]="",e[1008]=" {0} ",e[1009]=" {0}  {1}",e[1010]=" {0}  {1} ",e[1011]="URL: {0}",e[1012]=" {0}  Class",e[1013]="NaN",e[1014]=" {0}  {1} ",e[1015]="xml not found!",e[1016]="{0}",e[1017]="JSON: {0}\ndata: {1}",e[1018]="9",e[1019]=":{0}",e[1020]="",e[1021]="webgl",e[1022]="{0} ArgumentError",e[1023]="ScrollView!",e[1025]="",e[1026]="EncodingError! The code point {0} could not be encoded.",e[1027]="DecodingError",e[1028]=":{0} ",e[1029]="Function.prototype.bind - what is trying to be bound is not callable",e[1033]="toDataURLbase64",e[1034]='"{0}"mp3',e[1035]="Native ",e[1036]=" Sound.play() ",e[1037]="blob",e[1038]="XML !",e[1039]="!",e[1040]="hitTestPoint ! ",e[1041]="{0} , {1} ",e[1042]="drawToTexture,",e[1043]="{0}  : {1} : {2}",e[1044]=" runtime ,",e[1045]="",e[1046]="BitmapText :{0}",e[1047]="egret.localStorage.setItem,key={0}&value={1}",e[1048]="",e[1049]="",e[1050]="ExternalInterfacejs: {0}",e[1051]="runtime  webgl ",e[1052]=":{0}",e[3e3]=": {0}",e[3001]=": {0}",e[3002]=':"{0}"',e[3003]="",e[3004]="addChild(){0}addElement()",e[3005]="addChildAt(){0}addElementAt()",e[3006]="removeChild(){0}removeElement()",e[3007]="removeChildAt(){0}removeElementAt()",e[3008]="setChildIndex(){0}setElementIndex()",e[3009]="swapChildren(){0}swapElements()",e[3010]="swapChildrenAt(){0}swapElementsAt()",e[3011]=':"{0}"',e[3012]="Scroller!",e[3013]="UIStageGUI",e[3014]="",e[3100]="WebSocket",e[3101]="WebSocket",e[3102]="type",e[3200]="getResByUrl  loadConfig ",e[4e3]="An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)",e[4001]="Abstract class can not be instantiated!",e[4002]="Unnamed data!",e[4003]="Nonsupport version!",e[4500]=" {0}  {1} "
}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.localStorage||(t.localStorage={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t){r.indexOf(t)<0&&r.push(t)}function i(t){var e=r.indexOf(t);return e>=0?(r.splice(e,1),!0):!1}var r=[];t.$pushSoundChannel=e,t.$popSoundChannel=i}(e=t.sys||(t.sys={}))}(egret||(egret={})),function(t){}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e;!function(t){t.GET="GET",t.POST="POST"}(e=t.HttpMethod||(t.HttpMethod={}))}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.TEXT="text",t.ARRAY_BUFFER="arraybuffer",t}();t.HttpResponseType=e,__reflect(e.prototype,"egret.HttpResponseType")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(i){function r(r){var n=i.call(this)||this;return n.isStage=!1,n.$renderNode=new e.BitmapNode,n.renderBuffer=null,n.offsetX=0,n.offsetY=0,n.offsetMatrix=new t.Matrix,n.$canvasScaleX=1,n.$canvasScaleY=1,n.$stageRenderToSurface=function(){e.systemRenderer.render(this.root,this.renderBuffer,this.offsetMatrix)},n.root=r,n.isStage=r instanceof t.Stage,n}return __extends(r,i),r.create=function(i){var r=new t.sys.DisplayList(i);try{var n=new e.RenderBuffer;r.renderBuffer=n}catch(a){return null}return r.root=i,r},r.prototype.$getRenderNode=function(){return this.$renderNode},r.prototype.setClipRect=function(t,e){t*=r.$canvasScaleX,e*=r.$canvasScaleY,this.renderBuffer.resize(t,e)},r.prototype.drawToSurface=function(){var i=0;this.$canvasScaleX=this.offsetMatrix.a=r.$canvasScaleX,this.$canvasScaleY=this.offsetMatrix.d=r.$canvasScaleY,this.isStage||this.changeSurfaceSize();var n=this.renderBuffer;if(n.clear(),i=e.systemRenderer.render(this.root,n,this.offsetMatrix),!this.isStage){var a=n.surface,o=this.$renderNode;o.drawData.length=0;var s=a.width,h=a.height;this.bitmapData?(this.bitmapData.source=a,this.bitmapData.width=s,this.bitmapData.height=h):this.bitmapData=new t.BitmapData(a),o.image=this.bitmapData,o.imageWidth=s,o.imageHeight=h,o.drawImage(0,0,s,h,-this.offsetX,-this.offsetY,s/this.$canvasScaleX,h/this.$canvasScaleY)}return i},r.prototype.changeSurfaceSize=function(){var t=(this.root,this.offsetX),e=this.offsetY,i=this.root.$getOriginalBounds(),r=this.$canvasScaleX,n=this.$canvasScaleY;this.offsetX=-i.x,this.offsetY=-i.y,this.offsetMatrix.setTo(this.offsetMatrix.a,0,0,this.offsetMatrix.d,this.offsetX,this.offsetY);var a=this.renderBuffer,o=Math.max(257,i.width*r),s=Math.max(257,i.height*n);(this.offsetX!=t||this.offsetY!=e||a.surface.width!=o||a.surface.height!=s)&&a.resize(o,s)},r.$setCanvasScale=function(e,i){r.$canvasScaleX=e,r.$canvasScaleY=i,t.nativeRender&&egret_native.nrSetCanvasScaleFactor(r.$canvasScaleFactor,e,i)},r.$canvasScaleFactor=1,r.$canvasScaleX=1,r.$canvasScaleY=1,r}(t.HashObject);e.DisplayList=i,__reflect(i.prototype,"egret.sys.DisplayList")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e}var r=function(r){function h(e,i,n){var a=r.call(this)||this;return a.isPlaying=!1,a.entryClassName=n,a.stage=i,a.screenDisplayList=a.createDisplayList(i,e),a.showFPS=!1,a.showLog=!1,a.stageDisplayList=null,t.nativeRender&&(egret_native.rootWebGLBuffer=e),a}return __extends(h,r),h.prototype.createDisplayList=function(t,i){var r=new e.DisplayList(t);return r.renderBuffer=i,t.$displayList=r,r},h.prototype.start=function(){!this.isPlaying&&this.stage&&(e.$TempStage=e.$TempStage||this.stage,this.isPlaying=!0,this.root||this.initialize(),t.ticker.$addPlayer(this))},h.prototype.initialize=function(){var e;if(this.entryClassName&&(e=t.getDefinitionByName(this.entryClassName)),e){var i=new e;this.root=i,i instanceof t.DisplayObject&&this.stage.addChild(i)}},h.prototype.stop=function(){this.pause(),this.stage=null},h.prototype.pause=function(){this.isPlaying&&(this.isPlaying=!1,t.ticker.$removePlayer(this))},h.prototype.$render=function(e,i){if(t.nativeRender)return egret_native.updateNativeRender(),void egret_native.nrRender();t.sys.systemRenderer.renderClear&&t.sys.systemRenderer.renderClear();var r=this.stage,a=t.getTimer(),o=r.$displayList.drawToSurface(),s=t.getTimer();e&&this.showFPS&&n.update(o,s-a,i)},h.prototype.updateStageSize=function(e,i){var r=this.stage;r.$stageWidth=e,r.$stageHeight=i,t.nativeRender?egret_native.nrResize(e,i):(this.screenDisplayList.setClipRect(e,i),this.stageDisplayList&&this.stageDisplayList.setClipRect(e,i)),r.dispatchEventWith(t.Event.RESIZE)},h.prototype.displayFPS=function(r,h,c,l){if(h=!!h,h&&(t.log=function(){for(var t=arguments.length,r="",n=0;t>n;n++)r+=arguments[n]+" ";e.$logToFPS(r),console.log.apply(console,i(arguments))},t.warn=function(){for(var t=arguments.length,r="",n=0;t>n;n++)r+=arguments[n]+" ";e.$warnToFPS(r),console.warn.apply(console,i(arguments))},t.error=function(){for(var t=arguments.length,r="",n=0;t>n;n++)r+=arguments[n]+" ";e.$errorToFPS(r),console.error.apply(console,i(arguments))}),this.showFPS=!!r,this.showLog=h,!n){n=new FPS(this.stage,r,h,c,l);for(var u=a.length,p=0;u>p;p++)n.updateInfo(a[p]);a=null;for(var d=o.length,p=0;d>p;p++)n.updateWarn(o[p]);o=null;for(var f=s.length,p=0;f>p;p++)n.updateError(s[p]);s=null}},h}(t.HashObject);e.Player=r,__reflect(r.prototype,"egret.sys.Player");var n,a=[],o=[],s=[];e.$logToFPS=function(t){return n?void n.updateInfo(t):void a.push(t)},e.$warnToFPS=function(t){return n?void n.updateWarn(t):void o.push(t)},e.$errorToFPS=function(t){return n?void n.updateError(t):void s.push(t)};var h=function(){function e(e,i,r,n,a){this.showFPS=i,this.showLog=r,this.logFilter=n,this.styles=a,this.infoLines=[],this.totalTime=0,this.totalTick=0,this.lastTime=0,this.drawCalls=0,this.costRender=0,this.costTicker=0,this.infoLines=[],this.totalTime=0,this.totalTick=0,this.lastTime=0,this.drawCalls=0,this.costRender=0,this.costTicker=0,this._stage=e,this.showFPS=i,this.showLog=r,this.logFilter=n,this.styles=a,this.fpsDisplay=new t.FPSDisplay(e,i,r,n,a);var o;try{o=n?new RegExp(n):null}catch(s){t.log(s)}this.filter=function(t){return o?o.test(t):!n||0==t.indexOf(n)}}return e.prototype.update=function(e,i,r){var n=t.getTimer();if(this.totalTime+=n-this.lastTime,this.lastTime=n,this.totalTick++,this.drawCalls+=e,this.costRender+=i,this.costTicker+=r,this.totalTime>=1e3){var a=Math.min(Math.ceil(1e3*this.totalTick/this.totalTime),t.ticker.$frameRate),o=Math.round(this.drawCalls/this.totalTick),s=Math.round(this.costRender/this.totalTick),h=Math.round(this.costTicker/this.totalTick);this.fpsDisplay.update({fps:a,draw:o,costTicker:h,costRender:s}),this.totalTick=0,this.totalTime=this.totalTime%1e3,this.drawCalls=0,this.costRender=0,this.costTicker=0}},e.prototype.updateInfo=function(t){t&&this.showLog&&this.filter(t)&&this.fpsDisplay.updateInfo(t)},e.prototype.updateWarn=function(t){t&&this.showLog&&this.filter(t)&&(this.fpsDisplay.updateWarn?this.fpsDisplay.updateWarn(t):this.fpsDisplay.updateInfo("[Warning]"+t))},e.prototype.updateError=function(t){t&&this.showLog&&this.filter(t)&&(this.fpsDisplay.updateError?this.fpsDisplay.updateError(t):this.fpsDisplay.updateInfo("[Error]"+t))},e}();__reflect(h.prototype,"FPSImpl"),__global.FPS=h,t.warn=function(){console.warn.apply(console,i(arguments))},t.error=function(){console.error.apply(console,i(arguments))},t.assert=function(){console.assert.apply(console,i(arguments))},t.log=function(){console.log.apply(console,i(arguments))}}(e=t.sys||(t.sys={}))}(egret||(egret={})),function(t){if(t.nativeRender=__global.nativeRender,t.nativeRender){var e=egret_native.nrABIVersion,i=egret_native.nrMinEgretVersion,r=5;if(r>e){t.nativeRender=!1;var n=" 0.1.14 ";t.sys.$warnToFPS(n),t.warn(n)}else if(e>r){t.nativeRender=!1;var n=" "+i+" ";t.sys.$warnToFPS(n),t.warn(n)}}}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t,e,i,r){return void 0===e&&(e=512),void 0===i&&(i=512),void 0===r&&(r=1),Application.instance.egretProUtil.execute("createTextureFrom3dScene",t,e,i,r)}function i(t,e,i,r,n){return void 0===i&&(i=512),void 0===r&&(r=512),void 0===n&&(n=1),Application.instance.egretProUtil.execute("createTextureForCameras",t,e,i,r,n)}function r(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return(r=Application.instance.egretProUtil).execute.apply(r,[t].concat(e));var r}function n(t,e,i){return Application.instance.egretProUtil.register(t,e,i)}function a(t,e,i,r){return Application.instance.egretProUtil.addEventListener(t,e,i,r)}function o(t,e,i){return Application.instance.egretProUtil.removeEventListener(t,e,i)}function s(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return(n=Application.instance.egretProUtil).dispatch.apply(n,[t,e].concat(i));var n}t.egret2dDriveMode=!1,t.createTextureFrom3dScene=e,t.createTextureForCameras=i,t.execute=r,t.register=n,t.addEventListener=a,t.removeEventListener=o,t.dispatch=s}(e=t.pro||(t.pro={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.calculateStageSize=function(e,i,r,n,a){var o=i,s=r,h=n,c=a,l=i/h||0,u=r/c||0;switch(e){case t.StageScaleMode.EXACT_FIT:break;case t.StageScaleMode.FIXED_HEIGHT:h=Math.round(i/u);break;case t.StageScaleMode.FIXED_WIDTH:c=Math.round(r/l);break;case t.StageScaleMode.NO_BORDER:l>u?s=Math.round(c*l):o=Math.round(h*u);break;case t.StageScaleMode.SHOW_ALL:l>u?o=Math.round(h*u):s=Math.round(c*l);break;case t.StageScaleMode.FIXED_NARROW:l>u?h=Math.round(i/u):c=Math.round(r/l);break;case t.StageScaleMode.FIXED_WIDE:l>u?c=Math.round(r/l):h=Math.round(i/u);break;default:h=i,c=r}return t.Capabilities.runtimeType!=t.RuntimeType.WXGAME&&(h%2!=0&&(h+=1),c%2!=0&&(c+=1),o%2!=0&&(o+=1),s%2!=0&&(s+=1)),{stageWidth:h,stageHeight:c,displayWidth:o,displayHeight:s}},i}(t.HashObject);e.DefaultScreenAdapter=i,__reflect(i.prototype,"egret.sys.DefaultScreenAdapter",["egret.sys.IScreenAdapter"])}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.NO_SCALE="noScale",t.SHOW_ALL="showAll",t.NO_BORDER="noBorder",t.EXACT_FIT="exactFit",t.FIXED_WIDTH="fixedWidth",t.FIXED_HEIGHT="fixedHeight",t.FIXED_NARROW="fixedNarrow",t.FIXED_WIDE="fixedWide",t}();t.StageScaleMode=e,__reflect(e.prototype,"egret.StageScaleMode")}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t,e){return console.error("empty sys.mainCanvas = "+t+", "+e),null}function i(t,e){return console.error("empty sys.createCanvas = "+t+", "+e),null}function r(t,e,i,r){console.error("empty sys.resizeContext = "+t+", "+e+", "+i+", "+r)}function n(t){return console.error("empty sys.getContextWebGL = "+t),null}function a(t){return console.error("empty sys.getContext2d = "+t),null}function o(t,e){return console.error("empty sys.createTexture = "+e),null}function s(t,e,i,r){return console.error("empty sys._createTexture = "+e+", "+i+", "+r),null}function h(t,e,i){return console.error("empty sys.drawTextureElements = "+t+", "+e+", "+i),0}function c(t,e){return console.error("empty sys.measureTextWith = "+t+", "+e),0}function l(t,e,i,r){return console.error("empty sys.createCanvasRenderBufferSurface = "+e+", "+i),null}function u(t,e,i,r){console.error("empty sys.resizeContext = "+t+", "+e+", "+i+", "+r)}t.mainCanvas=e,t.createCanvas=i,t.resizeContext=r,t.getContextWebGL=n,t.getContext2d=a,t.createTexture=o,t._createTexture=s,t.drawTextureElements=h,t.measureTextWith=c,t.createCanvasRenderBufferSurface=l,t.resizeCanvasRenderBuffer=u}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){e.$START_TIME=0,e.$invalidateRenderFlag=!1,e.$requestRenderingFlag=!1;var i=function(){function i(){var i=this;this.playerList=[],this.callBackList=[],this.thisObjectList=[],this.$frameRate=30,this.lastTimeStamp=0,this.costEnterFrame=0,this.isPaused=!1,this.$beforeRender=function(){for(var r=i.callBackList,n=i.thisObjectList,a=r.length,o=t.getTimer(),s=t.lifecycle.contexts,h=0,c=s;h<c.length;h++){var l=c[h];l.onUpdate&&l.onUpdate()}if(i.isPaused)return void(i.lastTimeStamp=o);i.callLaterAsyncs();for(var u=0;a>u;u++)r[u].call(n[u],o);i.callLaters(),e.$invalidateRenderFlag&&(i.broadcastRender(),e.$invalidateRenderFlag=!1)},this.$afterRender=function(){i.broadcastEnterFrame()},e.$START_TIME=Date.now(),this.frameDeltaTime=1e3/this.$frameRate,this.lastCount=this.frameInterval=Math.round(6e4/this.$frameRate)}return i.prototype.$addPlayer=function(t){-1==this.playerList.indexOf(t)&&(this.playerList=this.playerList.concat(),this.playerList.push(t))},i.prototype.$removePlayer=function(t){var e=this.playerList.indexOf(t);if(-1!==e){this.playerList=this.playerList.concat(),this.playerList.splice(e,1)}},i.prototype.$startTick=function(t,e){var i=this.getTickIndex(t,e);-1==i&&(this.concatTick(),this.callBackList.push(t),this.thisObjectList.push(e))},i.prototype.$stopTick=function(t,e){var i=this.getTickIndex(t,e);-1!=i&&(this.concatTick(),this.callBackList.splice(i,1),this.thisObjectList.splice(i,1))},i.prototype.getTickIndex=function(t,e){for(var i=this.callBackList,r=this.thisObjectList,n=i.length-1;n>=0;n--)if(i[n]==t&&r[n]==e)return n;return-1},i.prototype.concatTick=function(){this.callBackList=this.callBackList.concat(),this.thisObjectList=this.thisObjectList.concat()},i.prototype.$setFrameRate=function(t){return 0>=t?!1:this.$frameRate==t?!1:(this.$frameRate=t,t>60&&(t=60),this.frameDeltaTime=1e3/t,this.lastCount=this.frameInterval=Math.round(6e4/t),!0)},i.prototype.pause=function(){this.isPaused=!0},i.prototype.resume=function(){this.isPaused=!1},i.prototype.update=function(i){for(var r=t.getTimer(),n=this.callBackList,a=this.thisObjectList,o=n.length,s=e.$requestRenderingFlag,h=t.getTimer(),c=t.lifecycle.contexts,l=0,u=c;l<u.length;l++){var p=u[l];p.onUpdate&&p.onUpdate()}if(this.isPaused)return void(this.lastTimeStamp=h);this.callLaterAsyncs();for(var d=0;o>d;d++)n[d].call(a[d],h)&&(s=!0);var f=t.getTimer(),g=h-this.lastTimeStamp;if(this.lastTimeStamp=h,g>=this.frameDeltaTime||i)this.lastCount=this.frameInterval;else{if(this.lastCount-=1e3,this.lastCount>0)return void(s&&this.render(!1,this.costEnterFrame+f-r));this.lastCount+=this.frameInterval}this.render(!0,this.costEnterFrame+f-r);var $=t.getTimer();this.broadcastEnterFrame();var y=t.getTimer();this.costEnterFrame=y-$},i.prototype.render=function(t,i){var r=this.playerList,n=r.length;if(0!=n){this.callLaters(),e.$invalidateRenderFlag&&(this.broadcastRender(),e.$invalidateRenderFlag=!1);for(var a=0;n>a;a++)r[a].$render(t,i);e.$requestRenderingFlag=!1}},i.prototype.broadcastEnterFrame=function(){var e=t.DisplayObject.$enterFrameCallBackList,i=e.length;if(0!=i){e=e.concat();for(var r=0;i>r;r++)e[r].dispatchEventWith(t.Event.ENTER_FRAME)}},i.prototype.broadcastRender=function(){var e=t.DisplayObject.$renderCallBackList,i=e.length;if(0!=i){e=e.concat();for(var r=0;i>r;r++)e[r].dispatchEventWith(t.Event.RENDER)}},i.prototype.callLaters=function(){var e,i,r;if(t.$callLaterFunctionList.length>0&&(e=t.$callLaterFunctionList,t.$callLaterFunctionList=[],i=t.$callLaterThisList,t.$callLaterThisList=[],r=t.$callLaterArgsList,t.$callLaterArgsList=[]),e)for(var n=e.length,a=0;n>a;a++){var o=e[a];null!=o&&o.apply(i[a],r[a])}},i.prototype.callLaterAsyncs=function(){if(t.$callAsyncFunctionList.length>0){var e=t.$callAsyncFunctionList,i=t.$callAsyncThisList,r=t.$callAsyncArgsList;t.$callAsyncFunctionList=[],t.$callAsyncThisList=[],t.$callAsyncArgsList=[];for(var n=0;n<e.length;n++){var a=e[n];null!=a&&a.apply(i[n],r[n])}}},i}();e.SystemTicker=i,__reflect(i.prototype,"egret.sys.SystemTicker")}(e=t.sys||(t.sys={}))}(egret||(egret={})),function(t){var e;!function(e){function i(t){var i=new n;e.contexts.push(i),t(i)}e.contexts=[];var r=!0,n=function(){function i(){}return i.prototype.pause=function(){r&&(r=!1,e.stage.dispatchEvent(new t.Event(t.Event.DEACTIVATE)),e.onPause&&e.onPause())},i.prototype.resume=function(){r||(r=!0,e.stage.dispatchEvent(new t.Event(t.Event.ACTIVATE)),e.onResume&&e.onResume())},i}();e.LifecycleContext=n,__reflect(n.prototype,"egret.lifecycle.LifecycleContext"),e.addLifecycleListener=i}(e=t.lifecycle||(t.lifecycle={})),t.ticker=new t.sys.SystemTicker}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(t){var i=e.call(this)||this;return i.maxTouches=0,i.useTouchesCount=0,i.touchDownTarget={},i.lastTouchX=-1,i.lastTouchY=-1,i.$updateMaxTouches=function(t){this.maxTouches=t},i.stage=t,i}return __extends(i,e),i.prototype.$initMaxTouches=function(){this.maxTouches=this.stage.$maxTouches},i.prototype.onTouchBegin=function(e,i,r){if(!(this.useTouchesCount>=this.maxTouches)){this.lastTouchX=e,this.lastTouchY=i;var n=this.findTarget(e,i);return null==this.touchDownTarget[r]&&(this.touchDownTarget[r]=n,this.useTouchesCount++),t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_BEGIN,!0,!0,e,i,r,!0),n!==this.stage}},i.prototype.onTouchMove=function(e,i,r){if(null!=this.touchDownTarget[r]&&(this.lastTouchX!=e||this.lastTouchY!=i)){this.lastTouchX=e,this.lastTouchY=i;var n=this.findTarget(e,i);return t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_MOVE,!0,!0,e,i,r,!0),n!==this.stage}},i.prototype.onTouchEnd=function(e,i,r){if(null!=this.touchDownTarget[r]){var n=this.findTarget(e,i),a=this.touchDownTarget[r];return delete this.touchDownTarget[r],this.useTouchesCount--,t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_END,!0,!0,e,i,r,!1),a==n?t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_TAP,!0,!0,e,i,r,!1):t.TouchEvent.dispatchTouchEvent(a,t.TouchEvent.TOUCH_RELEASE_OUTSIDE,!0,!0,e,i,r,!1),n!==this.stage}},i.prototype.findTarget=function(t,e){var i=this.stage.$hitTest(t,e);return i||(i=this.stage),i},i}(t.HashObject);e.TouchHandler=i,__reflect(i.prototype,"egret.sys.TouchHandler")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var t=e.call(this)||this;return t.image=null,t.smoothing=!0,t.blendMode=null,t.alpha=0/0,t.filter=null,t.rotated=!1,t.type=1,t}return __extends(i,e),i.prototype.drawImage=function(t,e,i,r,n,a,o,s){this.drawData.push(t,e,i,r,n,a,o,s),this.renderCount++},i.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.image=null,this.matrix=null,this.blendMode=null,this.alpha=0/0,this.filter=null},i.$updateTextureData=function(e,r,n,a,o,s,h,c,l,u,p,d,f,g,$,y){if(r){var v=t.$TextureScaleFactor;if(e.smoothing=y,e.image=r,e.imageWidth=f,e.imageHeight=g,$==t.BitmapFillMode.SCALE){var m=p/l*v,b=d/u*v;e.drawImage(n,a,o,s,m*h,b*c,m*o,b*s)}else if($==t.BitmapFillMode.CLIP){var x=Math.min(l,p),T=Math.min(u,d),_=o*v,D=s*v;i.drawClipImage(e,v,n,a,_,D,h,c,x,T)}else for(var _=o*v,D=s*v,O=0;p>O;O+=l)for(var w=0;d>w;w+=u){var x=Math.min(p-O,l),T=Math.min(d-w,u);i.drawClipImage(e,v,n,a,_,D,h,c,x,T,O,w)}}},i.$updateTextureDataWithScale9Grid=function(e,i,r,n,a,o,s,h,c,l,u,p,d,f,g,$){e.smoothing=$,e.image=i,e.imageWidth=f,e.imageHeight=g;var y=o,v=s;p-=l-o*t.$TextureScaleFactor,d-=u-s*t.$TextureScaleFactor;var m=r.x-h,b=r.y-c,x=m/t.$TextureScaleFactor,T=b/t.$TextureScaleFactor,_=r.width/t.$TextureScaleFactor,D=r.height/t.$TextureScaleFactor;0==D&&(D=1,T>=v&&T--),0==_&&(_=1,x>=y&&x--);var O=n,w=O+x,E=w+_,C=y-x-_,R=a,S=R+T,F=S+D,P=v-T-D,M=C*t.$TextureScaleFactor,j=P*t.$TextureScaleFactor;if((x+C)*t.$TextureScaleFactor>p||(T+P)*t.$TextureScaleFactor>d)return void e.drawImage(n,a,o,s,h,c,p,d);var A=h,B=A+m,N=A+(p-M),k=p-m-M,L=c,I=L+b,U=L+d-j,H=d-b-j;T>0&&(x>0&&e.drawImage(O,R,x,T,A,L,m,b),_>0&&e.drawImage(w,R,_,T,B,L,k,b),C>0&&e.drawImage(E,R,C,T,N,L,M,b)),D>0&&(x>0&&e.drawImage(O,S,x,D,A,I,m,H),_>0&&e.drawImage(w,S,_,D,B,I,k,H),C>0&&e.drawImage(E,S,C,D,N,I,M,H)),P>0&&(x>0&&e.drawImage(O,F,x,P,A,U,m,j),_>0&&e.drawImage(w,F,_,P,B,U,k,j),C>0&&e.drawImage(E,F,C,P,N,U,M,j))},i.drawClipImage=function(t,e,i,r,n,a,o,s,h,c,l,u){void 0===l&&(l=0),void 0===u&&(u=0);var p=o+n-h;p>0&&(n-=p),p=s+a-c,p>0&&(a-=p),t.drawImage(i,r,n/e,a/e,l+o,u+s,n,a)},i}(e.RenderNode);e.BitmapNode=i,__reflect(i.prototype,"egret.sys.BitmapNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=["none","round","square"],r=["bevel","miter","round"],n=function(n){function a(){var t=n.call(this)||this;return t.dirtyRender=!0,t.type=3,t}return __extends(a,n),a.prototype.beginFill=function(t,i,r){void 0===i&&(i=1);var n=new e.FillPath;if(n.fillColor=t,n.fillAlpha=i,r){var a=this.drawData.lastIndexOf(r);this.drawData.splice(a,0,n)}else this.drawData.push(n);return this.renderCount++,n},a.prototype.beginGradientFill=function(i,r,n,a,o,s){var h=new t.Matrix;o?(h.a=819.2*o.a,h.b=819.2*o.b,h.c=819.2*o.c,h.d=819.2*o.d,h.tx=o.tx,h.ty=o.ty):(h.a=100,h.d=100);var c=new e.GradientFillPath;if(c.gradientType=i,c.colors=r,c.alphas=n,c.ratios=a,c.matrix=h,s){var l=this.drawData.lastIndexOf(s);this.drawData.splice(l,0,c)}else this.drawData.push(c);return this.renderCount++,c},a.prototype.lineStyle=function(n,a,o,s,h,c,l){void 0===o&&(o=1),void 0===c&&(c=3),void 0===l&&(l=[]),-1==i.indexOf(s)&&(s="round"),-1==r.indexOf(h)&&(h="round");var u=new e.StrokePath;return u.lineWidth=n,u.lineColor=a,u.lineAlpha=o,u.caps=s||t.CapsStyle.ROUND,u.joints=h,u.miterLimit=c,u.lineDash=l,this.drawData.push(u),this.renderCount++,u},a.prototype.clear=function(){this.drawData.length=0,this.dirtyRender=!0,this.renderCount=0},a.prototype.cleanBeforeRender=function(){},a.prototype.clean=function(){this.$texture&&(t.WebGLUtils.deleteWebGLTexture(this.$texture),this.$texture=null,this.dirtyRender=!0)},a}(e.RenderNode);e.GraphicsNode=n,__reflect(n.prototype,"egret.sys.GraphicsNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=4,e}return __extends(e,t),e.prototype.addNode=function(t){this.drawData.push(t)},e.prototype.cleanBeforeRender=function(){for(var t=this.drawData,e=t.length-1;e>=0;e--)t[e].cleanBeforeRender()},e.prototype.$getRenderCount=function(){for(var t=0,e=this.drawData,i=e.length-1;i>=0;i--)t+=e[i].$getRenderCount();return t},e}(t.RenderNode);t.GroupNode=e,__reflect(e.prototype,"egret.sys.GroupNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var i=e.call(this)||this;return i.image=null,i.smoothing=!0,i.bounds=new t.Rectangle,i.blendMode=null,i.alpha=0/0,i.filter=null,i.rotated=!1,i.type=5,i.vertices=[],i.uvs=[],i.indices=[],i}return __extends(i,e),i.prototype.drawMesh=function(t,e,i,r,n,a,o,s){this.drawData.push(t,e,i,r,n,a,o,s),this.renderCount++},i.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.image=null,this.matrix=null},i}(e.RenderNode);e.MeshNode=i,__reflect(i.prototype,"egret.sys.MeshNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.image=null,e.smoothing=!0,e.rotated=!1,e.type=6,e}return __extends(e,t),e.prototype.drawImage=function(t,e,i,r,n,a,o,s){var h=this;h.sourceX=t,h.sourceY=e,h.sourceW=i,h.sourceH=r,h.drawX=n,h.drawY=a,h.drawW=o,h.drawH=s,h.renderCount=1},e.prototype.cleanBeforeRender=function(){t.prototype.cleanBeforeRender.call(this),this.image=null},e}(t.RenderNode);t.NormalBitmapNode=e,__reflect(e.prototype,"egret.sys.NormalBitmapNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function e(t,i,r,n){this.arrayBuffer=t,this.isInvalid=!1;var a=new Uint8Array(this.arrayBuffer,0,12);if(171!==a[0]||75!==a[1]||84!==a[2]||88!==a[3]||32!==a[4]||49!==a[5]||49!==a[6]||187!==a[7]||13!==a[8]||10!==a[9]||26!==a[10]||10!==a[11])return this.isInvalid=!0,void console.error("texture missing KTX identifier");var o=Uint32Array.BYTES_PER_ELEMENT,s=new DataView(this.arrayBuffer,12,13*o),h=s.getUint32(0,!0),c=67305985===h;return this.glType=s.getUint32(1*o,c),this.glTypeSize=s.getUint32(2*o,c),this.glFormat=s.getUint32(3*o,c),this.glInternalFormat=s.getUint32(4*o,c),this.glBaseInternalFormat=s.getUint32(5*o,c),this.pixelWidth=s.getUint32(6*o,c),this.pixelHeight=s.getUint32(7*o,c),this.pixelDepth=s.getUint32(8*o,c),this.numberOfArrayElements=s.getUint32(9*o,c),this.numberOfFaces=s.getUint32(10*o,c),this.numberOfMipmapLevels=s.getUint32(11*o,c),this.bytesOfKeyValueData=s.getUint32(12*o,c),0!==this.glType?void console.error("only compressed formats currently supported"):(this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),0===this.pixelHeight||0!==this.pixelDepth?void console.error("only 2D textures currently supported"):0!==this.numberOfArrayElements?void console.error("texture arrays not currently supported"):this.numberOfFaces!==i?void console.error("number of faces expected"+i+", but found "+this.numberOfFaces):void(this.loadType=e.COMPRESSED_2D))}return e.prototype.uploadLevels=function(t,i){this.loadType===e.COMPRESSED_2D&&this._upload2DCompressedLevels(t,i)},e.prototype._upload2DCompressedLevels=function(i,r){i.clearCompressedTextureData();for(var n=i.compressedTextureData,a=e.HEADER_LEN+this.bytesOfKeyValueData,o=this.pixelWidth,s=this.pixelHeight,h=r?this.numberOfMipmapLevels:1,c=0;h>c;c++){var l=new Int32Array(this.arrayBuffer,a,1)[0];a+=4;for(var u=[],p=0;p<this.numberOfFaces;p++){var d=new Uint8Array(this.arrayBuffer,a,l),f=new t.CompressedTextureData;f.glInternalFormat=this.glInternalFormat,f.width=o,f.height=s,f.byteArray=d,f.face=p,f.level=c,u.push(f),a+=l,a+=3-(l+3)%4}n.push(u),o=Math.max(1,.5*o),s=Math.max(1,.5*s)}var g=i.getCompressed2dTextureData();g&&(i.width=g.width,i.height=g.height)},e.HEADER_LEN=64,e.COMPRESSED_2D=0,e.COMPRESSED_3D=1,e.TEX_2D=2,e.TEX_3D=3,e}();t.KTXContainer=e,__reflect(e.prototype,"egret.KTXContainer")}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var t=e.call(this)||this;return t.textColor=16777215,t.strokeColor=0,t.size=30,t.stroke=0,t.bold=!1,t.italic=!1,t.fontFamily="Arial",t.dirtyRender=!0,t.type=2,t}return __extends(i,e),i.prototype.drawText=function(t,e,i,r){this.drawData.push(t,e,i,r),this.renderCount++,this.dirtyRender=!0},i.prototype.clean=function(){this.$texture&&(t.WebGLUtils.deleteWebGLTexture(this.$texture),this.$texture=null,this.dirtyRender=!0)},i.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.dirtyRender=!0},i}(e.RenderNode);e.TextNode=i,__reflect(i.prototype,"egret.sys.TextNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=1,e}return __extends(e,t),e}(t.Path2D);t.FillPath=e,__reflect(e.prototype,"egret.sys.FillPath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=2,e}return __extends(e,t),e}(t.Path2D);t.GradientFillPath=e,__reflect(e.prototype,"egret.sys.GradientFillPath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(i){var r=e.call(this,i)||this;return r._verticesDirty=!0,r._bounds=new t.Rectangle,r.$renderNode=new t.sys.MeshNode,r}return __extends(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(12)},i.prototype.setBitmapDataToWasm=function(t){this.$nativeDisplayObject.setBitmapDataToMesh(t)},i.prototype.$updateRenderNode=function(){var e=this.$bitmapData;if(e){var i=(t.$TextureScaleFactor,this.$renderNode);i.smoothing=this.$smoothing,i.image=e,i.imageWidth=this.$sourceWidth,i.imageHeight=this.$sourceHeight;var r=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,n=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight,a=r/this.$textureWidth,o=n/this.$textureHeight,s=this.$bitmapWidth,h=this.$bitmapHeight;i.drawMesh(this.$bitmapX,this.$bitmapY,s,h,this.$offsetX*a,this.$offsetY*o,a*s,o*h)}},i.prototype.$updateVertices=function(){var e=this;if(e._verticesDirty=!0,e.$renderDirty=!0,t.nativeRender){var i=this.$renderNode;this.$nativeDisplayObject.setDataToMesh(i.vertices,i.indices,i.uvs)}else{var r=e.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=e.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},i.prototype.$measureContentBounds=function(t){if(this._verticesDirty){this._verticesDirty=!1;var e=this.$renderNode,i=e.vertices;if(i.length){this._bounds.setTo(Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var r=0,n=i.length;n>r;r+=2){var a=i[r],o=i[r+1];this._bounds.x>a&&(this._bounds.x=a),this._bounds.width<a&&(this._bounds.width=a),this._bounds.y>o&&(this._bounds.y=o),this._bounds.height<o&&(this._bounds.height=o)}this._bounds.width-=this._bounds.x,this._bounds.height-=this._bounds.y}else this._bounds.setTo(0,0,0,0);e.bounds.copyFrom(this._bounds)}t.copyFrom(this._bounds)},i}(t.Bitmap);t.Mesh=e,__reflect(e.prototype,"egret.Mesh")}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=3,e}return __extends(e,t),e}(t.Path2D);t.StrokePath=e,__reflect(e.prototype,"egret.sys.StrokePath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){function e(t,e){var i=null==e.italic?t.italic:e.italic,r=null==e.bold?t.bold:e.bold,n=null==e.size?t.size:e.size,a=e.fontFamily||t.fontFamily,o=i?"italic ":"normal ";return o+=r?"bold ":"normal ",o+=n+"px "+a}function i(t,e){var i=t>>16,r=t>>8&255,n=255&t;return"rgba("+i+","+r+","+n+","+e+")"}function r(e,r,n,a,o,s){var h;h=r==t.GradientType.LINEAR?e.createLinearGradient(-1,0,1,0):e.createRadialGradient(0,0,0,0,0,1);for(var c=n.length,l=0;c>l;l++)h.addColorStop(o[l]/255,i(n[l],a[l]));return h}function n(t,e,i){void 0===i&&(i=0);for(var r=0,n=e.length;n>r;r++)t[r+i]=e[r]}function a(t,e,i,r){for(var n=r[0],a=r[1],o=r[2],s=r[3],h=r[4],c=r[5],l=r[6],u=r[7],p=r[8],d=r[9],f=r[10],g=r[11],$=r[12],y=r[13],v=r[14],m=r[15],b=r[16],x=r[17],T=r[18],_=r[19],D=0,O=e*i*4;O>D;D+=4){var w=t[D+0],E=t[D+1],C=t[D+2],R=t[D+3];t[D+0]=n*w+a*E+o*C+s*R+h,t[D+1]=c*w+l*E+u*C+p*R+d,t[D+2]=f*w+g*E+$*C+y*R+v,t[D+3]=m*w+b*E+x*C+T*R+_}}function o(t,e,i,r,n){s(t,e,i,r),h(t,e,i,n)}function s(t,e,i,r){var a;a=_?new Uint8ClampedArray(4*e):new Array(4*e);for(var o=4*e,s=2*r+1,h=0;i>h;h++){for(var c=h*o,l=0,u=0,p=0,d=0,f=0,g=0,$=4*-r,y=4*r+4;y>$;$+=4){var v=c+$;c>v||v>=c+o||(f=t[v+3],l+=t[v+0]*f,u+=t[v+1]*f,p+=t[v+2]*f,d+=f)}for(var $=c,y=c+o,m=0,b=$-4*r,x=$+4*(r+1);y>$;$+=4,m+=4,x+=4,b+=4)0===d?(a[m+0]=0,a[m+1]=0,a[m+2]=0,a[m+3]=0):(a[m+0]=l/d,a[m+1]=u/d,a[m+2]=p/d,a[m+3]=d/s),f=t[x+3],g=t[b+3],f||0==f?g||0==g?(l+=t[x+0]*f-t[b+0]*g,u+=t[x+1]*f-t[b+1]*g,p+=t[x+2]*f-t[b+2]*g,d+=f-g):(l+=t[x+0]*f,u+=t[x+1]*f,p+=t[x+2]*f,d+=f):(g||0==g)&&(l+=-t[b+0]*g,u+=-t[b+1]*g,p+=-t[b+2]*g,d+=-g);_?t.set(a,c):n(t,a,c)}}function h(t,e,i,r){var n;n=_?new Uint8ClampedArray(4*i):new Array(4*i);for(var a=4*e,o=2*r+1,s=0;e>s;s++){for(var h=4*s,c=0,l=0,u=0,p=0,d=0,f=0,g=-r*a,$=r*a+a;$>g;g+=a){var y=h+g;h>y||y>=h+i*a||(d=t[y+3],c+=t[y+0]*d,l+=t[y+1]*d,u+=t[y+2]*d,p+=d)}for(var g=h,$=h+i*a,v=0,m=h-r*a,b=h+(r+1)*a;$>g;g+=a,v+=4,b+=a,m+=a)0===p?(n[v+0]=0,n[v+1]=0,n[v+2]=0,n[v+3]=0):(n[v+0]=c/p,n[v+1]=l/p,n[v+2]=u/p,n[v+3]=p/o),d=t[b+3],f=t[m+3],d||0==d?f||0==f?(c+=t[b+0]*d-t[m+0]*f,l+=t[b+1]*d-t[m+1]*f,u+=t[b+2]*d-t[m+2]*f,p+=d-f):(c+=t[b+0]*d,l+=t[b+1]*d,u+=t[b+2]*d,p+=d):(f||0==f)&&(c+=-t[m+0]*f,l+=-t[m+1]*f,u+=-t[m+2]*f,p+=-f);for(var x=4*s,$=x+i*a,T=0;$>x;x+=a,T+=4)t[x+0]=n[T+0],t[x+1]=n[T+1],t[x+2]=n[T+2],t[x+3]=n[T+3]}}function c(t,e,i,r,a,s,h,c,f){var g=l(t,r);u(g,e,i,h,c),o(g,e,i,a,s),p(g,f),d(g,t),t.set(g),_?t.set(g):n(t,g)
}function l(t,e){e||(e=[0,0,0,0]);var i;_?i=new Uint8ClampedArray(t):(i=new Array(t.length),n(i,t));for(var r=e[0],a=e[1],o=e[2],s=e[3],h=0,c=i.length;c>h;h+=4){var l=i[h+3];i[h+0]=r*l,i[h+1]=a*l,i[h+2]=o*l,i[h+3]=s*l}return i}function u(t,e,i,r,a){var o,s,h=Math.sin(r)*a|0,c=Math.cos(r)*a|0;if(_){o=new Int32Array(t.buffer),s=new Int32Array(o.length);for(var l=0;i>l;l++){var u=l+h;if(!(0>u||u>i))for(var p=0;e>p;p++){var d=p+c;0>d||d>e||(s[u*e+d]=o[l*e+p])}}o.set(s)}else{o=t,s=new Array(o.length);for(var l=0;i>l;l++){var u=l+h;if(!(0>u||u>i))for(var p=0;e>p;p++){var d=p+c;0>d||d>e||(s[4*(u*e+d)+0]=o[4*(l*e+p)+0],s[4*(u*e+d)+1]=o[4*(l*e+p)+1],s[4*(u*e+d)+2]=o[4*(l*e+p)+2],s[4*(u*e+d)+3]=o[4*(l*e+p)+3])}}n(o,s)}}function p(t,e){for(var i=0,r=t.length;r>i;i+=4)t[i+3]*=e}function d(t,e){for(var i=0,r=t.length;r>i;i+=4){var n=t[i+0],a=t[i+1],o=t[i+2],s=t[i+3]/255,h=e[i+0],c=e[i+1],l=e[i+2],u=e[i+3]/255;t[i+0]=h+n*(1-u),t[i+1]=c+a*(1-u),t[i+2]=l+o*(1-u),t[i+3]=255*(u+s*(1-u))}}function f(t,e,i){return t*(1-i)+e*i}function g(t,e,i,r,a,o,s,h,c,l,u,p){var d;d=_?new Uint8ClampedArray(t.length):new Array(t.length);for(var g,$,y=r[3],v=0,m=0,b=h*Math.cos(s),x=h*Math.sin(s),T=7,D=12,O=3.141592653589793,w=a/T,E=o/T,C=0;e>C;C++)for(var R=0;i>R;R++){for(var S=0,F=R*e*4+4*C,P=0,M=0,j=t[F+0]/255,A=t[F+1]/255,B=t[F+2]/255,N=t[F+3]/255,k=0;2*O>=k;k+=2*O/D){g=Math.cos(k+S),$=Math.sin(k+S);for(var L=0;T>L;L++){v=L*w*g,m=L*E*$;var I=Math.round(C+v-b),U=Math.round(R+m-x),H=0;if(I>=e||0>I||0>U||U>=i)H=0;else{var X=U*e*4+4*I;H=t[X+3]/255}P+=(T-L)*H,M+=T-L}}N=Math.max(N,1e-4);var Y=P/M*c*y*(1-l)*Math.max(Math.min(p,u),1-N),W=(M-P)/M*c*y*l*N;N=Math.max(N*u*(1-p),1e-4);var G=W/(W+N),z=f(j,r[0],G),V=f(A,r[1],G),q=f(B,r[2],G),K=Y/(W+N+Y),J=f(z,r[0],K),Q=f(V,r[1],K),Z=f(q,r[2],K),te=Math.min(N+Y+W,1);d[F+0]=255*J,d[F+1]=255*Q,d[F+2]=255*Z,d[F+3]=255*te}_?t.set(d):n(t,d)}var $=["source-over","lighter","destination-out"],y="source-over",v="#000000",m={none:"butt",square:"square",round:"round"},b=[],x=[],T=function(){function n(){this.nestLevel=0,this.renderingMask=!1}return n.prototype.render=function(e,i,r,n){this.nestLevel++;var a=i.context;a.transform(r.a,r.b,r.c,r.d,0,0);var o=this.drawDisplayObject(e,a,r.tx,r.ty,!0),s=t.Matrix.create();if(r.$invertInto(s),a.transform(s.a,s.b,s.c,s.d,0,0),t.Matrix.release(s),this.nestLevel--,0===this.nestLevel){b.length>6&&(b.length=6);for(var h=b.length,c=0;h>c;c++)b[c].resize(0,0)}return o},n.prototype.drawDisplayObject=function(e,i,r,n,a){var o,s=0,h=e.$displayList;if(h&&!a?((e.$cacheDirty||e.$renderDirty||h.$canvasScaleX!=t.sys.DisplayList.$canvasScaleX||h.$canvasScaleY!=t.sys.DisplayList.$canvasScaleY)&&(s+=h.drawToSurface()),o=h.$renderNode):o=e.$renderDirty?e.$getRenderNode():e.$renderNode,e.$cacheDirty=!1,o){switch(s++,i.$offsetX=r,i.$offsetY=n,o.type){case 1:this.renderBitmap(o,i);break;case 2:this.renderText(o,i);break;case 3:this.renderGraphics(o,i);break;case 4:this.renderGroup(o,i);break;case 5:this.renderMesh(o,i);break;case 6:this.renderNormalBitmap(o,i)}i.$offsetX=0,i.$offsetY=0}if(h&&!a)return s;var c=e.$children;if(c)for(var l=c.length,u=0;l>u;u++){var p=c[u],d=void 0,f=void 0;if(p.$useTranslate){var g=p.$getMatrix();d=r+p.$x,f=n+p.$y,i.save(),i.transform(g.a,g.b,g.c,g.d,d,f),d=-p.$anchorOffsetX,f=-p.$anchorOffsetY}else d=r+p.$x-p.$anchorOffsetX,f=n+p.$y-p.$anchorOffsetY;var $=void 0;switch(1!=p.$alpha&&($=i.globalAlpha,i.globalAlpha*=p.$alpha),p.$renderMode){case 1:break;case 2:s+=this.drawWithFilter(p,i,d,f);break;case 3:s+=this.drawWithClip(p,i,d,f);break;case 4:s+=this.drawWithScrollRect(p,i,d,f);break;default:s+=this.drawDisplayObject(p,i,d,f)}p.$useTranslate?i.restore():$&&(i.globalAlpha=$)}return s},n.prototype.drawWithFilter=function(t,e,i,r){if(t.$children&&0==t.$children.length&&(!t.$renderNode||0==t.$renderNode.$getRenderCount()))return 0;var n,s=0,h=t.$filters,l=h.length,u=0!==t.$blendMode;u&&(n=$[t.$blendMode],n||(n=y));var p=t.$getOriginalBounds(),d=p.x,f=p.y,v=p.width,m=p.height;if(0>=v||0>=m)return s;var b=this.createRenderBuffer(v-d,m-f,!0),T=b.context;if(s+=t.$mask?this.drawWithClip(t,T,-d,-f):t.$scrollRect||t.$maskRect?this.drawWithScrollRect(t,T,-d,-f):this.drawDisplayObject(t,T,-d,-f),s>0){u&&(e.globalCompositeOperation=n),s++;for(var _=T.getImageData(0,0,b.surface.width,b.surface.height),D=0;l>D;D++){var O=h[D];if("colorTransform"==O.type)a(_.data,b.surface.width,b.surface.height,O.$matrix);else if("blur"==O.type)o(_.data,b.surface.width,b.surface.height,O.$blurX,O.$blurY);else if("glow"==O.type){var w=O.$red,E=O.$green,C=O.$blue,R=O.$alpha;O.$inner||O.$knockout||O.$hideObject?g(_.data,b.surface.width,b.surface.height,[w/255,E/255,C/255,R],O.$blurX,O.$blurY,O.$angle?O.$angle/180*Math.PI:0,O.$distance||0,O.$strength,O.$inner?1:0,O.$knockout?0:1,O.$hideObject?1:0):c(_.data,b.surface.width,b.surface.height,[w/255,E/255,C/255,R],O.$blurX,O.$blurY,O.$angle?O.$angle/180*Math.PI:0,O.$distance||0,O.$strength)}else"custom"==O.type}T.putImageData(_,0,0),e.drawImage(b.surface,i+d,r+f),u&&(e.globalCompositeOperation=y)}return x.push(b),s},n.prototype.drawWithClip=function(e,i,r,n){var a,o=0,s=0!==e.$blendMode;s&&(a=$[e.$blendMode],a||(a=y));var h=e.$scrollRect?e.$scrollRect:e.$maskRect,c=e.$mask;if(c){var l=c.$getMatrix();if(0==l.a&&0==l.b||0==l.c&&0==l.d)return o}if(!(c||e.$children&&0!=e.$children.length))return h&&(i.save(),i.beginPath(),i.rect(h.x+r,h.y+n,h.width,h.height),i.clip()),s&&(i.globalCompositeOperation=a),o+=this.drawDisplayObject(e,i,r,n),s&&(i.globalCompositeOperation=y),h&&i.restore(),o;if(c){var u=c.$getRenderNode();if((!c.$children||0==c.$children.length)&&u&&3==u.type&&1==u.drawData.length&&1==u.drawData[0].type&&1==u.drawData[0].fillAlpha){this.renderingMask=!0,i.save();var p=t.Matrix.create();p.copyFrom(c.$getConcatenatedMatrix()),c.$getConcatenatedMatrixAt(e,p),p.prepend(1,0,0,1,r,n),i.transform(p.a,p.b,p.c,p.d,p.tx,p.ty);var d=this.drawDisplayObject(c,i,0,0);return this.renderingMask=!1,p.$invertInto(p),i.transform(p.a,p.b,p.c,p.d,p.tx,p.ty),t.Matrix.release(p),h&&(i.beginPath(),i.rect(h.x+r,h.y+n,h.width,h.height),i.clip()),d+=this.drawDisplayObject(e,i,r,n),i.restore(),d}}var f=e.$getOriginalBounds(),g=f.x,v=f.y,m=f.width,x=f.height;if(0>=m||0>=x)return o;var T=this.createRenderBuffer(m,x),_=T.context;if(!_)return o+=this.drawDisplayObject(e,i,r,n);if(o+=this.drawDisplayObject(e,_,-g,-v),c){var u=c.$getRenderNode(),p=t.Matrix.create();if(p.copyFrom(c.$getConcatenatedMatrix()),c.$getConcatenatedMatrixAt(e,p),p.translate(-g,-v),u&&1==u.$getRenderCount()||c.$displayList)_.globalCompositeOperation="destination-in",_.save(),_.setTransform(p.a,p.b,p.c,p.d,p.tx,p.ty),o+=this.drawDisplayObject(c,_,0,0),_.restore();else{var D=this.createRenderBuffer(m,x),O=D.context;O.setTransform(p.a,p.b,p.c,p.d,p.tx,p.ty),o+=this.drawDisplayObject(c,O,0,0),_.globalCompositeOperation="destination-in",_.drawImage(D.surface,0,0),b.push(D)}t.Matrix.release(p)}return o>0&&(o++,s&&(i.globalCompositeOperation=a),h&&(i.save(),i.beginPath(),i.rect(h.x+r,h.y+n,h.width,h.height),i.clip()),i.drawImage(T.surface,r+g,n+v),h&&i.restore(),s&&(i.globalCompositeOperation=y)),b.push(T),o},n.prototype.drawWithScrollRect=function(t,e,i,r){var n=0,a=t.$scrollRect?t.$scrollRect:t.$maskRect;return a.isEmpty()?n:(t.$scrollRect&&(i-=a.x,r-=a.y),e.save(),e.beginPath(),e.rect(a.x+i,a.y+r,a.width,a.height),e.clip(),n+=this.drawDisplayObject(t,e,i,r),e.restore(),n)},n.prototype.drawNodeToBuffer=function(t,e,i,r){var n=e.context;n.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),this.renderNode(t,n,r)},n.prototype.drawDisplayToBuffer=function(t,e,i){var r=e.context;i&&r.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty);var n;n=t.$renderDirty?t.$getRenderNode():t.$renderNode;var a=0;if(n)switch(a++,n.type){case 1:this.renderBitmap(n,r);break;case 2:this.renderText(n,r);break;case 3:this.renderGraphics(n,r);break;case 4:this.renderGroup(n,r);break;case 5:this.renderMesh(n,r);break;case 6:this.renderNormalBitmap(n,r)}var o=t.$children;if(o)for(var s=o.length,h=0;s>h;h++){var c=o[h];switch(c.$renderMode){case 1:break;case 2:a+=this.drawWithFilter(c,r,0,0);break;case 3:a+=this.drawWithClip(c,r,0,0);break;case 4:a+=this.drawWithScrollRect(c,r,0,0);break;default:a+=this.drawDisplayObject(c,r,0,0)}}return a},n.prototype.renderNode=function(t,e,i){var r=0;switch(t.type){case 1:r=this.renderBitmap(t,e);break;case 2:r=1,this.renderText(t,e);break;case 3:r=this.renderGraphics(t,e,i);break;case 4:r=this.renderGroup(t,e);break;case 5:r=this.renderMesh(t,e);break;case 6:r+=this.renderNormalBitmap(t,e)}return r},n.prototype.renderNormalBitmap=function(t,e){var i=t.image;if(!i||!i.source)return 0;if(e.$imageSmoothingEnabled!=t.smoothing&&(e.imageSmoothingEnabled=t.smoothing,e.$imageSmoothingEnabled=t.smoothing),t.rotated){var r=t.sourceX,n=t.sourceY,a=t.sourceW,o=t.sourceH,s=t.drawX,h=t.drawY,c=t.drawW,l=t.drawH;e.save(),e.transform(0,-1,1,0,0,l),e.drawImage(i.source,r,n,o,a,s+e.$offsetX,h+e.$offsetY,l,c),e.restore()}else e.drawImage(i.source,t.sourceX,t.sourceY,t.sourceW,t.sourceH,t.drawX+e.$offsetX,t.drawY+e.$offsetY,t.drawW,t.drawH);return 1},n.prototype.renderBitmap=function(t,e){var i=t.image;if(!i||!i.source)return 0;e.$imageSmoothingEnabled!=t.smoothing&&(e.imageSmoothingEnabled=t.smoothing,e.$imageSmoothingEnabled=t.smoothing);var r,n,o=t.drawData,s=o.length,h=0,c=t.matrix,l=t.blendMode,u=t.alpha,p=!1;c&&(e.save(),p=!0,(0!=e.$offsetX||0!=e.$offsetY)&&(e.translate(e.$offsetX,e.$offsetY),r=e.$offsetX,n=e.$offsetY,e.$offsetX=e.$offsetY=0),e.transform(c.a,c.b,c.c,c.d,c.tx,c.ty)),l&&(e.globalCompositeOperation=$[l]);var d;u==u&&(d=e.globalAlpha,e.globalAlpha*=u);var f=0,g=t.filter;if(g&&8==s){var v=o[0],m=o[1],x=o[2],T=o[3],_=o[4],D=o[5],O=o[6],w=o[7];t.rotated&&(x=o[3],T=o[2],O=o[7],w=o[6]);var E=this.createRenderBuffer(O,w),C=E.context;f++,t.rotated&&e.transform(0,-1,1,0,0,O),C.drawImage(i.source,v,m,x,T,0,0,O,w),f++;var R=C.getImageData(0,0,O,w);a(R.data,O,w,g.$matrix),C.putImageData(R,0,0),e.drawImage(E.surface,0,0,O,w,_+e.$offsetX,D+e.$offsetY,O,w),b.push(E)}else for(;s>h;)if(f++,t.rotated){var v=o[h++],m=o[h++],T=o[h++],x=o[h++],S=o[h++],F=o[h++],w=o[h++],O=o[h++];e.save(),e.transform(0,-1,1,0,0,O),e.drawImage(i.source,v,m,x,T,S+e.$offsetX,F+e.$offsetY,O,w),e.restore()}else e.drawImage(i.source,o[h++],o[h++],o[h++],o[h++],o[h++]+e.$offsetX,o[h++]+e.$offsetY,o[h++],o[h++]);return p?e.restore():(l&&(e.globalCompositeOperation=y),u==u&&(e.globalAlpha=d)),r&&(e.$offsetX=r),n&&(e.$offsetY=n),f},n.prototype.renderMesh=function(t,e){var i,r,n=t.image,a=t.drawData,o=a.length,s=0,h=t.matrix,c=t.blendMode,l=t.alpha,u=!1,p=0;e.$imageSmoothingEnabled!=t.smoothing&&(e.imageSmoothingEnabled=t.smoothing,e.$imageSmoothingEnabled=t.smoothing),h&&(e.save(),u=!0,(0!=e.$offsetX||0!=e.$offsetY)&&(e.translate(e.$offsetX,e.$offsetY),i=e.$offsetX,r=e.$offsetY,e.$offsetX=e.$offsetY=0),e.transform(h.a,h.b,h.c,h.d,h.tx,h.ty)),c&&(e.globalCompositeOperation=$[c]);var d;for(l==l&&(d=e.globalAlpha,e.globalAlpha*=l);o>s;)p+=this.drawMesh(n,a[s++],a[s++],a[s++],a[s++],a[s++],a[s++],a[s++],a[s++],t.uvs,t.vertices,t.indices,t.bounds,t.rotated,e);return c&&(e.globalCompositeOperation=y),l==l&&(e.globalAlpha=d),i&&(e.$offsetX=i),r&&(e.$offsetY=r),u&&e.restore(),p},n.prototype.drawMesh=function(t,e,i,r,n,a,o,s,h,c,l,u,p,d,f){if(f&&t){var g=0,$=0/0,y=0/0,v=0/0,m=0/0,b=0/0,x=0/0,T=1,_=0,D=0,O=1,w=0,E=0,C=r,R=n,S=s,F=h;d&&(C=n,R=r,S=h,F=s);for(var P,M,j,A,B,N,k,L,I,U=u.length,H=0;U>H;H+=3){P=2*u[H],M=2*u[H+1],j=2*u[H+2],$=c[P]*r,m=c[P+1]*n,y=c[M]*r,b=c[M+1]*n,v=c[j]*r,x=c[j+1]*n,A=l[P],B=l[P+1],N=l[M],k=l[M+1],L=l[j],I=l[j+1],f.save(),f.beginPath(),f.moveTo(A,B),f.lineTo(N,k),f.lineTo(L,I),f.closePath(),f.clip();var X=1/($*b+m*v+y*x-b*v-m*y-$*x);T=A*b+m*L+N*x-b*L-m*N-A*x,_=B*b+m*I+k*x-b*I-m*k-B*x,D=$*N+A*v+y*L-N*v-A*y-$*L,O=$*k+B*v+y*I-k*v-B*y-$*I,w=$*b*L+m*N*v+A*y*x-A*b*v-m*y*L-$*N*x,E=$*b*I+m*k*v+B*y*x-B*b*v-m*y*I-$*k*x,f.transform(T*X,_*X,D*X,O*X,w*X,E*X),d&&f.transform(0,-1,1,0,0,S),f.drawImage(t.source,e,i,C,R,a+f.$offsetX,o+f.$offsetY,S,F),f.restore(),g++}return g}},n.prototype.renderText=function(i,r){r.textAlign="left",r.textBaseline="middle",r.lineJoin="round";for(var n=i.drawData,a=n.length,o=0;a>o;){var s=n[o++],h=n[o++],c=n[o++],l=n[o++];r.font=e(i,l);var u=null==l.textColor?i.textColor:l.textColor,p=null==l.strokeColor?i.strokeColor:l.strokeColor,d=null==l.stroke?i.stroke:l.stroke;r.fillStyle=t.toColorString(u),r.strokeStyle=t.toColorString(p),d&&(r.lineWidth=2*d,r.strokeText(c,s+r.$offsetX,h+r.$offsetY)),r.fillText(c,s+r.$offsetX,h+r.$offsetY)}},n.prototype.renderGraphics=function(t,e,n){var a=t.drawData,o=a.length;n=!!n;for(var s=0;o>s;s++){var h=a[s];switch(h.type){case 1:var c=h;e.fillStyle=n?v:i(c.fillColor,c.fillAlpha),this.renderPath(h,e),this.renderingMask?e.clip():e.fill();break;case 2:var l=h;e.fillStyle=n?v:r(e,l.gradientType,l.colors,l.alphas,l.ratios,l.matrix),e.save();var u=l.matrix;this.renderPath(h,e),e.transform(u.a,u.b,u.c,u.d,u.tx,u.ty),e.fill(),e.restore();break;case 3:var p=h,d=p.lineWidth;e.lineWidth=d,e.strokeStyle=n?v:i(p.lineColor,p.lineAlpha),e.lineCap=m[p.caps],e.lineJoin=p.joints,e.miterLimit=p.miterLimit,e.setLineDash&&e.setLineDash(p.lineDash);var f=1===d||3===d;f&&e.translate(.5,.5),this.renderPath(h,e),e.stroke(),f&&e.translate(-.5,-.5)}}return 0==o?0:1},n.prototype.renderPath=function(t,e){e.beginPath();for(var i=t.$data,r=t.$commands,n=r.length,a=0,o=0;n>o;o++){var s=r[o];switch(s){case 4:e.bezierCurveTo(i[a++]+e.$offsetX,i[a++]+e.$offsetY,i[a++]+e.$offsetX,i[a++]+e.$offsetY,i[a++]+e.$offsetX,i[a++]+e.$offsetY);break;case 3:e.quadraticCurveTo(i[a++]+e.$offsetX,i[a++]+e.$offsetY,i[a++]+e.$offsetX,i[a++]+e.$offsetY);break;case 2:e.lineTo(i[a++]+e.$offsetX,i[a++]+e.$offsetY);break;case 1:e.moveTo(i[a++]+e.$offsetX,i[a++]+e.$offsetY)}}},n.prototype.renderGroup=function(t,e){var i,r,n=t.matrix,a=!1;n&&(e.save(),a=!0,(0!=e.$offsetX||0!=e.$offsetY)&&(e.translate(e.$offsetX,e.$offsetY),i=e.$offsetX,r=e.$offsetY,e.$offsetX=e.$offsetY=0),e.transform(n.a,n.b,n.c,n.d,n.tx,n.ty));for(var o=0,s=t.drawData,h=s.length,c=0;h>c;c++){var l=s[c];o+=this.renderNode(l,e)}return a&&e.restore(),i&&(e.$offsetX=i),r&&(e.$offsetY=r),o},n.prototype.createRenderBuffer=function(e,i,r){var n=r?x.pop():b.pop();return n?n.resize(e,i,!0):n=new t.sys.CanvasRenderBuffer(e,i),n},n.prototype.renderClear=function(){},n}();t.CanvasRenderer=T,__reflect(T.prototype,"egret.CanvasRenderer"),t.getFontString=e,t.getRGBAString=i;var _=!1;try{_=void 0!==typeof Uint8ClampedArray}catch(D){}}(egret||(egret={}));var egret;!function(t){t.DeviceOrientation=null}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e;!function(t){t.WEB="web",t.NATIVE="native",t.RUNTIME2="runtime2",t.MYGAME="mygame",t.WXGAME="wxgame",t.BAIDUGAME="baidugame",t.QGAME="qgame",t.OPPOGAME="oppogame",t.QQGAME="qqgame",t.VIVOGAME="vivogame",t.QHGAME="qhgame",t.TTGAME="ttgame",t.FASTGAME="fastgame",t.TBCREATIVEAPP="tbcreativeapp"}(e=t.RuntimeType||(t.RuntimeType={}));var i=function(){function e(){}return Object.defineProperty(e,"supportedCompressedTexture",{get:function(){return this._supportedCompressedTexture&&void 0!=this._supportedCompressedTexture.pvrtc&&void 0!=this._supportedCompressedTexture?this._supportedCompressedTexture:(t.web?t.web.WebGLRenderContext.getInstance().getSupportedCompressedTexture():null,this._supportedCompressedTexture)},enumerable:!0,configurable:!0}),e.language="zh-CN",e.os="Unknown",e.runtimeType=t.RuntimeType.WEB,e.engineVersion="5.3.10",e.renderMode="Unknown",e.boundingClientWidth=0,e.boundingClientHeight=0,e._supportedCompressedTexture={},e}();t.Capabilities=i,__reflect(i.prototype,"egret.Capabilities")}(egret||(egret={}));var egret;!function(t){t.OrientationMode={AUTO:"auto",PORTRAIT:"portrait",LANDSCAPE:"landscape",LANDSCAPE_FLIPPED:"landscapeFlipped"}}(egret||(egret={}));var egret;!function(t){function e(t,e){r[t]=e}function i(t){return r[t]}var r={};t.registerImplementation=e,t.getImplementation=i}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;i.$renderBuffer=new t.sys.RenderBuffer;var r=new t.BitmapData(i.$renderBuffer.surface);return r.$deleteSource=!1,i._setBitmapData(r),i}return __extends(i,e),i.prototype.drawToTexture=function(e,i,r){if(void 0===r&&(r=1),i&&(0==i.width||0==i.height))return!1;var n=i||e.$getOriginalBounds();if(0==n.width||0==n.height)return!1;r/=t.$TextureScaleFactor;var a=(n.x+n.width)*r,o=(n.y+n.height)*r;i&&(a=n.width*r,o=n.height*r);var s=this.$renderBuffer;if(!s)return!1;if(s.resize(a,o),this.$bitmapData.width=a,this.$bitmapData.height=o,t.nativeRender){egret_native.activateBuffer(this.$renderBuffer);var h=!1,c=0,l=0,u=0,p=0;i&&(h=!0,c=i.x,l=i.y,u=i.width,p=i.height),egret_native.updateNativeRender(),egret_native.nrRenderDisplayObject(e.$nativeDisplayObject.id,r,h,c,l,u,p),egret_native.activateBuffer(null)}else{var d=t.Matrix.create();d.identity(),d.scale(r,r),i&&d.translate(-i.x,-i.y),t.sys.systemRenderer.render(e,s,d,!0),t.Matrix.release(d)}return this.$initData(0,0,a,o,0,0,a,o,a,o),!0},i.prototype.getPixel32=function(e,i){var r;if(this.$renderBuffer){var n=t.$TextureScaleFactor;e=Math.round(e/n),i=Math.round(i/n),r=this.$renderBuffer.getPixels(e,i,1,1)}return r},i.prototype.dispose=function(){e.prototype.dispose.call(this),this.$renderBuffer=null},i}(t.Texture);t.RenderTexture=e,__reflect(e.prototype,"egret.RenderTexture")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i){var r=t.call(this,e)||this;return r.firstCharHeight=0,"string"==typeof i?r.charList=r.parseConfig(i):i&&i.hasOwnProperty("frames")?r.charList=i.frames:r.charList={},r}return __extends(e,t),e.prototype.getTexture=function(t){var e=this._textureMap[t];if(!e){var i=this.charList[t];if(!i)return null;e=this.createTexture(t,i.x,i.y,i.w,i.h,i.offX,i.offY,i.sourceW,i.sourceH),this._textureMap[t]=e}return e},e.prototype.getConfig=function(t,e){return this.charList[t]?this.charList[t][e]:0},e.prototype._getFirstCharHeight=function(){if(0==this.firstCharHeight)for(var t in this.charList){var e=this.charList[t];if(e){var i=e.sourceH;if(void 0===i){var r=e.h;void 0===r&&(r=0);var n=e.offY;void 0===n&&(n=0),i=r+n}if(0>=i)continue;this.firstCharHeight=i;break}}return this.firstCharHeight},e.prototype.parseConfig=function(t){t=t.split("\r\n").join("\n");for(var e=t.split("\n"),i=this.getConfigByKey(e[3],"count"),r={},n=4;4+i>n;n++){var a=e[n],o=String.fromCharCode(this.getConfigByKey(a,"id")),s={};r[o]=s,s.x=this.getConfigByKey(a,"x"),s.y=this.getConfigByKey(a,"y"),s.w=this.getConfigByKey(a,"width"),s.h=this.getConfigByKey(a,"height"),s.offX=this.getConfigByKey(a,"xoffset"),s.offY=this.getConfigByKey(a,"yoffset"),s.xadvance=this.getConfigByKey(a,"xadvance")}return r},e.prototype.getConfigByKey=function(t,e){for(var i=t.split(" "),r=0,n=i.length;n>r;r++){var a=i[r];if(e==a.substring(0,e.length)){var o=a.substring(e.length+1);return parseInt(o)}}return 0},e}(t.SpriteSheet);t.BitmapFont=e,__reflect(e.prototype,"egret.BitmapFont")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$smoothing=t.Bitmap.defaultSmoothing,i.$text="",i.$textFieldWidth=0/0,i.$textLinesChanged=!1,i.$textFieldHeight=0/0,i.$font=null,i.$fontStringChanged=!1,i.$lineSpacing=0,i.$letterSpacing=0,i.$textAlign=t.HorizontalAlign.LEFT,i.$verticalAlign=t.VerticalAlign.TOP,i.$textWidth=0/0,i.$textHeight=0/0,i.$textOffsetX=0,i.$textOffsetY=0,i.$textStartX=0,i.$textStartY=0,i.textLines=[],i.$lineHeights=[],t.nativeRender||(i.$renderNode=new t.sys.BitmapNode),i}return __extends(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(11)},Object.defineProperty(i.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(e){var i=this;if(e!=i.$smoothing&&(i.$smoothing=e,!t.nativeRender)){var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"text",{get:function(){return this.$text},set:function(t){this.$setText(t)},enumerable:!0,configurable:!0}),i.prototype.$setText=function(t){t=null==t?"":String(t);var e=this;return t==e.$text?!1:(e.$text=t,e.$invalidateContentBounds(),!0)},i.prototype.$getWidth=function(){var t=this,e=t.$textFieldWidth;return isNaN(e)?t.$getContentBounds().width:e},i.prototype.$setWidth=function(t){var e=this;return 0>t||t==e.$textFieldWidth?!1:(e.$textFieldWidth=t,e.$invalidateContentBounds(),!0)},i.prototype.$invalidateContentBounds=function(){this.$renderDirty=!0,this.$textLinesChanged=!0,this.$updateRenderNode()},i.prototype.$getHeight=function(){var t=this,e=t.$textFieldHeight;return isNaN(e)?t.$getContentBounds().height:e},i.prototype.$setHeight=function(t){var e=this;return 0>t||t==e.$textFieldHeight?!1:(e.$textFieldHeight=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"font",{get:function(){return this.$font},set:function(t){this.$setFont(t)},enumerable:!0,configurable:!0}),i.prototype.$setFont=function(t){var e=this;return e.$font==t?!1:(e.$font=t,e.$fontStringChanged=!0,this.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"lineSpacing",{get:function(){return this.$lineSpacing},set:function(t){this.$setLineSpacing(t)},enumerable:!0,configurable:!0}),i.prototype.$setLineSpacing=function(t){var e=this;return e.$lineSpacing==t?!1:(e.$lineSpacing=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"letterSpacing",{get:function(){return this.$letterSpacing},set:function(t){this.$setLetterSpacing(t)},enumerable:!0,configurable:!0}),i.prototype.$setLetterSpacing=function(t){var e=this;return e.$letterSpacing==t?!1:(e.$letterSpacing=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"textAlign",{get:function(){return this.$textAlign},set:function(t){this.$setTextAlign(t)},enumerable:!0,configurable:!0}),i.prototype.$setTextAlign=function(t){var e=this;return e.$textAlign==t?!1:(e.$textAlign=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"verticalAlign",{get:function(){return this.$verticalAlign},set:function(t){this.$setVerticalAlign(t)},enumerable:!0,configurable:!0}),i.prototype.$setVerticalAlign=function(t){var e=this;return e.$verticalAlign==t?!1:(e.$verticalAlign=t,e.$invalidateContentBounds(),!0)},i.prototype.$updateRenderNode=function(){var e=this,r=this.$getTextLines(),n=r.length;if(0==n)return void(t.nativeRender&&e.$font&&(e.$nativeDisplayObject.setDataToBitmapNode(e.$nativeDisplayObject.id,e.$font.$texture,[]),e.$nativeDisplayObject.setWidth(0),e.$nativeDisplayObject.setHeight(0)));var a,o=[],s=this.$textLinesWidth,h=e.$font;t.nativeRender||(a=this.$renderNode,h.$texture&&(a.image=h.$texture.$bitmapData),a.smoothing=e.$smoothing);for(var c=h._getFirstCharHeight(),l=Math.ceil(c*i.EMPTY_FACTOR),u=!isNaN(e.$textFieldHeight),p=e.$textWidth,d=e.$textFieldWidth,f=e.$textFieldHeight,g=e.$textAlign,$=this.$textOffsetY+this.$textStartY,y=this.$lineHeights,v=0;n>v;v++){var m=y[v];if(u&&v>0&&$+m>f)break;var b=r[v],x=b.length,T=this.$textOffsetX;if(g!=t.HorizontalAlign.LEFT){var _=d>p?d:p;g==t.HorizontalAlign.RIGHT?T+=_-s[v]:g==t.HorizontalAlign.CENTER&&(T+=Math.floor((_-s[v])/2))}for(var D=0;x>D;D++){var O=b.charAt(D),w=h.getTexture(O);if(w){var E=w.$bitmapWidth,C=w.$bitmapHeight;t.nativeRender?o.push(w.$bitmapX,w.$bitmapY,E,C,T+w.$offsetX,$+w.$offsetY,w.$getScaleBitmapWidth(),w.$getScaleBitmapHeight(),w.$sourceWidth,w.$sourceHeight):(a.imageWidth=w.$sourceWidth,a.imageHeight=w.$sourceHeight,a.drawImage(w.$bitmapX,w.$bitmapY,E,C,T+w.$offsetX,$+w.$offsetY,w.$getScaleBitmapWidth(),w.$getScaleBitmapHeight())),T+=(h.getConfig(O,"xadvance")||w.$getTextureWidth())+e.$letterSpacing}else" "==O?T+=l:t.$warn(1046,O)}$+=m+e.$lineSpacing}if(t.nativeRender){e.$nativeDisplayObject.setDataToBitmapNode(e.$nativeDisplayObject.id,h.$texture,o);var R=e.$getContentBounds();e.$nativeDisplayObject.setWidth(R.width),e.$nativeDisplayObject.setHeight(R.height)}},i.prototype.$measureContentBounds=function(t){var e=this.$getTextLines();0==e.length?t.setEmpty():t.setTo(this.$textOffsetX+this.$textStartX,this.$textOffsetY+this.$textStartY,this.$textWidth-this.$textOffsetX,this.$textHeight-this.$textOffsetY)},Object.defineProperty(i.prototype,"textWidth",{get:function(){return this.$getTextLines(),this.$textWidth},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textHeight",{get:function(){return this.$getTextLines(),this.$textHeight},enumerable:!0,configurable:!0}),i.prototype.$getTextLines=function(){function e(t){return m&&n.length>0&&f>m?!1:(f+=c+u,s||h||(l-=p),n.push(t),o.push(c),a.push(l),d=Math.max(l,d),!0)}var r=this;if(!r.$textLinesChanged)return r.textLines;var n=[];r.textLines=n;var a=[];r.$textLinesWidth=a,r.$textLinesChanged=!1;var o=[];if(r.$lineHeights=o,!r.$text||!r.$font)return r.$textWidth=0,r.$textHeight=0,n;for(var s,h,c,l,u=r.$lineSpacing,p=r.$letterSpacing,d=0,f=0,g=0,$=0,y=!isNaN(r.$textFieldWidth),v=r.$textFieldWidth,m=r.$textFieldHeight,b=r.$font,x=b._getFirstCharHeight(),T=Math.ceil(x*i.EMPTY_FACTOR),_=r.$text,D=_.split(/(?:\r\n|\r|\n)/),O=D.length,w=!0,E=0;O>E;E++){var C=D[E],R=C.length;c=0,l=0,s=!0,h=!1;for(var S=0;R>S;S++){s||(l+=p);var F=C.charAt(S),P=void 0,M=void 0,j=0,A=0,B=b.getTexture(F);if(B)P=B.$getTextureWidth(),M=B.$getTextureHeight(),j=B.$offsetX,A=B.$offsetY;else{if(" "!=F){t.$warn(1046,F),s&&(s=!1);continue}P=T,M=x}if(s&&(s=!1),w&&(w=!1),y&&S>0&&l+P>v){if(!e(C.substring(0,S)))break;C=C.substring(S),R=C.length,S=0,l=S==R-1?P:b.getConfig(F,"xadvance")||P,c=M}else l+=S==R-1?P:b.getConfig(F,"xadvance")||P,c=Math.max(M,c)}if(m&&E>0&&f>m)break;if(h=!0,!e(C))break}f-=u,r.$textWidth=d,r.$textHeight=f,this.$textOffsetX=g,this.$textOffsetY=$,this.$textStartX=0,this.$textStartY=0;var N;return v>d&&(N=r.$textAlign,N==t.HorizontalAlign.RIGHT?this.$textStartX=v-d:N==t.HorizontalAlign.CENTER&&(this.$textStartX=Math.floor((v-d)/2))),m>f&&(N=r.$verticalAlign,N==t.VerticalAlign.BOTTOM?this.$textStartY=m-f:N==t.VerticalAlign.MIDDLE&&(this.$textStartY=Math.floor((m-f)/2))),n},i.EMPTY_FACTOR=.33,i}(t.DisplayObject);t.BitmapText=e,__reflect(e.prototype,"egret.BitmapText")}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t,e){console.error("empty sys.registerFontMapping = "+t+", "+e)}t.fontResourceCache={},t.registerFontMapping=e}(e=t.sys||(t.sys={}))}(egret||(egret={})),function(t){function e(e,i){t.sys.registerFontMapping(e,i)}t.registerFontMapping||(t.registerFontMapping=e)}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.LEFT="left",t.RIGHT="right",t.CENTER="center",t.JUSTIFY="justify",t.CONTENT_JUSTIFY="contentJustify",t}();t.HorizontalAlign=e,__reflect(e.prototype,"egret.HorizontalAlign")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){this.replaceArr=[],this.resutlArr=[],this.initReplaceArr()}return e.prototype.initReplaceArr=function(){this.replaceArr=[],this.replaceArr.push([/&lt;/g,"<"]),this.replaceArr.push([/&gt;/g,">"]),this.replaceArr.push([/&amp;/g,"&"]),this.replaceArr.push([/&quot;/g,'"']),this.replaceArr.push([/&apos;/g,"'"])},e.prototype.replaceSpecial=function(t){for(var e=0;e<this.replaceArr.length;e++){var i=this.replaceArr[e][0],r=this.replaceArr[e][1];t=t.replace(i,r)}return t},e.prototype.parse=function(e){this.stackArray=[],this.resutlArr=[];for(var i=0,r=e.length;r>i;){var n=e.indexOf("<",i);if(0>n)this.addToResultArr(e.substring(i)),i=r;else{this.addToResultArr(e.substring(i,n));var a=e.indexOf(">",n);-1==a?(t.$error(1038),a=n):"/"==e.charAt(n+1)?this.stackArray.pop():this.addToArray(e.substring(n+1,a)),i=a+1}}return this.resutlArr},e.prototype.parser=function(t){return this.parse(t)},e.prototype.addToResultArr=function(t){""!=t&&(t=this.replaceSpecial(t),this.stackArray.length>0?this.resutlArr.push({text:t,style:this.stackArray[this.stackArray.length-1]}):this.resutlArr.push({text:t}))},e.prototype.changeStringToObject=function(t){t=t.trim();var e={},i=[];if("i"==t.charAt(0)||"b"==t.charAt(0)||"u"==t.charAt(0))this.addProperty(e,t,"true");else if(i=t.match(/^(font|a)\s/)){t=t.substring(i[0].length).trim();for(var r=0,n=void 0;n=t.match(this.getHeadReg());){var a=n[0],o="";t=t.substring(a.length).trim(),'"'==t.charAt(0)?(r=t.indexOf('"',1),o=t.substring(1,r),r+=1):"'"==t.charAt(0)?(r=t.indexOf("'",1),o=t.substring(1,r),r+=1):(o=t.match(/(\S)+/)[0],r=o.length),this.addProperty(e,a.substring(0,a.length-1).trim(),o.trim()),t=t.substring(r).trim()}}return e},e.prototype.getHeadReg=function(){return/^(color|textcolor|strokecolor|stroke|b|bold|i|italic|u|size|fontfamily|href|target)(\s)*=/},e.prototype.addProperty=function(t,e,i){switch(e.toLowerCase()){case"color":case"textcolor":i=i.replace(/#/,"0x"),t.textColor=parseInt(i);break;case"strokecolor":i=i.replace(/#/,"0x"),t.strokeColor=parseInt(i);break;case"stroke":t.stroke=parseInt(i);break;case"b":case"bold":t.bold="true"==i;break;case"u":t.underline="true"==i;break;case"i":case"italic":t.italic="true"==i;break;case"size":t.size=parseInt(i);break;case"fontfamily":t.fontFamily=i;break;case"href":t.href=this.replaceSpecial(i);break;case"target":t.target=this.replaceSpecial(i)}},e.prototype.addToArray=function(t){var e=this.changeStringToObject(t);if(0==this.stackArray.length)this.stackArray.push(e);else{var i=this.stackArray[this.stackArray.length-1];for(var r in i)null==e[r]&&(e[r]=i[r]);this.stackArray.push(e)}},e}();t.HtmlTextParser=e,__reflect(e.prototype,"egret.HtmlTextParser")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.stageTextAdded=!1,t._text=null,t._isFocus=!1,t}return __extends(i,e),i.prototype.init=function(e){this._text=e,this.stageText=new t.StageText,this.stageText.$setTextField(this._text)},i.prototype._addStageText=function(){this.stageTextAdded||(this._text.$inputEnabled||(this._text.$touchEnabled=!0),this.tempStage=this._text.stage,this.stageText.$addToStage(),this.stageText.addEventListener("updateText",this.updateTextHandler,this),this._text.addEventListener(t.TouchEvent.TOUCH_BEGIN,this.onMouseDownHandler,this),this._text.addEventListener(t.TouchEvent.TOUCH_MOVE,this.onMouseMoveHandler,this),this.stageText.addEventListener("blur",this.blurHandler,this),this.stageText.addEventListener("focus",this.focusHandler,this),this.stageTextAdded=!0)},i.prototype._removeStageText=function(){this.stageTextAdded&&(this._text.$inputEnabled||(this._text.$touchEnabled=!1),this.stageText.$removeFromStage(),this.stageText.removeEventListener("updateText",this.updateTextHandler,this),this._text.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onMouseDownHandler,this),this._text.addEventListener(t.TouchEvent.TOUCH_MOVE,this.onMouseMoveHandler,this),this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),this.stageText.removeEventListener("blur",this.blurHandler,this),this.stageText.removeEventListener("focus",this.focusHandler,this),this.stageTextAdded=!1)},i.prototype._getText=function(){return this.stageText.$getText()},i.prototype._setText=function(t){this.stageText.$setText(t)},i.prototype._setColor=function(t){this.stageText.$setColor(t)},i.prototype.focusHandler=function(e){this._isFocus||(this._isFocus=!0,e.showing||this._text.$setIsTyping(!0),this._text.dispatchEvent(new t.FocusEvent(t.FocusEvent.FOCUS_IN,!0)))},i.prototype.blurHandler=function(e){this._isFocus&&(this._isFocus=!1,this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),this._text.$setIsTyping(!1),this.stageText.$onBlur(),this._text.dispatchEvent(new t.FocusEvent(t.FocusEvent.FOCUS_OUT,!0)))},i.prototype.onMouseDownHandler=function(t){this.$onFocus()},i.prototype.onMouseMoveHandler=function(t){this.stageText.$hide()},i.prototype.$onFocus=function(e){var i=this;void 0===e&&(e=!1),this._text.visible&&(this._isFocus||(this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),t.callLater(function(){i.tempStage.addEventListener(t.TouchEvent.TOUCH_BEGIN,i.onStageDownHandler,i)
},this),t.nativeRender&&this.stageText.$setText(this._text.$TextField[13]),this.stageText.$show(e)))},i.prototype.onStageDownHandler=function(t){t.$target!=this._text&&this.stageText.$hide()},i.prototype.updateTextHandler=function(e){var i,r,n=this._text.$TextField,a=this.stageText.$getText(),o=!1;null!=n[35]&&(i=new RegExp("["+n[35]+"]","g"),r=a.match(i),a=r?r.join(""):"",o=!0),null!=n[36]&&(i=new RegExp("[^"+n[36]+"]","g"),r=a.match(i),a=r?r.join(""):"",o=!0),o&&this.stageText.$getText()!=a&&this.stageText.$setText(a),this.resetText(),this._text.dispatchEvent(new t.Event(t.Event.CHANGE,!0))},i.prototype.resetText=function(){this._text.$setBaseText(this.stageText.$getText())},i.prototype._hideInput=function(){this.stageText.$removeFromStage()},i.prototype.updateInput=function(){!this._text.$visible&&this.stageText&&this._hideInput()},i.prototype._updateProperties=function(){return this._isFocus?(this.stageText.$resetStageText(),void this.updateInput()):(this.stageText.$setText(this._text.$TextField[13]),this.stageText.$resetStageText(),void this.updateInput())},i}(t.HashObject);t.InputController=e,__reflect(e.prototype,"egret.InputController")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){function e(e,i,n){n=n||{};var a=null==n.italic?i[16]:n.italic,o=null==n.bold?i[15]:n.bold,s=null==n.size?i[0]:n.size,h=n.fontFamily||i[8]||r.default_fontFamily;return t.sys.measureText(e,h,s,o,a)}var i=new RegExp("(?=[\\u00BF-\\u1FFF\\u2C00-\\uD7FF]|\\b|\\s)(?![)}\\.\\,\\!\\?\\]\\:])"),r=function(r){function n(){var e=r.call(this)||this;e.$inputEnabled=!1,e.inputUtils=null,e.$graphicsNode=null,e.isFlow=!1,e.textArr=[],e.linesArr=[],e.$isTyping=!1;var i=new t.sys.TextNode;return i.fontFamily=n.default_fontFamily,e.textNode=i,e.$renderNode=i,e.$TextField={0:n.default_size,1:0,2:n.default_textColor,3:0/0,4:0/0,5:0,6:0,7:0,8:n.default_fontFamily,9:"left",10:"top",11:"#ffffff",12:"",13:"",14:[],15:!1,16:!1,17:!0,18:!1,19:!1,20:!1,21:0,22:0,23:0,24:t.TextFieldType.DYNAMIC,25:0,26:"#000000",27:0,28:-1,29:0,30:!1,31:!1,32:0,33:!1,34:16777215,35:null,36:null,37:t.TextFieldInputType.TEXT,38:!1},t.nativeRender&&(e.$nativeDisplayObject.setFontFamily(n.default_fontFamily),e.$nativeDisplayObject.setFontSize(n.default_size)),e}return __extends(n,r),n.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(7)},n.prototype.isInput=function(){return this.$TextField[24]==t.TextFieldType.INPUT},n.prototype.$setTouchEnabled=function(t){r.prototype.$setTouchEnabled.call(this,t),this.isInput()&&(this.$inputEnabled=!0)},Object.defineProperty(n.prototype,"fontFamily",{get:function(){return this.$TextField[8]},set:function(t){this.$setFontFamily(t)},enumerable:!0,configurable:!0}),n.prototype.$setFontFamily=function(e){var i=this.$TextField;return i[8]==e?!1:(i[8]=e,this.invalidateFontString(),t.nativeRender&&this.$nativeDisplayObject.setFontFamily(e),!0)},Object.defineProperty(n.prototype,"size",{get:function(){return this.$TextField[0]},set:function(t){this.$setSize(t)},enumerable:!0,configurable:!0}),n.prototype.$setSize=function(e){var i=this.$TextField;return i[0]==e?!1:(i[0]=e,this.invalidateFontString(),t.nativeRender&&this.$nativeDisplayObject.setFontSize(e),!0)},Object.defineProperty(n.prototype,"bold",{get:function(){return this.$TextField[15]},set:function(t){this.$setBold(t)},enumerable:!0,configurable:!0}),n.prototype.$setBold=function(e){var i=this.$TextField;return e==i[15]?!1:(i[15]=e,this.invalidateFontString(),t.nativeRender&&this.$nativeDisplayObject.setBold(e),!0)},Object.defineProperty(n.prototype,"italic",{get:function(){return this.$TextField[16]},set:function(t){this.$setItalic(t)},enumerable:!0,configurable:!0}),n.prototype.$setItalic=function(e){var i=this.$TextField;return e==i[16]?!1:(i[16]=e,this.invalidateFontString(),t.nativeRender&&this.$nativeDisplayObject.setItalic(e),!0)},n.prototype.invalidateFontString=function(){this.$TextField[17]=!0,this.$invalidateTextField()},Object.defineProperty(n.prototype,"textAlign",{get:function(){return this.$TextField[9]},set:function(t){this.$setTextAlign(t)},enumerable:!0,configurable:!0}),n.prototype.$setTextAlign=function(e){var i=this.$TextField;return i[9]==e?!1:(i[9]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setTextAlign(e),!0)},Object.defineProperty(n.prototype,"verticalAlign",{get:function(){return this.$TextField[10]},set:function(t){this.$setVerticalAlign(t)},enumerable:!0,configurable:!0}),n.prototype.$setVerticalAlign=function(e){var i=this.$TextField;return i[10]==e?!1:(i[10]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setVerticalAlign(e),!0)},Object.defineProperty(n.prototype,"lineSpacing",{get:function(){return this.$TextField[1]},set:function(t){this.$setLineSpacing(t)},enumerable:!0,configurable:!0}),n.prototype.$setLineSpacing=function(e){var i=this.$TextField;return i[1]==e?!1:(i[1]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setLineSpacing(e),!0)},Object.defineProperty(n.prototype,"textColor",{get:function(){return this.$TextField[2]},set:function(t){this.$setTextColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setTextColor=function(e){var i=this.$TextField;return i[2]==e?!1:(i[2]=e,this.inputUtils&&this.inputUtils._setColor(this.$TextField[2]),this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setTextColor(e),!0)},Object.defineProperty(n.prototype,"wordWrap",{get:function(){return this.$TextField[19]},set:function(t){this.$setWordWrap(t)},enumerable:!0,configurable:!0}),n.prototype.$setWordWrap=function(e){var i=this.$TextField;e!=i[19]&&(i[20]||(i[19]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setWordWrap(e)))},Object.defineProperty(n.prototype,"type",{get:function(){return this.$TextField[24]},set:function(t){this.$setType(t)},enumerable:!0,configurable:!0}),n.prototype.$setType=function(e){var i=this.$TextField;return i[24]!=e?(i[24]=e,t.nativeRender&&this.$nativeDisplayObject.setType(e),e==t.TextFieldType.INPUT?(isNaN(i[3])&&this.$setWidth(100),isNaN(i[4])&&this.$setHeight(30),this.$setTouchEnabled(!0),null==this.inputUtils&&(this.inputUtils=new t.InputController),this.inputUtils.init(this),this.$invalidateTextField(),this.$stage&&this.inputUtils._addStageText()):(this.inputUtils&&(this.inputUtils._removeStageText(),this.inputUtils=null),this.$setTouchEnabled(!1)),!0):!1},Object.defineProperty(n.prototype,"inputType",{get:function(){return this.$TextField[37]},set:function(e){this.$TextField[37]!=e&&(this.$TextField[37]=e,t.nativeRender&&this.$nativeDisplayObject.setInputType(e))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this.$getText()},set:function(t){this.$setText(t)},enumerable:!0,configurable:!0}),n.prototype.$getText=function(){return this.$TextField[24]==t.TextFieldType.INPUT?this.inputUtils._getText():this.$TextField[13]},n.prototype.$setBaseText=function(e){e=null==e?"":e.toString(),this.isFlow=!1;var i=this.$TextField;if(i[13]!=e){this.$invalidateTextField(),i[13]=e;var r="";return r=i[20]?this.changeToPassText(e):e,t.nativeRender&&this.$nativeDisplayObject.setText(r),this.setMiddleStyle([{text:r}]),!0}return!1},n.prototype.$setText=function(t){null==t&&(t="");var e=this.$setBaseText(t);return this.inputUtils&&this.inputUtils._setText(this.$TextField[13]),e},Object.defineProperty(n.prototype,"displayAsPassword",{get:function(){return this.$TextField[20]},set:function(t){this.$setDisplayAsPassword(t)},enumerable:!0,configurable:!0}),n.prototype.$setDisplayAsPassword=function(e){var i=this.$TextField;if(i[20]!=e){i[20]=e,this.$invalidateTextField();var r="";return r=e?this.changeToPassText(i[13]):i[13],t.nativeRender&&this.$nativeDisplayObject.setText(r),this.setMiddleStyle([{text:r}]),!0}return!1},Object.defineProperty(n.prototype,"strokeColor",{get:function(){return this.$TextField[25]},set:function(t){this.$setStrokeColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setStrokeColor=function(e){var i=this.$TextField;return i[25]!=e?(this.$invalidateTextField(),i[25]=e,t.nativeRender&&this.$nativeDisplayObject.setStrokeColor(e),i[26]=t.toColorString(e),!0):!1},Object.defineProperty(n.prototype,"stroke",{get:function(){return this.$TextField[27]},set:function(t){this.$setStroke(t)},enumerable:!0,configurable:!0}),n.prototype.$setStroke=function(e){return this.$TextField[27]!=e?(this.$invalidateTextField(),this.$TextField[27]=e,t.nativeRender&&this.$nativeDisplayObject.setStroke(e),!0):!1},Object.defineProperty(n.prototype,"maxChars",{get:function(){return this.$TextField[21]},set:function(t){this.$setMaxChars(t)},enumerable:!0,configurable:!0}),n.prototype.$setMaxChars=function(e){return this.$TextField[21]!=e?(this.$TextField[21]=e,t.nativeRender&&this.$nativeDisplayObject.setMaxChars(e),!0):!1},Object.defineProperty(n.prototype,"scrollV",{get:function(){return Math.min(Math.max(this.$TextField[28],1),this.maxScrollV)},set:function(e){e=Math.max(e,1),e!=this.$TextField[28]&&(this.$TextField[28]=e,t.nativeRender&&this.$nativeDisplayObject.setScrollV(e),this.$invalidateTextField())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxScrollV",{get:function(){return this.$getLinesArr(),Math.max(this.$TextField[29]-t.TextFieldUtils.$getScrollNum(this)+1,1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionBeginIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionEndIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"caretIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),n.prototype.$setSelection=function(t,e){return!1},n.prototype.$getLineHeight=function(){return this.$TextField[1]+this.$TextField[0]},Object.defineProperty(n.prototype,"numLines",{get:function(){return this.$getLinesArr(),this.$TextField[29]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"multiline",{get:function(){return this.$TextField[30]},set:function(t){this.$setMultiline(t)},enumerable:!0,configurable:!0}),n.prototype.$setMultiline=function(e){return this.$TextField[30]==e?!1:(this.$TextField[30]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setMultiline(e),!0)},Object.defineProperty(n.prototype,"restrict",{get:function(){var t=this.$TextField,e=null;return null!=t[35]&&(e=t[35]),null!=t[36]&&(null==e&&(e=""),e+="^"+t[36]),e},set:function(t){var e=this.$TextField;if(null==t)e[35]=null,e[36]=null;else{for(var i=-1;i<t.length&&(i=t.indexOf("^",i),0!=i)&&i>0&&"\\"==t.charAt(i-1);)i++;0==i?(e[35]=null,e[36]=t.substring(i+1)):i>0?(e[35]=t.substring(0,i),e[36]=t.substring(i+1)):(e[35]=t,e[36]=null)}},enumerable:!0,configurable:!0}),n.prototype.$setWidth=function(e){t.nativeRender&&this.$nativeDisplayObject.setTextFieldWidth(e);var i=this.$TextField;if(isNaN(e)){if(isNaN(i[3]))return!1;i[3]=0/0}else{if(i[3]==e)return!1;i[3]=e}return e=+e,0>e?!1:(this.$invalidateTextField(),!0)},n.prototype.$setHeight=function(e){t.nativeRender&&this.$nativeDisplayObject.setTextFieldHeight(e);var i=this.$TextField;if(isNaN(e)){if(isNaN(i[4]))return!1;i[4]=0/0}else{if(i[4]==e)return!1;i[4]=e}return e=+e,0>e?!1:(this.$invalidateTextField(),!0)},n.prototype.$getWidth=function(){var t=this.$TextField;return isNaN(t[3])?this.$getContentBounds().width:t[3]},n.prototype.$getHeight=function(){var t=this.$TextField;return isNaN(t[4])?this.$getContentBounds().height:t[4]},Object.defineProperty(n.prototype,"border",{get:function(){return this.$TextField[31]},set:function(t){this.$setBorder(t)},enumerable:!0,configurable:!0}),n.prototype.$setBorder=function(e){e=!!e,this.$TextField[31]!=e&&(this.$TextField[31]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setBorder(e))},Object.defineProperty(n.prototype,"borderColor",{get:function(){return this.$TextField[32]},set:function(t){this.$setBorderColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setBorderColor=function(e){e=+e||0,this.$TextField[32]!=e&&(this.$TextField[32]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setBorderColor(e))},Object.defineProperty(n.prototype,"background",{get:function(){return this.$TextField[33]},set:function(t){this.$setBackground(t)},enumerable:!0,configurable:!0}),n.prototype.$setBackground=function(e){this.$TextField[33]!=e&&(this.$TextField[33]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setBackground(e))},Object.defineProperty(n.prototype,"backgroundColor",{get:function(){return this.$TextField[34]},set:function(t){this.$setBackgroundColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setBackgroundColor=function(e){this.$TextField[34]!=e&&(this.$TextField[34]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setBackgroundColor(e))},n.prototype.fillBackground=function(e){var i=this.$graphicsNode;i&&i.clear();var r=this.$TextField;if(r[33]||r[31]||e&&e.length>0){if(!i)if(i=this.$graphicsNode=new t.sys.GraphicsNode,t.nativeRender)this.$renderNode=this.textNode;else{var n=new t.sys.GroupNode;n.addNode(i),n.addNode(this.textNode),this.$renderNode=n}var a=void 0,o=void 0;if(r[33]&&(a=i.beginFill(r[34]),a.drawRect(0,0,this.$getWidth(),this.$getHeight())),r[31]&&(o=i.lineStyle(1,r[32]),o.drawRect(0,0,this.$getWidth()-1,this.$getHeight()-1)),e&&e.length>0)for(var s=r[2],h=-1,c=e.length,l=0;c>l;l+=4){var u=e[l],p=e[l+1],d=e[l+2],f=e[l+3]||s;(0>h||h!=f)&&(h=f,o=i.lineStyle(2,f,1,t.CapsStyle.NONE)),o.moveTo(u,p),o.lineTo(u+d,p)}}if(i){var g=this.$getRenderBounds();i.x=g.x,i.y=g.y,i.width=g.width,i.height=g.height,t.Rectangle.release(g)}},n.prototype.setFocus=function(){this.type==t.TextFieldType.INPUT&&this.$stage&&this.inputUtils.$onFocus(!0)},n.prototype.$onRemoveFromStage=function(){r.prototype.$onRemoveFromStage.call(this),this.removeEvent(),this.$TextField[24]==t.TextFieldType.INPUT&&this.inputUtils._removeStageText(),this.textNode&&(this.textNode.clean(),t.nativeRender&&egret_native.NativeDisplayObject.disposeTextData(this))},n.prototype.$onAddToStage=function(e,i){r.prototype.$onAddToStage.call(this,e,i),this.addEvent(),this.$TextField[24]==t.TextFieldType.INPUT&&this.inputUtils._addStageText()},n.prototype.$invalidateTextField=function(){var e=this;if(e.$renderDirty=!0,e.$TextField[18]=!0,e.$TextField[38]=!0,t.nativeRender);else{var i=e.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var r=e.$maskedObject;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())}},n.prototype.$getRenderBounds=function(){var e=this.$getContentBounds(),i=t.Rectangle.create();i.copyFrom(e),this.$TextField[31]&&(i.width+=2,i.height+=2);var r=2*this.$TextField[27];return r>0&&(i.width+=2*r,i.height+=2*r),i.x-=r+2,i.y-=r+2,i.width=Math.ceil(i.width)+4,i.height=Math.ceil(i.height)+4,i},n.prototype.$measureContentBounds=function(e){this.$getLinesArr();var i=0,r=0;t.nativeRender?(i=egret_native.nrGetTextFieldWidth(this.$nativeDisplayObject.id),r=egret_native.nrGetTextFieldHeight(this.$nativeDisplayObject.id)):(i=isNaN(this.$TextField[3])?this.$TextField[5]:this.$TextField[3],r=isNaN(this.$TextField[4])?t.TextFieldUtils.$getTextHeight(this):this.$TextField[4]),e.setTo(0,0,i,r)},n.prototype.$updateRenderNode=function(){if(this.$TextField[24]==t.TextFieldType.INPUT){if(this.inputUtils._updateProperties(),this.$isTyping)return void this.fillBackground()}else if(0==this.$TextField[3]){var e=this.$graphicsNode;return void(e&&e.clear())}var i=this.drawText();this.fillBackground(i);var r=this.$getRenderBounds(),n=this.textNode;n.x=r.x,n.y=r.y,n.width=Math.ceil(r.width),n.height=Math.ceil(r.height),t.Rectangle.release(r)},Object.defineProperty(n.prototype,"textFlow",{get:function(){return this.textArr},set:function(e){this.isFlow=!0;var i="";null==e&&(e=[]);for(var r=0;r<e.length;r++){var n=e[r];i+=n.text}this.$TextField[20]?this.$setBaseText(i):(this.$TextField[13]=i,this.setMiddleStyle(e),t.nativeRender&&this.$nativeDisplayObject.setTextFlow(e))},enumerable:!0,configurable:!0}),n.prototype.changeToPassText=function(t){if(this.$TextField[20]){for(var e="",i=0,r=t.length;r>i;i++)switch(t.charAt(i)){case"\n":e+="\n";break;case"\r":break;default:e+="*"}return e}return t},n.prototype.setMiddleStyle=function(t){this.$TextField[18]=!0,this.$TextField[38]=!0,this.textArr=t,this.$invalidateTextField()},Object.defineProperty(n.prototype,"textWidth",{get:function(){return this.$getLinesArr(),t.nativeRender?egret_native.nrGetTextWidth(this.$nativeDisplayObject.id):this.$TextField[5]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textHeight",{get:function(){return this.$getLinesArr(),t.nativeRender?egret_native.nrGetTextHeight(this.$nativeDisplayObject.id):t.TextFieldUtils.$getTextHeight(this)},enumerable:!0,configurable:!0}),n.prototype.appendText=function(t){this.appendElement({text:t})},n.prototype.appendElement=function(e){var i=this.$TextField[13]+e.text;return t.nativeRender?(this.textArr.push(e),this.$TextField[13]=i,this.$TextField[18]=!0,this.$TextField[38]=!0,void this.$nativeDisplayObject.setTextFlow(this.textArr)):void(this.$TextField[20]?this.$setBaseText(i):(this.$TextField[13]=i,this.textArr.push(e),this.setMiddleStyle(this.textArr)))},n.prototype.$getLinesArr=function(){var e=this.$TextField;return t.nativeRender&&e[38]?(egret_native.updateNativeRender(),void(e[38]=!1)):this.$getLinesArr2()},n.prototype.$getLinesArr2=function(){var r=this.$TextField;if(!r[18])return this.linesArr;r[18]=!1;var n=this.textArr;this.linesArr.length=0,r[6]=0,r[5]=0;var a=r[3];if(!isNaN(a)&&0==a)return r[29]=0,[{width:0,height:0,charNum:0,elements:[],hasNextLine:!1}];for(var o,s=this.linesArr,h=0,c=0,l=0,u=0,p=0,d=n.length;d>p;p++){var f=n[p];if(f.text){f.style=f.style||{};for(var g=f.text.toString(),$=g.split(/(?:\r\n|\r|\n)/),y=0,v=$.length;v>y;y++){null==s[u]&&(o={width:0,height:0,elements:[],charNum:0,hasNextLine:!1},s[u]=o,h=0,l=0,c=0),l=r[24]==t.TextFieldType.INPUT?r[0]:Math.max(l,f.style.size||r[0]);var m=!0;if(""==$[y])y==v-1&&(m=!1);else{var b=e($[y],r,f.style);if(isNaN(a))h+=b,c+=$[y].length,o.elements.push({width:b,text:$[y],style:f.style}),y==v-1&&(m=!1);else if(a>=h+b)o.elements.push({width:b,text:$[y],style:f.style}),h+=b,c+=$[y].length,y==v-1&&(m=!1);else{var x=0,T=0,_=$[y],D=void 0;D=r[19]?_.split(i):_.match(/./g);for(var O=D.length,w=0;O>x;x++){var E=D[x].length,C=!1;if(1==E&&O-1>x){var R=D[x].charCodeAt(0),S=D[x+1].charCodeAt(0);if(R>=55296&&56319>=R&&56320==(64512&S)){var F=D[x]+D[x+1];E=2,C=!0,b=e(F,r,f.style)}else b=e(D[x],r,f.style)}else b=e(D[x],r,f.style);if(0!=h&&h+b>a&&h+x!=0)break;if(T+b>a)for(var P=D[x].match(/./g),M=0,j=P.length;j>M;M++){var E=P[M].length,A=!1;if(1==E&&j-1>M){var R=P[M].charCodeAt(0),S=P[M+1].charCodeAt(0);if(R>=55296&&56319>=R&&56320==(64512&S)){var F=P[M]+P[M+1];E=2,A=!0,b=e(F,r,f.style)}else b=e(P[M],r,f.style)}else b=e(P[M],r,f.style);if(M>0&&h+b>a)break;w+=E,T+=b,h+=b,c+=w,A&&M++}else w+=E,T+=b,h+=b,c+=w;C&&x++}if(x>0){o.elements.push({width:T,text:_.substring(0,w),style:f.style});var B=_.substring(w),N=void 0,k=B.length;for(N=0;k>N&&" "==B.charAt(N);N++);$[y]=B.substring(N)}""!=$[y]&&(y--,m=!1)}}m&&(c++,o.hasNextLine=!0),y<$.length-1&&(o.width=h,o.height=l,o.charNum=c,r[5]=Math.max(r[5],h),r[6]+=l,u++)}p==n.length-1&&o&&(o.width=h,o.height=l,o.charNum=c,r[5]=Math.max(r[5],h),r[6]+=l)}else o&&(o.width=h,o.height=l,o.charNum=c,r[5]=Math.max(r[5],h),r[6]+=l)}return r[29]=s.length,s},n.prototype.$setIsTyping=function(e){this.$isTyping=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setIsTyping(e)},n.prototype.drawText=function(){var e=this.textNode,i=this.$TextField;e.bold=i[15],e.fontFamily=i[8]||n.default_fontFamily,e.italic=i[16],e.size=i[0],e.stroke=i[27],e.strokeColor=i[25],e.textColor=i[2];var r=this.$getLinesArr();if(0==i[5])return[];var a=isNaN(i[3])?i[5]:i[3],o=t.TextFieldUtils.$getTextHeight(this),s=0,h=t.TextFieldUtils.$getStartLine(this),c=i[4];if(!isNaN(c)&&c>o){var l=t.TextFieldUtils.$getValign(this);s+=l*(c-o)}s=Math.round(s);for(var u=t.TextFieldUtils.$getHalign(this),p=0,d=[],f=h,g=i[29];g>f;f++){var $=r[f],y=$.height;if(s+=y/2,f!=h){if(i[24]==t.TextFieldType.INPUT&&!i[30])break;if(!isNaN(c)&&s>c)break}p=Math.round((a-$.width)*u);for(var v=0,m=$.elements.length;m>v;v++){var b=$.elements[v],x=b.style.size||i[0];e.drawText(p,s+(y-x)/2,b.text,b.style),b.style.underline&&d.push(p,s+y/2,b.width,b.style.textColor),p+=b.width}s+=y/2+i[1]}return d},n.prototype.addEvent=function(){this.addEventListener(t.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},n.prototype.removeEvent=function(){this.removeEventListener(t.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},n.prototype.onTapHandler=function(e){if(this.$TextField[24]!=t.TextFieldType.INPUT){var i=t.TextFieldUtils.$getTextElement(this,e.localX,e.localY);if(null!=i){var r=i.style;if(r&&r.href)if(r.href.match(/^event:/)){var n=r.href.match(/^event:/)[0];t.TextEvent.dispatchTextEvent(this,t.TextEvent.LINK,r.href.substring(n.length))}else open(r.href,r.target||"_blank")}}},n.default_fontFamily="Arial",n.default_size=30,n.default_textColor=16777215,n}(t.DisplayObject);t.TextField=r,__reflect(r.prototype,"egret.TextField")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.TEXT="text",t.TEL="tel",t.PASSWORD="password",t}();t.TextFieldInputType=e,__reflect(e.prototype,"egret.TextFieldInputType")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.DYNAMIC="dynamic",t.INPUT="input",t}();t.TextFieldType=e,__reflect(e.prototype,"egret.TextFieldType")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){}return e.$getStartLine=function(t){var i=t.$TextField,r=e.$getTextHeight(t),n=0,a=i[4];return isNaN(a)||(a>r||r>a&&(n=Math.max(i[28]-1,0),n=Math.min(i[29]-1,n)),i[30]||(n=Math.max(i[28]-1,0),i[29]>0&&(n=Math.min(i[29]-1,n)))),n},e.$getHalign=function(e){var i=e.$getLinesArr2(),r=0;return e.$TextField[9]==t.HorizontalAlign.CENTER?r=.5:e.$TextField[9]==t.HorizontalAlign.RIGHT&&(r=1),e.$TextField[24]==t.TextFieldType.INPUT&&!e.$TextField[30]&&i.length>1&&(r=0),r},e.$getTextHeight=function(e){var i=t.TextFieldType.INPUT!=e.$TextField[24]||e.$TextField[30]?e.$TextField[6]+(e.$TextField[29]-1)*e.$TextField[1]:e.$TextField[0];return i},e.$getValign=function(i){var r=e.$getTextHeight(i),n=i.$TextField[4];if(!isNaN(n)&&n>r){var a=0;return i.$TextField[10]==t.VerticalAlign.MIDDLE?a=.5:i.$TextField[10]==t.VerticalAlign.BOTTOM&&(a=1),a}return 0},e.$getTextElement=function(t,i,r){var n=e.$getHit(t,i,r),a=t.$getLinesArr2();return n&&a[n.lineIndex]&&a[n.lineIndex].elements[n.textElementIndex]?a[n.lineIndex].elements[n.textElementIndex]:null},e.$getHit=function(t,i,r){var n=t.$getLinesArr2();if(0==t.$TextField[3])return null;var a=0,o=e.$getTextHeight(t),s=0,h=t.$TextField[4];if(!isNaN(h)&&h>o){var c=e.$getValign(t);s=c*(h-o),0!=s&&(r-=s)}for(var l=e.$getStartLine(t),u=0,p=l;p<n.length;p++){var d=n[p];if(u+d.height>=r){r>u&&(a=p+1);break}if(u+=d.height,u+t.$TextField[1]>r)return null;u+=t.$TextField[1]}if(0==a)return null;var f=n[a-1],g=t.$TextField[3];isNaN(g)&&(g=t.textWidth);var $=e.$getHalign(t);i-=$*(g-f.width);for(var y=0,p=0;p<f.elements.length;p++){var v=f.elements[p];if(y+v.width<=i)y+=v.width;else if(i>y)return{lineIndex:a-1,textElementIndex:p}}return null},e.$getScrollNum=function(t){var e=1;if(t.$TextField[30]){var i=t.height,r=t.size,n=t.lineSpacing;e=Math.floor(i/(r+n));var a=i-(r+n)*e;a>r/2&&e++}return e},e}();t.TextFieldUtils=e,__reflect(e.prototype,"egret.TextFieldUtils")}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.TOP="top",t.BOTTOM="bottom",t.MIDDLE="middle",t.JUSTIFY="justify",t.CONTENT_JUSTIFY="contentJustify",t}();t.VerticalAlign=e,__reflect(e.prototype,"egret.VerticalAlign")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.encode=function(t){for(var e=new Uint8Array(t),i=e.length,r="",n=0;i>n;n+=3)r+=chars[e[n]>>2],r+=chars[(3&e[n])<<4|e[n+1]>>4],r+=chars[(15&e[n+1])<<2|e[n+2]>>6],r+=chars[63&e[n+2]];return i%3===2?r=r.substring(0,r.length-1)+"=":i%3===1&&(r=r.substring(0,r.length-2)+"=="),r},t.decode=function(t){var e=.75*t.length,i=t.length,r=0,n=0,a=0,o=0,s=0;"="===t[t.length-1]&&(e--,"="===t[t.length-2]&&e--);for(var h=new ArrayBuffer(e),c=new Uint8Array(h),l=0;i>l;l+=4)n=lookup[t.charCodeAt(l)],a=lookup[t.charCodeAt(l+1)],o=lookup[t.charCodeAt(l+2)],s=lookup[t.charCodeAt(l+3)],c[r++]=n<<2|a>>4,c[r++]=(15&a)<<4|o>>2,c[r++]=(3&o)<<6|63&s;return h},t}();t.Base64Util=e,__reflect(e.prototype,"egret.Base64Util")}(egret||(egret={}));for(var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=new Uint8Array(256),i=0;i<chars.length;i++)lookup[chars.charCodeAt(i)]=i;var egret;!function(t){var e=function(){function t(){}return t.LITTLE_ENDIAN="littleEndian",t.BIG_ENDIAN="bigEndian",t}();t.Endian=e,__reflect(e.prototype,"egret.Endian");var i=function(){function i(t,i){void 0===i&&(i=0),this.bufferExtSize=0,this.EOF_byte=-1,this.EOF_code_point=-1,0>i&&(i=0),this.bufferExtSize=i;var r,n=0;if(t){var a=void 0;if(t instanceof Uint8Array?(a=t,n=t.length):(n=t.byteLength,a=new Uint8Array(t)),0==i)r=new Uint8Array(n);else{var o=(n/i|0)+1;r=new Uint8Array(o*i)}r.set(a)}else r=new Uint8Array(i);this.write_position=n,this._position=0,this._bytes=r,this.data=new DataView(r.buffer),this.endian=e.BIG_ENDIAN}return Object.defineProperty(i.prototype,"endian",{get:function(){return 0==this.$endian?e.LITTLE_ENDIAN:e.BIG_ENDIAN},set:function(t){this.$endian=t==e.LITTLE_ENDIAN?0:1},enumerable:!0,configurable:!0}),i.prototype.setArrayBuffer=function(t){},Object.defineProperty(i.prototype,"readAvailable",{get:function(){return this.write_position-this._position},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"buffer",{get:function(){return this.data.buffer.slice(0,this.write_position)},set:function(t){var e,i=t.byteLength,r=new Uint8Array(t),n=this.bufferExtSize;if(0==n)e=new Uint8Array(i);else{var a=(i/n|0)+1;e=new Uint8Array(a*n)}e.set(r),this.write_position=i,this._bytes=e,this.data=new DataView(e.buffer)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rawBuffer",{get:function(){return this.data.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bytes",{get:function(){return this._bytes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dataView",{get:function(){return this.data},set:function(t){this.buffer=t.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bufferOffset",{get:function(){return this.data.byteOffset},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t,t>this.write_position&&(this.write_position=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){return this.write_position},set:function(t){this.write_position=t,this.data.byteLength>t&&(this._position=t),this._validateBuffer(t)},enumerable:!0,configurable:!0}),i.prototype._validateBuffer=function(t){if(this.data.byteLength<t){var e=this.bufferExtSize,i=void 0;if(0==e)i=new Uint8Array(t);else{var r=((t/e>>0)+1)*e;i=new Uint8Array(r)}i.set(this._bytes),this._bytes=i,this.data=new DataView(i.buffer)}},Object.defineProperty(i.prototype,"bytesAvailable",{get:function(){return this.data.byteLength-this._position},enumerable:!0,configurable:!0}),i.prototype.clear=function(){var t=new ArrayBuffer(this.bufferExtSize);this.data=new DataView(t),this._bytes=new Uint8Array(t),this._position=0,this.write_position=0},i.prototype.readBoolean=function(){return this.validate(1)?!!this._bytes[this.position++]:void 0},i.prototype.readByte=function(){return this.validate(1)?this.data.getInt8(this.position++):void 0},i.prototype.readBytes=function(e,i,r){if(void 0===i&&(i=0),void 0===r&&(r=0),e){var n=this._position,a=this.write_position-n;if(0>a)return void t.$error(1025);if(0==r)r=a;else if(r>a)return void t.$error(1025);var o=e._position;e._position=0,e.validateBuffer(i+r),e._position=o,e._bytes.set(this._bytes.subarray(n,n+r),i),this.position+=r}},i.prototype.readDouble=function(){if(this.validate(8)){var t=this.data.getFloat64(this._position,0==this.$endian);return this.position+=8,t}},i.prototype.readFloat=function(){if(this.validate(4)){var t=this.data.getFloat32(this._position,0==this.$endian);return this.position+=4,t}},i.prototype.readInt=function(){if(this.validate(4)){var t=this.data.getInt32(this._position,0==this.$endian);return this.position+=4,t}},i.prototype.readShort=function(){if(this.validate(2)){var t=this.data.getInt16(this._position,0==this.$endian);return this.position+=2,t}},i.prototype.readUnsignedByte=function(){return this.validate(1)?this._bytes[this.position++]:void 0},i.prototype.readUnsignedInt=function(){if(this.validate(4)){var t=this.data.getUint32(this._position,0==this.$endian);return this.position+=4,t}},i.prototype.readUnsignedShort=function(){if(this.validate(2)){var t=this.data.getUint16(this._position,0==this.$endian);return this.position+=2,t}},i.prototype.readUTF=function(){var t=this.readUnsignedShort();return t>0?this.readUTFBytes(t):""},i.prototype.readUTFBytes=function(t){if(this.validate(t)){var e=this.data,i=new Uint8Array(e.buffer,e.byteOffset+this._position,t);return this.position+=t,this.decodeUTF8(i)}},i.prototype.writeBoolean=function(t){this.validateBuffer(1),this._bytes[this.position++]=+t},i.prototype.writeByte=function(t){this.validateBuffer(1),this._bytes[this.position++]=255&t},i.prototype.writeBytes=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var r;0>e||0>i||(r=0==i?t.length-e:Math.min(t.length-e,i),r>0&&(this.validateBuffer(r),this._bytes.set(t._bytes.subarray(e,e+r),this._position),this.position=this._position+r))},i.prototype.writeDouble=function(t){this.validateBuffer(8),this.data.setFloat64(this._position,t,0==this.$endian),this.position+=8},i.prototype.writeFloat=function(t){this.validateBuffer(4),this.data.setFloat32(this._position,t,0==this.$endian),this.position+=4},i.prototype.writeInt=function(t){this.validateBuffer(4),this.data.setInt32(this._position,t,0==this.$endian),this.position+=4},i.prototype.writeShort=function(t){this.validateBuffer(2),this.data.setInt16(this._position,t,0==this.$endian),this.position+=2},i.prototype.writeUnsignedInt=function(t){this.validateBuffer(4),this.data.setUint32(this._position,t,0==this.$endian),this.position+=4},i.prototype.writeUnsignedShort=function(t){this.validateBuffer(2),this.data.setUint16(this._position,t,0==this.$endian),this.position+=2},i.prototype.writeUTF=function(t){var e=this.encodeUTF8(t),i=e.length;this.validateBuffer(2+i),this.data.setUint16(this._position,i,0==this.$endian),this.position+=2,this._writeUint8Array(e,!1)},i.prototype.writeUTFBytes=function(t){this._writeUint8Array(this.encodeUTF8(t))},i.prototype.toString=function(){return"[ByteArray] length:"+this.length+", bytesAvailable:"+this.bytesAvailable},i.prototype._writeUint8Array=function(t,e){void 0===e&&(e=!0);var i=this._position,r=i+t.length;e&&this.validateBuffer(r),this.bytes.set(t,i),this.position=r},i.prototype.validate=function(e){var i=this._bytes.length;return i>0&&this._position+e<=i?!0:void t.$error(1025)},i.prototype.validateBuffer=function(t){this.write_position=t>this.write_position?t:this.write_position,t+=this._position,this._validateBuffer(t)},i.prototype.encodeUTF8=function(t){for(var e=0,i=this.stringToCodePoints(t),r=[];i.length>e;){var n=i[e++];if(this.inRange(n,55296,57343))this.encoderError(n);else if(this.inRange(n,0,127))r.push(n);else{var a=void 0,o=void 0;for(this.inRange(n,128,2047)?(a=1,o=192):this.inRange(n,2048,65535)?(a=2,o=224):this.inRange(n,65536,1114111)&&(a=3,o=240),r.push(this.div(n,Math.pow(64,a))+o);a>0;){var s=this.div(n,Math.pow(64,a-1));
r.push(128+s%64),a-=1}}}return new Uint8Array(r)},i.prototype.decodeUTF8=function(t){for(var e,i=!1,r=0,n="",a=0,o=0,s=0,h=0;t.length>r;){var c=t[r++];if(c==this.EOF_byte)e=0!=o?this.decoderError(i):this.EOF_code_point;else if(0==o)this.inRange(c,0,127)?e=c:(this.inRange(c,194,223)?(o=1,h=128,a=c-192):this.inRange(c,224,239)?(o=2,h=2048,a=c-224):this.inRange(c,240,244)?(o=3,h=65536,a=c-240):this.decoderError(i),a*=Math.pow(64,o),e=null);else if(this.inRange(c,128,191))if(s+=1,a+=(c-128)*Math.pow(64,o-s),s!==o)e=null;else{var l=a,u=h;a=0,o=0,s=0,h=0,e=this.inRange(l,u,1114111)&&!this.inRange(l,55296,57343)?l:this.decoderError(i,c)}else a=0,o=0,s=0,h=0,r--,e=this.decoderError(i,c);null!==e&&e!==this.EOF_code_point&&(65535>=e?e>0&&(n+=String.fromCharCode(e)):(e-=65536,n+=String.fromCharCode(55296+(e>>10&1023)),n+=String.fromCharCode(56320+(1023&e))))}return n},i.prototype.encoderError=function(e){t.$error(1026,e)},i.prototype.decoderError=function(e,i){return e&&t.$error(1027),i||65533},i.prototype.inRange=function(t,e,i){return t>=e&&i>=t},i.prototype.div=function(t,e){return Math.floor(t/e)},i.prototype.stringToCodePoints=function(t){for(var e=[],i=0,r=t.length;i<t.length;){var n=t.charCodeAt(i);if(this.inRange(n,55296,57343))if(this.inRange(n,56320,57343))e.push(65533);else if(i==r-1)e.push(65533);else{var a=t.charCodeAt(i+1);if(this.inRange(a,56320,57343)){var o=1023&n,s=1023&a;i+=1,e.push(65536+(o<<10)+s)}else e.push(65533)}else e.push(n);i+=1}return e},i}();t.ByteArray=i,__reflect(i.prototype,"egret.ByteArray")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$graphics=new t.Graphics,i.$graphics.$setTarget(i),i}return __extends(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(8)},Object.defineProperty(i.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),i.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},i.prototype.$hitTest=function(t,i){var r=e.prototype.$hitTest.call(this,t,i);return r==this&&(r=this.$graphics.$hitTest(t,i)),r},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},i}(t.DisplayObject);t.Shape=e,__reflect(e.prototype,"egret.Shape")}(egret||(egret={}));var egret;!function(t){function e(t,e,i){var r=t.prototype;Object.defineProperty(r,"__class__",{value:e,enumerable:!1,writable:!0});var n=[e];i&&(n=n.concat(i));var a=r.__types__;if(r.__types__)for(var o=a.length,s=0;o>s;s++){var h=a[s];-1==n.indexOf(h)&&n.push(h)}Object.defineProperty(r,"__types__",{value:n,enumerable:!1,writable:!0})}t.registerClass=e}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$graphics=new t.Graphics,i.$graphics.$setTarget(i),i}return __extends(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(9)},Object.defineProperty(i.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),i.prototype.$hitTest=function(e,i){if(!this.$visible)return null;var r=this.$getInvertedConcatenatedMatrix(),n=r.a*e+r.c*i+r.tx,a=r.b*e+r.d*i+r.ty,o=this.$scrollRect?this.$scrollRect:this.$maskRect;if(o&&!o.contains(n,a))return null;if(this.$mask&&!this.$mask.$hitTest(e,i))return null;for(var s=this.$children,h=!1,c=null,l=s.length-1;l>=0;l--){var u=s[l];if(!u.$maskedObject&&(c=u.$hitTest(e,i))){if(h=!0,c.$touchEnabled)break;c=null}}return c?this.$touchChildren?c:this:h?this:(c=t.DisplayObject.prototype.$hitTest.call(this,e,i),c&&(c=this.$graphics.$hitTest(e,i)),c)},i.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},i}(t.DisplayObjectContainer);t.Sprite=e,__reflect(e.prototype,"egret.Sprite")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"logLevel",{set:function(t){},enumerable:!0,configurable:!0}),t.ALL="all",t.DEBUG="debug",t.INFO="info",t.WARN="warn",t.ERROR="error",t.OFF="off",t}();t.Logger=e,__reflect(e.prototype,"egret.Logger")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.isNumber=function(t){return"number"==typeof t&&!isNaN(t)},t.sin=function(e){var i=Math.floor(e),r=i+1,n=t.sinInt(i);if(i==e)return n;var a=t.sinInt(r);return(e-i)*a+(r-e)*n},t.sinInt=function(t){return t%=360,0>t&&(t+=360),egret_sin_map[t]},t.cos=function(e){var i=Math.floor(e),r=i+1,n=t.cosInt(i);if(i==e)return n;var a=t.cosInt(r);return(e-i)*a+(r-e)*n},t.cosInt=function(t){return t%=360,0>t&&(t+=360),egret_cos_map[t]},t.convertStringToHashCode=function(t){if(0===t.length)return 0;for(var e=0,i=0,r=t.length;r>i;++i){var n=t.charCodeAt(i);e=(e<<5)-e+n,e|=0}return e},t}();t.NumberUtils=e,__reflect(e.prototype,"egret.NumberUtils")}(egret||(egret={}));for(var egret_sin_map={},egret_cos_map={},DEG_TO_RAD=Math.PI/180,NumberUtils_i=0;360>NumberUtils_i;NumberUtils_i++)egret_sin_map[NumberUtils_i]=Math.sin(NumberUtils_i*DEG_TO_RAD),egret_cos_map[NumberUtils_i]=Math.cos(NumberUtils_i*DEG_TO_RAD);egret_sin_map[90]=1,egret_cos_map[90]=0,egret_sin_map[180]=0,egret_cos_map[180]=-1,egret_sin_map[270]=-1,egret_cos_map[270]=0,Function.prototype.bind||(Function.prototype.bind=function(t){"function"!=typeof this&&egret.$error(1029);var e=Array.prototype.slice.call(arguments,1),i=this,r=function(){},n=function(){return i.apply(this instanceof r&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,n.prototype=new r,n});var egret;!function(t){var e=function(e){function i(t,i){void 0===i&&(i=0);var r=e.call(this)||this;return r._delay=0,r._currentCount=0,r._running=!1,r.updateInterval=1e3,r.lastCount=1e3,r.lastTimeStamp=0,r.delay=t,r.repeatCount=0|+i,r}return __extends(i,e),Object.defineProperty(i.prototype,"delay",{get:function(){return this._delay},set:function(t){1>t&&(t=1),this._delay!=t&&(this._delay=t,this.lastCount=this.updateInterval=Math.round(60*t))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentCount",{get:function(){return this._currentCount},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"running",{get:function(){return this._running},enumerable:!0,configurable:!0}),i.prototype.reset=function(){this.stop(),this._currentCount=0},i.prototype.start=function(){this._running||(this.lastCount=this.updateInterval,this.lastTimeStamp=t.getTimer(),t.ticker.$startTick(this.$update,this),this._running=!0)},i.prototype.stop=function(){this._running&&(t.stopTick(this.$update,this),this._running=!1)},i.prototype.$update=function(e){var i=e-this.lastTimeStamp;if(i>=this._delay)this.lastCount=this.updateInterval;else{if(this.lastCount-=1e3,this.lastCount>0)return!1;this.lastCount+=this.updateInterval}this.lastTimeStamp=e,this._currentCount++;var r=this.repeatCount>0&&this._currentCount>=this.repeatCount;return(0==this.repeatCount||this._currentCount<=this.repeatCount)&&t.TimerEvent.dispatchTimerEvent(this,t.TimerEvent.TIMER),r&&(this.stop(),t.TimerEvent.dispatchTimerEvent(this,t.TimerEvent.TIMER_COMPLETE)),!1},i}(t.EventDispatcher);t.Timer=e,__reflect(e.prototype,"egret.Timer")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){function e(e,i){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t.$callLaterFunctionList.push(e),t.$callLaterThisList.push(i),t.$callLaterArgsList.push(r)}function i(e,i){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t.$callAsyncFunctionList.push(e),t.$callAsyncThisList.push(i),t.$callAsyncArgsList.push(r)}t.$callLaterFunctionList=[],t.$callLaterThisList=[],t.$callLaterArgsList=[],t.callLater=e,t.$callAsyncFunctionList=[],t.$callAsyncThisList=[],t.$callAsyncArgsList=[],t.$callAsync=i}(egret||(egret={}));var egret;!function(t){function e(t,e,i){for(var r=[],n=3;n<arguments.length;n++)r[n-3]=arguments[n];var a,o=t.prototype;t.hasOwnProperty("__sets__")||Object.defineProperty(t,"__sets__",{value:{}}),a=t.__sets__;var s=a[i];if(s)return s.apply(e,r);var h=Object.getPrototypeOf(o);if(null!=h){for(;!h.hasOwnProperty(i);)if(h=Object.getPrototypeOf(h),null==h)return;s=Object.getOwnPropertyDescriptor(h,i).set,a[i]=s,s.apply(e,r)}}function i(t,e,i){var r,n=t.prototype;t.hasOwnProperty("__gets__")||Object.defineProperty(t,"__gets__",{value:{}}),r=t.__gets__;var a=r[i];if(a)return a.call(e);var o=Object.getPrototypeOf(n);if(null!=o){for(;!o.hasOwnProperty(i);)if(o=Object.getPrototypeOf(o),null==o)return;return a=Object.getOwnPropertyDescriptor(o,i).get,r[i]=a,a.call(e)}}t.superSetter=e,t.superGetter=i}(egret||(egret={}));var egret;!function(t){function e(t){if(!t)return null;var e=i[t];if(e)return e;var r=t.split("."),n=r.length;e=global;for(var a=0;n>a;a++){var o=r[a];if(e=e[o],!e)return null}return i[t]=e,e}var i={};t.getDefinitionByName=e}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){function e(t){var e=typeof t;if(!t||"object"!=e&&!t.prototype)return e;var i=t.prototype?t.prototype:Object.getPrototypeOf(t);if(i.hasOwnProperty("__class__"))return i.__class__;var r=i.constructor.toString().trim(),n=r.indexOf("("),a=r.substring(9,n);return Object.defineProperty(i,"__class__",{value:a,enumerable:!1,writable:!0}),a}t.getQualifiedClassName=e}(egret||(egret={}));var egret;!function(t){function e(e){if(!e||"object"!=typeof e&&!e.prototype)return null;var i=e.prototype?e.prototype:Object.getPrototypeOf(e),r=Object.getPrototypeOf(i);if(!r)return null;var n=t.getQualifiedClassName(r.constructor);return n?n:null}t.getQualifiedSuperclassName=e}(egret||(egret={}));var egret;!function(t){function e(){return Date.now()-t.sys.$START_TIME}t.getTimer=e}(egret||(egret={}));var egret;!function(t){function e(e){var i=t.getDefinitionByName(e);return i?!0:!1}t.hasDefinition=e}(egret||(egret={}));var egret;!function(t){function e(t,e){if(!t||"object"!=typeof t)return!1;var i=Object.getPrototypeOf(t),r=i?i.__types__:null;return r?-1!==r.indexOf(e):!1}t.is=e}(egret||(egret={}));var egret;!function(t){function e(e,i){t.ticker.$startTick(e,i)}t.startTick=e}(egret||(egret={}));var egret;!function(t){function e(e,i){t.ticker.$stopTick(e,i)}t.stopTick=e}(egret||(egret={}));var egret;!function(t){function e(t){0>t&&(t=0),t>16777215&&(t=16777215);for(var e=t.toString(16).toUpperCase();e.length>6;)e=e.slice(1,e.length);for(;e.length<6;)e="0"+e;return"#"+e}t.toColorString=e}(egret||(egret={}));

 //js/egret.web.min_f6a09338.js
var __reflect=this&&this.__reflect||function(e,t,r){e.__class__=t,r?r.push(t):r=[t],e.__types__=e.__types__?r.concat(e.__types__):r},__extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);r.prototype=t.prototype,e.prototype=new r},egret;!function(e){var t;!function(t){var r=function(t){function r(r){var i=t.call(this)||this;return i.onUpdate=function(t){var r=new e.GeolocationEvent(e.Event.CHANGE),n=t.coords;r.altitude=n.altitude,r.heading=n.heading,r.accuracy=n.accuracy,r.latitude=n.latitude,r.longitude=n.longitude,r.speed=n.speed,r.altitudeAccuracy=n.altitudeAccuracy,i.dispatchEvent(r)},i.onError=function(t){var r=e.GeolocationEvent.UNAVAILABLE;t.code==t.PERMISSION_DENIED&&(r=e.GeolocationEvent.PERMISSION_DENIED);var n=new e.GeolocationEvent(e.IOErrorEvent.IO_ERROR);n.errorType=r,n.errorMessage=t.message,i.dispatchEvent(n)},i.geolocation=navigator.geolocation,i}return __extends(r,t),r.prototype.start=function(){var t=this.geolocation;t?this.watchId=t.watchPosition(this.onUpdate,this.onError):this.onError({code:2,message:e.sys.tr(3004),PERMISSION_DENIED:1,POSITION_UNAVAILABLE:2})},r.prototype.stop=function(){var e=this.geolocation;e.clearWatch(this.watchId)},r}(e.EventDispatcher);t.WebGeolocation=r,__reflect(r.prototype,"egret.web.WebGeolocation",["egret.Geolocation"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(t){function r(){var r=null!==t&&t.apply(this,arguments)||this;return r.onChange=function(t){var i=new e.MotionEvent(e.Event.CHANGE),n={x:t.acceleration.x,y:t.acceleration.y,z:t.acceleration.z},a={x:t.accelerationIncludingGravity.x,y:t.accelerationIncludingGravity.y,z:t.accelerationIncludingGravity.z},o={alpha:t.rotationRate.alpha,beta:t.rotationRate.beta,gamma:t.rotationRate.gamma};i.acceleration=n,i.accelerationIncludingGravity=a,i.rotationRate=o,r.dispatchEvent(i)},r}return __extends(r,t),r.prototype.start=function(){window.addEventListener("devicemotion",this.onChange)},r.prototype.stop=function(){window.removeEventListener("devicemotion",this.onChange)},r}(e.EventDispatcher);t.WebMotion=r,__reflect(r.prototype,"egret.web.WebMotion",["egret.Motion"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function r(e){if(window.location){var t=location.search;if(""==t)return"";t=t.slice(1);for(var r=t.split("&"),i=r.length,n=0;i>n;n++){var a=r[n],o=a.split("=");if(o[0]==e)return o[1]}}return""}t.getOption=r,e.getOption=r}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(r){function i(t){var i=r.call(this)||this;return i.$startTime=0,i.audio=null,i.isStopped=!1,i.canPlay=function(){i.audio.removeEventListener("canplay",i.canPlay);try{i.audio.currentTime=i.$startTime}catch(e){}finally{i.audio.play()}},i.onPlayEnd=function(){return 1==i.$loops?(i.stop(),void i.dispatchEventWith(e.Event.SOUND_COMPLETE)):(i.$loops>0&&i.$loops--,void i.$play())},i._volume=1,t.addEventListener("ended",i.onPlayEnd),i.audio=t,i}return __extends(i,r),i.prototype.$play=function(){if(this.isStopped)return void e.$error(1036);try{this.audio.volume=this._volume,this.audio.currentTime=this.$startTime}catch(t){return void this.audio.addEventListener("canplay",this.canPlay)}this.audio.play()},i.prototype.stop=function(){if(this.audio){this.isStopped||e.sys.$popSoundChannel(this),this.isStopped=!0;var r=this.audio;r.removeEventListener("ended",this.onPlayEnd),r.removeEventListener("canplay",this.canPlay),r.volume=0,this._volume=0,this.audio=null;var i=this.$url;window.setTimeout(function(){r.pause(),t.HtmlSound.$recycle(i,r)},200)}},Object.defineProperty(i.prototype,"volume",{get:function(){return this._volume},set:function(t){return this.isStopped?void e.$error(1036):(this._volume=t,void(this.audio&&(this.audio.volume=t)))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.audio?this.audio.currentTime:0},enumerable:!0,configurable:!0}),i}(e.EventDispatcher);t.HtmlSoundChannel=r,__reflect(r.prototype,"egret.web.HtmlSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(){function t(){}return t.decodeAudios=function(){if(!(t.decodeArr.length<=0||t.isDecoding)){t.isDecoding=!0;var r=t.decodeArr.shift();t.ctx.decodeAudioData(r.buffer,function(e){r.self.audioBuffer=e,r.success&&r.success(),t.isDecoding=!1,t.decodeAudios()},function(){e.log("sound decode error"),r.fail&&r.fail(),t.isDecoding=!1,t.decodeAudios()})}},t.decodeArr=[],t.isDecoding=!1,t}();t.WebAudioDecode=r,__reflect(r.prototype,"egret.web.WebAudioDecode");var i=function(i){function n(){var e=i.call(this)||this;return e.loaded=!1,e}return __extends(n,i),Object.defineProperty(n.prototype,"length",{get:function(){if(this.audioBuffer)return this.audioBuffer.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),n.prototype.load=function(t){function i(){a.loaded=!0,a.dispatchEventWith(e.Event.COMPLETE)}function n(){a.dispatchEventWith(e.IOErrorEvent.IO_ERROR)}var a=this;this.url=t;var o=new XMLHttpRequest;o.open("GET",t,!0),o.responseType="arraybuffer",o.addEventListener("load",function(){var t=o.status>=400;t?a.dispatchEventWith(e.IOErrorEvent.IO_ERROR):(r.decodeArr.push({buffer:o.response,success:i,fail:n,self:a,url:a.url}),r.decodeAudios())}),o.addEventListener("error",function(){a.dispatchEventWith(e.IOErrorEvent.IO_ERROR)}),o.send()},n.prototype.play=function(r,i){r=+r||0,i=+i||0;var n=new t.WebAudioSoundChannel;return n.$url=this.url,n.$loops=i,n.$audioBuffer=this.audioBuffer,n.$startTime=r,n.$play(),e.sys.$pushSoundChannel(n),n},n.prototype.close=function(){},n.MUSIC="music",n.EFFECT="effect",n}(e.EventDispatcher);t.WebAudioSound=i,__reflect(i.prototype,"egret.web.WebAudioSound",["egret.Sound"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(r){function i(){var i=r.call(this)||this;return i.$startTime=0,i.bufferSource=null,i.context=t.WebAudioDecode.ctx,i.isStopped=!1,i._currentTime=0,i._volume=1,i.onPlayEnd=function(){return 1==i.$loops?(i.stop(),void i.dispatchEventWith(e.Event.SOUND_COMPLETE)):(i.$loops>0&&i.$loops--,void i.$play())},i._startTime=0,i.context.createGain?i.gain=i.context.createGain():i.gain=i.context.createGainNode(),i}return __extends(i,r),i.prototype.$play=function(){if(this.isStopped)return void e.$error(1036);this.bufferSource&&(this.bufferSource.onended=null,this.bufferSource=null);var t=this.context,r=this.gain,i=t.createBufferSource();this.bufferSource=i,i.buffer=this.$audioBuffer,i.connect(r),r.connect(t.destination),i.onended=this.onPlayEnd,this._startTime=Date.now(),this.gain.gain.value=this._volume,i.start(0,this.$startTime),this._currentTime=0},i.prototype.stop=function(){if(this.bufferSource){var t=this.bufferSource;t.stop?t.stop(0):t.noteOff(0),t.onended=null,t.disconnect(),this.bufferSource=null,this.$audioBuffer=null}this.isStopped||e.sys.$popSoundChannel(this),this.isStopped=!0},Object.defineProperty(i.prototype,"volume",{get:function(){return this._volume},set:function(t){return this.isStopped?void e.$error(1036):(this._volume=t,void(this.gain.gain.value=t))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.bufferSource?(Date.now()-this._startTime)/1e3+this.$startTime:0},enumerable:!0,configurable:!0}),i}(e.EventDispatcher);t.WebAudioSoundChannel=r,__reflect(r.prototype,"egret.web.WebAudioSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(t){function r(r,i){void 0===i&&(i=!0);var n=t.call(this)||this;return n.loaded=!1,n.closed=!1,n.heightSet=0/0,n.widthSet=0/0,n.waiting=!1,n.userPause=!1,n.userPlay=!1,n.isPlayed=!1,n.screenChanged=function(t){var r=document.fullscreenEnabled||document.webkitIsFullScreen;r||(n.checkFullScreen(!1),e.Capabilities.isMobile||(n._fullscreen=r))},n._fullscreen=!0,n.onVideoLoaded=function(){n.video.removeEventListener("canplay",n.onVideoLoaded);var t=n.video;n.loaded=!0,n.posterData&&(n.posterData.width=n.getPlayWidth(),n.posterData.height=n.getPlayHeight()),t.width=t.videoWidth,t.height=t.videoHeight,window.setTimeout(function(){n.dispatchEventWith(e.Event.COMPLETE)},200)},n.$renderNode=new e.sys.BitmapNode,n.src=r,n.once(e.Event.ADDED_TO_STAGE,n.loadPoster,n),r&&n.load(),n}return __extends(r,t),r.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(1)},r.prototype.load=function(t,r){var i=this;if(void 0===r&&(r=!0),t=t||this.src,this.src=t,!this.video||this.video.src!=t){var n;!this.video||e.Capabilities.isMobile?(n=document.createElement("video"),this.video=n,n.controls=null):n=this.video,n.src=t,n.setAttribute("autoplay","autoplay"),n.setAttribute("webkit-playsinline","true"),n.setAttribute("playsinline","true"),n.setAttribute("x5-video-player-type","h5-page"),n.addEventListener("canplay",this.onVideoLoaded),n.addEventListener("error",function(){return i.onVideoError()}),n.addEventListener("ended",function(){return i.onVideoEnded()});var a=!1;n.addEventListener("canplay",function(){i.waiting=!1,a?i.userPause?i.pause():i.userPlay&&i.play():(a=!0,n.pause())}),n.addEventListener("waiting",function(){i.waiting=!0}),n.load(),this.videoPlay(),n.style.position="absolute",n.style.top="0px",n.style.zIndex="-88888",n.style.left="0px",n.height=1,n.width=1}},r.prototype.play=function(t,r){var i=this;if(void 0===r&&(r=!1),0==this.loaded)return this.load(this.src),void this.once(e.Event.COMPLETE,function(e){return i.play(t,r)},this);this.isPlayed=!0;var n=this.video;void 0!=t&&(n.currentTime=+t||0),n.loop=!!r,e.Capabilities.isMobile?n.style.zIndex="-88888":n.style.zIndex="9999",n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.height=n.videoHeight,n.width=n.videoWidth,"Windows PC"!=e.Capabilities.os&&"Mac OS"!=e.Capabilities.os&&window.setTimeout(function(){n.width=0},1e3),this.checkFullScreen(this._fullscreen)},r.prototype.videoPlay=function(){return this.userPause=!1,this.waiting?void(this.userPlay=!0):(this.userPlay=!1,void this.video.play())},r.prototype.checkFullScreen=function(t){var r=this.video;if(t)null==r.parentElement&&(r.removeAttribute("webkit-playsinline"),r.removeAttribute("playsinline"),document.body.appendChild(r)),e.stopTick(this.markDirty,this),this.goFullscreen();else if(null!=r.parentElement&&r.parentElement.removeChild(r),r.setAttribute("webkit-playsinline","true"),r.setAttribute("playsinline","true"),this.setFullScreenMonitor(!1),e.startTick(this.markDirty,this),e.Capabilities.isMobile)return this.video.currentTime=0,void this.onVideoEnded();this.videoPlay()},r.prototype.goFullscreen=function(){var t,r=this.video;return t=e.web.getPrefixStyleName("requestFullscreen",r),r[t]||(t=e.web.getPrefixStyleName("requestFullScreen",r),r[t])?(r.removeAttribute("webkit-playsinline"),r[t](),this.setFullScreenMonitor(!0),!0):!0},r.prototype.setFullScreenMonitor=function(e){var t=this.video;e?(t.addEventListener("mozfullscreenchange",this.screenChanged),t.addEventListener("webkitfullscreenchange",this.screenChanged),t.addEventListener("mozfullscreenerror",this.screenError),t.addEventListener("webkitfullscreenerror",this.screenError)):(t.removeEventListener("mozfullscreenchange",this.screenChanged),t.removeEventListener("webkitfullscreenchange",this.screenChanged),t.removeEventListener("mozfullscreenerror",this.screenError),t.removeEventListener("webkitfullscreenerror",this.screenError))},r.prototype.screenError=function(){e.$error(3014)},r.prototype.exitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.oCancelFullScreen?document.oCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():this.video.style.display="none",this.video&&this.video.parentElement&&this.video.parentElement.removeChild(this.video)},r.prototype.onVideoEnded=function(){this.pause(),this.isPlayed=!1,this._fullscreen&&this.exitFullscreen(),this.dispatchEventWith(e.Event.ENDED)},r.prototype.onVideoError=function(){console.error("video errorCode:",this.video.error.code),this.dispatchEventWith(e.IOErrorEvent.IO_ERROR)},r.prototype.close=function(){var e=this;this.closed=!0,this.video.removeEventListener("canplay",this.onVideoLoaded),this.video.removeEventListener("error",function(){return e.onVideoError()}),this.video.removeEventListener("ended",function(){return e.onVideoEnded()}),this.pause(),0==this.loaded&&this.video&&(this.video.src=""),this.video&&this.video.parentElement&&(this.video.parentElement.removeChild(this.video),this.video=null),this.loaded=!1},r.prototype.pause=function(){return this.userPlay=!1,this.waiting?void(this.userPause=!0):(this.userPause=!1,this.video.pause(),void e.stopTick(this.markDirty,this))},Object.defineProperty(r.prototype,"volume",{get:function(){return this.video?this.video.volume:1},set:function(e){this.video&&(this.video.volume=e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"position",{get:function(){return this.video?this.video.currentTime:0},set:function(e){this.video&&(this.video.currentTime=e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fullscreen",{get:function(){return this._fullscreen},set:function(t){e.Capabilities.isMobile||(this._fullscreen=!!t,this.video&&0==this.video.paused&&this.checkFullScreen(this._fullscreen))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bitmapData",{get:function(){return this.video&&this.loaded?(this._bitmapData||(this.video.width=this.video.videoWidth,this.video.height=this.video.videoHeight,this._bitmapData=new e.BitmapData(this.video),this._bitmapData.$deleteSource=!1),this._bitmapData):null},enumerable:!0,configurable:!0}),r.prototype.loadPoster=function(){var t=this,r=this.poster;if(r){var i=new e.ImageLoader;i.once(e.Event.COMPLETE,function(r){i.data;if(t.posterData=i.data,t.$renderDirty=!0,t.posterData.width=t.getPlayWidth(),t.posterData.height=t.getPlayHeight(),e.nativeRender){var n=new e.Texture;n._setBitmapData(t.posterData),t.$nativeDisplayObject.setTexture(n)}},this),i.load(r)}},r.prototype.$measureContentBounds=function(e){var t=this.bitmapData,r=this.posterData;t?e.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):r?e.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):e.setEmpty()},r.prototype.getPlayWidth=function(){return isNaN(this.widthSet)?this.bitmapData?this.bitmapData.width:this.posterData?this.posterData.width:0/0:this.widthSet},r.prototype.getPlayHeight=function(){return isNaN(this.heightSet)?this.bitmapData?this.bitmapData.height:this.posterData?this.posterData.height:0/0:this.heightSet},r.prototype.$updateRenderNode=function(){var t=this.$renderNode,r=this.bitmapData,i=this.posterData,n=this.getPlayWidth(),a=this.getPlayHeight();this.isPlayed&&!e.Capabilities.isMobile||!i?this.isPlayed&&r&&(t.image=r,t.imageWidth=r.width,t.imageHeight=r.height,e.WebGLUtils.deleteWebGLTexture(r.webGLTexture),r.webGLTexture=null,t.drawImage(0,0,r.width,r.height,0,0,n,a)):(t.image=i,t.imageWidth=n,t.imageHeight=a,t.drawImage(0,0,i.width,i.height,0,0,n,a))},r.prototype.markDirty=function(){return this.$renderDirty=!0,!0},r.prototype.$setHeight=function(e){if(this.heightSet=e,this.paused){var r=this;this.$renderDirty=!0,window.setTimeout(function(){r.$renderDirty=!1},200)}t.prototype.$setHeight.call(this,e)},r.prototype.$setWidth=function(e){if(this.widthSet=e,this.paused){var r=this;this.$renderDirty=!0,window.setTimeout(function(){r.$renderDirty=!1},200)}t.prototype.$setWidth.call(this,e)},Object.defineProperty(r.prototype,"paused",{get:function(){return this.video?this.video.paused:!0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"length",{get:function(){if(this.video)return this.video.duration;throw new Error("Video not loaded!")},enumerable:!0,configurable:!0}),r}(e.DisplayObject);t.WebVideo=r,__reflect(r.prototype,"egret.web.WebVideo",["egret.Video","egret.DisplayObject"]),e.Video=r}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(t){function r(){var e=t.call(this)||this;return e.timeout=0,e._url="",e._method="",e}return __extends(r,t),Object.defineProperty(r.prototype,"response",{get:function(){if(!this._xhr)return null;if(void 0!=this._xhr.response)return this._xhr.response;if("text"==this._responseType)return this._xhr.responseText;if("arraybuffer"==this._responseType&&/msie 9.0/i.test(navigator.userAgent)){var e=window;return e.convertResponseBodyToText(this._xhr.responseBody)}return"document"==this._responseType?this._xhr.responseXML:null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"responseType",{get:function(){return this._responseType},set:function(e){this._responseType=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"withCredentials",{get:function(){return this._withCredentials},set:function(e){this._withCredentials=e},enumerable:!0,configurable:!0}),r.prototype.getXHR=function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},r.prototype.open=function(e,t){void 0===t&&(t="GET"),this._url=e,this._method=t,this._xhr&&(this._xhr.abort(),this._xhr=null);var r=this.getXHR();window.XMLHttpRequest?(r.addEventListener("load",this.onload.bind(this)),r.addEventListener("error",this.onerror.bind(this))):r.onreadystatechange=this.onReadyStateChange.bind(this),r.onprogress=this.updateProgress.bind(this),r.ontimeout=this.onTimeout.bind(this),r.open(this._method,this._url,!0),this._xhr=r},r.prototype.send=function(e){if(null!=this._responseType&&(this._xhr.responseType=this._responseType),null!=this._withCredentials&&(this._xhr.withCredentials=this._withCredentials),this.headerObj)for(var t in this.headerObj)this._xhr.setRequestHeader(t,this.headerObj[t]);this._xhr.timeout=this.timeout,this._xhr.send(e)},r.prototype.abort=function(){this._xhr&&this._xhr.abort()},r.prototype.getAllResponseHeaders=function(){if(!this._xhr)return null;var e=this._xhr.getAllResponseHeaders();return e?e:""},r.prototype.setRequestHeader=function(e,t){this.headerObj||(this.headerObj={}),this.headerObj[e]=t},r.prototype.getResponseHeader=function(e){if(!this._xhr)return null;var t=this._xhr.getResponseHeader(e);return t?t:""},r.prototype.onTimeout=function(){this.dispatchEventWith(e.IOErrorEvent.IO_ERROR)},r.prototype.onReadyStateChange=function(){var t=this._xhr;if(4==t.readyState){var r=t.status>=400||0==t.status,i=(this._url,this);window.setTimeout(function(){r?i.dispatchEventWith(e.IOErrorEvent.IO_ERROR):i.dispatchEventWith(e.Event.COMPLETE)},0)}},r.prototype.updateProgress=function(t){t.lengthComputable&&e.ProgressEvent.dispatchProgressEvent(this,e.ProgressEvent.PROGRESS,t.loaded,t.total)},r.prototype.onload=function(){var t=this,r=this._xhr,i=(this._url,r.status>=400);window.setTimeout(function(){i?t.dispatchEventWith(e.IOErrorEvent.IO_ERROR):t.dispatchEventWith(e.Event.COMPLETE)},0)},r.prototype.onerror=function(){var t=(this._url,this);window.setTimeout(function(){t.dispatchEventWith(e.IOErrorEvent.IO_ERROR)},0)},r}(e.EventDispatcher);t.WebHttpRequest=r,__reflect(r.prototype,"egret.web.WebHttpRequest",["egret.HttpRequest"]),e.HttpRequest=r}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=window.URL||window.webkitURL,i=function(i){function n(){var e=null!==i&&i.apply(this,arguments)||this;return e.data=null,e._crossOrigin=null,e._hasCrossOriginSet=!1,e.currentImage=null,e.request=null,e}return __extends(n,i),Object.defineProperty(n.prototype,"crossOrigin",{get:function(){return this._crossOrigin},set:function(e){this._hasCrossOriginSet=!0,this._crossOrigin=e},enumerable:!0,configurable:!0}),n.prototype.load=function(r){if(t.Html5Capatibility._canUseBlob&&0!=r.indexOf("wxLocalResource:")&&0!=r.indexOf("data:")&&0!=r.indexOf("http:")&&0!=r.indexOf("https:")){var i=this.request;i||(i=this.request=new e.web.WebHttpRequest,i.addEventListener(e.Event.COMPLETE,this.onBlobLoaded,this),i.addEventListener(e.IOErrorEvent.IO_ERROR,this.onBlobError,this),i.responseType="blob"),i.open(r),i.send()}else this.loadImage(r)},n.prototype.onBlobLoaded=function(e){var t=this.request.response;this.request=void 0,this.loadImage(r.createObjectURL(t))},n.prototype.onBlobError=function(e){this.dispatchIOError(this.currentURL),this.request=void 0},n.prototype.loadImage=function(e){var t=new Image;this.data=null,this.currentImage=t,this._hasCrossOriginSet?this._crossOrigin&&(t.crossOrigin=this._crossOrigin):n.crossOrigin&&(t.crossOrigin=n.crossOrigin),t.onload=this.onImageComplete.bind(this),t.onerror=this.onLoadError.bind(this),t.src=e},n.prototype.onImageComplete=function(t){var r=this.getImage(t);if(r){this.data=new e.BitmapData(r);var i=this;window.setTimeout(function(){i.dispatchEventWith(e.Event.COMPLETE)},0)}},n.prototype.onLoadError=function(e){var t=this.getImage(e);t&&this.dispatchIOError(t.src)},n.prototype.dispatchIOError=function(t){var r=this;window.setTimeout(function(){r.dispatchEventWith(e.IOErrorEvent.IO_ERROR)},0)},n.prototype.getImage=function(t){var i=t.target,n=i.src;if(0==n.indexOf("blob:"))try{r.revokeObjectURL(i.src)}catch(a){e.$warn(1037)}return i.onerror=null,i.onload=null,this.currentImage!==i?null:(this.currentImage=null,i)},n.crossOrigin=null,n}(e.EventDispatcher);t.WebImageLoader=i,__reflect(i.prototype,"egret.web.WebImageLoader",["egret.ImageLoader"]),e.ImageLoader=i}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(t){function r(){var e=t.call(this)||this;return e._isNeedShow=!1,e.inputElement=null,e.inputDiv=null,e._gscaleX=0,e._gscaleY=0,e.textValue="",e.colorValue=16777215,e._styleInfoes={},e}return __extends(r,t),r.prototype.$setTextField=function(e){return this.$textfield=e,!0},r.prototype.$addToStage=function(){this.htmlInput=e.web.$getTextAdapter(this.$textfield)},r.prototype._initElement=function(){var t=this.$textfield.localToGlobal(0,0),r=t.x,i=t.y,n=this.htmlInput.$scaleX,a=this.htmlInput.$scaleY;this.inputDiv.style.left=r*n+"px",this.inputDiv.style.top=i*a+"px",this.$textfield.multiline&&this.$textfield.height>this.$textfield.size?(this.inputDiv.style.top=i*a+"px",this.inputElement.style.top=-this.$textfield.lineSpacing/2*a+"px"):(this.inputDiv.style.top=i*a+"px",this.inputElement.style.top="0px");for(var o=this.$textfield,s=1,l=1,c=0;o.parent;)s*=o.scaleX,l*=o.scaleY,c+=o.rotation,o=o.parent;var h=e.web.getPrefixStyleName("transform");this.inputDiv.style[h]="rotate("+c+"deg)",this._gscaleX=n*s,this._gscaleY=a*l},r.prototype.$show=function(e){void 0===e&&(e=!0),this.htmlInput.isCurrentStageText(this)?this.inputElement.onblur=null:(this.inputElement=this.htmlInput.getInputElement(this),this.$textfield.multiline?this.inputElement.type="text":this.inputElement.type=this.$textfield.inputType,this.inputDiv=this.htmlInput._inputDIV),this.htmlInput._needShow=!0,this._isNeedShow=!0,this._initElement(),e&&this.activeShowKeyboard()},r.prototype.activeShowKeyboard=function(){this.htmlInput._needShow?(this._isNeedShow=!1,this.dispatchEvent(new e.Event("focus")),this.executeShow(),this.htmlInput.show()):(this.htmlInput.blurInputElement(),this.htmlInput.disposeInputElement())},r.prototype.onBlurHandler=function(){this.htmlInput.clearInputElement(),window.scrollTo(0,0)},r.prototype.onFocusHandler=function(){var e=this;window.setTimeout(function(){e.inputElement&&e.inputElement.scrollIntoView()},200)},r.prototype.executeShow=function(){this.inputElement.value!==this.$getText()&&(this.inputElement.value=this.$getText()),null==this.inputElement.onblur&&(this.inputElement.onblur=this.onBlurHandler.bind(this)),null==this.inputElement.onfocus&&(this.inputElement.onfocus=this.onFocusHandler.bind(this)),this.$resetStageText(),this.$textfield.maxChars>0?this.inputElement.setAttribute("maxlength",this.$textfield.maxChars+""):this.inputElement.removeAttribute("maxlength"),this.inputElement.selectionStart=this.inputElement.value.length,this.inputElement.selectionEnd=this.inputElement.value.length,this.inputElement.focus()},r.prototype.$hide=function(){this.htmlInput&&this.htmlInput.disconnectStageText(this)},r.prototype.$getText=function(){return this.textValue||(this.textValue=""),this.textValue},r.prototype.$setText=function(e){return this.textValue=e,this.resetText(),!0},r.prototype.resetText=function(){this.inputElement&&(this.inputElement.value=this.textValue)},r.prototype.$setColor=function(e){return this.colorValue=e,this.resetColor(),!0},r.prototype.resetColor=function(){this.inputElement&&this.setElementStyle("color",e.toColorString(this.colorValue))},r.prototype.$onBlur=function(){},r.prototype._onInput=function(){var t=this;window.setTimeout(function(){t.inputElement&&t.inputElement.selectionStart==t.inputElement.selectionEnd&&(t.textValue=t.inputElement.value,e.Event.dispatchEvent(t,"updateText",!1))},0)},r.prototype.setAreaHeight=function(){var t=this.$textfield;if(t.multiline){var r=e.TextFieldUtils.$getTextHeight(t);if(t.height<=t.size)this.setElementStyle("height",t.size*this._gscaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",t.size*this._gscaleY+"px");else if(t.height<r)this.setElementStyle("height",t.height*this._gscaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",(t.size+t.lineSpacing)*this._gscaleY+"px");else{this.setElementStyle("height",(r+t.lineSpacing)*this._gscaleY+"px");var i=(t.height-r)*this._gscaleY,n=e.TextFieldUtils.$getValign(t),a=i*n,o=i-a;this.setElementStyle("padding",a+"px 0px "+o+"px 0px"),this.setElementStyle("lineHeight",(t.size+t.lineSpacing)*this._gscaleY+"px")}}},r.prototype._onClickHandler=function(t){this._isNeedShow&&(t.stopImmediatePropagation(),this._isNeedShow=!1,this.dispatchEvent(new e.Event("focus")),this.executeShow())},r.prototype._onDisconnect=function(){this.inputElement=null,this.dispatchEvent(new e.Event("blur"))},r.prototype.setElementStyle=function(e,t){this.inputElement&&this._styleInfoes[e]!=t&&(this.inputElement.style[e]=t)},r.prototype.$removeFromStage=function(){this.inputElement&&this.htmlInput.disconnectStageText(this)},r.prototype.$resetStageText=function(){if(this.inputElement){var t=this.$textfield;this.setElementStyle("fontFamily",t.fontFamily),this.setElementStyle("fontStyle",t.italic?"italic":"normal"),this.setElementStyle("fontWeight",t.bold?"bold":"normal"),this.setElementStyle("textAlign",t.textAlign),this.setElementStyle("fontSize",t.size*this._gscaleY+"px"),this.setElementStyle("color",e.toColorString(t.textColor));var r=void 0;if(t.stage?(r=t.localToGlobal(0,0).x,r=Math.min(t.width,t.stage.stageWidth-r)):r=t.width,this.setElementStyle("width",r*this._gscaleX+"px"),this.setElementStyle("verticalAlign",t.verticalAlign),t.multiline)this.setAreaHeight();else if(this.setElementStyle("lineHeight",t.size*this._gscaleY+"px"),t.height<t.size){this.setElementStyle("height",t.size*this._gscaleY+"px");var i=t.size/2*this._gscaleY;this.setElementStyle("padding","0px 0px "+i+"px 0px")}else{this.setElementStyle("height",t.size*this._gscaleY+"px");var n=(t.height-t.size)*this._gscaleY,a=e.TextFieldUtils.$getValign(t),o=n*a,i=n-o;i<t.size/2*this._gscaleY&&(i=t.size/2*this._gscaleY),this.setElementStyle("padding",o+"px 0px "+i+"px 0px")}this.inputDiv.style.clip="rect(0px "+t.width*this._gscaleX+"px "+t.height*this._gscaleY+"px 0px)",this.inputDiv.style.height=t.height*this._gscaleY+"px",this.inputDiv.style.width=r*this._gscaleX+"px"}},r}(e.EventDispatcher);t.HTML5StageText=r,__reflect(r.prototype,"egret.web.HTML5StageText",["egret.StageText"]),e.StageText=r}(t=e.web||(e.web={}))}(egret||(egret={})),function(e){var t;!function(t){var r=function(){function t(){var e=this;this._needShow=!1,this.$scaleX=1,this.$scaleY=1,this.stageTextClickHandler=function(t){e._needShow?(e._needShow=!1,e._stageText._onClickHandler(t),e.show()):(e.blurInputElement(),e.disposeInputElement())}}return t.prototype.isInputOn=function(){return null!=this._stageText},t.prototype.isCurrentStageText=function(e){return this._stageText==e},t.prototype.initValue=function(e){e.style.position="absolute",e.style.left="0px",e.style.top="0px",e.style.border="none",e.style.padding="0",e.ontouchmove=function(e){e.preventDefault()}},t.prototype.$updateSize=function(){if(this.canvas){this.$scaleX=e.sys.DisplayList.$canvasScaleX,this.$scaleY=e.sys.DisplayList.$canvasScaleY,this.StageDelegateDiv.style.left=this.canvas.style.left,this.StageDelegateDiv.style.top=this.canvas.style.top;var t=e.web.getPrefixStyleName("transform");this.StageDelegateDiv.style[t]=this.canvas.style[t],this.StageDelegateDiv.style[e.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px"}},t.prototype._initStageDelegateDiv=function(t,r){this.canvas=r;var i,n=this;i||(i=document.createElement("div"),this.StageDelegateDiv=i,i.id="StageDelegateDiv",t.appendChild(i),n.initValue(i),n._inputDIV=document.createElement("div"),n.initValue(n._inputDIV),n._inputDIV.style.width="0px",n._inputDIV.style.height="0px",n._inputDIV.style.left="0px",n._inputDIV.style.top="-100px",n._inputDIV.style[e.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",i.appendChild(n._inputDIV),this.canvas.addEventListener("click",this.stageTextClickHandler),n.initInputElement(!0),n.initInputElement(!1))},t.prototype.initInputElement=function(e){var t,r=this;e?(t=document.createElement("textarea"),t.style.resize="none",r._multiElement=t,t.id="egretTextarea"):(t=document.createElement("input"),r._simpleElement=t,t.id="egretInput"),t.type="text",r._inputDIV.appendChild(t),t.setAttribute("tabindex","-1"),t.style.width="1px",t.style.height="12px",r.initValue(t),t.style.outline="thin",t.style.background="none",t.style.overflow="hidden",t.style.wordBreak="break-all",t.style.opacity="0",t.oninput=function(){r._stageText&&r._stageText._onInput()}},t.prototype.show=function(){var t=this,r=t._inputElement;e.$callAsync(function(){r.style.opacity="1"},t)},t.prototype.disconnectStageText=function(e){(null==this._stageText||this._stageText==e)&&(this._inputElement&&this._inputElement.blur(),this.clearInputElement(),this._inputElement&&this._inputDIV.contains(this._inputElement)&&this._inputDIV.removeChild(this._inputElement),this._needShow=!1)},t.prototype.clearInputElement=function(){var e=this;if(e._inputElement){e._inputElement.value="",e._inputElement.onblur=null,e._inputElement.onfocus=null,e._inputElement.style.width="1px",e._inputElement.style.height="12px",e._inputElement.style.left="0px",e._inputElement.style.top="0px",e._inputElement.style.opacity="0";var t=void 0;t=e._simpleElement==e._inputElement?e._multiElement:e._simpleElement,t.style.display="block",e._inputDIV.style.left="0px",e._inputDIV.style.top="-100px",e._inputDIV.style.height="0px",e._inputDIV.style.width="0px",e._inputElement.blur()}e._stageText&&(e._stageText._onDisconnect(),e._stageText=null,this.canvas.userTyping=!1,this.finishUserTyping&&this.finishUserTyping())},t.prototype.getInputElement=function(e){var t=this;t.clearInputElement(),t._stageText=e,this.canvas.userTyping=!0,t._stageText.$textfield.multiline?t._inputElement=t._multiElement:t._inputElement=t._simpleElement;var r;return r=t._simpleElement==t._inputElement?t._multiElement:t._simpleElement,r.style.display="none",this._inputElement&&!this._inputDIV.contains(this._inputElement)&&this._inputDIV.appendChild(this._inputElement),t._inputElement},t.prototype.blurInputElement=function(){this._inputElement&&(this.clearInputElement(),this._inputElement.blur())},t.prototype.disposeInputElement=function(){this._inputElement=null},t}();t.HTMLInput=r,__reflect(r.prototype,"egret.web.HTMLInput")}(t=e.web||(e.web={}))}(egret||(egret={})),function(e){var t;!function(e){function t(e){var t=e.stage?e.stage.$hashCode:0,r=i[t],o=n[t],s=a[t];
return o&&s&&(delete n[t],delete a[t]),r}function r(e,t,r,o){e._initStageDelegateDiv(r,o),i[t.$hashCode]=e,n[t.$hashCode]=o,a[t.$hashCode]=r}var i={},n={},a={};e.$getTextAdapter=t,e.$cacheTextAdapter=r}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function r(t,r,a,o,s){n||i();var l="";return s&&(l+="italic "),o&&(l+="bold "),l+=(a||12)+"px ",l+=r||"Arial",n.font=l,e.sys.measureTextWith(n,t)}function i(){n=e.sys.canvasHitTestBuffer.context,n.textAlign="left",n.textBaseline="middle"}var n=null;e.sys.measureText=r}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function r(t,r){var i=e.sys.createCanvas(t,r),n=i.getContext("2d");if(void 0===n.imageSmoothingEnabled){for(var a,o=["webkitImageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled"],s=o.length-1;s>=0&&(a=o[s],void 0===n[a]);s--);try{Object.defineProperty(n,"imageSmoothingEnabled",{get:function(){return this[a]},set:function(e){this[a]=e}})}catch(l){n.imageSmoothingEnabled=n[a]}}return i}var i=function(){function t(t,i,n){this.surface=e.sys.createCanvasRenderBufferSurface(r,t,i,n),this.context=this.surface.getContext("2d"),this.context&&(this.context.$offsetX=0,this.context.$offsetY=0),this.resize(t,i)}return Object.defineProperty(t.prototype,"width",{get:function(){return this.surface.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.surface.height},enumerable:!0,configurable:!0}),t.prototype.resize=function(t,r,i){e.sys.resizeCanvasRenderBuffer(this,t,r,i)},t.prototype.getPixels=function(e,t,r,i){return void 0===r&&(r=1),void 0===i&&(i=1),this.context.getImageData(e,t,r,i).data},t.prototype.toDataURL=function(e,t){return this.surface.toDataURL(e,t)},t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.surface.width,this.surface.height)},t.prototype.destroy=function(){this.surface.width=this.surface.height=0},t}();t.CanvasRenderBuffer=i,__reflect(i.prototype,"egret.web.CanvasRenderBuffer",["egret.sys.RenderBuffer"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(t){function r(r,i){var n=t.call(this)||this;return n.onTouchBegin=function(e){var t=n.getLocation(e);n.touch.onTouchBegin(t.x,t.y,e.identifier)},n.onMouseMove=function(e){0==e.buttons?n.onTouchEnd(e):n.onTouchMove(e)},n.onTouchMove=function(e){var t=n.getLocation(e);n.touch.onTouchMove(t.x,t.y,e.identifier)},n.onTouchEnd=function(e){var t=n.getLocation(e);n.touch.onTouchEnd(t.x,t.y,e.identifier)},n.scaleX=1,n.scaleY=1,n.rotation=0,n.canvas=i,n.touch=new e.sys.TouchHandler(r),n.addListeners(),n}return __extends(r,t),r.prototype.addListeners=function(){var t=this;window.navigator.msPointerEnabled?(this.canvas.addEventListener("MSPointerDown",function(e){e.identifier=e.pointerId,t.onTouchBegin(e),t.prevent(e)},!1),this.canvas.addEventListener("MSPointerMove",function(e){e.identifier=e.pointerId,t.onTouchMove(e),t.prevent(e)},!1),this.canvas.addEventListener("MSPointerUp",function(e){e.identifier=e.pointerId,t.onTouchEnd(e),t.prevent(e)},!1)):(e.Capabilities.isMobile||this.addMouseListener(),this.addTouchListener())},r.prototype.addMouseListener=function(){this.canvas.addEventListener("mousedown",this.onTouchBegin),this.canvas.addEventListener("mousemove",this.onMouseMove),this.canvas.addEventListener("mouseup",this.onTouchEnd)},r.prototype.addTouchListener=function(){var e=this;this.canvas.addEventListener("touchstart",function(t){for(var r=t.changedTouches.length,i=0;r>i;i++)e.onTouchBegin(t.changedTouches[i]);e.prevent(t)},!1),this.canvas.addEventListener("touchmove",function(t){for(var r=t.changedTouches.length,i=0;r>i;i++)e.onTouchMove(t.changedTouches[i]);e.prevent(t)},!1),this.canvas.addEventListener("touchend",function(t){for(var r=t.changedTouches.length,i=0;r>i;i++)e.onTouchEnd(t.changedTouches[i]);e.prevent(t)},!1),this.canvas.addEventListener("touchcancel",function(t){for(var r=t.changedTouches.length,i=0;r>i;i++)e.onTouchEnd(t.changedTouches[i]);e.prevent(t)},!1)},r.prototype.prevent=function(e){e.stopPropagation(),1==e.isScroll||this.canvas.userTyping||e.preventDefault()},r.prototype.getLocation=function(t){t.identifier=+t.identifier||0;var r=document.documentElement,i=this.canvas.getBoundingClientRect(),n=i.left+window.pageXOffset-r.clientLeft,a=i.top+window.pageYOffset-r.clientTop,o=t.pageX-n,s=o,l=t.pageY-a,c=l;return 90==this.rotation?(s=l,c=i.width-o):-90==this.rotation&&(s=i.height-l,c=o),s/=this.scaleX,c/=this.scaleY,e.$TempPoint.setTo(Math.round(s),Math.round(c))},r.prototype.updateScaleMode=function(e,t,r){this.scaleX=e,this.scaleY=t,this.rotation=r},r.prototype.$updateMaxTouches=function(){this.touch.$initMaxTouches()},r}(e.HashObject);t.WebTouchHandler=r,__reflect(r.prototype,"egret.web.WebTouchHandler")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(e){e.WebLifeCycleHandler=function(t){var r=function(){t.resume(),e.WebAudioDecode.initAudioContext&&e.WebAudioDecode.initAudioContext()},i=function(){t.pause()},n=function(){document[a]?i():r()};window.addEventListener("focus",r,!1),window.addEventListener("blur",i,!1);var a,o;"undefined"!=typeof document.hidden?(a="hidden",o="visibilitychange"):"undefined"!=typeof document.mozHidden?(a="mozHidden",o="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(a="msHidden",o="msvisibilitychange"):"undefined"!=typeof document.webkitHidden?(a="webkitHidden",o="webkitvisibilitychange"):"undefined"!=typeof document.oHidden&&(a="oHidden",o="ovisibilitychange"),"onpageshow"in window&&"onpagehide"in window&&(window.addEventListener("pageshow",r,!1),window.addEventListener("pagehide",i,!1)),a&&o&&document.addEventListener(o,n,!1);var s=navigator.userAgent,l=/micromessenger/gi.test(s),c=/mqq/gi.test(s),h=/mobile.*qq/gi.test(s);if((h||l)&&(c=!1),c){var u=window.browser||{};u.execWebFn=u.execWebFn||{},u.execWebFn.postX5GamePlayerMessage=function(e){var t=e.type;"app_enter_background"==t?i():"app_enter_foreground"==t&&r()},window.browser=u}}}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function r(e,t){var r="";if(null!=t)r=i(e,t);else{if(null==o){var n=document.createElement("div").style;o=i("transform",n)}r=o}return""==r?e:r+e.charAt(0).toUpperCase()+e.substring(1,e.length)}function i(e,t){if(e in t)return"";e=e.charAt(0).toUpperCase()+e.substring(1,e.length);for(var r=["webkit","ms","Moz","O"],i=0;i<r.length;i++){var n=r[i]+e;if(n in t)return r[i]}return""}var n=function(){function e(){}return e.WEB_AUDIO=2,e.HTML5_AUDIO=3,e}();t.AudioType=n,__reflect(n.prototype,"egret.web.AudioType");var a=function(r){function i(){return r.call(this)||this}return __extends(i,r),i.$init=function(){var r=navigator.userAgent.toLowerCase();i.ua=r,i._canUseBlob=!1;var a=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,o=r.indexOf("iphone")>=0||r.indexOf("ipad")>=0||r.indexOf("ipod")>=0;if(a)try{t.WebAudioDecode.initAudioContext=function(){if(t.WebAudioDecode.ctx)try{t.WebAudioDecode.ctx.close()}catch(e){}t.WebAudioDecode.ctx=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext)},t.WebAudioDecode.initAudioContext()}catch(s){a=!1}var l,c=i._audioType;c==n.WEB_AUDIO&&a||c==n.HTML5_AUDIO?(l=!1,i.setAudioType(c)):!o&&r.indexOf("safari")>=0&&-1===r.indexOf("chrome")?(l=!1,i.setAudioType(n.WEB_AUDIO)):(l=!0,i.setAudioType(n.HTML5_AUDIO)),r.indexOf("android")>=0?l&&a&&i.setAudioType(n.WEB_AUDIO):o&&i.getIOSVersion()>=7&&(i._canUseBlob=!0,l&&a&&i.setAudioType(n.WEB_AUDIO));var h=window.URL||window.webkitURL;h||(i._canUseBlob=!1),r.indexOf("egretnative")>=0&&(i.setAudioType(n.HTML5_AUDIO),i._canUseBlob=!0),e.Sound=i._AudioClass},i.setAudioType=function(t){switch(i._audioType=t,t){case n.WEB_AUDIO:i._AudioClass=e.web.WebAudioSound;break;case n.HTML5_AUDIO:i._AudioClass=e.web.HtmlSound}},i.getIOSVersion=function(){var e=i.ua.toLowerCase().match(/cpu [^\d]*\d.*like mac os x/);if(!e||0==e.length)return 0;var t=e[0];return parseInt(t.match(/\d+(_\d)*/)[0])||0},i._canUseBlob=!1,i._audioType=0,i.ua="",i}(e.HashObject);t.Html5Capatibility=a,__reflect(a.prototype,"egret.web.Html5Capatibility");var o=null;t.getPrefixStyleName=r,t.getPrefix=i}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function r(t,r){var n=i(t,r);return e.pro.egret2dDriveMode&&(e.pro.mainCanvas=n),n}function i(e,t){var r=document.createElement("canvas");return isNaN(e)||isNaN(t)||(r.width=e,r.height=t),r}function n(e,t,r,i){if(e){var n=e,a=n.surface;i?(a.width<t&&(a.width=t),a.height<r&&(a.height=r)):(a.width!==t&&(a.width=t),a.height!==r&&(a.height=r)),n.onResize()}}function a(r){for(var i={antialias:t.WebGLRenderContext.antialias,stencil:!0},n=null,a=["webgl","experimental-webgl"],o=0;o<a.length;++o){try{n=r.getContext(a[o],i)}catch(s){}if(n)break}return n||e.$error(1021),n}function o(e){return e?e.getContext("2d"):null}function s(t,r){var i=t,n=i.context,a=n.createTexture();return a?(a[e.glContext]=n,n.bindTexture(n.TEXTURE_2D,a),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),a[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL]=!0,n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),a):void(i.contextLost=!0)}function l(t,r,i,n){var a=t,o=a.context,s=o.createTexture();return s?(s[e.glContext]=o,o.bindTexture(o.TEXTURE_2D,s),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),s[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL]=!0,o.texImage2D(o.TEXTURE_2D,0,o.RGBA,r,i,0,o.RGBA,o.UNSIGNED_BYTE,n),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),s):(a.contextLost=!0,null)}function c(e,t,r){var i=e,n=i.context;n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,t.texture);var a=3*t.count;return n.drawElements(n.TRIANGLES,a,n.UNSIGNED_SHORT,2*r),a}function h(e,t){return e.measureText(t).width}function u(e,t,r,i){return e(t,r)}function d(e,t,r,i){var n=e,a=n.surface;if(i){var o=!1;a.width<t&&(a.width=t,o=!0),a.height<r&&(a.height=r,o=!0),o||(n.context.globalCompositeOperation="source-over",n.context.setTransform(1,0,0,1,0,0),n.context.globalAlpha=1)}else a.width!=t&&(a.width=t),a.height!=r&&(a.height=r);n.clear()}function f(e,t){return window.FontFace?p(e,t):v(e,t)}function p(t,r){var i=e.sys.fontResourceCache;if(!i||!i[r])return void console.warn("registerFontMapping_WARN: Can not find TTF file:"+r+", please load file first.");var n=i[r],a=new window.FontFace(t,n);document.fonts.add(a),a.load()["catch"](function(e){console.error("loadFontError:",e)})}function v(e,t){var r=document.createElement("style");r.type="text/css",r.textContent='\n            @font-face\n            {\n                font-family:"'+e+'";\n                src:url("'+t+'");\n            }',r.onerror=function(e){console.error("loadFontError:",e)},document.body.appendChild(r)}e.sys.mainCanvas=r,e.sys.createCanvas=i,t.resizeContext=n,e.sys.resizeContext=n,e.sys.getContextWebGL=a,t.getContext2d=o,e.sys.getContext2d=o,e.sys.createTexture=s,e.sys._createTexture=l,e.sys.drawTextureElements=c,e.sys.measureTextWith=h,e.sys.createCanvasRenderBufferSurface=u,e.sys.resizeCanvasRenderBuffer=d,e.Geolocation=e.web.WebGeolocation,e.Motion=e.web.WebMotion,e.sys.registerFontMapping=f}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function r(){if(s)for(var e=document.querySelectorAll(".egret-player"),t=e.length,r=0;t>r;r++){var i=e[r],n=i["egret-player"];n.updateScreenSize()}}function i(r){if(!s){s=!0,r||(r={});var i=navigator.userAgent.toLowerCase();if(i.indexOf("egretnative")>=0&&-1==i.indexOf("egretwebview")&&(e.Capabilities.runtimeType=e.RuntimeType.RUNTIME2),r.pro){e.pro.egret2dDriveMode=!0;try{window.startup?window.startup():console.error("EgretPro.js don't has function:window.startup")}catch(c){console.error(c)}}if(i.indexOf("egretnative")>=0&&e.nativeRender)egret_native.addModuleCallback(function(){if(t.Html5Capatibility.$init(),"webgl"==r.renderMode){var i=r.antialias;t.WebGLRenderContext.antialias=!!i}e.sys.CanvasRenderBuffer=t.CanvasRenderBuffer,n(r.renderMode),egret_native.nrSetRenderMode(2);var s;s=r.canvasScaleFactor?r.canvasScaleFactor:r.calculateCanvasScaleFactor?r.calculateCanvasScaleFactor(e.sys.canvasHitTestBuffer.context):window.devicePixelRatio,e.sys.DisplayList.$canvasScaleFactor=s;var c=e.ticker;a(c),r.screenAdapter?e.sys.screenAdapter=r.screenAdapter:e.sys.screenAdapter||(e.sys.screenAdapter=new e.sys.DefaultScreenAdapter);for(var h=document.querySelectorAll(".egret-player"),u=h.length,d=0;u>d;d++){var f=h[d],p=new t.WebPlayer(f,r);f["egret-player"]=p}window.addEventListener("resize",function(){isNaN(l)&&(l=window.setTimeout(o,300))})},null),egret_native.initNativeRender();else{t.Html5Capatibility._audioType=r.audioType,t.Html5Capatibility.$init();var h=r.renderMode;if("webgl"==h){var u=r.antialias;t.WebGLRenderContext.antialias=!!u}e.sys.CanvasRenderBuffer=t.CanvasRenderBuffer,i.indexOf("egretnative")>=0&&"webgl"!=h&&(e.$warn(1051),h="webgl"),n(h);var d=void 0;if(r.canvasScaleFactor)d=r.canvasScaleFactor;else if(r.calculateCanvasScaleFactor)d=r.calculateCanvasScaleFactor(e.sys.canvasHitTestBuffer.context);else{var f=e.sys.canvasHitTestBuffer.context,p=f.backingStorePixelRatio||f.webkitBackingStorePixelRatio||f.mozBackingStorePixelRatio||f.msBackingStorePixelRatio||f.oBackingStorePixelRatio||f.backingStorePixelRatio||1;d=(window.devicePixelRatio||1)/p}e.sys.DisplayList.$canvasScaleFactor=d;var v=e.ticker;a(v),r.screenAdapter?e.sys.screenAdapter=r.screenAdapter:e.sys.screenAdapter||(e.sys.screenAdapter=new e.sys.DefaultScreenAdapter);for(var g=document.querySelectorAll(".egret-player"),x=g.length,m=0;x>m;m++){var y=g[m],b=new t.WebPlayer(y,r);y["egret-player"]=b}window.addEventListener("resize",function(){isNaN(l)&&(l=window.setTimeout(o,300))})}}}function n(r){"webgl"==r&&e.WebGLUtils.checkCanUseWebGL()?(e.sys.RenderBuffer=t.WebGLRenderBuffer,e.sys.systemRenderer=new t.WebGLRenderer,e.sys.canvasRenderer=new e.CanvasRenderer,e.sys.customHitTestBuffer=new t.WebGLRenderBuffer(3,3),e.sys.canvasHitTestBuffer=new t.CanvasRenderBuffer(3,3),e.Capabilities.renderMode="webgl"):(e.sys.RenderBuffer=t.CanvasRenderBuffer,e.sys.systemRenderer=new e.CanvasRenderer,e.sys.canvasRenderer=e.sys.systemRenderer,e.sys.customHitTestBuffer=new t.CanvasRenderBuffer(3,3),e.sys.canvasHitTestBuffer=e.sys.customHitTestBuffer,e.Capabilities.renderMode="canvas")}function a(e){function t(){r(t),e.update()}var r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;r||(r=function(e){return window.setTimeout(e,1e3/60)}),r(t)}function o(){l=0/0,e.updateAllScreens()}var s=!1;e.sys.setRenderMode=n,window.isNaN=function(e){return e=+e,e!==e},e.runEgret=i,e.updateAllScreens=r;var l=0/0}(t=e.web||(e.web={}))}(egret||(egret={}));var language,egret;!function(e){var t;!function(t){var r=function(){function t(){}return t.detect=function(){var r=e.Capabilities,i=navigator.userAgent.toLowerCase();r.isMobile=-1!=i.indexOf("mobile")||-1!=i.indexOf("android"),r.isMobile?i.indexOf("windows")<0&&(-1!=i.indexOf("iphone")||-1!=i.indexOf("ipad")||-1!=i.indexOf("ipod"))?r.os="iOS":-1!=i.indexOf("android")&&-1!=i.indexOf("linux")?r.os="Android":-1!=i.indexOf("windows")&&(r.os="Windows Phone"):-1!=i.indexOf("windows nt")?r.os="Windows PC":"MacIntel"==navigator.platform&&navigator.maxTouchPoints>1?(r.os="iOS",r.isMobile=!0):-1!=i.indexOf("mac os")&&(r.os="Mac OS");var n=(navigator.language||navigator.browserLanguage).toLowerCase(),a=n.split("-");a.length>1&&(a[1]=a[1].toUpperCase()),r.language=a.join("-"),t.injectUIntFixOnIE9()},t.injectUIntFixOnIE9=function(){if(/msie 9.0/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){var e="<!-- IEBinaryToArray_ByteStr -->\r\n<script type='text/vbscript' language='VBScript'>\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = \"\"\r\n   End If\r\nEnd Function\r\n</script>\r\n<!-- convertResponseBodyToText -->\r\n<script>\r\nlet convertResponseBodyToText = function (binary) {\r\n   let byteMapping = {};\r\n   for ( let i = 0; i < 256; i++ ) {\r\n       for ( let j = 0; j < 256; j++ ) {\r\n           byteMapping[ String.fromCharCode( i + j * 256 ) ] =\r\n           String.fromCharCode(i) + String.fromCharCode(j);\r\n       }\r\n   }\r\n   let rawBytes = IEBinaryToArray_ByteStr(binary);\r\n   let lastChr = IEBinaryToArray_ByteStr_Last(binary);\r\n   return rawBytes.replace(/[\\s\\S]/g,                           function( match ) { return byteMapping[match]; }) + lastChr;\r\n};\r\n</script>\r\n";document.write(e)}},t}();t.WebCapability=r,__reflect(r.prototype,"egret.web.WebCapability"),r.detect()}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(){function t(t,r,i,n,a){if(this.showPanle=!0,this.fpsHeight=0,this.WIDTH=101,this.HEIGHT=20,this.bgCanvasColor="#18304b",this.fpsFrontColor="#18fefe",this.WIDTH_COST=50,this.cost1Color="#18fefe",this.cost3Color="#ff0000",this.arrFps=[],this.arrCost=[],this.arrLog=[],r||i){"canvas"==e.Capabilities.renderMode?this.renderMode="Canvas":this.renderMode="WebGL",this.panelX=void 0===a.x?0:parseInt(a.x),this.panelY=void 0===a.y?0:parseInt(a.y),this.fontColor=void 0===a.textColor?"#ffffff":a.textColor.replace("0x","#"),this.fontSize=void 0===a.size?12:parseInt(a.size),e.Capabilities.isMobile&&(this.fontSize-=2);var o=document.createElement("div");o.style.position="absolute",o.style.background="rgba(0,0,0,"+a.bgAlpha+")",o.style.left=this.panelX+"px",o.style.top=this.panelY+"px",o.style.pointerEvents="none",o.id="egret-fps-panel",document.body.appendChild(o);var s=document.createElement("div");s.style.color=this.fontColor,s.style.fontSize=this.fontSize+"px",s.style.lineHeight=this.fontSize+"px",s.style.margin="4px 4px 4px 4px",this.container=s,o.appendChild(s),r&&this.addFps(),i&&this.addLog()}}return t.prototype.addFps=function(){var e=document.createElement("div");e.style.display="inline-block",this.containerFps=e,this.container.appendChild(e);var t=document.createElement("div");t.style.paddingBottom="2px",this.fps=t,this.containerFps.appendChild(t),t.innerHTML="0 FPS "+this.renderMode+"<br/>min0 max0 avg0";var r=document.createElement("canvas");this.containerFps.appendChild(r),r.width=this.WIDTH,r.height=this.HEIGHT,this.canvasFps=r;var i=r.getContext("2d");this.contextFps=i,i.fillStyle=this.bgCanvasColor,i.fillRect(0,0,this.WIDTH,this.HEIGHT);var n=document.createElement("div");this.divDatas=n,this.containerFps.appendChild(n);var a=document.createElement("div");a.style["float"]="left",a.innerHTML="Draw<br/>Cost",n.appendChild(a);var o=document.createElement("div");o.style.paddingLeft=a.offsetWidth+20+"px",n.appendChild(o);var s=document.createElement("div");this.divDraw=s,s.innerHTML="0<br/>",o.appendChild(s);var l=document.createElement("div");this.divCost=l,l.innerHTML='<font  style="color:'+this.cost1Color+'">0<font/> <font  style="color:'+this.cost3Color+'">0<font/>',o.appendChild(l),r=document.createElement("canvas"),this.canvasCost=r,this.containerFps.appendChild(r),r.width=this.WIDTH,r.height=this.HEIGHT,i=r.getContext("2d"),this.contextCost=i,i.fillStyle=this.bgCanvasColor,i.fillRect(0,0,this.WIDTH,this.HEIGHT),i.fillStyle="#000000",i.fillRect(this.WIDTH_COST,0,1,this.HEIGHT),this.fpsHeight=this.container.offsetHeight},t.prototype.addLog=function(){var e=document.createElement("div");e.style.maxWidth=document.body.clientWidth-8-this.panelX+"px",e.style.wordWrap="break-word",this.log=e,this.container.appendChild(e)},t.prototype.update=function(e,t){void 0===t&&(t=!1);var r,i,n;t?(r=this.arrFps[this.arrFps.length-1],i=this.arrCost[this.arrCost.length-1][0],n=this.arrCost[this.arrCost.length-1][1]):(r=e.fps,i=e.costTicker,n=e.costRender,this.lastNumDraw=e.draw,this.arrFps.push(r),this.arrCost.push([i,n]));var a=0,o=this.arrFps.length;o>101&&(o=101,this.arrFps.shift(),this.arrCost.shift());for(var s=this.arrFps[0],l=this.arrFps[0],c=0;o>c;c++){var h=this.arrFps[c];a+=h,s>h?s=h:h>l&&(l=h)}var u=this.WIDTH,d=this.HEIGHT,f=this.contextFps;f.drawImage(this.canvasFps,1,0,u-1,d,0,0,u-1,d),f.fillStyle=this.bgCanvasColor,f.fillRect(u-1,0,1,d);var p=Math.floor(r/60*20);1>p&&(p=1),f.fillStyle=this.fpsFrontColor,f.fillRect(u-1,20-p,1,p);var v=this.WIDTH_COST;f=this.contextCost,f.drawImage(this.canvasCost,1,0,v-1,d,0,0,v-1,d),f.drawImage(this.canvasCost,v+2,0,v-1,d,v+1,0,v-1,d);var g=Math.floor(i/2);1>g?g=1:g>20&&(g=20);var x=Math.floor(n/2);1>x?x=1:x>20&&(x=20),f.fillStyle=this.bgCanvasColor,f.fillRect(v-1,0,1,d),f.fillRect(2*v,0,1,d),f.fillRect(3*v+1,0,1,d),f.fillStyle=this.cost1Color,f.fillRect(v-1,20-g,1,g),f.fillStyle=this.cost3Color,f.fillRect(2*v,20-x,1,x);var m=Math.floor(a/o),y=r+" FPS "+this.renderMode;this.showPanle&&(y+="<br/>min"+s+" max"+l+" avg"+m,this.divDraw.innerHTML=this.lastNumDraw+"<br/>",this.divCost.innerHTML='<font  style="color:#18fefe">'+i+'<font/> <font  style="color:#ff0000">'+n+"<font/>"),this.fps.innerHTML=y},t.prototype.updateInfo=function(e){this.arrLog.push(e),this.updateLogLayout()},t.prototype.updateWarn=function(e){this.arrLog.push("[Warning]"+e),this.updateLogLayout()},t.prototype.updateError=function(e){this.arrLog.push("[Error]"+e),this.updateLogLayout()},t.prototype.updateLogLayout=function(){for(this.log.innerHTML=this.arrLog.join("<br/>");document.body.clientHeight<this.log.offsetHeight+this.fpsHeight+this.panelY+2*this.fontSize;)this.arrLog.shift(),this.log.innerHTML=this.arrLog.join("<br/>")},t}();t.WebFps=r,__reflect(r.prototype,"egret.web.WebFps",["egret.FPSDisplay"]),e.FPSDisplay=r}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r;!function(r){function i(e){return window.localStorage.getItem(e)}function n(t,r){try{return window.localStorage.setItem(t,r),!0}catch(i){return e.$warn(1047,t,r),!1}}function a(e){window.localStorage.removeItem(e)}function o(){window.localStorage.clear()}t.getItem=i,t.setItem=n,t.removeItem=a,t.clear=o}(r=t.web||(t.web={}))}(t=e.localStorage||(e.localStorage={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(r){function i(e,t){var i=r.call(this)||this;return i.updateAfterTyping=!1,i.init(e,t),i.initOrientation(),i}return __extends(i,r),i.prototype.init=function(r,i){var n=this;console.log("Egret Engine Version:",e.Capabilities.engineVersion);var a=this.readOption(r,i),o=new e.Stage;o.$screen=this,o.$scaleMode=a.scaleMode,o.$orientation=a.orientation,o.$maxTouches=a.maxTouches,o.frameRate=a.frameRate,o.textureScaleFactor=a.textureScaleFactor;var s=new e.sys.RenderBuffer(void 0,void 0,!0),l=s.surface;this.attachCanvas(r,l);var c=new t.WebTouchHandler(o,l),h=new e.sys.Player(s,o,a.entryClassName);e.lifecycle.stage=o,e.lifecycle.addLifecycleListener(t.WebLifeCycleHandler);var u=new t.HTMLInput;(a.showFPS||a.showLog)&&(e.nativeRender||h.displayFPS(a.showFPS,a.showLog,a.logFilter,a.fpsStyles)),this.playerOption=a,this.container=r,this.canvas=l,this.stage=o,this.player=h,this.webTouchHandler=c,this.webInput=u,u.finishUserTyping=function(){n.updateAfterTyping&&setTimeout(function(){n.updateScreenSize(),n.updateAfterTyping=!1},300)},e.web.$cacheTextAdapter(u,o,r,l),this.updateScreenSize(),this.updateMaxTouches(),h.start()},i.prototype.initOrientation=function(){var t=this;window.addEventListener("orientationchange",function(){window.setTimeout(function(){e.StageOrientationEvent.dispatchStageOrientationEvent(t.stage,e.StageOrientationEvent.ORIENTATION_CHANGE)},350)})},i.prototype.readOption=function(t,r){var i={};i.entryClassName=t.getAttribute("data-entry-class"),i.scaleMode=t.getAttribute("data-scale-mode")||e.StageScaleMode.NO_SCALE,i.frameRate=+t.getAttribute("data-frame-rate")||30,i.contentWidth=+t.getAttribute("data-content-width")||480,i.contentHeight=+t.getAttribute("data-content-height")||800,i.orientation=t.getAttribute("data-orientation")||e.OrientationMode.AUTO,i.maxTouches=+t.getAttribute("data-multi-fingered")||2,i.textureScaleFactor=+t.getAttribute("texture-scale-factor")||1,i.showFPS="true"==t.getAttribute("data-show-fps");for(var n=t.getAttribute("data-show-fps-style")||"",a=n.split(","),o={},s=0;s<a.length;s++){var l=a[s].split(":");o[l[0]]=l[1]}return i.fpsStyles=o,i.showLog="true"==t.getAttribute("data-show-log"),i.logFilter=t.getAttribute("data-log-filter"),i},i.prototype.attachCanvas=function(e,t){var r=t.style;r.cursor="inherit",r.position="absolute",r.top="0",r.bottom="0",r.left="0",r.right="0",e.appendChild(t),r=e.style,r.overflow="hidden",r.position="absolute"},i.prototype.updateScreenSize=function(){var t=this.canvas;if(t.userTyping)return void(this.updateAfterTyping=!0);var r=this.playerOption,i=this.container.getBoundingClientRect(),n=0,a=i.width,o=i.height;if(0!=a&&0!=o){i.top<0&&(o+=i.top,n=-i.top);var s=!1,l=this.stage.$orientation;l!=e.OrientationMode.AUTO&&(s=l!=e.OrientationMode.PORTRAIT&&o>a||l==e.OrientationMode.PORTRAIT&&a>o);var c=s?o:a,h=s?a:o;e.Capabilities.boundingClientWidth=c,e.Capabilities.boundingClientHeight=h;var u=e.sys.screenAdapter.calculateStageSize(this.stage.$scaleMode,c,h,r.contentWidth,r.contentHeight),d=u.stageWidth,f=u.stageHeight,p=u.displayWidth,v=u.displayHeight;t.style[e.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",t.width!=d&&(t.width=d),t.height!=f&&(t.height=f);var g=0;s?l==e.OrientationMode.LANDSCAPE?(g=90,t.style.top=n+(o-p)/2+"px",t.style.left=(a+v)/2+"px"):(g=-90,t.style.top=n+(o+p)/2+"px",t.style.left=(a-v)/2+"px"):(t.style.top=n+(o-v)/2+"px",t.style.left=(a-p)/2+"px");var x=p/d,m=v/f,y=x*e.sys.DisplayList.$canvasScaleFactor,b=m*e.sys.DisplayList.$canvasScaleFactor;y=Math.ceil(y),b=Math.ceil(b);var w=e.Matrix.create();w.identity(),w.scale(x/y,m/b),w.rotate(g*Math.PI/180);var T="matrix("+w.a+","+w.b+","+w.c+","+w.d+","+w.tx+","+w.ty+")";e.Matrix.release(w),t.style[e.web.getPrefixStyleName("transform")]=T,e.sys.DisplayList.$setCanvasScale(y,b),this.webTouchHandler.updateScaleMode(x,m,g),this.webInput.$updateSize(),this.player.updateStageSize(d,f),e.nativeRender&&(t.width=d*y,t.height=f*b)}},i.prototype.setContentSize=function(e,t){var r=this.playerOption;r.contentWidth=e,r.contentHeight=t,this.updateScreenSize()},i.prototype.updateMaxTouches=function(){this.webTouchHandler.$updateMaxTouches()},i}(e.HashObject);t.WebPlayer=r,__reflect(r.prototype,"egret.web.WebPlayer",["egret.sys.Screen"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function r(t,r){s||(s=e.sys.createCanvas(),l=s.getContext("2d"));var i=t.$getTextureWidth(),n=t.$getTextureHeight();null==r&&(r=e.$TempRectangle,r.x=0,r.y=0,r.width=i,r.height=n),r.x=Math.min(r.x,i-1),r.y=Math.min(r.y,n-1),r.width=Math.min(r.width,i-r.x),r.height=Math.min(r.height,n-r.y);var a=r.width,o=r.height,c=s;if(c.style.width=a+"px",c.style.height=o+"px",s.width=a,s.height=o,"webgl"==e.Capabilities.renderMode){var h=void 0;t.$renderBuffer?h=t:(e.sys.systemRenderer.renderClear&&e.sys.systemRenderer.renderClear(),h=new e.RenderTexture,h.drawToTexture(new e.Bitmap(t)));for(var u=h.$renderBuffer.getPixels(r.x,r.y,a,o),d=new ImageData(a,o),f=0;f<u.length;f++)d.data[f]=u[f];return l.putImageData(d,0,0),t.$renderBuffer||h.dispose(),c}var p=t,v=Math.round(p.$offsetX),g=Math.round(p.$offsetY),x=p.$bitmapWidth,m=p.$bitmapHeight;return l.drawImage(p.$bitmapData.source,p.$bitmapX+r.x/e.$TextureScaleFactor,p.$bitmapY+r.y/e.$TextureScaleFactor,x*r.width/i,m*r.height/n,v,g,r.width,r.height),c}function i(t,i,n){try{var a=r(this,i),o=a.toDataURL(t,n);return o}catch(s){e.$error(1033)}return null}function n(e,t,r,n){var a=i.call(this,e,r,n);if(null!=a){var o=a.replace(/^data:image[^;]*/,"data:image/octet-stream"),s=document.createElement("a");s.download=t,s.href=o;var l=document.createEvent("MouseEvents");l.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),s.dispatchEvent(l)}}function a(t,r){return e.$warn(1041,"getPixel32","getPixels"),this.getPixels(t,r)}function o(t,i,n,a){if(void 0===n&&(n=1),void 0===a&&(a=1),"webgl"==e.Capabilities.renderMode){var o=void 0;this.$renderBuffer?o=this:(o=new e.RenderTexture,o.drawToTexture(new e.Bitmap(this)));var s=o.$renderBuffer.getPixels(t,i,n,a);return s}try{var c=(r(this),l.getImageData(t,i,n,a).data);return c}catch(h){e.$error(1039)}}var s,l;e.Texture.prototype.toDataURL=i,e.Texture.prototype.saveToFile=n,e.Texture.prototype.getPixel32=a,e.Texture.prototype.getPixels=o}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function r(e){for(var t=s.parseFromString(e,"text/xml"),r=t.childNodes.length,n=0;r>n;n++){var a=t.childNodes[n];if(1==a.nodeType)return i(a,null)}return null}function i(e,t){if("parsererror"==e.localName)throw new Error(e.textContent);for(var r=new a(e.localName,t,e.prefix,e.namespaceURI,e.nodeName),n=e.attributes,s=r.attributes,l=n.length,c=0;l>c;c++){var h=n[c],u=h.name;0!=u.indexOf("xmlns:")&&(s[u]=h.value,r["$"+u]=h.value)}var d=e.childNodes;l=d.length;for(var f=r.children,c=0;l>c;c++){var p=d[c],v=p.nodeType,g=null;if(1==v)g=i(p,r);else if(3==v){var x=p.textContent.trim();x&&(g=new o(x,r))}g&&f.push(g)}return r}var n=function(){function e(e,t){this.nodeType=e,this.parent=t}return e}();t.XMLNode=n,__reflect(n.prototype,"egret.web.XMLNode");var a=function(e){function t(t,r,i,n,a){var o=e.call(this,1,r)||this;return o.attributes={},o.children=[],o.localName=t,o.prefix=i,o.namespace=n,o.name=a,o}return __extends(t,e),t}(n);t.XML=a,__reflect(a.prototype,"egret.web.XML");var o=function(e){function t(t,r){var i=e.call(this,3,r)||this;return i.text=t,i}return __extends(t,e),t}(n);t.XMLText=o,__reflect(o.prototype,"egret.web.XMLText");var s=new DOMParser;e.XML={parse:r}}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(t){function r(){var r=null!==t&&t.apply(this,arguments)||this;return r.onChange=function(t){var i=new e.OrientationEvent(e.Event.CHANGE);i.beta=t.beta,i.gamma=t.gamma,i.alpha=t.alpha,r.dispatchEvent(i)},r}return __extends(r,t),r.prototype.start=function(){window.addEventListener("deviceorientation",this.onChange)},r.prototype.stop=function(){window.removeEventListener("deviceorientation",this.onChange)},r}(e.EventDispatcher);t.WebDeviceOrientation=r,__reflect(r.prototype,"egret.web.WebDeviceOrientation",["egret.DeviceOrientation"])}(t=e.web||(e.web={}))}(egret||(egret={})),egret.DeviceOrientation=egret.web.WebDeviceOrientation;var egret;!function(e){var t;!function(t){var r=function(){function e(){}return e.call=function(e,t){},e.addCallback=function(e,t){},e}();t.WebExternalInterface=r,__reflect(r.prototype,"egret.web.WebExternalInterface",["egret.ExternalInterface"]);var i=navigator.userAgent.toLowerCase();i.indexOf("egretnative")<0&&(e.ExternalInterface=r)}(t=e.web||(e.web={}))}(egret||(egret={})),function(e){var t;!function(t){function r(t){var r=JSON.parse(t),n=r.functionName,a=i[n];if(a){var o=r.value;a.call(null,o)}else e.$warn(1050,n)}var i={},n=function(){function e(){}return e.call=function(e,t){var r={};r.functionName=e,r.value=t,egret_native.sendInfoToPlugin(JSON.stringify(r))},e.addCallback=function(e,t){i[e]=t},e}();t.NativeExternalInterface=n,__reflect(n.prototype,"egret.web.NativeExternalInterface",["egret.ExternalInterface"]);
var a=navigator.userAgent.toLowerCase();a.indexOf("egretnative")>=0&&(e.ExternalInterface=n,egret_native.receivedPluginInfo=r)}(t=e.web||(e.web={}))}(egret||(egret={})),function(e){var t;!function(t){var r={},i=function(){function t(){}return t.call=function(e,t){__global.ExternalInterface.call(e,t)},t.addCallback=function(e,t){r[e]=t},t.invokeCallback=function(t,i){var n=r[t];n?n.call(null,i):e.$warn(1050,t)},t}();t.WebViewExternalInterface=i,__reflect(i.prototype,"egret.web.WebViewExternalInterface",["egret.ExternalInterface"]);var n=navigator.userAgent.toLowerCase();n.indexOf("egretwebview")>=0&&(e.ExternalInterface=i)}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(r){function i(){var e=r.call(this)||this;return e.loaded=!1,e}return __extends(i,r),Object.defineProperty(i.prototype,"length",{get:function(){if(this.originAudio)return this.originAudio.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),i.prototype.load=function(t){function r(){delete i.loadingSoundMap[t],i.$recycle(o.url,s),a(),l.indexOf("firefox")>=0&&(s.pause(),s.muted=!1),c&&document.body.appendChild(s),o.loaded=!0,o.dispatchEventWith(e.Event.COMPLETE)}function n(){a(),o.dispatchEventWith(e.IOErrorEvent.IO_ERROR)}function a(){s.removeEventListener("canplaythrough",r),s.removeEventListener("error",n),c&&document.body.removeChild(s)}var o=this;this.url=t;var s=new Audio(t);s.addEventListener("canplaythrough",r),s.addEventListener("error",n);var l=navigator.userAgent.toLowerCase();l.indexOf("firefox")>=0&&(s.autoplay=!0,s.muted=!0);var c=l.indexOf("edge")>=0||l.indexOf("trident")>=0;c&&document.body.appendChild(s),s.load(),i.loadingSoundMap[t]=s,this.originAudio=s,i.clearAudios[this.url]&&delete i.clearAudios[this.url]},i.prototype.play=function(r,n){r=+r||0,n=+n||0;var a=i.$pop(this.url);null==a&&(a=this.originAudio.cloneNode()),a.autoplay=!0;var o=new t.HtmlSoundChannel(a);return o.$url=this.url,o.$loops=n,o.$startTime=r,o.$play(),e.sys.$pushSoundChannel(o),o},i.prototype.close=function(){this.loaded&&this.originAudio&&(this.originAudio.src=""),this.originAudio&&(this.originAudio=null),i.$clear(this.url),this.loaded=!1},i.$clear=function(e){i.clearAudios[e]=!0;var t=i.audios[e];t&&(t.length=0)},i.$pop=function(e){var t=i.audios[e];return t&&t.length>0?t.pop():null},i.$recycle=function(e,t){if(!i.clearAudios[e]){var r=i.audios[e];null==i.audios[e]&&(r=i.audios[e]=[]),r.push(t)}},i.MUSIC="music",i.EFFECT="effect",i.loadingSoundMap={},i.audios={},i.clearAudios={},i}(e.EventDispatcher);t.HtmlSound=r,__reflect(r.prototype,"egret.web.HtmlSound",["egret.Sound"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(e){}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(e){var t=function(){function e(){this.drawData=[],this.drawDataLen=0}return e.prototype.pushDrawRect=function(){if(0==this.drawDataLen||1!=this.drawData[this.drawDataLen-1].type){var e=this.drawData[this.drawDataLen]||{};e.type=1,e.count=0,this.drawData[this.drawDataLen]=e,this.drawDataLen++}this.drawData[this.drawDataLen-1].count+=2},e.prototype.pushDrawTexture=function(e,t,r,i,n){if(void 0===t&&(t=2),r){var a=this.drawData[this.drawDataLen]||{};a.type=0,a.texture=e,a.filter=r,a.count=t,a.textureWidth=i,a.textureHeight=n,this.drawData[this.drawDataLen]=a,this.drawDataLen++}else{if(0==this.drawDataLen||0!=this.drawData[this.drawDataLen-1].type||e!=this.drawData[this.drawDataLen-1].texture||this.drawData[this.drawDataLen-1].filter){var a=this.drawData[this.drawDataLen]||{};a.type=0,a.texture=e,a.count=0,this.drawData[this.drawDataLen]=a,this.drawDataLen++}this.drawData[this.drawDataLen-1].count+=t}},e.prototype.pushChangeSmoothing=function(e,t){e.smoothing=t;var r=this.drawData[this.drawDataLen]||{};r.type=10,r.texture=e,r.smoothing=t,this.drawData[this.drawDataLen]=r,this.drawDataLen++},e.prototype.pushPushMask=function(e){void 0===e&&(e=1);var t=this.drawData[this.drawDataLen]||{};t.type=2,t.count=2*e,this.drawData[this.drawDataLen]=t,this.drawDataLen++},e.prototype.pushPopMask=function(e){void 0===e&&(e=1);var t=this.drawData[this.drawDataLen]||{};t.type=3,t.count=2*e,this.drawData[this.drawDataLen]=t,this.drawDataLen++},e.prototype.pushSetBlend=function(e){for(var t=this.drawDataLen,r=!1,i=t-1;i>=0;i--){var n=this.drawData[i];if(n){if((0==n.type||1==n.type)&&(r=!0),!r&&4==n.type){this.drawData.splice(i,1),this.drawDataLen--;continue}if(4==n.type){if(n.value==e)return;break}}}var a=this.drawData[this.drawDataLen]||{};a.type=4,a.value=e,this.drawData[this.drawDataLen]=a,this.drawDataLen++},e.prototype.pushResize=function(e,t,r){var i=this.drawData[this.drawDataLen]||{};i.type=5,i.buffer=e,i.width=t,i.height=r,this.drawData[this.drawDataLen]=i,this.drawDataLen++},e.prototype.pushClearColor=function(){var e=this.drawData[this.drawDataLen]||{};e.type=6,this.drawData[this.drawDataLen]=e,this.drawDataLen++},e.prototype.pushActivateBuffer=function(e){for(var t=this.drawDataLen,r=!1,i=t-1;i>=0;i--){var n=this.drawData[i];!n||(4!=n.type&&7!=n.type&&(r=!0),r||7!=n.type)||(this.drawData.splice(i,1),this.drawDataLen--)}var a=this.drawData[this.drawDataLen]||{};a.type=7,a.buffer=e,a.width=e.rootRenderTarget.width,a.height=e.rootRenderTarget.height,this.drawData[this.drawDataLen]=a,this.drawDataLen++},e.prototype.pushEnableScissor=function(e,t,r,i){var n=this.drawData[this.drawDataLen]||{};n.type=8,n.x=e,n.y=t,n.width=r,n.height=i,this.drawData[this.drawDataLen]=n,this.drawDataLen++},e.prototype.pushDisableScissor=function(){var e=this.drawData[this.drawDataLen]||{};e.type=9,this.drawData[this.drawDataLen]=e,this.drawDataLen++},e.prototype.clear=function(){for(var e=0;e<this.drawDataLen;e++){var t=this.drawData[e];t.type=0,t.count=0,t.texture=null,t.filter=null,t.value="",t.buffer=null,t.width=0,t.height=0,t.textureWidth=0,t.textureHeight=0,t.smoothing=!1,t.x=0,t.y=0}this.drawDataLen=0},e}();e.WebGLDrawCmdManager=t,__reflect(t.prototype,"egret.web.WebGLDrawCmdManager")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function r(){return e.Capabilities.runtimeType==e.RuntimeType.WEB&&"iOS"==e.Capabilities.os&&e.Capabilities.isMobile&&/iPhone OS 14/.test(window.navigator.userAgent)}var i=function(){function t(){this.vertSize=5,this.vertByteSize=4*this.vertSize,this.maxQuadsCount=2048,this.maxVertexCount=4*this.maxQuadsCount,this.maxIndicesCount=6*this.maxQuadsCount,this.vertices=null,this.indices=null,this.indicesForMesh=null,this.vertexIndex=0,this.indexIndex=0,this.hasMesh=!1,this._vertices=null,this._verticesFloat32View=null,this._verticesUint32View=null;var e=this.maxVertexCount*this.vertSize;this.vertices=new Float32Array(e),this._vertices=new ArrayBuffer(this.maxVertexCount*this.vertByteSize),this._verticesFloat32View=new Float32Array(this._vertices),this._verticesUint32View=new Uint32Array(this._vertices),this.vertices=this._verticesFloat32View;var t=this.maxIndicesCount;this.indices=new Uint16Array(t),this.indicesForMesh=new Uint16Array(t);for(var r=0,i=0;t>r;r+=6,i+=4)this.indices[r+0]=i+0,this.indices[r+1]=i+1,this.indices[r+2]=i+2,this.indices[r+3]=i+0,this.indices[r+4]=i+2,this.indices[r+5]=i+3}return t.prototype.reachMaxSize=function(e,t){return void 0===e&&(e=4),void 0===t&&(t=6),this.vertexIndex>this.maxVertexCount-e||this.indexIndex>this.maxIndicesCount-t},t.prototype.getVertices=function(){var e=this.vertices.subarray(0,this.vertexIndex*this.vertSize);return e},t.prototype.getIndices=function(){return this.indices},t.prototype.getMeshIndices=function(){return this.indicesForMesh},t.prototype.changeToMeshIndices=function(){if(!this.hasMesh){for(var e=0,t=this.indexIndex;t>e;++e)this.indicesForMesh[e]=this.indices[e];this.hasMesh=!0}},t.prototype.isMesh=function(){return this.hasMesh},t.prototype.cacheArrays=function(t,i,n,a,o,s,l,c,h,u,d,f,p,v,g){var x=t.globalAlpha;x=Math.min(x,1);var m=t.globalTintColor||16777215,y=t.currentTexture;x=1>x&&y&&y[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL]?e.WebGLUtils.premultiplyTint(m,x):m+(255*x<<24);var b=t.globalMatrix,w=b.a,T=b.b,E=b.c,_=b.d,C=b.tx,S=b.ty,R=t.$offsetX,L=t.$offsetY;if((0!=R||0!=L)&&(C=R*w+L*E+C,S=R*T+L*_+S),!p){(0!=s||0!=l)&&(C=s*w+l*E+C,S=s*T+l*_+S);var D=c/a;1!=D&&(w=D*w,T=D*T);var A=h/o;1!=A&&(E=A*E,_=A*_)}if(p)if(r()){var I=[],$=this.vertices,M=this._verticesUint32View,B=this.vertexIndex*this.vertSize,O=0,P=0,W=0,F=0,G=0,k=0,H=0;for(O=0,W=f.length;W>O;O+=2)P=B+5*O/2,k=p[O],H=p[O+1],F=f[O],G=f[O+1],g?I.push([w*k+E*H+C,T*k+_*H+S,(i+(1-G)*o)/u,(n+F*a)/d]):I.push([w*k+E*H+C,T*k+_*H+S,(i+F*a)/u,(n+G*o)/d]),M[P+4]=x;for(var U=0;U<v.length;U+=3){var N=I[v[U]];$[B++]=N[0],$[B++]=N[1],$[B++]=N[2],$[B++]=N[3],M[B++]=x;var X=I[v[U+1]];$[B++]=X[0],$[B++]=X[1],$[B++]=X[2],$[B++]=X[3],M[B++]=x;var z=I[v[U+2]];$[B++]=z[0],$[B++]=z[1],$[B++]=z[2],$[B++]=z[3],M[B++]=x,$[B++]=z[0],$[B++]=z[1],$[B++]=z[2],$[B++]=z[3],M[B++]=x}var Y=v.length/3;this.vertexIndex+=4*Y,this.indexIndex+=6*Y}else{var $=this.vertices,M=this._verticesUint32View,B=this.vertexIndex*this.vertSize,O=0,P=0,W=0,F=0,G=0,k=0,H=0;for(O=0,W=f.length;W>O;O+=2)P=B+5*O/2,k=p[O],H=p[O+1],F=f[O],G=f[O+1],$[P+0]=w*k+E*H+C,$[P+1]=T*k+_*H+S,g?($[P+2]=(i+(1-G)*o)/u,$[P+3]=(n+F*a)/d):($[P+2]=(i+F*a)/u,$[P+3]=(n+G*o)/d),M[P+4]=x;if(this.hasMesh)for(var V=0,j=v.length;j>V;++V)this.indicesForMesh[this.indexIndex+V]=v[V]+this.vertexIndex;this.vertexIndex+=f.length/2,this.indexIndex+=v.length}else{var q=u,K=d,Q=a,J=o;i/=q,n/=K;var $=this.vertices,M=this._verticesUint32View,B=this.vertexIndex*this.vertSize;if(g){var Z=a;a=o/q,o=Z/K,$[B++]=C,$[B++]=S,$[B++]=a+i,$[B++]=n,M[B++]=x,$[B++]=w*Q+C,$[B++]=T*Q+S,$[B++]=a+i,$[B++]=o+n,M[B++]=x,$[B++]=w*Q+E*J+C,$[B++]=_*J+T*Q+S,$[B++]=i,$[B++]=o+n,M[B++]=x,$[B++]=E*J+C,$[B++]=_*J+S,$[B++]=i,$[B++]=n,M[B++]=x}else a/=q,o/=K,$[B++]=C,$[B++]=S,$[B++]=i,$[B++]=n,M[B++]=x,$[B++]=w*Q+C,$[B++]=T*Q+S,$[B++]=a+i,$[B++]=n,M[B++]=x,$[B++]=w*Q+E*J+C,$[B++]=_*J+T*Q+S,$[B++]=a+i,$[B++]=o+n,M[B++]=x,$[B++]=E*J+C,$[B++]=_*J+S,$[B++]=i,$[B++]=o+n,M[B++]=x;if(this.hasMesh){var et=this.indicesForMesh;et[this.indexIndex+0]=0+this.vertexIndex,et[this.indexIndex+1]=1+this.vertexIndex,et[this.indexIndex+2]=2+this.vertexIndex,et[this.indexIndex+3]=0+this.vertexIndex,et[this.indexIndex+4]=2+this.vertexIndex,et[this.indexIndex+5]=3+this.vertexIndex}this.vertexIndex+=4,this.indexIndex+=6}},t.prototype.clear=function(){this.hasMesh=!1,this.vertexIndex=0,this.indexIndex=0},t}();t.WebGLVertexArrayObject=i,__reflect(i.prototype,"egret.web.WebGLVertexArrayObject"),t.isIOS14Device=r}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(r){function i(e,t,i){var n=r.call(this)||this;return n.clearColor=[0,0,0,0],n.useFrameBuffer=!0,n.gl=e,n._resize(t,i),n}return __extends(i,r),i.prototype._resize=function(e,t){e=e||1,t=t||1,1>e&&(e=1),1>t&&(t=1),this.width=e,this.height=t},i.prototype.resize=function(e,t){this._resize(e,t);var r=this.gl;this.frameBuffer&&(r.bindTexture(r.TEXTURE_2D,this.texture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.width,this.height,0,r.RGBA,r.UNSIGNED_BYTE,null)),this.stencilBuffer&&(r.deleteRenderbuffer(this.stencilBuffer),this.stencilBuffer=null)},i.prototype.activate=function(){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.getFrameBuffer())},i.prototype.getFrameBuffer=function(){return this.useFrameBuffer?this.frameBuffer:null},i.prototype.initFrameBuffer=function(){if(!this.frameBuffer){var e=this.gl;this.texture=this.createTexture(),this.frameBuffer=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture,0)}},i.prototype.createTexture=function(){var r=t.WebGLRenderContext.getInstance(0,0);return e.sys._createTexture(r,this.width,this.height,null)},i.prototype.clear=function(e){var t=this.gl;e&&this.activate(),t.colorMask(!0,!0,!0,!0),t.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),t.clear(t.COLOR_BUFFER_BIT)},i.prototype.enabledStencil=function(){if(this.frameBuffer&&!this.stencilBuffer){var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer),this.stencilBuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this.stencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,this.width,this.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,this.stencilBuffer)}},i.prototype.dispose=function(){e.WebGLUtils.deleteWebGLTexture(this.texture)},i}(e.HashObject);t.WebGLRenderTarget=r,__reflect(r.prototype,"egret.web.WebGLRenderTarget")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r={},i=function(){function i(r,i,n){if(this._defaultEmptyTexture=null,this.glID=null,this.projectionX=0/0,this.projectionY=0/0,this.contextLost=!1,this._supportedCompressedTextureInfo=[],this.$scissorState=!1,this.vertSize=5,this.$beforeRender=function(){var e=this.context;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),e.disable(e.STENCIL_TEST),e.colorMask(!0,!0,!0,!0),this.setBlendMode("source-over"),e.activeTexture(e.TEXTURE0),this.currentProgram=null},this.surface=e.sys.mainCanvas(r,i),!e.nativeRender){this.initWebGL(n),this.getSupportedCompressedTexture(),this.$bufferStack=[];var a=this.context;this.vertexBuffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.drawCmdManager=new t.WebGLDrawCmdManager,this.vao=new t.WebGLVertexArrayObject,this.setGlobalCompositeOperation("source-over")}}return i.getInstance=function(e,t,r){return this.instance?this.instance:(this.instance=new i(e,t,r),this.instance)},i.prototype.pushBuffer=function(e){this.$bufferStack.push(e),e!=this.currentBuffer&&(this.currentBuffer,this.drawCmdManager.pushActivateBuffer(e)),this.currentBuffer=e},i.prototype.popBuffer=function(){if(!(this.$bufferStack.length<=1)){var e=this.$bufferStack.pop(),t=this.$bufferStack[this.$bufferStack.length-1];e!=t&&this.drawCmdManager.pushActivateBuffer(t),this.currentBuffer=t}},i.prototype.activateBuffer=function(e,t,r){e.rootRenderTarget.activate(),this.bindIndices||this.uploadIndicesArray(this.vao.getIndices()),e.restoreStencil(),e.restoreScissor(),this.onResize(t,r)},i.prototype.uploadVerticesArray=function(e){var t=this.context;t.bufferData(t.ARRAY_BUFFER,e,t.STREAM_DRAW)},i.prototype.uploadIndicesArray=function(e){var t=this.context;t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW),this.bindIndices=!0},i.prototype.destroy=function(){this.surface.width=this.surface.height=0},i.prototype.onResize=function(e,t){e=e||this.surface.width,t=t||this.surface.height,this.projectionX=e/2,this.projectionY=-t/2,this.context&&this.context.viewport(0,0,e,t)},i.prototype.resize=function(t,r,i){e.sys.resizeContext(this,t,r,i)},i.prototype._buildSupportedCompressedTextureInfo=function(e){for(var t=[],r=0,i=e;r<i.length;r++){var n=i[r];if(n){var a={extensionName:n.name,supportedFormats:[]};for(var o in n)a.supportedFormats.push([o,n[o]]);var o;t.push(a)}}return t},i.prototype.initWebGL=function(e){this.onResize(),this.surface.addEventListener("webglcontextlost",this.handleContextLost.bind(this),!1),this.surface.addEventListener("webglcontextrestored",this.handleContextRestored.bind(this),!1),e?this.setContext(e):this.getWebGLContext();var t=this.context;this.$maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)},i.prototype.getSupportedCompressedTexture=function(){var t=this.context?this.context:e.sys.getContextWebGL(this.surface);this.pvrtc=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),this.pvrtc&&(this.pvrtc.name="WEBGL_compressed_texture_pvrtc"),this.etc1=t.getExtension("WEBGL_compressed_texture_etc1")||t.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"),this.etc1&&(this.etc1.name="WEBGL_compressed_texture_etc1"),e.Capabilities._supportedCompressedTexture?(e.Capabilities._supportedCompressedTexture=e.Capabilities._supportedCompressedTexture||{},e.Capabilities._supportedCompressedTexture.pvrtc=!!this.pvrtc,e.Capabilities._supportedCompressedTexture.etc1=!!this.etc1):(e.Capabilities.supportedCompressedTexture=e.Capabilities._supportedCompressedTexture||{},e.Capabilities.supportedCompressedTexture.pvrtc=!!this.pvrtc,e.Capabilities.supportedCompressedTexture.etc1=!!this.etc1),this._supportedCompressedTextureInfo=this._buildSupportedCompressedTextureInfo([this.etc1,this.pvrtc])},i.prototype.handleContextLost=function(){this.contextLost=!0},i.prototype.handleContextRestored=function(){this.initWebGL(),this.contextLost=!1},i.prototype.getWebGLContext=function(){var t=e.sys.getContextWebGL(this.surface);return this.setContext(t),t},i.prototype.setContext=function(e){this.context=e,e.id=i.glContextId++,this.glID=e.id,e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),e.colorMask(!0,!0,!0,!0),e.activeTexture(e.TEXTURE0)},i.prototype.enableStencilTest=function(){var e=this.context;e.enable(e.STENCIL_TEST)},i.prototype.disableStencilTest=function(){var e=this.context;e.disable(e.STENCIL_TEST)},i.prototype.enableScissorTest=function(e){var t=this.context;t.enable(t.SCISSOR_TEST),t.scissor(e.x,e.y,e.width,e.height)},i.prototype.disableScissorTest=function(){var e=this.context;e.disable(e.SCISSOR_TEST)},i.prototype.getPixels=function(e,t,r,i,n){var a=this.context;a.readPixels(e,t,r,i,a.RGBA,a.UNSIGNED_BYTE,n)},i.prototype.createTexture=function(t){return e.sys.createTexture(this,t)},i.prototype.checkCompressedTextureInternalFormat=function(e,t){for(var r=0,i=e.length;i>r;++r)for(var n=e[r],a=n.supportedFormats,o=0,s=a.length;s>o;++o)if(a[o][1]===t)return!0;return!1},i.prototype.$debugLogCompressedTextureNotSupported=function(t,i){if(!r[i]){r[i]=!0,e.log("internalFormat = "+i+":0x"+i.toString(16)+", the current hardware does not support the corresponding compression format.");for(var n=0,a=t.length;a>n;++n){var o=t[n];if(o.supportedFormats.length>0){e.log("support = "+o.extensionName);for(var s=0,l=o.supportedFormats.length;l>s;++s){var c=o.supportedFormats[s];e.log(c[0]+" : "+c[1]+" : 0x"+c[1].toString(16))}}}}},i.prototype.createCompressedTexture=function(t,r,i,n,a){var o=this.checkCompressedTextureInternalFormat(this._supportedCompressedTextureInfo,a);if(!o)return this.$debugLogCompressedTextureNotSupported(this._supportedCompressedTextureInfo,a),this.defaultEmptyTexture;var s=this.context,l=s.createTexture();return l?(l[e.glContext]=s,l[e.is_compressed_texture]=!0,s.bindTexture(s.TEXTURE_2D,l),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),l[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL]=!0,s.compressedTexImage2D(s.TEXTURE_2D,n,a,r,i,0,t),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.bindTexture(s.TEXTURE_2D,null),l):void(this.contextLost=!0)},i.prototype.updateTexture=function(e,t){var r=this.context;r.bindTexture(r.TEXTURE_2D,e),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t)},Object.defineProperty(i.prototype,"defaultEmptyTexture",{get:function(){if(!this._defaultEmptyTexture){var t=16,r=e.sys.createCanvas(t,t),i=e.sys.getContext2d(r);i.fillStyle="white",i.fillRect(0,0,t,t),this._defaultEmptyTexture=this.createTexture(r),this._defaultEmptyTexture[e.engine_default_empty_texture]=!0}return this._defaultEmptyTexture},enumerable:!0,configurable:!0}),i.prototype.getWebGLTexture=function(t){if(!t.webGLTexture){if("image"!=t.format||t.hasCompressed2d()){if(t.hasCompressed2d()){var r=t.getCompressed2dTextureData();t.webGLTexture=this.createCompressedTexture(r.byteArray,r.width,r.height,r.level,r.glInternalFormat);var i=t.etcAlphaMask;if(i){var n=this.getWebGLTexture(i);n&&(t.webGLTexture[e.etc_alpha_mask]=n)}}}else t.webGLTexture=this.createTexture(t.source);t.$deleteSource&&t.webGLTexture&&(t.source&&(t.source.src="",t.source=null),t.clearCompressedTextureData()),t.webGLTexture&&(t.webGLTexture.smoothing=!0)}return t.webGLTexture},i.prototype.clearRect=function(e,t,r,i){if(0!=e||0!=t||r!=this.surface.width||i!=this.surface.height){var n=this.currentBuffer;if(n.$hasScissor)this.setGlobalCompositeOperation("destination-out"),this.drawRect(e,t,r,i),this.setGlobalCompositeOperation("source-over");else{var a=n.globalMatrix;0==a.b&&0==a.c?(e=e*a.a+a.tx,t=t*a.d+a.ty,r*=a.a,i*=a.d,this.enableScissor(e,-t-i+n.height,r,i),this.clear(),this.disableScissor()):(this.setGlobalCompositeOperation("destination-out"),this.drawRect(e,t,r,i),this.setGlobalCompositeOperation("source-over"))}}else this.clear()},i.prototype.setGlobalCompositeOperation=function(e){this.drawCmdManager.pushSetBlend(e)},i.prototype.drawImage=function(e,t,r,i,n,a,o,s,l,c,h,u,d){var f=this.currentBuffer;if(!this.contextLost&&e&&f){var p,v,g;if(e.texture||e.source&&e.source.texture)p=e.texture||e.source.texture,f.saveTransform(),v=f.$offsetX,g=f.$offsetY,f.useOffset(),f.transform(1,0,0,-1,0,l+2*o);else{if(!e.source&&!e.webGLTexture)return;p=this.getWebGLTexture(e)}p&&(this.drawTexture(p,t,r,i,n,a,o,s,l,c,h,void 0,void 0,void 0,void 0,u,d),e.source&&e.source.texture&&(f.$offsetX=v,f.$offsetY=g,f.restoreTransform()))}},i.prototype.drawMesh=function(e,t,r,i,n,a,o,s,l,c,h,u,d,f,p,v,g){var x=this.currentBuffer;if(!this.contextLost&&e&&x){var m,y,b;if(e.texture||e.source&&e.source.texture)m=e.texture||e.source.texture,x.saveTransform(),y=x.$offsetX,b=x.$offsetY,x.useOffset(),x.transform(1,0,0,-1,0,l+2*o);else{if(!e.source&&!e.webGLTexture)return;m=this.getWebGLTexture(e)}m&&(this.drawTexture(m,t,r,i,n,a,o,s,l,c,h,u,d,f,p,v,g),(e.texture||e.source&&e.source.texture)&&(x.$offsetX=y,x.$offsetY=b,x.restoreTransform()))}},i.prototype.drawTexture=function(e,r,i,n,a,o,s,l,c,h,u,d,f,p,v,g,x){var m=this.currentBuffer;if(!this.contextLost&&e&&m){var y;if(t.isIOS14Device()){var b=p&&p.length/3||0;p?this.vao.reachMaxSize(4*b,6*b)&&this.$drawWebGL():this.vao.reachMaxSize()&&this.$drawWebGL(),void 0!=x&&e.smoothing!=x&&this.drawCmdManager.pushChangeSmoothing(e,x),y=p?2*b:2}else f&&p?this.vao.reachMaxSize(f.length/2,p.length)&&this.$drawWebGL():this.vao.reachMaxSize()&&this.$drawWebGL(),void 0!=x&&e.smoothing!=x&&this.drawCmdManager.pushChangeSmoothing(e,x),d&&this.vao.changeToMeshIndices(),y=p?p.length/3:2;this.drawCmdManager.pushDrawTexture(e,y,this.$filter,h,u),m.currentTexture=e,this.vao.cacheArrays(m,r,i,n,a,o,s,l,c,h,u,d,f,p,g)}},i.prototype.drawRect=function(e,t,r,i){var n=this.currentBuffer;!this.contextLost&&n&&(this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushDrawRect(),n.currentTexture=null,this.vao.cacheArrays(n,0,0,r,i,e,t,r,i,r,i))},i.prototype.pushMask=function(e,t,r,i){var n=this.currentBuffer;!this.contextLost&&n&&(n.$stencilList.push({x:e,y:t,width:r,height:i}),this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushPushMask(),n.currentTexture=null,this.vao.cacheArrays(n,0,0,r,i,e,t,r,i,r,i))},i.prototype.popMask=function(){var e=this.currentBuffer;if(!this.contextLost&&e){var t=e.$stencilList.pop();this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushPopMask(),e.currentTexture=null,this.vao.cacheArrays(e,0,0,t.width,t.height,t.x,t.y,t.width,t.height,t.width,t.height)}},i.prototype.clear=function(){this.drawCmdManager.pushClearColor()},i.prototype.enableScissor=function(e,t,r,i){var n=this.currentBuffer;this.drawCmdManager.pushEnableScissor(e,t,r,i),n.$hasScissor=!0},i.prototype.disableScissor=function(){var e=this.currentBuffer;this.drawCmdManager.pushDisableScissor(),e.$hasScissor=!1},i.prototype.$drawWebGL=function(){if(0!=this.drawCmdManager.drawDataLen&&!this.contextLost){this.uploadVerticesArray(this.vao.getVertices()),this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getMeshIndices());for(var e=this.drawCmdManager.drawDataLen,t=0,r=0;e>r;r++){var i=this.drawCmdManager.drawData[r];t=this.drawData(i,t),7==i.type&&(this.activatedBuffer=i.buffer),(0==i.type||1==i.type||2==i.type||3==i.type)&&this.activatedBuffer&&this.activatedBuffer.$computeDrawCall&&this.activatedBuffer.$drawCalls++}this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getIndices()),this.drawCmdManager.clear(),this.vao.clear()}},i.prototype.drawData=function(r,i){if(r){var n,a=this.context,o=r.filter;switch(r.type){case 0:o?"custom"===o.type?n=t.EgretWebGLProgram.getProgram(a,o.$vertexSrc,o.$fragmentSrc,o.$shaderKey):"colorTransform"===o.type?r.texture[e.etc_alpha_mask]?(a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,r.texture[e.etc_alpha_mask]),n=t.EgretWebGLProgram.getProgram(a,t.EgretShaderLib.default_vert,t.EgretShaderLib.colorTransform_frag_etc_alphamask_frag,"colorTransform_frag_etc_alphamask_frag")):n=t.EgretWebGLProgram.getProgram(a,t.EgretShaderLib.default_vert,t.EgretShaderLib.colorTransform_frag,"colorTransform"):"blurX"===o.type?n=t.EgretWebGLProgram.getProgram(a,t.EgretShaderLib.default_vert,t.EgretShaderLib.blur_frag,"blur"):"blurY"===o.type?n=t.EgretWebGLProgram.getProgram(a,t.EgretShaderLib.default_vert,t.EgretShaderLib.blur_frag,"blur"):"glow"===o.type&&(n=t.EgretWebGLProgram.getProgram(a,t.EgretShaderLib.default_vert,t.EgretShaderLib.glow_frag,"glow")):r.texture[e.etc_alpha_mask]?(n=t.EgretWebGLProgram.getProgram(a,t.EgretShaderLib.default_vert,t.EgretShaderLib.texture_etc_alphamask_frag,e.etc_alpha_mask),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,r.texture[e.etc_alpha_mask])):n=t.EgretWebGLProgram.getProgram(a,t.EgretShaderLib.default_vert,t.EgretShaderLib.texture_frag,"texture"),this.activeProgram(a,n),this.syncUniforms(n,o,r.textureWidth,r.textureHeight),i+=this.drawTextureElements(r,i);break;case 1:n=t.EgretWebGLProgram.getProgram(a,t.EgretShaderLib.default_vert,t.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(a,n),this.syncUniforms(n,o,r.textureWidth,r.textureHeight),i+=this.drawRectElements(r,i);break;case 2:n=t.EgretWebGLProgram.getProgram(a,t.EgretShaderLib.default_vert,t.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(a,n),this.syncUniforms(n,o,r.textureWidth,r.textureHeight),i+=this.drawPushMaskElements(r,i);break;case 3:n=t.EgretWebGLProgram.getProgram(a,t.EgretShaderLib.default_vert,t.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(a,n),this.syncUniforms(n,o,r.textureWidth,r.textureHeight),i+=this.drawPopMaskElements(r,i);break;case 4:this.setBlendMode(r.value);break;case 5:r.buffer.rootRenderTarget.resize(r.width,r.height),this.onResize(r.width,r.height);break;case 6:if(this.activatedBuffer){var s=this.activatedBuffer.rootRenderTarget;(0!=s.width||0!=s.height)&&s.clear(!0)}break;case 7:this.activateBuffer(r.buffer,r.width,r.height);break;case 8:var l=this.activatedBuffer;l&&(l.rootRenderTarget&&l.rootRenderTarget.enabledStencil(),l.enableScissor(r.x,r.y,r.width,r.height));break;case 9:l=this.activatedBuffer,l&&l.disableScissor();break;case 10:a.bindTexture(a.TEXTURE_2D,r.texture),r.smoothing?(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR)):(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST))}return i}},i.prototype.activeProgram=function(t,r){if(e.pro.egret2dDriveMode||r!=this.currentProgram){t.useProgram(r.id);var i=r.attributes;for(var n in i)"aVertexPosition"===n?(t.vertexAttribPointer(i.aVertexPosition.location,2,t.FLOAT,!1,20,0),t.enableVertexAttribArray(i.aVertexPosition.location)):"aTextureCoord"===n?(t.vertexAttribPointer(i.aTextureCoord.location,2,t.FLOAT,!1,20,8),t.enableVertexAttribArray(i.aTextureCoord.location)):"aColor"===n&&(t.vertexAttribPointer(i.aColor.location,4,t.UNSIGNED_BYTE,!0,20,16),t.enableVertexAttribArray(i.aColor.location));this.currentProgram=r}},i.prototype.syncUniforms=function(e,t,r,i){var n=e.uniforms;t&&"custom"===t.type;for(var a in n)if("$filterScale"!=a)if("projectionVector"===a)n[a].setValue({x:this.projectionX,y:this.projectionY});else if("uTextureSize"===a)n[a].setValue({x:r,y:i});else if("uSampler"===a)n[a].setValue(0);else if("uSamplerAlphaMask"===a)n[a].setValue(1);else{var o=t.$uniforms[a];if(void 0!==o){if("glow"==t.type||0==t.type.indexOf("blur"))if("blurX"==a||"blurY"==a||"dist"==a)o*=t.$uniforms.$filterScale||1;else if("blur"==a&&void 0!=o.x&&void 0!=o.y){var s={x:0,y:0};s.x=o.x*(void 0!=t.$uniforms.$filterScale?t.$uniforms.$filterScale:1),s.y=o.y*(void 0!=t.$uniforms.$filterScale?t.$uniforms.$filterScale:1),n[a].setValue(s);continue}n[a].setValue(o)}}},i.prototype.drawTextureElements=function(t,r){return e.sys.drawTextureElements(this,t,r)},i.prototype.drawRectElements=function(e,t){var r=this.context,i=3*e.count;return r.drawElements(r.TRIANGLES,i,r.UNSIGNED_SHORT,2*t),i},i.prototype.drawPushMaskElements=function(e,t){var r=this.context,i=3*e.count,n=this.activatedBuffer;if(n){n.rootRenderTarget&&n.rootRenderTarget.enabledStencil(),0==n.stencilHandleCount&&(n.enableStencil(),r.clear(r.STENCIL_BUFFER_BIT));var a=n.stencilHandleCount;n.stencilHandleCount++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,a,255),r.stencilOp(r.KEEP,r.KEEP,r.INCR),r.drawElements(r.TRIANGLES,i,r.UNSIGNED_SHORT,2*t),r.stencilFunc(r.EQUAL,a+1,255),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP)}return i},i.prototype.drawPopMaskElements=function(e,t){var r=this.context,i=3*e.count,n=this.activatedBuffer;if(n)if(n.stencilHandleCount--,0==n.stencilHandleCount)n.disableStencil();else{var a=n.stencilHandleCount;r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,a+1,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR),r.drawElements(r.TRIANGLES,i,r.UNSIGNED_SHORT,2*t),r.stencilFunc(r.EQUAL,a,255),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP)}return i},i.prototype.setBlendMode=function(e){var t=this.context,r=i.blendModesForGL[e];r&&t.blendFunc(r[0],r[1])},i.prototype.drawTargetWidthFilters=function(r,i){var n,a=i,o=r.length;if(o>1)for(var s=0;o-1>s;s++){var l=r[s],c=i.rootRenderTarget.width,h=i.rootRenderTarget.height;n=t.WebGLRenderBuffer.create(c,h);var u=Math.max(e.sys.DisplayList.$canvasScaleFactor,2);n.setTransform(u,0,0,u,0,0),n.globalAlpha=1,this.drawToRenderTarget(l,i,n),i!=a&&t.WebGLRenderBuffer.release(i),i=n}var d=r[o-1];this.drawToRenderTarget(d,i,this.currentBuffer),i!=a&&t.WebGLRenderBuffer.release(i)},i.prototype.drawToRenderTarget=function(r,i,n){if(!this.contextLost){this.vao.reachMaxSize()&&this.$drawWebGL(),this.pushBuffer(n);var a,o=i,s=i.rootRenderTarget.width,l=i.rootRenderTarget.height;if("blur"==r.type){var c=r.blurXFilter,h=r.blurYFilter;if(0!=c.blurX&&0!=h.blurY){a=t.WebGLRenderBuffer.create(s,l);var u=Math.max(e.sys.DisplayList.$canvasScaleFactor,2);a.setTransform(1,0,0,1,0,0),a.transform(u,0,0,u,0,0),a.globalAlpha=1,this.drawToRenderTarget(r.blurXFilter,i,a),i!=o&&t.WebGLRenderBuffer.release(i),i=a,r=h}else r=0===c.blurX?h:c}n.saveTransform();var d=Math.max(e.sys.DisplayList.$canvasScaleFactor,2);n.transform(1/d,0,0,1/d,0,0),n.transform(1,0,0,-1,0,l),n.currentTexture=i.rootRenderTarget.texture,this.vao.cacheArrays(n,0,0,s,l,0,0,s,l,s,l),n.restoreTransform(),this.drawCmdManager.pushDrawTexture(i.rootRenderTarget.texture,2,r,s,l),i!=o&&t.WebGLRenderBuffer.release(i),this.popBuffer()}},i.initBlendMode=function(){i.blendModesForGL={},i.blendModesForGL["source-over"]=[1,771],i.blendModesForGL.lighter=[1,1],i.blendModesForGL["lighter-in"]=[770,771],i.blendModesForGL["destination-out"]=[0,771],i.blendModesForGL["destination-in"]=[0,770]},i.glContextId=0,i.blendModesForGL=null,i}();t.WebGLRenderContext=i,__reflect(i.prototype,"egret.web.WebGLRenderContext",["egret.sys.RenderContext"]),i.initBlendMode(),e.sys.WebGLRenderContext=i}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(r){function n(i,n,a){var o=r.call(this)||this;
if(o.currentTexture=null,o.globalAlpha=1,o.globalTintColor=16777215,o.stencilState=!1,o.$stencilList=[],o.stencilHandleCount=0,o.$scissorState=!1,o.scissorRect=new e.Rectangle,o.$hasScissor=!1,o.$drawCalls=0,o.$computeDrawCall=!1,o.globalMatrix=new e.Matrix,o.savedGlobalMatrix=new e.Matrix,o.$offsetX=0,o.$offsetY=0,o.context=t.WebGLRenderContext.getInstance(i,n),e.nativeRender)return a?o.surface=o.context.surface:o.surface=new egret_native.NativeRenderSurface(o,i,n,a),o.rootRenderTarget=null,o;if(o.rootRenderTarget=new t.WebGLRenderTarget(o.context.context,3,3),i&&n&&o.resize(i,n),o.root=a,o.root)o.context.pushBuffer(o),o.surface=o.context.surface,o.$computeDrawCall=!0;else{var s=o.context.activatedBuffer;s&&s.rootRenderTarget.activate(),o.rootRenderTarget.initFrameBuffer(),o.surface=o.rootRenderTarget}return o}return __extends(n,r),n.prototype.enableStencil=function(){this.stencilState||(this.context.enableStencilTest(),this.stencilState=!0)},n.prototype.disableStencil=function(){this.stencilState&&(this.context.disableStencilTest(),this.stencilState=!1)},n.prototype.restoreStencil=function(){this.stencilState?this.context.enableStencilTest():this.context.disableStencilTest()},n.prototype.enableScissor=function(e,t,r,i){this.$scissorState||(this.$scissorState=!0,this.scissorRect.setTo(e,t,r,i),this.context.enableScissorTest(this.scissorRect))},n.prototype.disableScissor=function(){this.$scissorState&&(this.$scissorState=!1,this.scissorRect.setEmpty(),this.context.disableScissorTest())},n.prototype.restoreScissor=function(){this.$scissorState?this.context.enableScissorTest(this.scissorRect):this.context.disableScissorTest()},Object.defineProperty(n.prototype,"width",{get:function(){return e.nativeRender?this.surface.width:this.rootRenderTarget.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return e.nativeRender?this.surface.height:this.rootRenderTarget.height},enumerable:!0,configurable:!0}),n.prototype.resize=function(t,r,i){return t=t||1,r=r||1,e.nativeRender?void this.surface.resize(t,r):(this.context.pushBuffer(this),(t!=this.rootRenderTarget.width||r!=this.rootRenderTarget.height)&&(this.context.drawCmdManager.pushResize(this,t,r),this.rootRenderTarget.width=t,this.rootRenderTarget.height=r),this.root&&this.context.resize(t,r,i),this.context.clear(),void this.context.popBuffer())},n.prototype.getPixels=function(t,r,i,n){void 0===i&&(i=1),void 0===n&&(n=1);var a=new Uint8Array(4*i*n);if(e.nativeRender)egret_native.activateBuffer(this),egret_native.nrGetPixels(t,r,i,n,a),egret_native.activateBuffer(null);else{var o=this.rootRenderTarget.useFrameBuffer;this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.getPixels(t,r,i,n,a),this.rootRenderTarget.useFrameBuffer=o,this.rootRenderTarget.activate()}for(var s=new Uint8Array(4*i*n),l=0;n>l;l++)for(var c=0;i>c;c++){var h=4*(i*(n-l-1)+c),u=4*(i*l+c),d=a[u+3];s[h]=Math.round(a[u]/d*255),s[h+1]=Math.round(a[u+1]/d*255),s[h+2]=Math.round(a[u+2]/d*255),s[h+3]=a[u+3]}return s},n.prototype.toDataURL=function(e,t){return this.context.surface.toDataURL(e,t)},n.prototype.destroy=function(){this.context.destroy()},n.prototype.onRenderFinish=function(){this.$drawCalls=0},n.prototype.drawFrameBufferToSurface=function(e,t,r,i,n,a,o,s,l){void 0===l&&(l=!1),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),l&&this.context.clear(),this.context.drawImage(this.rootRenderTarget,e,t,r,i,n,a,o,s,r,i,!1),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},n.prototype.drawSurfaceToFrameBuffer=function(e,t,r,i,n,a,o,s,l){void 0===l&&(l=!1),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),l&&this.context.clear(),this.context.drawImage(this.context.surface,e,t,r,i,n,a,o,s,r,i,!1),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},n.prototype.clear=function(){this.context.pushBuffer(this),this.context.clear(),this.context.popBuffer()},n.prototype.setTransform=function(e,t,r,i,n,a){var o=this.globalMatrix;o.a=e,o.b=t,o.c=r,o.d=i,o.tx=n,o.ty=a},n.prototype.transform=function(e,t,r,i,n,a){var o=this.globalMatrix,s=o.a,l=o.b,c=o.c,h=o.d;(1!=e||0!=t||0!=r||1!=i)&&(o.a=e*s+t*c,o.b=e*l+t*h,o.c=r*s+i*c,o.d=r*l+i*h),o.tx=n*s+a*c+o.tx,o.ty=n*l+a*h+o.ty},n.prototype.useOffset=function(){var e=this;(0!=e.$offsetX||0!=e.$offsetY)&&(e.globalMatrix.append(1,0,0,1,e.$offsetX,e.$offsetY),e.$offsetX=e.$offsetY=0)},n.prototype.saveTransform=function(){var e=this.globalMatrix,t=this.savedGlobalMatrix;t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t.tx=e.tx,t.ty=e.ty},n.prototype.restoreTransform=function(){var e=this.globalMatrix,t=this.savedGlobalMatrix;e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.tx=t.tx,e.ty=t.ty},n.create=function(e,t){var r=i.pop();if(r){r.resize(e,t);var a=r.globalMatrix;a.a=1,a.b=0,a.c=0,a.d=1,a.tx=0,a.ty=0,r.globalAlpha=1,r.$offsetX=0,r.$offsetY=0}else r=new n(e,t),r.$computeDrawCall=!1;return r},n.release=function(e){i.push(e)},n.autoClear=!0,n}(e.HashObject);t.WebGLRenderBuffer=r,__reflect(r.prototype,"egret.web.WebGLRenderBuffer",["egret.sys.RenderBuffer"]);var i=[]}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=["source-over","lighter","destination-out"],i="source-over",n=[],a=function(){function a(){this.wxiOS10=!1,this.nestLevel=0}return a.prototype.render=function(t,r,i,a){this.nestLevel++;var o=r,s=o.context;s.pushBuffer(o),o.transform(i.a,i.b,i.c,i.d,0,0),this.drawDisplayObject(t,o,i.tx,i.ty,!0),s.$drawWebGL();var l=o.$drawCalls;o.onRenderFinish(),s.popBuffer();var c=e.Matrix.create();if(i.$invertInto(c),o.transform(c.a,c.b,c.c,c.d,0,0),e.Matrix.release(c),this.nestLevel--,0===this.nestLevel){n.length>6&&(n.length=6);for(var h=n.length,u=0;h>u;u++)n[u].resize(0,0)}return l},a.prototype.drawDisplayObject=function(t,r,i,n,a){var o,s=0,l=t.$displayList;if(l&&!a?((t.$cacheDirty||t.$renderDirty||l.$canvasScaleX!=e.sys.DisplayList.$canvasScaleX||l.$canvasScaleY!=e.sys.DisplayList.$canvasScaleY)&&(s+=l.drawToSurface()),o=l.$renderNode):o=t.$renderDirty?t.$getRenderNode():t.$renderNode,t.$cacheDirty=!1,o){switch(s++,r.$offsetX=i,r.$offsetY=n,o.type){case 1:this.renderBitmap(o,r);break;case 2:this.renderText(o,r);break;case 3:this.renderGraphics(o,r);break;case 4:this.renderGroup(o,r);break;case 5:this.renderMesh(o,r);break;case 6:this.renderNormalBitmap(o,r)}r.$offsetX=0,r.$offsetY=0}if(l&&!a)return s;var c=t.$children;if(c){t.sortableChildren&&t.$sortDirty&&t.sortChildren();for(var h=c.length,u=0;h>u;u++){var d=c[u],f=void 0,p=void 0,v=void 0,g=void 0;1!=d.$alpha&&(v=r.globalAlpha,r.globalAlpha*=d.$alpha),16777215!==d.tint&&(g=r.globalTintColor,r.globalTintColor=d.$tintRGB);var x=void 0;if(d.$useTranslate){var m=d.$getMatrix();f=i+d.$x,p=n+d.$y;var y=r.globalMatrix;x=e.Matrix.create(),x.a=y.a,x.b=y.b,x.c=y.c,x.d=y.d,x.tx=y.tx,x.ty=y.ty,r.transform(m.a,m.b,m.c,m.d,f,p),f=-d.$anchorOffsetX,p=-d.$anchorOffsetY}else f=i+d.$x-d.$anchorOffsetX,p=n+d.$y-d.$anchorOffsetY;switch(d.$renderMode){case 1:break;case 2:s+=this.drawWithFilter(d,r,f,p);break;case 3:s+=this.drawWithClip(d,r,f,p);break;case 4:s+=this.drawWithScrollRect(d,r,f,p);break;default:s+=this.drawDisplayObject(d,r,f,p)}if(v&&(r.globalAlpha=v),g&&(r.globalTintColor=g),x){var m=r.globalMatrix;m.a=x.a,m.b=x.b,m.c=x.c,m.d=x.d,m.tx=x.tx,m.ty=x.ty,e.Matrix.release(x)}}}return s},a.prototype.drawWithFilter=function(t,a,o,s){var l=0;if(t.$children&&0==t.$children.length&&(!t.$renderNode||0==t.$renderNode.$getRenderCount()))return l;var c,h=t.$filters,u=0!==t.$blendMode;u&&(c=r[t.$blendMode],c||(c=i));var d=t.$getOriginalBounds(),f=d.x,p=d.y,v=d.width,g=d.height;if(0>=v||0>=g)return l;if(!t.mask&&1==h.length&&("colorTransform"==h[0].type||"custom"===h[0].type&&0===h[0].padding)){var x=this.getRenderCount(t);if(!t.$children||1==x)return u&&a.context.setGlobalCompositeOperation(c),a.context.$filter=h[0],l+=t.$mask?this.drawWithClip(t,a,o,s):t.$scrollRect||t.$maskRect?this.drawWithScrollRect(t,a,o,s):this.drawDisplayObject(t,a,o,s),a.context.$filter=null,u&&a.context.setGlobalCompositeOperation(i),l}var m=Math.max(e.sys.DisplayList.$canvasScaleFactor,2);h.forEach(function(t){if((t instanceof e.GlowFilter||t instanceof e.BlurFilter)&&(t.$uniforms.$filterScale=m,"blur"==t.type)){var r=t;r.blurXFilter.$uniforms.$filterScale=m,r.blurYFilter.$uniforms.$filterScale=m}});var y=this.createRenderBuffer(m*v,m*g);if(y.saveTransform(),y.transform(m,0,0,m,0,0),y.context.pushBuffer(y),l+=t.$mask?this.drawWithClip(t,y,-f,-p):t.$scrollRect||t.$maskRect?this.drawWithScrollRect(t,y,-f,-p):this.drawDisplayObject(t,y,-f,-p),y.context.popBuffer(),y.restoreTransform(),l>0){u&&a.context.setGlobalCompositeOperation(c),l++,a.$offsetX=o+f,a.$offsetY=s+p;var b=e.Matrix.create(),w=a.globalMatrix;b.a=w.a,b.b=w.b,b.c=w.c,b.d=w.d,b.tx=w.tx,b.ty=w.ty,a.useOffset(),a.context.drawTargetWidthFilters(h,y),w.a=b.a,w.b=b.b,w.c=b.c,w.d=b.d,w.tx=b.tx,w.ty=b.ty,e.Matrix.release(b),u&&a.context.setGlobalCompositeOperation(i)}return n.push(y),l},a.prototype.getRenderCount=function(e){var t=0,r=e.$getRenderNode();if(r&&(t+=r.$getRenderCount()),e.$children)for(var i=0,n=e.$children;i<n.length;i++){var a=n[i],o=a.$filters;if(o&&o.length>0)return 2;if(a.$children)t+=this.getRenderCount(a);else{var s=a.$getRenderNode();s&&(t+=s.$getRenderCount())}}return t},a.prototype.drawWithClip=function(t,a,o,s){var l,c=0,h=0!==t.$blendMode;h&&(l=r[t.$blendMode],l||(l=i));var u=t.$scrollRect?t.$scrollRect:t.$maskRect,d=t.$mask;if(d){var f=d.$getMatrix();if(0==f.a&&0==f.b||0==f.c&&0==f.d)return c}if(d||t.$children&&0!=t.$children.length){var p=t.$getOriginalBounds(),v=p.x,g=p.y,x=p.width,m=p.height;if(0>=x||0>=m)return c;var y=this.createRenderBuffer(x,m);if(y.context.pushBuffer(y),c+=this.drawDisplayObject(t,y,-v,-g),d){var b=this.createRenderBuffer(x,m);b.context.pushBuffer(b);var w=e.Matrix.create();w.copyFrom(d.$getConcatenatedMatrix()),d.$getConcatenatedMatrixAt(t,w),w.translate(-v,-g),b.setTransform(w.a,w.b,w.c,w.d,w.tx,w.ty),e.Matrix.release(w),c+=this.drawDisplayObject(d,b,0,0),b.context.popBuffer(),y.context.setGlobalCompositeOperation("destination-in"),y.setTransform(1,0,0,-1,0,b.height);var T=b.rootRenderTarget.width,E=b.rootRenderTarget.height;y.context.drawTexture(b.rootRenderTarget.texture,0,0,T,E,0,0,T,E,T,E),y.setTransform(1,0,0,1,0,0),y.context.setGlobalCompositeOperation("source-over"),b.setTransform(1,0,0,1,0,0),n.push(b)}if(y.context.setGlobalCompositeOperation(i),y.context.popBuffer(),c>0){c++,h&&a.context.setGlobalCompositeOperation(l),u&&a.context.pushMask(u.x+o,u.y+s,u.width,u.height);var _=e.Matrix.create(),C=a.globalMatrix;_.a=C.a,_.b=C.b,_.c=C.c,_.d=C.d,_.tx=C.tx,_.ty=C.ty,C.append(1,0,0,-1,o+v,s+g+y.height);var S=y.rootRenderTarget.width,R=y.rootRenderTarget.height;a.context.drawTexture(y.rootRenderTarget.texture,0,0,S,R,0,0,S,R,S,R),u&&y.context.popMask(),h&&a.context.setGlobalCompositeOperation(i);var L=a.globalMatrix;L.a=_.a,L.b=_.b,L.c=_.c,L.d=_.d,L.tx=_.tx,L.ty=_.ty,e.Matrix.release(_)}return n.push(y),c}return u&&a.context.pushMask(u.x+o,u.y+s,u.width,u.height),h&&a.context.setGlobalCompositeOperation(l),c+=this.drawDisplayObject(t,a,o,s),h&&a.context.setGlobalCompositeOperation(i),u&&a.context.popMask(),c},a.prototype.drawWithScrollRect=function(e,t,r,i){var n=0,a=e.$scrollRect?e.$scrollRect:e.$maskRect;if(a.isEmpty())return n;e.$scrollRect&&(r-=a.x,i-=a.y);var o=t.globalMatrix,s=t.context,l=!1;if(t.$hasScissor||0!=o.b||0!=o.c)t.context.pushMask(a.x+r,a.y+i,a.width,a.height);else{var c=o.a,h=o.d,u=o.tx,d=o.ty,f=a.x+r,p=a.y+i,v=f+a.width,g=p+a.height,x=void 0,m=void 0,y=void 0,b=void 0;if(1==c&&1==h)x=f+u,m=p+d,y=v+u,b=g+d;else{var w=c*f+u,T=h*p+d,E=c*v+u,_=h*p+d,C=c*v+u,S=h*g+d,R=c*f+u,L=h*g+d,D=0;w>E&&(D=w,w=E,E=D),C>R&&(D=C,C=R,R=D),x=C>w?w:C,y=E>R?E:R,T>_&&(D=T,T=_,_=D),S>L&&(D=S,S=L,L=D),m=S>T?T:S,b=_>L?_:L}s.enableScissor(x,-b+t.height,y-x,b-m),l=!0}return n+=this.drawDisplayObject(e,t,r,i),l?s.disableScissor():s.popMask(),n},a.prototype.drawNodeToBuffer=function(e,t,r,i){var n=t;n.context.pushBuffer(n),n.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty),this.renderNode(e,t,0,0,i),n.context.$drawWebGL(),n.onRenderFinish(),n.context.popBuffer()},a.prototype.drawDisplayToBuffer=function(e,t,r){t.context.pushBuffer(t),r&&t.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty);var i;i=e.$renderDirty?e.$getRenderNode():e.$renderNode;var n=0;if(i)switch(n++,i.type){case 1:this.renderBitmap(i,t);break;case 2:this.renderText(i,t);break;case 3:this.renderGraphics(i,t);break;case 4:this.renderGroup(i,t);break;case 5:this.renderMesh(i,t);break;case 6:this.renderNormalBitmap(i,t)}var a=e.$children;if(a)for(var o=a.length,s=0;o>s;s++){var l=a[s];switch(l.$renderMode){case 1:break;case 2:n+=this.drawWithFilter(l,t,0,0);break;case 3:n+=this.drawWithClip(l,t,0,0);break;case 4:n+=this.drawWithScrollRect(l,t,0,0);break;default:n+=this.drawDisplayObject(l,t,0,0)}}return t.context.$drawWebGL(),t.onRenderFinish(),t.context.popBuffer(),n},a.prototype.renderNode=function(e,t,r,i,n){switch(t.$offsetX=r,t.$offsetY=i,e.type){case 1:this.renderBitmap(e,t);break;case 2:this.renderText(e,t);break;case 3:this.renderGraphics(e,t,n);break;case 4:this.renderGroup(e,t);break;case 5:this.renderMesh(e,t);break;case 6:this.renderNormalBitmap(e,t)}},a.prototype.renderNormalBitmap=function(e,t){var r=e.image;r&&t.context.drawImage(r,e.sourceX,e.sourceY,e.sourceW,e.sourceH,e.drawX,e.drawY,e.drawW,e.drawH,e.imageWidth,e.imageHeight,e.rotated,e.smoothing)},a.prototype.renderBitmap=function(t,n){var a=t.image;if(a){var o,s,l,c=t.drawData,h=c.length,u=0,d=t.matrix,f=t.blendMode,p=t.alpha;if(d){o=e.Matrix.create();var v=n.globalMatrix;o.a=v.a,o.b=v.b,o.c=v.c,o.d=v.d,o.tx=v.tx,o.ty=v.ty,s=n.$offsetX,l=n.$offsetY,n.useOffset(),n.transform(d.a,d.b,d.c,d.d,d.tx,d.ty)}f&&n.context.setGlobalCompositeOperation(r[f]);var g;if(p==p&&(g=n.globalAlpha,n.globalAlpha*=p),t.filter){for(n.context.$filter=t.filter;h>u;)n.context.drawImage(a,c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],t.imageWidth,t.imageHeight,t.rotated,t.smoothing);n.context.$filter=null}else for(;h>u;)n.context.drawImage(a,c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],t.imageWidth,t.imageHeight,t.rotated,t.smoothing);if(f&&n.context.setGlobalCompositeOperation(i),p==p&&(n.globalAlpha=g),d){var x=n.globalMatrix;x.a=o.a,x.b=o.b,x.c=o.c,x.d=o.d,x.tx=o.tx,x.ty=o.ty,n.$offsetX=s,n.$offsetY=l,e.Matrix.release(o)}}},a.prototype.renderMesh=function(t,n){var a,o,s,l=t.image,c=t.drawData,h=c.length,u=0,d=t.matrix,f=t.blendMode,p=t.alpha;if(d){a=e.Matrix.create();var v=n.globalMatrix;a.a=v.a,a.b=v.b,a.c=v.c,a.d=v.d,a.tx=v.tx,a.ty=v.ty,o=n.$offsetX,s=n.$offsetY,n.useOffset(),n.transform(d.a,d.b,d.c,d.d,d.tx,d.ty)}f&&n.context.setGlobalCompositeOperation(r[f]);var g;if(p==p&&(g=n.globalAlpha,n.globalAlpha*=p),t.filter){for(n.context.$filter=t.filter;h>u;)n.context.drawMesh(l,c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],t.imageWidth,t.imageHeight,t.uvs,t.vertices,t.indices,t.bounds,t.rotated,t.smoothing);n.context.$filter=null}else for(;h>u;)n.context.drawMesh(l,c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],c[u++],t.imageWidth,t.imageHeight,t.uvs,t.vertices,t.indices,t.bounds,t.rotated,t.smoothing);if(f&&n.context.setGlobalCompositeOperation(i),p==p&&(n.globalAlpha=g),d){var x=n.globalMatrix;x.a=a.a,x.b=a.b,x.c=a.c,x.d=a.d,x.tx=a.tx,x.ty=a.ty,n.$offsetX=o,n.$offsetY=s,e.Matrix.release(a)}},a.prototype.___renderText____=function(r,i){var n=r.width-r.x,a=r.height-r.y;if(!(0>=n||0>=a)&&n&&a&&0!==r.drawData.length){var o=e.sys.DisplayList.$canvasScaleX,s=e.sys.DisplayList.$canvasScaleY,l=i.context.$maxTextureSize;n*o>l&&(o*=l/(n*o)),a*s>l&&(s*=l/(a*s)),n*=o,a*=s;var c=r.x*o,h=r.y*s;(r.$canvasScaleX!==o||r.$canvasScaleY!==s)&&(r.$canvasScaleX=o,r.$canvasScaleY=s,r.dirtyRender=!0),(c||h)&&i.transform(1,0,0,1,c/o,h/s),r.dirtyRender&&t.TextAtlasRender.analysisTextNodeAndFlushDrawLabel(r);var u=r[t.property_drawLabel];if(u&&u.length>0){for(var d=i.$offsetX,f=i.$offsetY,p=null,v=0,g=0,x=null,m=null,y=null,b=0,w=u.length;w>b;++b){p=u[b],v=p.anchorX,g=p.anchorY,x=p.textBlocks,i.$offsetX=d+v;for(var T=0,E=x.length;E>T;++T)m=x[T],T>0&&(i.$offsetX-=m.canvasWidthOffset),i.$offsetY=f+g-(m.measureHeight+(m.stroke2?m.canvasHeightOffset:0))/2,y=m.line.page,i.context.drawTexture(y.webGLTexture,m.u,m.v,m.contentWidth,m.contentHeight,0,0,m.contentWidth,m.contentHeight,y.pageWidth,y.pageHeight),i.$offsetX+=m.contentWidth-m.canvasWidthOffset}i.$offsetX=d,i.$offsetY=f}(c||h)&&i.transform(1,0,0,1,-c/o,-h/s),r.dirtyRender=!1}},a.prototype.renderText=function(r,i){if(t.textAtlasRenderEnable)return void this.___renderText____(r,i);var n=r.width-r.x,a=r.height-r.y;if(!(0>=n||0>=a)&&n&&a&&0!=r.drawData.length){var o=e.sys.DisplayList.$canvasScaleX,s=e.sys.DisplayList.$canvasScaleY,l=i.context.$maxTextureSize;n*o>l&&(o*=l/(n*o)),a*s>l&&(s*=l/(a*s)),n*=o,a*=s;var c=r.x*o,h=r.y*s;if((r.$canvasScaleX!=o||r.$canvasScaleY!=s)&&(r.$canvasScaleX=o,r.$canvasScaleY=s,r.dirtyRender=!0),this.wxiOS10?(this.canvasRenderer||(this.canvasRenderer=new e.CanvasRenderer),r.dirtyRender&&(this.canvasRenderBuffer=new t.CanvasRenderBuffer(n,a))):this.canvasRenderBuffer&&this.canvasRenderBuffer.context?r.dirtyRender&&this.canvasRenderBuffer.resize(n,a):(this.canvasRenderer=new e.CanvasRenderer,this.canvasRenderBuffer=new t.CanvasRenderBuffer(n,a)),this.canvasRenderBuffer.context){if((1!=o||1!=s)&&this.canvasRenderBuffer.context.setTransform(o,0,0,s,0,0),c||h?(r.dirtyRender&&this.canvasRenderBuffer.context.setTransform(o,0,0,s,-c,-h),i.transform(1,0,0,1,c/o,h/s)):(1!=o||1!=s)&&this.canvasRenderBuffer.context.setTransform(o,0,0,s,0,0),r.dirtyRender){var u=this.canvasRenderBuffer.surface;if(this.canvasRenderer.renderText(r,this.canvasRenderBuffer.context),this.wxiOS10)u.isCanvas=!0,r.$texture=u;else{var d=r.$texture;d?i.context.updateTexture(d,u):(d=i.context.createTexture(u),r.$texture=d)}r.$textureWidth=u.width,r.$textureHeight=u.height}var f=r.$textureWidth,p=r.$textureHeight;i.context.drawTexture(r.$texture,0,0,f,p,0,0,f/o,p/s,f,p),(c||h)&&(r.dirtyRender&&this.canvasRenderBuffer.context.setTransform(o,0,0,s,0,0),i.transform(1,0,0,1,-c/o,-h/s)),r.dirtyRender=!1}}},a.prototype.renderGraphics=function(r,i,n){var a=r.width,o=r.height;if(!(0>=a||0>=o)&&a&&o&&0!=r.drawData.length){var s=e.sys.DisplayList.$canvasScaleX,l=e.sys.DisplayList.$canvasScaleY;(1>a*s||1>o*l)&&(s=l=1),(r.$canvasScaleX!=s||r.$canvasScaleY!=l)&&(r.$canvasScaleX=s,r.$canvasScaleY=l,r.dirtyRender=!0),a*=s,o*=l;var c=Math.ceil(a),h=Math.ceil(o);if(s*=c/a,l*=h/o,a=c,o=h,this.wxiOS10?(this.canvasRenderer||(this.canvasRenderer=new e.CanvasRenderer),r.dirtyRender&&(this.canvasRenderBuffer=new t.CanvasRenderBuffer(a,o))):this.canvasRenderBuffer&&this.canvasRenderBuffer.context?r.dirtyRender&&this.canvasRenderBuffer.resize(a,o):(this.canvasRenderer=new e.CanvasRenderer,this.canvasRenderBuffer=new t.CanvasRenderBuffer(a,o)),this.canvasRenderBuffer.context){(1!=s||1!=l)&&this.canvasRenderBuffer.context.setTransform(s,0,0,l,0,0),(r.x||r.y)&&((r.dirtyRender||n)&&this.canvasRenderBuffer.context.translate(-r.x,-r.y),i.transform(1,0,0,1,r.x,r.y));var u=this.canvasRenderBuffer.surface;if(n){this.canvasRenderer.renderGraphics(r,this.canvasRenderBuffer.context,!0);var d=void 0;this.wxiOS10?(u.isCanvas=!0,d=u):(e.WebGLUtils.deleteWebGLTexture(u),d=i.context.getWebGLTexture(u)),i.context.drawTexture(d,0,0,a,o,0,0,a,o,u.width,u.height)}else{if(r.dirtyRender){if(this.canvasRenderer.renderGraphics(r,this.canvasRenderBuffer.context),this.wxiOS10)u.isCanvas=!0,r.$texture=u;else{var d=r.$texture;d?i.context.updateTexture(d,u):(d=i.context.createTexture(u),r.$texture=d)}r.$textureWidth=u.width,r.$textureHeight=u.height}var f=r.$textureWidth,p=r.$textureHeight;i.context.drawTexture(r.$texture,0,0,f,p,0,0,f/s,p/l,f,p)}(r.x||r.y)&&((r.dirtyRender||n)&&this.canvasRenderBuffer.context.translate(r.x,r.y),i.transform(1,0,0,1,-r.x,-r.y)),n||(r.dirtyRender=!1)}}},a.prototype.renderGroup=function(t,r){var i,n,a,o=t.matrix;if(o){i=e.Matrix.create();var s=r.globalMatrix;i.a=s.a,i.b=s.b,i.c=s.c,i.d=s.d,i.tx=s.tx,i.ty=s.ty,n=r.$offsetX,a=r.$offsetY,r.useOffset(),r.transform(o.a,o.b,o.c,o.d,o.tx,o.ty)}for(var l=t.drawData,c=l.length,h=0;c>h;h++){var u=l[h];this.renderNode(u,r,r.$offsetX,r.$offsetY)}if(o){var d=r.globalMatrix;d.a=i.a,d.b=i.b,d.c=i.c,d.d=i.d,d.tx=i.tx,d.ty=i.ty,r.$offsetX=n,r.$offsetY=a,e.Matrix.release(i)}},a.prototype.createRenderBuffer=function(e,r){var i=n.pop();return i?(i.resize(e,r),i.setTransform(1,0,0,1,0,0)):(i=new t.WebGLRenderBuffer(e,r),i.$computeDrawCall=!1),i},a.prototype.renderClear=function(){var e=t.WebGLRenderContext.getInstance(),r=e.context;e.$beforeRender();var i=e.surface.width,n=e.surface.height;r.viewport(0,0,i,n)},a}();t.WebGLRenderer=a,__reflect(a.prototype,"egret.web.WebGLRenderer",["egret.sys.SystemRenderer"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var r=function(e){function t(t,r,i,n,a,o,s,l){var c=e.call(this)||this;return c._width=0,c._height=0,c._border=0,c.line=null,c.x=0,c.y=0,c.u=0,c.v=0,c.tag="",c.measureWidth=0,c.measureHeight=0,c.canvasWidthOffset=0,c.canvasHeightOffset=0,c.stroke2=0,c._width=t,c._height=r,c._border=l,c.measureWidth=i,c.measureHeight=n,c.canvasWidthOffset=a,c.canvasHeightOffset=o,c.stroke2=s,c}return __extends(t,e),Object.defineProperty(t.prototype,"border",{get:function(){return this._border},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width+2*this.border},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height+2*this.border},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentWidth",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentHeight",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"page",{get:function(){return this.line?this.line.page:null},enumerable:!0,configurable:!0}),t.prototype.updateUV=function(){var e=this.line;return e?(this.u=e.x+this.x+1*this.border,this.v=e.y+this.y+1*this.border,!0):!1},Object.defineProperty(t.prototype,"subImageOffsetX",{get:function(){var e=this.line;return e?e.x+this.x+this.border:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subImageOffsetY",{get:function(){var e=this.line;return e?e.y+this.y+this.border:0},enumerable:!0,configurable:!0}),t}(e.HashObject);t.TextBlock=r,__reflect(r.prototype,"egret.web.TextBlock");var i=function(e){function t(t){var r=e.call(this)||this;return r.page=null,r.textBlocks=[],r.dynamicMaxHeight=0,r.maxWidth=0,r.x=0,r.y=0,r.maxWidth=t,r}return __extends(t,e),t.prototype.isCapacityOf=function(e){if(!e)return!1;var t=0,r=0,i=this.lastTextBlock();return i&&(t=i.x+i.width,r=i.y),t+e.width>this.maxWidth?!1:this.dynamicMaxHeight>0&&(e.height>this.dynamicMaxHeight||e.height/this.dynamicMaxHeight<.5)?!1:!0},t.prototype.lastTextBlock=function(){var e=this.textBlocks;return e.length>0?e[e.length-1]:null},t.prototype.addTextBlock=function(e,t){if(!e)return!1;if(t&&!this.isCapacityOf(e))return!1;var r=0,i=0,n=this.lastTextBlock();return n&&(r=n.x+n.width,i=n.y),e.x=r,e.y=i,e.line=this,this.textBlocks.push(e),this.dynamicMaxHeight=Math.max(this.dynamicMaxHeight,e.height),!0},t}(e.HashObject);t.Line=i,__reflect(i.prototype,"egret.web.Line");var n=function(e){function t(t,r){var i=e.call(this)||this;return i.lines=[],i.pageWidth=0,i.pageHeight=0,i.webGLTexture=null,i.pageWidth=t,i.pageHeight=r,i}return __extends(t,e),t.prototype.addLine=function(e){if(!e)return!1;var t=0,r=0,i=this.lines;if(i.length>0){var n=i[i.length-1];t=n.x,r=n.y+n.dynamicMaxHeight}return e.maxWidth>this.pageWidth?(console.error("line.maxWidth = "+e.maxWidth+", this.pageWidth = "+this.pageWidth),!1):r+e.dynamicMaxHeight>this.pageHeight?!1:(e.x=t,e.y=r,e.page=this,this.lines.push(e),!0)},t}(e.HashObject);t.Page=n,__reflect(n.prototype,"egret.web.Page");var a=function(e){function t(t,r){var i=e.call(this)||this;return i._pages=[],i._sortLines=[],i._maxSize=1024,i._border=1,i._maxSize=t,i._border=r,i}return __extends(t,e),t.prototype.addTextBlock=function(e){var t=this._addTextBlock(e);if(!t)return!1;e.updateUV();for(var r=!1,i=t,n=this._sortLines,a=0,o=n;a<o.length;a++){var s=o[a];if(s===i[1]){r=!0;break}}return r||n.push(i[1]),this.sort(),!0},t.prototype._addTextBlock=function(e){if(!e)return null;if(e.width>this._maxSize||e.height>this._maxSize)return null;for(var t=this._sortLines,r=0,n=t.length;n>r;++r){var a=t[r];if(a.isCapacityOf(e)&&a.addTextBlock(e,!1))return[a.page,a]}var o=new i(this._maxSize);if(!o.addTextBlock(e,!0))return console.error("_addTextBlock !newLine.addTextBlock(textBlock, true)"),null;for(var s=this._pages,r=0,l=s.length;l>r;++r){var c=s[r];if(c.addLine(o))return[c,o]}var h=this.createPage(this._maxSize,this._maxSize);return h.addLine(o)?[h,o]:(console.error("_addText newPage.addLine failed"),null)},t.prototype.createPage=function(e,t){var r=new n(e,t);return this._pages.push(r),r},t.prototype.sort=function(){if(!(this._sortLines.length<=1)){var e=function(e,t){return e.dynamicMaxHeight<t.dynamicMaxHeight?-1:1};this._sortLines=this._sortLines.sort(e)}},t.prototype.createTextBlock=function(e,t,i,n,a,o,s,l){var c=new r(t,i,n,a,o,s,l,this._border);return this.addTextBlock(c)?(c.tag=e,c):null},t}(e.HashObject);t.Book=a,__reflect(a.prototype,"egret.web.Book")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){t.textAtlasRenderEnable=!1,t.__textAtlasRender__=null,t.property_drawLabel="DrawLabel";var r=!1,i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.anchorX=0,t.anchorY=0,t.textBlocks=[],t}return __extends(t,e),t.prototype.clear=function(){this.anchorX=0,this.anchorY=0,this.textBlocks.length=0},t.create=function(){var e=t.pool;return 0===e.length&&e.push(new t),e.pop()},t.back=function(e,r){if(e){var i=t.pool;if(r&&i.indexOf(e)>=0)return void console.error("DrawLabel.back repeat");e.clear(),i.push(e)}},t.pool=[],t}(e.HashObject);t.DrawLabel=i,__reflect(i.prototype,"egret.web.DrawLabel");var n=function(t){function i(i,n){var a=t.call(this)||this;a.format=null;var o=0;r&&(o=i.textColor,i.textColor=16711680),a.textColor=i.textColor,a.strokeColor=i.strokeColor,a.size=i.size,a.stroke=i.stroke,a.bold=i.bold,a.italic=i.italic,a.fontFamily=i.fontFamily,a.format=n,a.font=e.getFontString(i,a.format);var s=n.textColor?n.textColor:i.textColor,l=n.strokeColor?n.strokeColor:i.strokeColor,c=n.stroke?n.stroke:i.stroke,h=n.size?n.size:i.size;return a.description=""+a.font+"-"+h,a.description+="-"+e.toColorString(s),a.description+="-"+e.toColorString(l),c&&(a.description+="-"+2*c),r&&(i.textColor=o),a}return __extends(i,t),i}(e.HashObject);__reflect(n.prototype,"StyleInfo");var a=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e["char"]="",e.styleInfo=null,e.hashCodeString="",e.charWithStyleHashCode=0,e.measureWidth=0,e.measureHeight=0,e.canvasWidthOffset=0,e.canvasHeightOffset=0,e.stroke2=0,e}return __extends(r,t),r.prototype.reset=function(t,r){return this["char"]=t,this.styleInfo=r,this.hashCodeString=t+":"+r.description,this.charWithStyleHashCode=e.NumberUtils.convertStringToHashCode(this.hashCodeString),this.canvasWidthOffset=0,this.canvasHeightOffset=0,this.stroke2=0,this},r.prototype.measureAndDraw=function(t){var r=t;if(r){var i=this["char"],n=this.styleInfo.format,a=n.textColor?n.textColor:this.styleInfo.textColor,o=n.strokeColor?n.strokeColor:this.styleInfo.strokeColor,s=n.stroke?n.stroke:this.styleInfo.stroke,l=n.size?n.size:this.styleInfo.size;this.measureWidth=this.measure(i,this.styleInfo,l),this.measureHeight=l;var c=this.measureWidth,h=this.measureHeight,u=2*s;u>0&&(c+=2*u,h+=2*u),this.stroke2=u,r.width=c=Math.ceil(c)+4,r.height=h=Math.ceil(h)+4,this.canvasWidthOffset=(r.width-this.measureWidth)/2,this.canvasHeightOffset=(r.height-this.measureHeight)/2;var d=3,f=Math.pow(10,d);this.canvasWidthOffset=Math.floor(this.canvasWidthOffset*f)/f,this.canvasHeightOffset=Math.floor(this.canvasHeightOffset*f)/f;var p=e.sys.getContext2d(r);p.save(),p.textAlign="center",p.textBaseline="middle",p.lineJoin="round",p.font=this.styleInfo.font,p.fillStyle=e.toColorString(a),p.strokeStyle=e.toColorString(o),p.clearRect(0,0,r.width,r.height),s&&(p.lineWidth=2*s,p.strokeText(i,r.width/2,r.height/2)),p.fillText(i,r.width/2,r.height/2),p.restore()}},r.prototype.measure=function(t,i,n){var a=r.chineseCharactersRegExp.test(t);if(a&&r.chineseCharacterMeasureFastMap[i.font])return r.chineseCharacterMeasureFastMap[i.font];var o=e.sys.measureText(t,i.fontFamily,n||i.size,i.bold,i.italic);return a&&(r.chineseCharacterMeasureFastMap[i.font]=o),o},r.chineseCharactersRegExp=new RegExp("^[-]$"),r.chineseCharacterMeasureFastMap={},r}(e.HashObject);__reflect(a.prototype,"CharImageRender");var o=function(o){function s(e,r,i){var n=o.call(this)||this;return n.book=null,n.charImageRender=new a,n.textBlockMap={},n._canvas=null,n.textAtlasTextureCache=[],n.webglRenderContext=null,n.webglRenderContext=e,n.book=new t.Book(r,i),n}return __extends(s,o),s.analysisTextNodeAndFlushDrawLabel=function(a){if(a){if(!t.__textAtlasRender__){var o=e.web.WebGLRenderContext.getInstance(0,0);t.__textAtlasRender__=new s(o,512,r?12:1)}a[t.property_drawLabel]=a[t.property_drawLabel]||[];for(var l=a[t.property_drawLabel],c=0,h=l;c<h.length;c++){var u=h[c];i.back(u,!1)}l.length=0;for(var d=4,f=a.drawData,p=0,v=0,g="",x={},m=[],y=0,b=f.length;b>y;y+=d){p=f[y+0],v=f[y+1],g=f[y+2],x=f[y+3]||{},m.length=0,t.__textAtlasRender__.convertLabelStringToTextAtlas(g,new n(a,x),m);var u=i.create();u.anchorX=p,u.anchorY=v,u.textBlocks=[].concat(m),l.push(u)}}},s.prototype.convertLabelStringToTextAtlas=function(t,i,n){for(var a=this.canvas,o=this.charImageRender,s=this.textBlockMap,l=0,c=t;l<c.length;l++){var h=c[l];if(o.reset(h,i),s[o.charWithStyleHashCode])n.push(s[o.charWithStyleHashCode]);else{o.measureAndDraw(a);var u=this.book.createTextBlock(h,a.width,a.height,o.measureWidth,o.measureHeight,o.canvasWidthOffset,o.canvasHeightOffset,o.stroke2);if(u){n.push(u),s[o.charWithStyleHashCode]=u;var d=u.page;d.webGLTexture||(d.webGLTexture=this.createTextTextureAtlas(d.pageWidth,d.pageHeight,r));var f=this.webglRenderContext.context;d.webGLTexture[e.glContext]=f,f.bindTexture(f.TEXTURE_2D,d.webGLTexture),f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),d.webGLTexture[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL]=!0,f.texSubImage2D(f.TEXTURE_2D,0,u.subImageOffsetX,u.subImageOffsetY,f.RGBA,f.UNSIGNED_BYTE,a),f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1)}}}},s.prototype.createTextTextureAtlas=function(t,r,i){var n=null;if(i){var a=e.sys.createCanvas(t,t),o=e.sys.getContext2d(a);o.fillStyle="black",o.fillRect(0,0,t,t),n=e.sys.createTexture(this.webglRenderContext,a)}else n=e.sys._createTexture(this.webglRenderContext,t,r,null);return n&&this.textAtlasTextureCache.push(n),n},Object.defineProperty(s.prototype,"canvas",{get:function(){return this._canvas||(this._canvas=e.sys.createCanvas(24,24)),this._canvas},enumerable:!0,configurable:!0}),s}(e.HashObject);t.TextAtlasRender=o,__reflect(o.prototype,"egret.web.TextAtlasRender")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(e){var t=function(){function e(e,t,r){this.gl=e,this.name=r.name,this.type=r.type,this.size=r.size,this.location=e.getAttribLocation(t,this.name),this.count=0,this.initCount(e),this.format=e.FLOAT,this.initFormat(e)
}return e.prototype.initCount=function(e){var t=this.type;switch(t){case 5126:case 5120:case 5121:case 5123:this.count=1;break;case 35664:this.count=2;break;case 35665:this.count=3;break;case 35666:this.count=4}},e.prototype.initFormat=function(e){var t=this.type;switch(t){case 5126:case 35664:case 35665:case 35666:this.format=e.FLOAT;break;case 5121:this.format=e.UNSIGNED_BYTE;break;case 5123:this.format=e.UNSIGNED_SHORT;break;case 5120:this.format=e.BYTE}},e}();e.EgretWebGLAttribute=t,__reflect(t.prototype,"egret.web.EgretWebGLAttribute")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(e){function t(e,t,r){var i=e.createShader(t);e.shaderSource(i,r),e.compileShader(i);var n=e.getShaderParameter(i,e.COMPILE_STATUS);return n||(console.log("shader not compiled!"),console.log(e.getShaderInfoLog(i))),i}function r(e,t,r){var i=e.createProgram();return e.attachShader(i,t),e.attachShader(i,r),e.linkProgram(i),i}function i(t,r){for(var i={},n=t.getProgramParameter(r,t.ACTIVE_ATTRIBUTES),a=0;n>a;a++){var o=t.getActiveAttrib(r,a),s=o.name,l=new e.EgretWebGLAttribute(t,r,o);i[s]=l}return i}function n(t,r){for(var i={},n=t.getProgramParameter(r,t.ACTIVE_UNIFORMS),a=0;n>a;a++){var o=t.getActiveUniform(r,a),s=o.name,l=new e.EgretWebGLUniform(t,r,o);i[s]=l}return i}var a=function(){function e(e,a,o){this.vshaderSource=a,this.fshaderSource=o,this.vertexShader=t(e,e.VERTEX_SHADER,this.vshaderSource),this.fragmentShader=t(e,e.FRAGMENT_SHADER,this.fshaderSource),this.id=r(e,this.vertexShader,this.fragmentShader),this.uniforms=n(e,this.id),this.attributes=i(e,this.id)}return e.getProgram=function(t,r,i,n){return this.programCache[n]||(this.programCache[n]=new e(t,r,i)),this.programCache[n]},e.deleteProgram=function(e,t,r,i){},e.programCache={},e}();e.EgretWebGLProgram=a,__reflect(a.prototype,"egret.web.EgretWebGLProgram")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(e){var t=function(){function e(e,t,r){this.gl=e,this.name=r.name,this.type=r.type,this.size=r.size,this.location=e.getUniformLocation(t,this.name),this.setDefaultValue(),this.generateSetValue(),this.generateUpload()}return e.prototype.setDefaultValue=function(){var e=this.type;switch(e){case 5126:case 35678:case 35680:case 35670:case 5124:this.value=0;break;case 35664:case 35671:case 35667:this.value=[0,0];break;case 35665:case 35672:case 35668:this.value=[0,0,0];break;case 35666:case 35673:case 35669:this.value=[0,0,0,0];break;case 35674:this.value=new Float32Array([1,0,0,1]);break;case 35675:this.value=new Float32Array([1,0,0,0,1,0,0,0,1]);break;case 35676:this.value=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},e.prototype.generateSetValue=function(){var e=this.type;switch(e){case 5126:case 35678:case 35680:case 35670:case 5124:this.setValue=function(e){var t=this.value!==e;this.value=e,t&&this.upload()};break;case 35664:case 35671:case 35667:this.setValue=function(e){var t=this.value[0]!==e.x||this.value[1]!==e.y;this.value[0]=e.x,this.value[1]=e.y,t&&this.upload()};break;case 35665:case 35672:case 35668:this.setValue=function(e){this.value[0]=e.x,this.value[1]=e.y,this.value[2]=e.z,this.upload()};break;case 35666:case 35673:case 35669:this.setValue=function(e){this.value[0]=e.x,this.value[1]=e.y,this.value[2]=e.z,this.value[3]=e.w,this.upload()};break;case 35674:case 35675:case 35676:this.setValue=function(e){this.value.set(e),this.upload()}}},e.prototype.generateUpload=function(){var e=this.gl,t=this.type,r=this.location;switch(t){case 5126:this.upload=function(){var t=this.value;e.uniform1f(r,t)};break;case 35664:this.upload=function(){var t=this.value;e.uniform2f(r,t[0],t[1])};break;case 35665:this.upload=function(){var t=this.value;e.uniform3f(r,t[0],t[1],t[2])};break;case 35666:this.upload=function(){var t=this.value;e.uniform4f(r,t[0],t[1],t[2],t[3])};break;case 35678:case 35680:case 35670:case 5124:this.upload=function(){var t=this.value;e.uniform1i(r,t)};break;case 35671:case 35667:this.upload=function(){var t=this.value;e.uniform2i(r,t[0],t[1])};break;case 35672:case 35668:this.upload=function(){var t=this.value;e.uniform3i(r,t[0],t[1],t[2])};break;case 35673:case 35669:this.upload=function(){var t=this.value;e.uniform4i(r,t[0],t[1],t[2],t[3])};break;case 35674:this.upload=function(){var t=this.value;e.uniformMatrix2fv(r,!1,t)};break;case 35675:this.upload=function(){var t=this.value;e.uniformMatrix3fv(r,!1,t)};break;case 35676:this.upload=function(){var t=this.value;e.uniformMatrix4fv(r,!1,t)}}},e}();e.EgretWebGLUniform=t,__reflect(t.prototype,"egret.web.EgretWebGLUniform")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(e){var t=function(){function e(){}return e.blur_frag="precision mediump float;\r\nuniform vec2 blur;\r\nuniform sampler2D uSampler;\r\nvarying vec2 vTextureCoord;\r\nuniform vec2 uTextureSize;\r\nvoid main()\r\n{\r\n    const int sampleRadius = 5;\r\n    const int samples = sampleRadius * 2 + 1;\r\n    vec2 blurUv = blur / uTextureSize;\r\n    vec4 color = vec4(0, 0, 0, 0);\r\n    vec2 uv = vec2(0.0, 0.0);\r\n    blurUv /= float(sampleRadius);\r\n\r\n    for (int i = -sampleRadius; i <= sampleRadius; i++) {\r\n        uv.x = vTextureCoord.x + float(i) * blurUv.x;\r\n        uv.y = vTextureCoord.y + float(i) * blurUv.y;\r\n        color += texture2D(uSampler, uv);\r\n    }\r\n\r\n    color /= float(samples);\r\n    gl_FragColor = color;\r\n}",e.colorTransform_frag="precision mediump float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\nuniform mat4 matrix;\r\nuniform vec4 colorAdd;\r\nuniform sampler2D uSampler;\r\n\r\nvoid main(void) {\r\n    vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n    if(texColor.a > 0.) {\r\n        // alpha\r\n        texColor = vec4(texColor.rgb / texColor.a, texColor.a);\r\n    }\r\n    vec4 locColor = clamp(texColor * matrix + colorAdd, 0., 1.);\r\n    gl_FragColor = vColor * vec4(locColor.rgb * locColor.a, locColor.a);\r\n}",e.default_vert="attribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\nattribute vec4 aColor;\r\n\r\nuniform vec2 projectionVector;\r\n// uniform vec2 offsetVector;\r\n\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\n\r\nconst vec2 center = vec2(-1.0, 1.0);\r\n\r\nvoid main(void) {\r\n   gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\r\n   vTextureCoord = aTextureCoord;\r\n   vColor = aColor;\r\n}",e.glow_frag="precision highp float;\r\nvarying vec2 vTextureCoord;\r\n\r\nuniform sampler2D uSampler;\r\n\r\nuniform float dist;\r\nuniform float angle;\r\nuniform vec4 color;\r\nuniform float alpha;\r\nuniform float blurX;\r\nuniform float blurY;\r\n// uniform vec4 quality;\r\nuniform float strength;\r\nuniform float inner;\r\nuniform float knockout;\r\nuniform float hideObject;\r\n\r\nuniform vec2 uTextureSize;\r\n\r\nfloat random(vec2 scale)\r\n{\r\n    return fract(sin(dot(gl_FragCoord.xy, scale)) * 43758.5453);\r\n}\r\n\r\nvoid main(void) {\r\n    vec2 px = vec2(1.0 / uTextureSize.x, 1.0 / uTextureSize.y);\r\n    // TODO \r\n    const float linearSamplingTimes = 7.0;\r\n    const float circleSamplingTimes = 12.0;\r\n    vec4 ownColor = texture2D(uSampler, vTextureCoord);\r\n    vec4 curColor;\r\n    float totalAlpha = 0.0;\r\n    float maxTotalAlpha = 0.0;\r\n    float curDistanceX = 0.0;\r\n    float curDistanceY = 0.0;\r\n    float offsetX = dist * cos(angle) * px.x;\r\n    float offsetY = dist * sin(angle) * px.y;\r\n\r\n    const float PI = 3.14159265358979323846264;\r\n    float cosAngle;\r\n    float sinAngle;\r\n    float offset = PI * 2.0 / circleSamplingTimes * random(vec2(12.9898, 78.233));\r\n    float stepX = blurX * px.x / linearSamplingTimes;\r\n    float stepY = blurY * px.y / linearSamplingTimes;\r\n    for (float a = 0.0; a <= PI * 2.0; a += PI * 2.0 / circleSamplingTimes) {\r\n        cosAngle = cos(a + offset);\r\n        sinAngle = sin(a + offset);\r\n        for (float i = 1.0; i <= linearSamplingTimes; i++) {\r\n            curDistanceX = i * stepX * cosAngle;\r\n            curDistanceY = i * stepY * sinAngle;\r\n            if (vTextureCoord.x + curDistanceX - offsetX >= 0.0 && vTextureCoord.y + curDistanceY + offsetY <= 1.0){\r\n                curColor = texture2D(uSampler, vec2(vTextureCoord.x + curDistanceX - offsetX, vTextureCoord.y + curDistanceY + offsetY));\r\n                totalAlpha += (linearSamplingTimes - i) * curColor.a;\r\n            }\r\n            maxTotalAlpha += (linearSamplingTimes - i);\r\n        }\r\n    }\r\n\r\n    ownColor.a = max(ownColor.a, 0.0001);\r\n    ownColor.rgb = ownColor.rgb / ownColor.a;\r\n\r\n    float outerGlowAlpha = (totalAlpha / maxTotalAlpha) * strength * alpha * (1. - inner) * max(min(hideObject, knockout), 1. - ownColor.a);\r\n    float innerGlowAlpha = ((maxTotalAlpha - totalAlpha) / maxTotalAlpha) * strength * alpha * inner * ownColor.a;\r\n\r\n    ownColor.a = max(ownColor.a * knockout * (1. - hideObject), 0.0001);\r\n    vec3 mix1 = mix(ownColor.rgb, color.rgb, innerGlowAlpha / (innerGlowAlpha + ownColor.a));\r\n    vec3 mix2 = mix(mix1, color.rgb, outerGlowAlpha / (innerGlowAlpha + ownColor.a + outerGlowAlpha));\r\n    float resultAlpha = min(ownColor.a + outerGlowAlpha + innerGlowAlpha, 1.);\r\n    gl_FragColor = vec4(mix2 * resultAlpha, resultAlpha);\r\n}",e.primitive_frag="precision lowp float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\n\r\nvoid main(void) {\r\n    gl_FragColor = vColor;\r\n}",e.texture_frag="precision lowp float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\nuniform sampler2D uSampler;\r\n\r\nvoid main(void) {\r\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;\r\n}",e.texture_etc_alphamask_frag="precision lowp float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\nuniform sampler2D uSampler;\r\nuniform sampler2D uSamplerAlphaMask;\r\nvoid main(void) {\r\nfloat alpha = texture2D(uSamplerAlphaMask, vTextureCoord).r;\r\nif (alpha < 0.0039) { discard; }\r\nvec4 v4Color = texture2D(uSampler, vTextureCoord);\r\nv4Color.rgb = v4Color.rgb * alpha;\r\nv4Color.a = alpha;\r\ngl_FragColor = v4Color * vColor;\r\n}",e.colorTransform_frag_etc_alphamask_frag="precision mediump float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\nuniform mat4 matrix;\r\nuniform vec4 colorAdd;\r\nuniform sampler2D uSampler;\r\nuniform sampler2D uSamplerAlphaMask;\r\n\r\nvoid main(void){\r\nfloat alpha = texture2D(uSamplerAlphaMask, vTextureCoord).r;\r\nif (alpha < 0.0039) { discard; }\r\nvec4 texColor = texture2D(uSampler, vTextureCoord);\r\nif(texColor.a > 0.0) {\r\n // alpha\r\ntexColor = vec4(texColor.rgb / texColor.a, texColor.a);\r\n}\r\nvec4 v4Color = clamp(texColor * matrix + colorAdd, 0.0, 1.0);\r\nv4Color.rgb = v4Color.rgb * alpha;\r\nv4Color.a = alpha;\r\ngl_FragColor = v4Color * vColor;\r\n}",e}();e.EgretShaderLib=t,__reflect(t.prototype,"egret.web.EgretShaderLib")}(t=e.web||(e.web={}))}(egret||(egret={}));

 //js/assetsmanager.min_f5f8ba18.js
var __reflect=this&&this.__reflect||function(e,r,t){e.__class__=r,t?t.push(r):t=[r],e.__types__=e.__types__?t.concat(e.__types__):t},__extends=this&&this.__extends||function(e,r){function t(){this.constructor=e}for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);t.prototype=r.prototype,e.prototype=new t},__decorate=this&&this.__decorate||function(e,r,t,o){var n,i=arguments.length,a=3>i?r:null===o?o=Object.getOwnPropertyDescriptor(r,t):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,r,t,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(3>i?n(a):i>3?n(r,t,a):n(r,t))||a);return i>3&&a&&Object.defineProperty(r,t,a),a},RES;!function(e){e.checkNull=function(e,r,t){var o=t.value;t.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e[0]?o.apply(this,e):(console.warn(""+r+"null"),null)}},e.FEATURE_FLAG={FIX_DUPLICATE_LOAD:1};var r;!function(e){function r(e){t=e}var t="warning";e.setUpgradeGuideLevel=r}(r=e.upgrade||(e.upgrade={}))}(RES||(RES={}));var RES;!function(e){function r(r){var t=e.config.config.fileSystem.getFile(r);return t||(r=e.resourceNameSelector(r),t=e.config.config.fileSystem.getFile(r)),t}function t(e,r){var t;t=e.indexOf(".json")>=0?"legacyResourceConfig":"resourceConfig",o={type:t,root:r,url:e,name:e}}e.resourceNameSelector=function(e){return e},e.getResourceInfo=r;var o;e.setConfigURL=t;var n=function(){function t(){}return t.prototype.init=function(){return this.config||(this.config={alias:{},groups:{},resourceRoot:o.root,mergeSelector:null,fileSystem:null,loadGroup:[]}),e.queue.pushResItem(o)["catch"](function(r){return e.isCompatible||r.__resource_manager_error__||(r.error?console.error(r.error.stack):console.error(r.stack),r=new e.ResourceManagerError(1002)),e.host.remove(o),Promise.reject(r)})},t.prototype.getGroupByName=function(r){var t=this.config.groups[r],o=[];if(!t)return o;for(var n=0,i=t;n<i.length;n++){var a=i[n],s=void 0;if(s=e.config.getResourceWithSubkey(a),null!=s){var u=s.r,c=s.key;if(null==u)throw new e.ResourceManagerError(2005,c);-1==o.indexOf(u)&&o.push(u)}}return o},t.prototype.__temp__get__type__via__url=function(r){var t=this.config.alias[r];if(t||(t=r),e.typeSelector){var o=e.typeSelector(t);if(!o)throw new e.ResourceManagerError(2004,t);return o}return console.warn("RES.mapConfig  typeSelector"),"unknown"},t.prototype.getResourceWithSubkey=function(e){e=this.getKeyByAlias(e);var r=e.indexOf("#"),t="";r>=0&&(t=e.substr(r+1),e=e.substr(0,r));var o=this.getResource(e);return o?{r:o,key:e,subkey:t}:null},t.prototype.getKeyByAlias=function(e){return this.config.alias[e]?this.config.alias[e]:e},t.prototype.getResource=function(e){var t=this.config.alias[e];t||(t=e);var o=r(t);return o?o:null},t.prototype.createGroup=function(e,r,t){if(void 0===t&&(t=!1),!t&&this.config.groups[e]||!r||0==r.length)return!1;for(var o=[],n=0,i=r;n<i.length;n++){var a=i[n];if(this.config.groups[a]){var s=this.config.groups[a];o=o.concat(s)}else o.push(a)}return this.config.groups[e]=o,!0},t.prototype.addSubkey=function(e,r){this.addAlias(e,r+"#"+e)},t.prototype.addAlias=function(e,r){this.config.alias[r]&&(r=this.config.alias[r]),this.config.alias[e]=r},t.prototype.addResourceData=function(r){e.hasRes(r.name)||(r.type||(r.type=this.__temp__get__type__via__url(r.url)),e.config.config.fileSystem.addFile(r))},t.prototype.removeResourceData=function(r){e.hasRes(r.name)&&(e.config.config.fileSystem.removeFile(r.url),this.config.alias[r.name]&&delete this.config.alias[r.name])},t}();e.ResourceConfig=n,__reflect(n.prototype,"RES.ResourceConfig")}(RES||(RES={}));var RES;!function(e){var r=function(){function r(){this.groupTotalDic={},this.numLoadedDic={},this.groupErrorDic={},this.retryTimesDic={},this.maxRetryTimes=3,this.reporterDic={},this.dispatcherDic={},this.failedList=new Array,this.loadItemErrorDic={},this.errorDic={},this.itemListPriorityDic={},this.itemLoadDic={},this.promiseHash={},this.lazyLoadList=new Array,this.loadingCount=0,this.thread=4}return r.prototype.pushResItem=function(e){if(this.promiseHash[e.root+e.name])return this.promiseHash[e.root+e.name];this.lazyLoadList.push(e),this.itemListPriorityDic[Number.NEGATIVE_INFINITY]=this.lazyLoadList,this.updatelistPriority(this.lazyLoadList,Number.NEGATIVE_INFINITY);var r=new egret.EventDispatcher;this.dispatcherDic[e.root+e.name]=r;var t=new Promise(function(e,t){r.addEventListener("complete",function(r){e(r.data)},null),r.addEventListener("error",function(e){t(e.data)},null)});return this.promiseHash[e.root+e.name]=t,this.loadNextResource(),t},r.prototype.pushResGroup=function(e,r,t,o){if(this.promiseHash[r])return this.promiseHash[r];for(var n=e.length,i=0;n>i;i++){var a=e[i];a.groupNames||(a.groupNames=[]),a.groupNames.push(r)}this.groupTotalDic[r]=e.length,this.numLoadedDic[r]=0,this.updatelistPriority(e,t),this.reporterDic[r]=o;var s=new egret.EventDispatcher;this.dispatcherDic[r]=s;var u=new Promise(function(e,r){s.addEventListener("complete",e,null),s.addEventListener("error",function(e){r(e.data)},null)});return this.promiseHash[r]=u,this.loadNextResource(),u},r.prototype.updatelistPriority=function(e,r){void 0==this.itemListPriorityDic[r]&&(this.itemListPriorityDic[r]=[]);for(var t=0,o=e;t<o.length;t++){var n=o[t];if(1!=this.itemLoadDic[n.root+n.name]){var i=this.findPriorityInDic(n);if(void 0==i)this.itemListPriorityDic[r].push(n);else if(r>i){this.itemListPriorityDic[r].push(n);var a=this.itemListPriorityDic[i].indexOf(n);this.itemListPriorityDic[i].splice(a,1)}}}},r.prototype.findPriorityInDic=function(e){for(var r in this.itemListPriorityDic)if(this.itemListPriorityDic[r].indexOf(e)>-1)return parseInt(r)},r.prototype.loadNextResource=function(){for(;this.loadingCount<this.thread;){var e=this.loadSingleResource();if(!e)break}},r.prototype.loadSingleResource=function(){var r=this,t=this.getOneResourceInfoInGroup();return t?(this.itemLoadDic[t.root+t.name]=1,this.loadingCount++,this.loadResource(t).then(function(o){if(r.loadingCount--,delete r.itemLoadDic[t.root+t.name],e.host.save(t,o),r.promiseHash[t.root+t.name]){var n=r.deleteDispatcher(t.root+t.name);n.dispatchEventWith("complete",!1,o)}var i=t.groupNames;if(i){delete t.groupNames;for(var a=0,s=i;a<s.length;a++){var u=s[a];r.setGroupProgress(u,t)&&r.loadGroupEnd(u)}}r.loadNextResource()})["catch"](function(o){if(!o)throw t.name+" load fail";if(!o.__resource_manager_error__)throw o;delete r.itemLoadDic[t.root+t.name],r.loadingCount--,delete e.host.state[t.root+t.name];var n=r.retryTimesDic[t.name]||1;if(!(n>r.maxRetryTimes))return r.retryTimesDic[t.name]=n+1,r.failedList.push(t),void r.loadNextResource();if(delete r.retryTimesDic[t.name],r.promiseHash[t.root+t.name]){var i=r.deleteDispatcher(t.root+t.name);i.dispatchEventWith("error",!1,{r:t,error:o})}var a=t.groupNames;if(a){delete t.groupNames;for(var s=0,u=a;s<u.length;s++){var c=u[s];r.loadItemErrorDic[c]||(r.loadItemErrorDic[c]=[]),-1==r.loadItemErrorDic[c].indexOf(t)&&r.loadItemErrorDic[c].push(t),r.groupErrorDic[c]=!0,r.setGroupProgress(c,t)?r.loadGroupEnd(c,o):r.errorDic[c]=o}}r.loadNextResource()}),!0):!1},r.prototype.getOneResourceInfoInGroup=function(){if(this.failedList.length>0)return this.failedList.shift();var e=Number.NEGATIVE_INFINITY;for(var r in this.itemListPriorityDic)e=Math.max(e,r);var t=this.itemListPriorityDic[e];if(t)return 0==t.length?(delete this.itemListPriorityDic[e],this.getOneResourceInfoInGroup()):t.shift()},r.prototype.setGroupProgress=function(e,r){var t=this.reporterDic[e];this.numLoadedDic[e]++;var o=this.numLoadedDic[e],n=this.groupTotalDic[e];return t&&t.onProgress&&t.onProgress(o,n,r),o==n},r.prototype.loadGroupEnd=function(e,r){delete this.groupTotalDic[e],delete this.numLoadedDic[e],delete this.reporterDic[e];var t=this.deleteDispatcher(e);if(r){delete this.groupErrorDic[e];var o=this.loadItemErrorDic[e];delete this.loadItemErrorDic[e],t.dispatchEventWith("error",!1,{itemList:o,lastError:r})}else{var n=this.groupErrorDic[e];if(delete this.groupErrorDic[e],n){var o=this.loadItemErrorDic[e];delete this.loadItemErrorDic[e];var i=this.errorDic[e];delete this.errorDic[e],t.dispatchEventWith("error",!1,{itemList:o,error:i})}else t.dispatchEventWith("complete")}},r.prototype.deleteDispatcher=function(e){delete this.promiseHash[e];var r=this.dispatcherDic[e];return delete this.dispatcherDic[e],r},r.prototype.loadResource=function(r,t){if(!t){if(1==e.FEATURE_FLAG.FIX_DUPLICATE_LOAD){var o=e.host.state[r.root+r.name];if(2==o)return Promise.resolve(e.host.get(r));if(1==o)return r.promise}t=e.processor.isSupport(r)}if(!t)throw new e.ResourceManagerError(2001,r.name,r.type);e.host.state[r.root+r.name]=1;var n=t.onLoadStart(e.host,r);return r.promise=n,n},r.prototype.unloadResource=function(r){var t=e.host.get(r);if(!t)return console.warn(":",r.name),!1;var o=e.processor.isSupport(r);return o?(o.onRemoveStart(e.host,r),e.host.remove(r),1==r.extra&&e.config.removeResourceData(r),!0):!0},r}();e.ResourceLoader=r,__reflect(r.prototype,"RES.ResourceLoader")}(RES||(RES={}));var RES;!function(e){}(RES||(RES={}));var RES;!function(e){var r;!function(e){function r(e){var r=e.split("/");return r.filter(function(e,t){return!!e||t==r.length-1}).join("/")}function t(e){return e.substr(e.lastIndexOf("/")+1)}function o(e){return e.substr(0,e.lastIndexOf("/"))}e.normalize=r,e.basename=t,e.dirname=o}(r=e.path||(e.path={}))}(RES||(RES={}));var RES;!function(e){function r(){e.config.config.fileSystem.profile(),console.log(t);var r=0;for(var o in t){var n=t[o];n instanceof egret.Texture&&(r+=n.$bitmapWidth*n.$bitmapHeight*4)}console.log("gpu size : "+(r/1024).toFixed(3)+"kb")}var t={};e.profile=r,e.host={state:{},get resourceConfig(){return e.config},load:function(r,t){var o="string"==typeof t?e.processor._map[t]:t;return e.queue.loadResource(r,o)},unload:function(r){return e.queue.unloadResource(r)},save:function(r,o){e.host.state[r.root+r.name]=2,delete r.promise,t[r.root+r.name]=o},get:function(e){return t[e.root+e.name]},remove:function(r){delete e.host.state[r.root+r.name],delete t[r.root+r.name]}},e.config=new e.ResourceConfig,e.queue=new e.ResourceLoader;var o=function(e){function r(t,o,n){var i=e.call(this)||this;return i.__resource_manager_error__=!0,i.name=t.toString(),i.message=r.errorMessage[t].replace("{0}",o).replace("{1}",n),i}return __extends(r,e),r.errorMessage={1001:":{0}",1002:"ResourceManager ",2001:"{0},:'{1}' Processor  https://github.com/egret-labs/resourcemanager/blob/master/docs/README.md#processor",2002:"Analyzer API  ResourceManager  Processor  https://github.com/egret-labs/resourcemanager/blob/master/docs/README.md#processor",2003:"{0},:{1}",2004:":{0}",2005:'RES:"{0}"',2006:":{0}"},r}(Error);e.ResourceManagerError=o,__reflect(o.prototype,"RES.ResourceManagerError")}(RES||(RES={}));var RES;!function(e){var r=function(){function r(e){this.data=e}return r.prototype.profile=function(){console.log(this.data)},r.prototype.addFile=function(r,t){t||(t=""),r=e.path.normalize(r);var o=e.path.basename(r),n=e.path.dirname(r);this.exists(n)||this.mkdir(n);var i=this.resolve(n);i[o]={url:r,type:t}},r.prototype.getFile=function(e){var r=this.resolve(e);return r&&(r.name=e),r},r.prototype.resolve=function(r){if(""==r)return this.data;r=e.path.normalize(r);for(var t=r.split("/"),o=this.data,n=0,i=t;n<i.length;n++){var a=i[n];if(!o)return o;o=o[a]}return o},r.prototype.mkdir=function(r){r=e.path.normalize(r);for(var t=r.split("/"),o=this.data,n=0,i=t;n<i.length;n++){var a=i[n];o[a]||(o[a]={}),o=o[a]}},r.prototype.exists=function(r){if(""==r)return!0;r=e.path.normalize(r);for(var t=r.split("/"),o=this.data,n=0,i=t;n<i.length;n++){var a=i[n];if(!o[a])return!1;o=o[a]}return!0},r}();e.NewFileSystem=r,__reflect(r.prototype,"RES.NewFileSystem")}(RES||(RES={}));var RES;!function(e){function r(r){return e.path.basename(r).split(".").join("_")}function t(r){var t,o=r.substr(r.lastIndexOf(".")+1);switch(o){case e.ResourceItem.TYPE_XML:case e.ResourceItem.TYPE_JSON:case e.ResourceItem.TYPE_SHEET:t=o;break;case"png":case"jpg":case"gif":case"jpeg":case"bmp":t=e.ResourceItem.TYPE_IMAGE;break;case"fnt":t=e.ResourceItem.TYPE_FONT;break;case"txt":t=e.ResourceItem.TYPE_TEXT;break;case"mp3":case"ogg":case"mpeg":case"wav":case"m4a":case"mp4":case"aiff":case"wma":case"mid":t=e.ResourceItem.TYPE_SOUND;break;case"mergeJson":case"zip":case"pvr":t=o;break;case"ttf":t=e.ResourceItem.TYPE_TTF;default:t=e.ResourceItem.TYPE_BIN}return t}function o(r,t){throw new e.ResourceManagerError(2002)}function n(r){e.isCompatible=r}function i(r,t){if(t.indexOf("://")>=0){var o=t.split("://");t=o[0]+"://"+e.path.normalize(o[1]+"/"),r=r.replace(t,"")}else t=e.path.normalize(t+"/"),r=r.replace(t,"");return e.setConfigURL(r,t),D||(D=new P),a(D.loadConfig())}function a(r){return e.isCompatible?void r["catch"](function(e){}).then():r}function s(e,r,t){return void 0===r&&(r=0),a(D.loadGroup(e,r,t))}function u(e){return D.isGroupLoaded(e)}function c(r){return D.getGroupByName(r).map(function(r){return e.ResourceItem.convertToResItem(r)})}function l(e,r,t){return void 0===t&&(t=!1),D.createGroup(e,r,t)}function f(e){return D.hasRes(e)}function p(e){return D.getRes(e)}function g(e,r,t){return a(D.getResAsync.apply(D,arguments))}function d(e,r,t,o){if(void 0===o&&(o=""),!D){var n=egret.sys.tr(3200);return egret.warn(n),Promise.reject(n)}return a(D.getResByUrl(e,r,t,o))}function h(e,r){return D.destroyRes(e,r)}function v(e){D||(D=new P),D.setMaxLoadingThread(e)}function m(e){D.setMaxRetryTimes(e)}function R(e,r,t,o,n){void 0===o&&(o=!1),void 0===n&&(n=0),D||(D=new P),D.addEventListener(e,r,t,o,n)}function y(e,r,t,o){void 0===o&&(o=!1),D.removeEventListener(e,r,t,o)}function E(e){D.addResourceData(e)}function _(){return D||(D=new P),D.vcs}function S(e){D||(D=new P),D.registerVersionController(e)}function L(e){return D.vcs?D.vcs.getVirtualUrl(e):e}e.nameSelector=r,e.typeSelector=t,e.registerAnalyzer=o,e.setIsCompatible=n,e.isCompatible=!1,e.loadConfig=i,e.loadGroup=s,e.isGroupLoaded=u,e.getGroupByName=c,e.createGroup=l,e.hasRes=f,e.getRes=p,e.getResAsync=g,e.getResByUrl=d,e.destroyRes=h,e.setMaxLoadingThread=v,e.setMaxRetryTimes=m,e.addEventListener=R,e.removeEventListener=y,e.$addResourceData=E,e.getVersionController=_,e.registerVersionController=S,e.getVirtualUrl=L;var P=function(r){function t(){var t=r.call(this)||this;return t.isVcsInit=!1,t.normalLoadConfig=function(){return e.config.init().then(function(r){e.ResourceEvent.dispatchResourceEvent(t,e.ResourceEvent.CONFIG_COMPLETE)},function(r){return e.ResourceEvent.dispatchResourceEvent(t,e.ResourceEvent.CONFIG_LOAD_ERROR),Promise.reject(r)})},e.VersionController&&(t.vcs=new e.VersionController),t}return __extends(t,r),t.prototype.registerVersionController=function(e){this.vcs=e,this.isVcsInit=!1},t.prototype.loadConfig=function(){var e=this;return!this.isVcsInit&&this.vcs?(this.isVcsInit=!0,this.vcs.init().then(function(){return e.normalLoadConfig()})):this.normalLoadConfig()},t.prototype.isGroupLoaded=function(r){var t=e.config.getGroupByName(r);return t.every(function(r){return null!=e.host.get(r)})},t.prototype.getGroupByName=function(r){return e.config.getGroupByName(r)},t.prototype.loadGroup=function(r,t,o){var n=this;void 0===t&&(t=0);var i={onProgress:function(t,i,a){o&&o.onProgress&&o.onProgress(t,i,a),e.ResourceEvent.dispatchResourceEvent(n,e.ResourceEvent.GROUP_PROGRESS,r,a,t,i)}};return this._loadGroup(r,t,i).then(function(t){-1==e.config.config.loadGroup.indexOf(r)&&e.config.config.loadGroup.push(r),e.ResourceEvent.dispatchResourceEvent(n,e.ResourceEvent.GROUP_COMPLETE,r)},function(t){if(-1==e.config.config.loadGroup.indexOf(r)&&e.config.config.loadGroup.push(r),t.itemList)for(var o=t.itemList,i=o.length,a=0;i>a;a++){var s=o[a];delete s.promise,e.ResourceEvent.dispatchResourceEvent(n,e.ResourceEvent.ITEM_LOAD_ERROR,r,s)}return e.isCompatible&&console.warn(t.error.message),e.ResourceEvent.dispatchResourceEvent(n,e.ResourceEvent.GROUP_LOAD_ERROR,r),Promise.reject(t.error)})},t.prototype._loadGroup=function(r,t,o){void 0===t&&(t=0);var n=e.config.getGroupByName(r);return 0==n.length?new Promise(function(t,o){o({error:new e.ResourceManagerError(2005,r)})}):e.queue.pushResGroup(n,r,t,o)},t.prototype.createGroup=function(r,t,o){return void 0===o&&(o=!1),e.config.createGroup(r,t,o)},t.prototype.hasRes=function(r){return null!=e.config.getResourceWithSubkey(r)},t.prototype.getRes=function(r){var t=e.config.getResourceWithSubkey(r);if(t){var o=t.r,n=t.key,i=t.subkey,a=e.processor.isSupport(o);return a&&a.getData&&i?a.getData(e.host,o,n,i):e.host.get(o)}return null},t.prototype.getResAsync=function(r,t,o){var n=this,i=r,a=e.config.getResourceWithSubkey(r);if(null==a)return t&&t.call(o,null,i),Promise.reject(new e.ResourceManagerError(2006,r));var s=this.getRes(r);if(s)return t&&egret.callLater(function(){t.call(o,s,i)},this),Promise.resolve(s);var u=a.r,c=a.subkey;return e.queue.pushResItem(u).then(function(n){e.host.save(u,n);var a=e.processor.isSupport(u);return a&&a.getData&&c&&(n=a.getData(e.host,u,r,c)),t&&t.call(o,n,i),n},function(r){return e.host.remove(u),e.ResourceEvent.dispatchResourceEvent(n,e.ResourceEvent.ITEM_LOAD_ERROR,"",u),t?(t.call(o,null,i),Promise.reject(null)):Promise.reject(r)})},t.prototype.getResByUrl=function(r,t,o,n){var i=this;void 0===n&&(n="");var a=e.config.getResource(r);if(!a&&(n||(n=e.config.__temp__get__type__via__url(r)),a={name:r,url:r,type:n,root:"",extra:1},e.config.addResourceData(a),a=e.config.getResource(r),!a))throw"never";return e.queue.pushResItem(a).then(function(r){return e.host.save(a,r),t&&a&&t.call(o,r,a.url),r},function(n){return e.host.remove(a),e.ResourceEvent.dispatchResourceEvent(i,e.ResourceEvent.ITEM_LOAD_ERROR,"",a),t?(t.call(o,null,r),Promise.reject(null)):Promise.reject(n)})},t.prototype.destroyRes=function(r,t){void 0===t&&(t=!0);var o=e.config.getGroupByName(r);if(o&&o.length>0){var n=e.config.config.loadGroup.indexOf(r);if(-1==n)return!1;if(t||1==e.config.config.loadGroup.length&&e.config.config.loadGroup[0]==r){for(var i=0,a=o;i<a.length;i++){var s=a[i];e.queue.unloadResource(s)}e.config.config.loadGroup.splice(n,1)}else{for(var u={},c=0,l=e.config.config.loadGroup;c<l.length;c++){var f=l[c];for(var p in e.config.config.groups[f]){var g=e.config.config.groups[f][p];u[g]?u[g]++:u[g]=1}}for(var d=0,h=o;d<h.length;d++){var s=h[d];u[s.name]&&1==u[s.name]&&e.queue.unloadResource(s)}e.config.config.loadGroup.splice(n,1)}return!0}var s=e.config.getResource(r);return s?e.queue.unloadResource(s):(console.warn(""+r+""),!1)},t.prototype.setMaxLoadingThread=function(r){1>r&&(r=1),e.queue.thread=r},t.prototype.setMaxRetryTimes=function(r){r=Math.max(r,0),e.queue.maxRetryTimes=r},t.prototype.addResourceData=function(r){r.root="",e.config.addResourceData(r)},__decorate([e.checkNull],t.prototype,"hasRes",null),__decorate([e.checkNull],t.prototype,"getRes",null),__decorate([e.checkNull],t.prototype,"getResAsync",null),__decorate([e.checkNull],t.prototype,"getResByUrl",null),t}(egret.EventDispatcher);e.Resource=P,__reflect(P.prototype,"RES.Resource");var D}(RES||(RES={}));var RES;!function(e){var r=function(r){function t(e,t,o){void 0===t&&(t=!1),void 0===o&&(o=!1);var n=r.call(this,e,t,o)||this;return n.itemsLoaded=0,n.itemsTotal=0,n.groupName="",n}return __extends(t,r),t.dispatchResourceEvent=function(r,o,n,i,a,s){void 0===n&&(n=""),void 0===i&&(i=void 0),void 0===a&&(a=0),void 0===s&&(s=0);var u=egret.Event.create(t,o);u.groupName=n,i&&(u.resItem=e.ResourceItem.convertToResItem(i)),u.itemsLoaded=a,u.itemsTotal=s;var c=r.dispatchEvent(u);return egret.Event.release(u),c},t.ITEM_LOAD_ERROR="itemLoadError",t.CONFIG_COMPLETE="configComplete",t.CONFIG_LOAD_ERROR="configLoadError",t.GROUP_PROGRESS="groupProgress",t.GROUP_COMPLETE="groupComplete",t.GROUP_LOAD_ERROR="groupLoadError",t}(egret.Event);e.ResourceEvent=r,__reflect(r.prototype,"RES.ResourceEvent")}(RES||(RES={}));var RES;!function(e){var r;!function(r){function t(r){var t=r.name;if(e.config.config)for(var o in e.config.config.alias)e.config.config.alias[o]==r.url&&(t=o);else t=r.url;var n={name:t,url:r.url,type:r.type,data:r,root:r.root};return n}r.TYPE_XML="xml",r.TYPE_IMAGE="image",r.TYPE_BIN="bin",r.TYPE_TEXT="text",r.TYPE_JSON="json",r.TYPE_SHEET="sheet",r.TYPE_FONT="font",r.TYPE_SOUND="sound",r.TYPE_TTF="ttf",r.convertToResItem=t}(r=e.ResourceItem||(e.ResourceItem={}))}(RES||(RES={}));var RES;!function(e){var r=function(){function e(){}return e.prototype.init=function(){return this.versionInfo=this.getLocalData("all.manifest"),Promise.resolve()},e.prototype.getVirtualUrl=function(e){return e},e.prototype.getLocalData=function(e){if(egret_native.readUpdateFileSync&&egret_native.readResourceFileSync){var r=egret_native.readUpdateFileSync(e);if(null!=r)return JSON.parse(r);if(r=egret_native.readResourceFileSync(e),null!=r)return JSON.parse(r)}return null},e}();e.NativeVersionController=r,__reflect(r.prototype,"RES.NativeVersionController",["RES.IVersionController"]),egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE&&(e.VersionController=r)}(RES||(RES={}));var RES;!function(e){var r;!function(r){function t(e){return r._map[e.type]}function o(e,t){r._map[e]=t}function n(r,t){var o=this;return new Promise(function(n,i){var a=function(){var e=r.data?r.data:r.response;n(e)},s=function(){var r=new e.ResourceManagerError(1001,t.url);i(r)};r.addEventListener(egret.Event.COMPLETE,a,o),r.addEventListener(egret.IOErrorEvent.IO_ERROR,s,o)})}function i(e,r){if(-1!=r.indexOf("://"))return r;e=e.split("\\").join("/");var t=e.match(/#.*|\?.*/),o="";t&&(o=t[0]);var n=e.lastIndexOf("/");return e=-1!=n?e.substring(0,n+1)+r:r,e+o}function a(e){return{name:e.name+"_alpha",url:e.etc1_alpha_url,type:"ktx",root:e.root}}r.isSupport=t,r.map=o,r.getRelativePath=i,r.ImageProcessor={onLoadStart:function(r,t){var o=new egret.ImageLoader;return o.load(e.getVirtualUrl(t.root+t.url)),n(o,t).then(function(e){var o=new egret.Texture;o._setBitmapData(e);var n=r.resourceConfig.getResource(t.name);if(n&&n.scale9grid){var i=n.scale9grid.split(",");o.scale9Grid=new egret.Rectangle(parseInt(i[0]),parseInt(i[1]),parseInt(i[2]),parseInt(i[3]))}return o})},onRemoveStart:function(e,r){var t=e.get(r);t.dispose()}},r.KTXTextureProcessor={onLoadStart:function(e,r){return e.load(r,"bin").then(function(t){if(!t)return console.error("ktx:"+r.root+r.url+" is null"),null;var o=new egret.KTXContainer(t,1);if(o.isInvalid)return console.error("ktx:"+r.root+r.url+" is invalid"),null;var n=new egret.BitmapData(t);n.debugCompressedTextureURL=r.root+r.url,n.format="ktx",o.uploadLevels(n,!1);var i=new egret.Texture;i._setBitmapData(n);var a=e.resourceConfig.getResource(r.name);if(a&&a.scale9grid){var s=a.scale9grid.split(",");i.scale9Grid=new egret.Rectangle(parseInt(s[0]),parseInt(s[1]),parseInt(s[2]),parseInt(s[3]))}return e.save(r,i),i},function(t){throw e.remove(r),t})},onRemoveStart:function(e,r){var t=e.get(r);t&&t.dispose()}},r.makeEtc1SeperatedAlphaResourceInfo=a,r.ETC1KTXProcessor={onLoadStart:function(e,r){return e.load(r,"ktx").then(function(t){if(!t)return null;if(r.etc1_alpha_url){var o=a(r);return e.load(o,"ktx").then(function(r){return t&&t.$bitmapData&&r.$bitmapData?(t.$bitmapData.etcAlphaMask=r.$bitmapData,e.save(o,r)):e.remove(o),t},function(r){throw e.remove(o),r})}return t},function(t){throw e.remove(r),t})},onRemoveStart:function(e,r){var t=e.get(r);if(t&&t.dispose(),r.etc1_alpha_url){var o=a(r),n=e.get(o);n&&n.dispose(),e.unload(o)}}},r.BinaryProcessor={onLoadStart:function(r,t){var o=new egret.HttpRequest;return o.responseType=egret.HttpResponseType.ARRAY_BUFFER,o.open(e.getVirtualUrl(t.root+t.url),"get"),o.send(),n(o,t)},onRemoveStart:function(e,r){}},r.TextProcessor={onLoadStart:function(r,t){var o=new egret.HttpRequest;return o.responseType=egret.HttpResponseType.TEXT,o.open(e.getVirtualUrl(t.root+t.url),"get"),o.send(),n(o,t)},onRemoveStart:function(e,r){return!0}},r.JsonProcessor={onLoadStart:function(e,r){return e.load(r,"text").then(function(e){var r=JSON.parse(e);return r})},onRemoveStart:function(e,r){}},r.XMLProcessor={onLoadStart:function(e,r){return e.load(r,"text").then(function(e){var r=egret.XML.parse(e);return r})},onRemoveStart:function(e,r){return!0}},r.CommonJSProcessor={onLoadStart:function(r,t){return r.load(t,"text").then(function(r){var o=new Function("require","exports",r),n=function(){},i={};try{o(n,i)}catch(a){throw new e.ResourceManagerError(2003,t.name,a.message)}return i})},onRemoveStart:function(e,r){}},r.SheetProcessor={onLoadStart:function(r,t){return r.load(t,"json").then(function(o){var n=r.resourceConfig.getResource(e.nameSelector(o.file));if(!n){var a=i(t.url,o.file);n={name:a,url:a,type:"image",root:t.root}}return r.load(n).then(function(e){if(!e)return null;var t=o.frames,i=new egret.SpriteSheet(e);i.$resourceInfo=n;for(var a in t){var s=t[a],u=i.createTexture(a,s.x,s.y,s.w,s.h,s.offX,s.offY,s.sourceW,s.sourceH);if(s.scale9grid){var c=s.scale9grid,l=c.split(",");u.scale9Grid=new egret.Rectangle(parseInt(l[0]),parseInt(l[1]),parseInt(l[2]),parseInt(l[3]))}}return r.save(n,e),i},function(e){throw r.remove(n),e})})},getData:function(e,r,t,o){var n=e.get(r);return n?n.getTexture(o):null},onRemoveStart:function(e,r){var t=e.get(r),o=t.$resourceInfo;t.dispose(),e.unload(o)}};var s=function(e,r){var t="",o=r.split("\n"),n=o[2],i=n.indexOf('file="');-1!=i&&(n=n.substring(i+6),i=n.indexOf('"'),t=n.substring(0,i)),e=e.split("\\").join("/");var i=e.lastIndexOf("/");return e=-1!=i?e.substring(0,i+1)+t:t};r.FontProcessor={onLoadStart:function(r,t){return r.load(t,"text").then(function(o){var n;try{n=JSON.parse(o)}catch(a){n=o}var u;u="string"==typeof n?s(t.url,n):i(t.url,n.file);var c=r.resourceConfig.getResource(e.nameSelector(u));return c||(c={name:u,url:u,type:"image",root:t.root}),r.load(c).then(function(e){var t=new egret.BitmapFont(e,n);return t.$resourceInfo=c,r.save(c,e),t},function(e){throw r.remove(c),e})})},onRemoveStart:function(e,r){var t=e.get(r),o=t.$resourceInfo;e.unload(o)}},r.SoundProcessor={onLoadStart:function(r,t){var o=new egret.Sound;return o.load(e.getVirtualUrl(t.root+t.url)),n(o,t).then(function(){return o})},onRemoveStart:function(e,r){var t=e.get(r);t.close()}},r.MovieClipProcessor={onLoadStart:function(r,t){var o,n;return r.load(t,"json").then(function(i){o=i;var a=t.name,s=a.substring(0,a.lastIndexOf("."))+".png";if(n=r.resourceConfig.getResource(s),!n)throw new e.ResourceManagerError(1001,s);return r.load(n)}).then(function(e){r.save(n,e);var t=e,i=new egret.MovieClipDataFactory(o,t);return i})},onRemoveStart:function(e,r){var t=e.get(r);t.clearCache(),t.$spriteSheet.dispose();var o=r.name,n=o.substring(0,o.lastIndexOf("."))+".png",i=e.resourceConfig.getResource(n);i&&e.unload(i)}},r.MergeJSONProcessor={onLoadStart:function(r,t){return r.load(t,"json").then(function(r){for(var o in r)e.config.addSubkey(o,t.name);return r})},getData:function(e,r,t,o){var n=e.get(r);return n?n[o]:(console.error("missing resource :"+r.name),null)},onRemoveStart:function(e,r){}},r.TTFProcessor={onLoadStart:function(e,r){return e.load(r,"bin").then(function(e){egret.Capabilities.runtimeType==egret.RuntimeType.WEB&&(egret.sys.fontResourceCache||(egret.sys.fontResourceCache={}),egret.sys.fontResourceCache[r.root+r.url]=e)})},onRemoveStart:function(e,r){if(egret.Capabilities.runtimeType==egret.RuntimeType.WEB){var t=egret.sys.fontResourceCache;t&&t[r.url]&&(t[r.root+r.url]=null)}}},r.LegacyResourceConfigProcessor={onLoadStart:function(r,t){return r.load(t,"json").then(function(o){var n=e.config.config,i=t.root,a=n.fileSystem;a||(a={fsData:{},getFile:function(e){return p[e]},addFile:function(e){e.type||(e.type=""),void 0==i&&(e.root=""),p[e.name]=e},profile:function(){console.log(p)},removeFile:function(e){delete p[e]}},n.fileSystem=a);for(var s=n.groups,u=0,c=o.groups;u<c.length;u++){var l=c[u];""==l.keys?s[l.name]=[]:s[l.name]=l.keys.split(",")}for(var f=n.alias,p=a.fsData,g=function(e){p[e.name]=e,p[e.name].root=i,e.subkeys&&e.subkeys.split(",").forEach(function(r){f[r]=e.name+"#"+r,f[e.name+"."+r]=e.name+"#"+r})},d=0,h=o.resources;d<h.length;d++){var v=h[d];g(v)}return r.save(t,o),o})},onRemoveStart:function(){}},r._map={image:r.ImageProcessor,json:r.JsonProcessor,text:r.TextProcessor,xml:r.XMLProcessor,sheet:r.SheetProcessor,font:r.FontProcessor,bin:r.BinaryProcessor,commonjs:r.CommonJSProcessor,sound:r.SoundProcessor,movieclip:r.MovieClipProcessor,mergeJson:r.MergeJSONProcessor,legacyResourceConfig:r.LegacyResourceConfigProcessor,ktx:r.KTXTextureProcessor,"etc1.ktx":r.ETC1KTXProcessor,"pvrtc.ktx":r.KTXTextureProcessor,ttf:r.TTFProcessor}}(r=e.processor||(e.processor={}))}(RES||(RES={}));

 //js/dragonBones.min_b56dbd62.js
"use strict";var __extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)if(e.hasOwnProperty(a))t[a]=e[a]};return function(t,e){r(t,e);function a(){this.constructor=t}t.prototype=e===null?Object.create(e):(a.prototype=e.prototype,new a)}}();var dragonBones;(function(o){var t=function(){function e(t){this._clock=new o.WorldClock;this._events=[];this._objects=[];this._eventManager=null;this._eventManager=t;console.info("DragonBones: "+e.VERSION+"\nWebsite: http://dragonbones.com/\nSource and Demo: https://github.com/DragonBones/")}e.prototype.advanceTime=function(t){if(this._objects.length>0){for(var e=0,a=this._objects;e<a.length;e++){var r=a[e];r.returnToPool()}this._objects.length=0}this._clock.advanceTime(t);if(this._events.length>0){for(var i=0;i<this._events.length;++i){var n=this._events[i];var s=n.armature;if(s._armatureData!==null){s.eventDispatcher.dispatchDBEvent(n.type,n);if(n.type===o.EventObject.SOUND_EVENT){this._eventManager.dispatchDBEvent(n.type,n)}}this.bufferObject(n)}this._events.length=0}};e.prototype.bufferEvent=function(t){if(this._events.indexOf(t)<0){this._events.push(t)}};e.prototype.bufferObject=function(t){if(this._objects.indexOf(t)<0){this._objects.push(t)}};Object.defineProperty(e.prototype,"clock",{get:function(){return this._clock},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"eventManager",{get:function(){return this._eventManager},enumerable:true,configurable:true});e.VERSION="5.7.000";e.yDown=true;e.debug=false;e.debugDraw=false;return e}();o.DragonBones=t})(dragonBones||(dragonBones={}));if(!console.warn){console.warn=function(){}}if(!console.assert){console.assert=function(){}}if(!Date.now){Date.now=function t(){return(new Date).getTime()}}var __extends=function(t,e){function a(){this.constructor=t}for(var r in e){if(e.hasOwnProperty(r)){t[r]=e[r]}}a.prototype=e.prototype,t.prototype=new a};if(typeof global==="undefined"&&typeof window!=="undefined"){var global=window}if(typeof exports==="object"&&typeof module==="object"){module.exports=dragonBones}else if(typeof define==="function"&&define["amd"]){define(["dragonBones"],function(){return dragonBones})}else if(typeof exports==="object"){exports=dragonBones}else if(typeof global!=="undefined"){global.dragonBones=dragonBones}var dragonBones;(function(t){var e=function(){function n(){this.hashCode=n._hashCode++;this._isInPool=false}n._returnObject=function(t){var e=String(t.constructor);var a=e in n._maxCountMap?n._maxCountMap[e]:n._defaultMaxCount;var r=n._poolsMap[e]=n._poolsMap[e]||[];if(r.length<a){if(!t._isInPool){t._isInPool=true;r.push(t)}else{console.warn("The object is already in the pool.")}}else{}};n.toString=function(){throw new Error};n.setMaxCount=function(t,e){if(e<0||e!==e){e=0}if(t!==null){var a=String(t);var r=a in n._poolsMap?n._poolsMap[a]:null;if(r!==null&&r.length>e){r.length=e}n._maxCountMap[a]=e}else{n._defaultMaxCount=e;for(var a in n._poolsMap){var r=n._poolsMap[a];if(r.length>e){r.length=e}if(a in n._maxCountMap){n._maxCountMap[a]=e}}}};n.clearPool=function(t){if(t===void 0){t=null}if(t!==null){var e=String(t);var a=e in n._poolsMap?n._poolsMap[e]:null;if(a!==null&&a.length>0){a.length=0}}else{for(var r in n._poolsMap){var a=n._poolsMap[r];a.length=0}}};n.borrowObject=function(t){var e=String(t);var a=e in n._poolsMap?n._poolsMap[e]:null;if(a!==null&&a.length>0){var r=a.pop();r._isInPool=false;return r}var i=new t;i._onClear();return i};n.prototype.returnToPool=function(){this._onClear();n._returnObject(this)};n._hashCode=0;n._defaultMaxCount=3e3;n._maxCountMap={};n._poolsMap={};return n}();t.BaseObject=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(){function t(t,e,a,r,i,n){if(t===void 0){t=1}if(e===void 0){e=0}if(a===void 0){a=0}if(r===void 0){r=1}if(i===void 0){i=0}if(n===void 0){n=0}this.a=t;this.b=e;this.c=a;this.d=r;this.tx=i;this.ty=n}t.prototype.toString=function(){return"[object dragonBones.Matrix] a:"+this.a+" b:"+this.b+" c:"+this.c+" d:"+this.d+" tx:"+this.tx+" ty:"+this.ty};t.prototype.copyFrom=function(t){this.a=t.a;this.b=t.b;this.c=t.c;this.d=t.d;this.tx=t.tx;this.ty=t.ty;return this};t.prototype.copyFromArray=function(t,e){if(e===void 0){e=0}this.a=t[e];this.b=t[e+1];this.c=t[e+2];this.d=t[e+3];this.tx=t[e+4];this.ty=t[e+5];return this};t.prototype.identity=function(){this.a=this.d=1;this.b=this.c=0;this.tx=this.ty=0;return this};t.prototype.concat=function(t){var e=this.a*t.a;var a=0;var r=0;var i=this.d*t.d;var n=this.tx*t.a+t.tx;var s=this.ty*t.d+t.ty;if(this.b!==0||this.c!==0){e+=this.b*t.c;a+=this.b*t.d;r+=this.c*t.a;i+=this.c*t.b}if(t.b!==0||t.c!==0){a+=this.a*t.b;r+=this.d*t.c;n+=this.ty*t.c;s+=this.tx*t.b}this.a=e;this.b=a;this.c=r;this.d=i;this.tx=n;this.ty=s;return this};t.prototype.invert=function(){var t=this.a;var e=this.b;var a=this.c;var r=this.d;var i=this.tx;var n=this.ty;if(e===0&&a===0){this.b=this.c=0;if(t===0||r===0){this.a=this.b=this.tx=this.ty=0}else{t=this.a=1/t;r=this.d=1/r;this.tx=-t*i;this.ty=-r*n}return this}var s=t*r-e*a;if(s===0){this.a=this.d=1;this.b=this.c=0;this.tx=this.ty=0;return this}s=1/s;var o=this.a=r*s;e=this.b=-e*s;a=this.c=-a*s;r=this.d=t*s;this.tx=-(o*i+a*n);this.ty=-(e*i+r*n);return this};t.prototype.transformPoint=function(t,e,a,r){if(r===void 0){r=false}a.x=this.a*t+this.c*e;a.y=this.b*t+this.d*e;if(!r){a.x+=this.tx;a.y+=this.ty}};t.prototype.transformRectangle=function(t,e){if(e===void 0){e=false}var a=this.a;var r=this.b;var i=this.c;var n=this.d;var s=e?0:this.tx;var o=e?0:this.ty;var l=t.x;var h=t.y;var f=l+t.width;var u=h+t.height;var _=a*l+i*h+s;var m=r*l+n*h+o;var p=a*f+i*h+s;var c=r*f+n*h+o;var d=a*f+i*u+s;var y=r*f+n*u+o;var v=a*l+i*u+s;var g=r*l+n*u+o;var D=0;if(_>p){D=_;_=p;p=D}if(d>v){D=d;d=v;v=D}t.x=Math.floor(_<d?_:d);t.width=Math.ceil((p>v?p:v)-t.x);if(m>c){D=m;m=c;c=D}if(y>g){D=y;y=g;g=D}t.y=Math.floor(m<y?m:y);t.height=Math.ceil((c>g?c:g)-t.y)};return t}();t.Matrix=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(){function n(t,e,a,r,i,n){if(t===void 0){t=0}if(e===void 0){e=0}if(a===void 0){a=0}if(r===void 0){r=0}if(i===void 0){i=1}if(n===void 0){n=1}this.x=t;this.y=e;this.skew=a;this.rotation=r;this.scaleX=i;this.scaleY=n}n.normalizeRadian=function(t){t=(t+Math.PI)%(Math.PI*2);t+=t>0?-Math.PI:Math.PI;return t};n.prototype.toString=function(){return"[object dragonBones.Transform] x:"+this.x+" y:"+this.y+" skewX:"+this.skew*180/Math.PI+" skewY:"+this.rotation*180/Math.PI+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY};n.prototype.copyFrom=function(t){this.x=t.x;this.y=t.y;this.skew=t.skew;this.rotation=t.rotation;this.scaleX=t.scaleX;this.scaleY=t.scaleY;return this};n.prototype.identity=function(){this.x=this.y=0;this.skew=this.rotation=0;this.scaleX=this.scaleY=1;return this};n.prototype.add=function(t){this.x+=t.x;this.y+=t.y;this.skew+=t.skew;this.rotation+=t.rotation;this.scaleX*=t.scaleX;this.scaleY*=t.scaleY;return this};n.prototype.minus=function(t){this.x-=t.x;this.y-=t.y;this.skew-=t.skew;this.rotation-=t.rotation;this.scaleX/=t.scaleX;this.scaleY/=t.scaleY;return this};n.prototype.fromMatrix=function(t){var e=this.scaleX,a=this.scaleY;var r=n.PI_Q;this.x=t.tx;this.y=t.ty;this.rotation=Math.atan(t.b/t.a);var i=Math.atan(-t.c/t.d);this.scaleX=this.rotation>-r&&this.rotation<r?t.a/Math.cos(this.rotation):t.b/Math.sin(this.rotation);this.scaleY=i>-r&&i<r?t.d/Math.cos(i):-t.c/Math.sin(i);if(e>=0&&this.scaleX<0){this.scaleX=-this.scaleX;this.rotation=this.rotation-Math.PI}if(a>=0&&this.scaleY<0){this.scaleY=-this.scaleY;i=i-Math.PI}this.skew=i-this.rotation;return this};n.prototype.toMatrix=function(t){if(this.rotation===0){t.a=1;t.b=0}else{t.a=Math.cos(this.rotation);t.b=Math.sin(this.rotation)}if(this.skew===0){t.c=-t.b;t.d=t.a}else{t.c=-Math.sin(this.skew+this.rotation);t.d=Math.cos(this.skew+this.rotation)}if(this.scaleX!==1){t.a*=this.scaleX;t.b*=this.scaleX}if(this.scaleY!==1){t.c*=this.scaleY;t.d*=this.scaleY}t.tx=this.x;t.ty=this.y;return this};n.PI=Math.PI;n.PI_D=Math.PI*2;n.PI_H=Math.PI/2;n.PI_Q=Math.PI/4;n.RAD_DEG=180/Math.PI;n.DEG_RAD=Math.PI/180;return n}();t.Transform=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(){function t(t,e,a,r,i,n,s,o){if(t===void 0){t=1}if(e===void 0){e=1}if(a===void 0){a=1}if(r===void 0){r=1}if(i===void 0){i=0}if(n===void 0){n=0}if(s===void 0){s=0}if(o===void 0){o=0}this.alphaMultiplier=t;this.redMultiplier=e;this.greenMultiplier=a;this.blueMultiplier=r;this.alphaOffset=i;this.redOffset=n;this.greenOffset=s;this.blueOffset=o}t.prototype.copyFrom=function(t){this.alphaMultiplier=t.alphaMultiplier;this.redMultiplier=t.redMultiplier;this.greenMultiplier=t.greenMultiplier;this.blueMultiplier=t.blueMultiplier;this.alphaOffset=t.alphaOffset;this.redOffset=t.redOffset;this.greenOffset=t.greenOffset;this.blueOffset=t.blueOffset};t.prototype.identity=function(){this.alphaMultiplier=this.redMultiplier=this.greenMultiplier=this.blueMultiplier=1;this.alphaOffset=this.redOffset=this.greenOffset=this.blueOffset=0};return t}();t.ColorTransform=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(){function t(t,e){if(t===void 0){t=0}if(e===void 0){e=0}this.x=t;this.y=e}t.prototype.copyFrom=function(t){this.x=t.x;this.y=t.y};t.prototype.clear=function(){this.x=this.y=0};return t}();t.Point=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(){function t(t,e,a,r){if(t===void 0){t=0}if(e===void 0){e=0}if(a===void 0){a=0}if(r===void 0){r=0}this.x=t;this.y=e;this.width=a;this.height=r}t.prototype.copyFrom=function(t){this.x=t.x;this.y=t.y;this.width=t.width;this.height=t.height};t.prototype.clear=function(){this.x=this.y=0;this.width=this.height=0};return t}();t.Rectangle=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.ints=[];t.floats=[];t.strings=[];return t}t.toString=function(){return"[class dragonBones.UserData]"};t.prototype._onClear=function(){this.ints.length=0;this.floats.length=0;this.strings.length=0};t.prototype.addInt=function(t){this.ints.push(t)};t.prototype.addFloat=function(t){this.floats.push(t)};t.prototype.addString=function(t){this.strings.push(t)};t.prototype.getInt=function(t){if(t===void 0){t=0}return t>=0&&t<this.ints.length?this.ints[t]:0};t.prototype.getFloat=function(t){if(t===void 0){t=0}return t>=0&&t<this.floats.length?this.floats[t]:0};t.prototype.getString=function(t){if(t===void 0){t=0}return t>=0&&t<this.strings.length?this.strings[t]:""};return t}(t.BaseObject);t.UserData=e;var a=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.data=null;return t}t.toString=function(){return"[class dragonBones.ActionData]"};t.prototype._onClear=function(){if(this.data!==null){this.data.returnToPool()}this.type=0;this.name="";this.bone=null;this.slot=null;this.data=null};return t}(t.BaseObject);t.ActionData=a})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.frameIndices=[];t.cachedFrames=[];t.armatureNames=[];t.armatures={};t.userData=null;return t}t.toString=function(){return"[class dragonBones.DragonBonesData]"};t.prototype._onClear=function(){for(var t in this.armatures){this.armatures[t].returnToPool();delete this.armatures[t]}if(this.userData!==null){this.userData.returnToPool()}this.autoSearch=false;this.frameRate=0;this.version="";this.name="";this.stage=null;this.frameIndices.length=0;this.cachedFrames.length=0;this.armatureNames.length=0;this.binary=null;this.intArray=null;this.floatArray=null;this.frameIntArray=null;this.frameFloatArray=null;this.frameArray=null;this.timelineArray=null;this.colorArray=null;this.userData=null};t.prototype.addArmature=function(t){if(t.name in this.armatures){console.warn("Same armature: "+t.name);return}t.parent=this;this.armatures[t.name]=t;this.armatureNames.push(t.name)};t.prototype.getArmature=function(t){return t in this.armatures?this.armatures[t]:null};return t}(t.BaseObject);t.DragonBonesData=e})(dragonBones||(dragonBones={}));var dragonBones;(function(a){var t=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.aabb=new a.Rectangle;t.animationNames=[];t.sortedBones=[];t.sortedSlots=[];t.defaultActions=[];t.actions=[];t.bones={};t.slots={};t.constraints={};t.skins={};t.animations={};t.canvas=null;t.userData=null;return t}t.toString=function(){return"[class dragonBones.ArmatureData]"};t.prototype._onClear=function(){for(var t=0,e=this.defaultActions;t<e.length;t++){var a=e[t];a.returnToPool()}for(var r=0,i=this.actions;r<i.length;r++){var a=i[r];a.returnToPool()}for(var n in this.bones){this.bones[n].returnToPool();delete this.bones[n]}for(var n in this.slots){this.slots[n].returnToPool();delete this.slots[n]}for(var n in this.constraints){this.constraints[n].returnToPool();delete this.constraints[n]}for(var n in this.skins){this.skins[n].returnToPool();delete this.skins[n]}for(var n in this.animations){this.animations[n].returnToPool();delete this.animations[n]}if(this.canvas!==null){this.canvas.returnToPool()}if(this.userData!==null){this.userData.returnToPool()}this.type=0;this.frameRate=0;this.cacheFrameRate=0;this.scale=1;this.name="";this.aabb.clear();this.animationNames.length=0;this.sortedBones.length=0;this.sortedSlots.length=0;this.defaultActions.length=0;this.actions.length=0;this.defaultSkin=null;this.defaultAnimation=null;this.canvas=null;this.userData=null;this.parent=null};t.prototype.sortBones=function(){var t=this.sortedBones.length;if(t<=0){return}var e=this.sortedBones.concat();var a=0;var r=0;this.sortedBones.length=0;while(r<t){var i=e[a++];if(a>=t){a=0}if(this.sortedBones.indexOf(i)>=0){continue}var n=false;for(var s in this.constraints){var o=this.constraints[s];if(o.root===i&&this.sortedBones.indexOf(o.target)<0){n=true;break}}if(n){continue}if(i.parent!==null&&this.sortedBones.indexOf(i.parent)<0){continue}this.sortedBones.push(i);r++}};t.prototype.cacheFrames=function(t){if(this.cacheFrameRate>0){return}this.cacheFrameRate=t;for(var e in this.animations){this.animations[e].cacheFrames(this.cacheFrameRate)}};t.prototype.setCacheFrame=function(t,e){var a=this.parent.cachedFrames;var r=a.length;a.length+=10;a[r]=t.a;a[r+1]=t.b;a[r+2]=t.c;a[r+3]=t.d;a[r+4]=t.tx;a[r+5]=t.ty;a[r+6]=e.rotation;a[r+7]=e.skew;a[r+8]=e.scaleX;a[r+9]=e.scaleY;return r};t.prototype.getCacheFrame=function(t,e,a){var r=this.parent.cachedFrames;t.a=r[a];t.b=r[a+1];t.c=r[a+2];t.d=r[a+3];t.tx=r[a+4];t.ty=r[a+5];e.rotation=r[a+6];e.skew=r[a+7];e.scaleX=r[a+8];e.scaleY=r[a+9];e.x=t.tx;e.y=t.ty};t.prototype.addBone=function(t){if(t.name in this.bones){console.warn("Same bone: "+t.name);return}this.bones[t.name]=t;this.sortedBones.push(t)};t.prototype.addSlot=function(t){if(t.name in this.slots){console.warn("Same slot: "+t.name);return}this.slots[t.name]=t;this.sortedSlots.push(t)};t.prototype.addConstraint=function(t){if(t.name in this.constraints){console.warn("Same constraint: "+t.name);return}this.constraints[t.name]=t};t.prototype.addSkin=function(t){if(t.name in this.skins){console.warn("Same skin: "+t.name);return}t.parent=this;this.skins[t.name]=t;if(this.defaultSkin===null){this.defaultSkin=t}if(t.name==="default"){this.defaultSkin=t}};t.prototype.addAnimation=function(t){if(t.name in this.animations){console.warn("Same animation: "+t.name);return}t.parent=this;this.animations[t.name]=t;this.animationNames.push(t.name);if(this.defaultAnimation===null){this.defaultAnimation=t}};t.prototype.addAction=function(t,e){if(e){this.defaultActions.push(t)}else{this.actions.push(t)}};t.prototype.getBone=function(t){return t in this.bones?this.bones[t]:null};t.prototype.getSlot=function(t){return t in this.slots?this.slots[t]:null};t.prototype.getConstraint=function(t){return t in this.constraints?this.constraints[t]:null};t.prototype.getSkin=function(t){return t in this.skins?this.skins[t]:null};t.prototype.getMesh=function(t,e,a){var r=this.getSkin(t);if(r===null){return null}return r.getDisplay(e,a)};t.prototype.getAnimation=function(t){return t in this.animations?this.animations[t]:null};return t}(a.BaseObject);a.ArmatureData=t;var e=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.transform=new a.Transform;t.userData=null;return t}t.toString=function(){return"[class dragonBones.BoneData]"};t.prototype._onClear=function(){if(this.userData!==null){this.userData.returnToPool()}this.inheritTranslation=false;this.inheritRotation=false;this.inheritScale=false;this.inheritReflection=false;this.type=0;this.length=0;this.alpha=1;this.name="";this.transform.identity();this.userData=null;this.parent=null};return t}(a.BaseObject);a.BoneData=e;var r=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.geometry=new a.GeometryData;return t}t.toString=function(){return"[class dragonBones.SurfaceData]"};t.prototype._onClear=function(){e.prototype._onClear.call(this);this.type=1;this.segmentX=0;this.segmentY=0;this.geometry.clear()};return t}(e);a.SurfaceData=r;var i=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.color=null;t.userData=null;return t}t.createColor=function(){return new a.ColorTransform};t.toString=function(){return"[class dragonBones.SlotData]"};t.prototype._onClear=function(){if(this.userData!==null){this.userData.returnToPool()}this.blendMode=0;this.displayIndex=0;this.zOrder=0;this.zIndex=0;this.alpha=1;this.name="";this.color=null;this.userData=null;this.parent=null};t.DEFAULT_COLOR=new a.ColorTransform;return t}(a.BaseObject);a.SlotData=i})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.CanvasData]"};e.prototype._onClear=function(){this.hasBackground=false;this.color=0;this.x=0;this.y=0;this.width=0;this.height=0};return e}(t.BaseObject);t.CanvasData=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.displays={};return t}t.toString=function(){return"[class dragonBones.SkinData]"};t.prototype._onClear=function(){for(var t in this.displays){var e=this.displays[t];for(var a=0,r=e;a<r.length;a++){var i=r[a];if(i!==null){i.returnToPool()}}delete this.displays[t]}this.name="";this.parent=null};t.prototype.addDisplay=function(t,e){if(!(t in this.displays)){this.displays[t]=[]}if(e!==null){e.parent=this}var a=this.displays[t];a.push(e)};t.prototype.getDisplay=function(t,e){var a=this.getDisplays(t);if(a!==null){for(var r=0,i=a;r<i.length;r++){var n=i[r];if(n!==null&&n.name===e){return n}}}return null};t.prototype.getDisplays=function(t){if(!(t in this.displays)){return null}return this.displays[t]};return t}(t.BaseObject);t.SkinData=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype._onClear=function(){this.order=0;this.name="";this.type=0;this.target=null;this.root=null;this.bone=null};return e}(t.BaseObject);t.ConstraintData=e;var a=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.IKConstraintData]"};e.prototype._onClear=function(){t.prototype._onClear.call(this);this.scaleEnabled=false;this.bendPositive=false;this.weight=1};return e}(e);t.IKConstraintData=a;var r=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.bones=[];return t}t.toString=function(){return"[class dragonBones.PathConstraintData]"};t.prototype._onClear=function(){e.prototype._onClear.call(this);this.pathSlot=null;this.pathDisplayData=null;this.bones.length=0;this.positionMode=0;this.spacingMode=1;this.rotateMode=1;this.position=0;this.spacing=0;this.rotateOffset=0;this.rotateMix=0;this.translateMix=0};t.prototype.AddBone=function(t){this.bones.push(t)};return t}(e);t.PathConstraintData=r})(dragonBones||(dragonBones={}));var dragonBones;(function(a){var r=function(){function t(){this.weight=null}t.prototype.clear=function(){if(!this.isShared&&this.weight!==null){this.weight.returnToPool()}this.isShared=false;this.inheritDeform=false;this.offset=0;this.data=null;this.weight=null};t.prototype.shareFrom=function(t){this.isShared=true;this.offset=t.offset;this.weight=t.weight};Object.defineProperty(t.prototype,"vertexCount",{get:function(){var t=this.data.intArray;return t[this.offset+0]},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"triangleCount",{get:function(){var t=this.data.intArray;return t[this.offset+1]},enumerable:true,configurable:true});return t}();a.GeometryData=r;var t=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.transform=new a.Transform;return t}t.prototype._onClear=function(){this.name="";this.path="";this.transform.identity();this.parent=null};return t}(a.BaseObject);a.DisplayData=t;var e=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.pivot=new a.Point;return t}t.toString=function(){return"[class dragonBones.ImageDisplayData]"};t.prototype._onClear=function(){e.prototype._onClear.call(this);this.type=0;this.pivot.clear();this.texture=null};return t}(t);a.ImageDisplayData=e;var i=function(r){__extends(t,r);function t(){var t=r!==null&&r.apply(this,arguments)||this;t.actions=[];return t}t.toString=function(){return"[class dragonBones.ArmatureDisplayData]"};t.prototype._onClear=function(){r.prototype._onClear.call(this);for(var t=0,e=this.actions;t<e.length;t++){var a=e[t];a.returnToPool()}this.type=1;this.inheritAnimation=false;this.actions.length=0;this.armature=null};t.prototype.addAction=function(t){this.actions.push(t)};return t}(t);a.ArmatureDisplayData=i;var n=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.geometry=new r;return t}t.toString=function(){return"[class dragonBones.MeshDisplayData]"};t.prototype._onClear=function(){e.prototype._onClear.call(this);this.type=2;this.geometry.clear();this.texture=null};return t}(t);a.MeshDisplayData=n;var s=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.boundingBox=null;return t}t.toString=function(){return"[class dragonBones.BoundingBoxDisplayData]"};t.prototype._onClear=function(){e.prototype._onClear.call(this);if(this.boundingBox!==null){this.boundingBox.returnToPool()}this.type=3;this.boundingBox=null};return t}(t);a.BoundingBoxDisplayData=s;var o=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.geometry=new r;t.curveLengths=[];return t}t.toString=function(){return"[class dragonBones.PathDisplayData]"};t.prototype._onClear=function(){e.prototype._onClear.call(this);this.type=4;this.closed=false;this.constantSpeed=false;this.geometry.clear();this.curveLengths.length=0};return t}(t);a.PathDisplayData=o;var l=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.bones=[];return t}t.toString=function(){return"[class dragonBones.WeightData]"};t.prototype._onClear=function(){this.count=0;this.offset=0;this.bones.length=0};t.prototype.addBone=function(t){this.bones.push(t)};return t}(a.BaseObject);a.WeightData=l})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype._onClear=function(){this.color=0;this.width=0;this.height=0};return e}(t.BaseObject);t.BoundingBoxData=e;var h=function(t){__extends(D,t);function D(){return t!==null&&t.apply(this,arguments)||this}D.toString=function(){return"[class dragonBones.RectangleBoundingBoxData]"};D._computeOutCode=function(t,e,a,r,i,n){var s=0;if(t<a){s|=1}else if(t>i){s|=2}if(e<r){s|=4}else if(e>n){s|=8}return s};D.rectangleIntersectsSegment=function(t,e,a,r,i,n,s,o,l,h,f){if(l===void 0){l=null}if(h===void 0){h=null}if(f===void 0){f=null}var u=t>i&&t<s&&e>n&&e<o;var _=a>i&&a<s&&r>n&&r<o;if(u&&_){return-1}var m=0;var p=D._computeOutCode(t,e,i,n,s,o);var c=D._computeOutCode(a,r,i,n,s,o);while(true){if((p|c)===0){m=2;break}else if((p&c)!==0){break}var d=0;var y=0;var v=0;var g=p!==0?p:c;if((g&4)!==0){d=t+(a-t)*(n-e)/(r-e);y=n;if(f!==null){v=-Math.PI*.5}}else if((g&8)!==0){d=t+(a-t)*(o-e)/(r-e);y=o;if(f!==null){v=Math.PI*.5}}else if((g&2)!==0){y=e+(r-e)*(s-t)/(a-t);d=s;if(f!==null){v=0}}else if((g&1)!==0){y=e+(r-e)*(i-t)/(a-t);d=i;if(f!==null){v=Math.PI}}if(g===p){t=d;e=y;p=D._computeOutCode(t,e,i,n,s,o);if(f!==null){f.x=v}}else{a=d;r=y;c=D._computeOutCode(a,r,i,n,s,o);if(f!==null){f.y=v}}}if(m){if(u){m=2;if(l!==null){l.x=a;l.y=r}if(h!==null){h.x=a;h.y=a}if(f!==null){f.x=f.y+Math.PI}}else if(_){m=1;if(l!==null){l.x=t;l.y=e}if(h!==null){h.x=t;h.y=e}if(f!==null){f.y=f.x+Math.PI}}else{m=3;if(l!==null){l.x=t;l.y=e}if(h!==null){h.x=a;h.y=r}}}return m};D.prototype._onClear=function(){t.prototype._onClear.call(this);this.type=0};D.prototype.containsPoint=function(t,e){var a=this.width*.5;if(t>=-a&&t<=a){var r=this.height*.5;if(e>=-r&&e<=r){return true}}return false};D.prototype.intersectsSegment=function(t,e,a,r,i,n,s){if(i===void 0){i=null}if(n===void 0){n=null}if(s===void 0){s=null}var o=this.width*.5;var l=this.height*.5;var h=D.rectangleIntersectsSegment(t,e,a,r,-o,-l,o,l,i,n,s);return h};return D}(e);t.RectangleBoundingBoxData=h;var a=function(t){__extends(l,t);function l(){return t!==null&&t.apply(this,arguments)||this}l.toString=function(){return"[class dragonBones.EllipseData]"};l.ellipseIntersectsSegment=function(t,e,a,r,i,n,s,o,l,h,f){if(l===void 0){l=null}if(h===void 0){h=null}if(f===void 0){f=null}var u=s/o;var _=u*u;e*=u;r*=u;var m=a-t;var p=r-e;var c=Math.sqrt(m*m+p*p);var d=m/c;var y=p/c;var v=(i-t)*d+(n-e)*y;var g=v*v;var D=t*t+e*e;var b=s*s;var T=b-D+g;var A=0;if(T>=0){var P=Math.sqrt(T);var O=v-P;var S=v+P;var x=O<0?-1:O<=c?0:1;var B=S<0?-1:S<=c?0:1;var E=x*B;if(E<0){return-1}else if(E===0){if(x===-1){A=2;a=t+S*d;r=(e+S*y)/u;if(l!==null){l.x=a;l.y=r}if(h!==null){h.x=a;h.y=r}if(f!==null){f.x=Math.atan2(r/b*_,a/b);f.y=f.x+Math.PI}}else if(B===1){A=1;t=t+O*d;e=(e+O*y)/u;if(l!==null){l.x=t;l.y=e}if(h!==null){h.x=t;h.y=e}if(f!==null){f.x=Math.atan2(e/b*_,t/b);f.y=f.x+Math.PI}}else{A=3;if(l!==null){l.x=t+O*d;l.y=(e+O*y)/u;if(f!==null){f.x=Math.atan2(l.y/b*_,l.x/b)}}if(h!==null){h.x=t+S*d;h.y=(e+S*y)/u;if(f!==null){f.y=Math.atan2(h.y/b*_,h.x/b)}}}}}return A};l.prototype._onClear=function(){t.prototype._onClear.call(this);this.type=1};l.prototype.containsPoint=function(t,e){var a=this.width*.5;if(t>=-a&&t<=a){var r=this.height*.5;if(e>=-r&&e<=r){e*=a/r;return Math.sqrt(t*t+e*e)<=a}}return false};l.prototype.intersectsSegment=function(t,e,a,r,i,n,s){if(i===void 0){i=null}if(n===void 0){n=null}if(s===void 0){s=null}var o=l.ellipseIntersectsSegment(t,e,a,r,0,0,this.width*.5,this.height*.5,i,n,s);return o};return l}(e);t.EllipseBoundingBoxData=a;var r=function(e){__extends(l,e);function l(){var t=e!==null&&e.apply(this,arguments)||this;t.vertices=[];return t}l.toString=function(){return"[class dragonBones.PolygonBoundingBoxData]"};l.polygonIntersectsSegment=function(t,e,a,r,i,n,s,o){if(n===void 0){n=null}if(s===void 0){s=null}if(o===void 0){o=null}if(t===a){t=a+1e-6}if(e===r){e=r+1e-6}var l=i.length;var h=t-a;var f=e-r;var u=t*r-e*a;var _=0;var m=i[l-2];var p=i[l-1];var c=0;var d=0;var y=0;var v=0;var g=0;var D=0;for(var b=0;b<l;b+=2){var T=i[b];var A=i[b+1];if(m===T){m=T+1e-4}if(p===A){p=A+1e-4}var P=m-T;var O=p-A;var S=m*A-p*T;var x=h*O-f*P;var B=(u*P-h*S)/x;if((B>=m&&B<=T||B>=T&&B<=m)&&(h===0||B>=t&&B<=a||B>=a&&B<=t)){var E=(u*O-f*S)/x;if((E>=p&&E<=A||E>=A&&E<=p)&&(f===0||E>=e&&E<=r||E>=r&&E<=e)){if(s!==null){var M=B-t;if(M<0){M=-M}if(_===0){c=M;d=M;y=B;v=E;g=B;D=E;if(o!==null){o.x=Math.atan2(A-p,T-m)-Math.PI*.5;o.y=o.x}}else{if(M<c){c=M;y=B;v=E;if(o!==null){o.x=Math.atan2(A-p,T-m)-Math.PI*.5}}if(M>d){d=M;g=B;D=E;if(o!==null){o.y=Math.atan2(A-p,T-m)-Math.PI*.5}}}_++}else{y=B;v=E;g=B;D=E;_++;if(o!==null){o.x=Math.atan2(A-p,T-m)-Math.PI*.5;o.y=o.x}break}}}m=T;p=A}if(_===1){if(n!==null){n.x=y;n.y=v}if(s!==null){s.x=y;s.y=v}if(o!==null){o.y=o.x+Math.PI}}else if(_>1){_++;if(n!==null){n.x=y;n.y=v}if(s!==null){s.x=g;s.y=D}}return _};l.prototype._onClear=function(){e.prototype._onClear.call(this);this.type=2;this.x=0;this.y=0;this.vertices.length=0};l.prototype.containsPoint=function(t,e){var a=false;if(t>=this.x&&t<=this.width&&e>=this.y&&e<=this.height){for(var r=0,i=this.vertices.length,n=i-2;r<i;r+=2){var s=this.vertices[n+1];var o=this.vertices[r+1];if(o<e&&s>=e||s<e&&o>=e){var l=this.vertices[n];var h=this.vertices[r];if((e-o)*(l-h)/(s-o)+h<t){a=!a}}n=r}}return a};l.prototype.intersectsSegment=function(t,e,a,r,i,n,s){if(i===void 0){i=null}if(n===void 0){n=null}if(s===void 0){s=null}var o=0;if(h.rectangleIntersectsSegment(t,e,a,r,this.x,this.y,this.x+this.width,this.y+this.height,null,null,null)!==0){o=l.polygonIntersectsSegment(t,e,a,r,this.vertices,i,n,s)}return o};return l}(e);t.PolygonBoundingBoxData=r})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.cachedFrames=[];t.boneTimelines={};t.slotTimelines={};t.constraintTimelines={};t.animationTimelines={};t.boneCachedFrameIndices={};t.slotCachedFrameIndices={};t.actionTimeline=null;t.zOrderTimeline=null;return t}t.toString=function(){return"[class dragonBones.AnimationData]"};t.prototype._onClear=function(){for(var t in this.boneTimelines){for(var e=0,a=this.boneTimelines[t];e<a.length;e++){var r=a[e];r.returnToPool()}delete this.boneTimelines[t]}for(var t in this.slotTimelines){for(var i=0,n=this.slotTimelines[t];i<n.length;i++){var r=n[i];r.returnToPool()}delete this.slotTimelines[t]}for(var t in this.constraintTimelines){for(var s=0,o=this.constraintTimelines[t];s<o.length;s++){var r=o[s];r.returnToPool()}delete this.constraintTimelines[t]}for(var t in this.animationTimelines){for(var l=0,h=this.animationTimelines[t];l<h.length;l++){var r=h[l];r.returnToPool()}delete this.animationTimelines[t]}for(var t in this.boneCachedFrameIndices){delete this.boneCachedFrameIndices[t]}for(var t in this.slotCachedFrameIndices){delete this.slotCachedFrameIndices[t]}if(this.actionTimeline!==null){this.actionTimeline.returnToPool()}if(this.zOrderTimeline!==null){this.zOrderTimeline.returnToPool()}this.frameIntOffset=0;this.frameFloatOffset=0;this.frameOffset=0;this.blendType=0;this.frameCount=0;this.playTimes=0;this.duration=0;this.scale=1;this.fadeInTime=0;this.cacheFrameRate=0;this.name="";this.cachedFrames.length=0;this.actionTimeline=null;this.zOrderTimeline=null;this.parent=null};t.prototype.cacheFrames=function(t){if(this.cacheFrameRate>0){return}this.cacheFrameRate=Math.max(Math.ceil(t*this.scale),1);var e=Math.ceil(this.cacheFrameRate*this.duration)+1;this.cachedFrames.length=e;for(var a=0,r=this.cacheFrames.length;a<r;++a){this.cachedFrames[a]=false}for(var i=0,n=this.parent.sortedBones;i<n.length;i++){var s=n[i];var o=new Array(e);for(var a=0,r=o.length;a<r;++a){o[a]=-1}this.boneCachedFrameIndices[s.name]=o}for(var l=0,h=this.parent.sortedSlots;l<h.length;l++){var f=h[l];var o=new Array(e);for(var a=0,r=o.length;a<r;++a){o[a]=-1}this.slotCachedFrameIndices[f.name]=o}};t.prototype.addBoneTimeline=function(t,e){var a=t in this.boneTimelines?this.boneTimelines[t]:this.boneTimelines[t]=[];if(a.indexOf(e)<0){a.push(e)}};t.prototype.addSlotTimeline=function(t,e){var a=t in this.slotTimelines?this.slotTimelines[t]:this.slotTimelines[t]=[];if(a.indexOf(e)<0){a.push(e)}};t.prototype.addConstraintTimeline=function(t,e){var a=t in this.constraintTimelines?this.constraintTimelines[t]:this.constraintTimelines[t]=[];if(a.indexOf(e)<0){a.push(e)}};t.prototype.addAnimationTimeline=function(t,e){var a=t in this.animationTimelines?this.animationTimelines[t]:this.animationTimelines[t]=[];if(a.indexOf(e)<0){a.push(e)}};t.prototype.getBoneTimelines=function(t){return t in this.boneTimelines?this.boneTimelines[t]:null};t.prototype.getSlotTimelines=function(t){return t in this.slotTimelines?this.slotTimelines[t]:null};t.prototype.getConstraintTimelines=function(t){return t in this.constraintTimelines?this.constraintTimelines[t]:null};t.prototype.getAnimationTimelines=function(t){return t in this.animationTimelines?this.animationTimelines[t]:null};t.prototype.getBoneCachedFrameIndices=function(t){return t in this.boneCachedFrameIndices?this.boneCachedFrameIndices[t]:null};t.prototype.getSlotCachedFrameIndices=function(t){return t in this.slotCachedFrameIndices?this.slotCachedFrameIndices[t]:null};return t}(t.BaseObject);t.AnimationData=e;var a=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.TimelineData]"};e.prototype._onClear=function(){this.type=10;this.offset=0;this.frameIndicesOffset=-1};return e}(t.BaseObject);t.TimelineData=a;var r=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.AnimationTimelineData]"};e.prototype._onClear=function(){t.prototype._onClear.call(this);this.x=0;this.y=0};return e}(a);t.AnimationTimelineData=r})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.boneMask=[];return t}t.toString=function(){return"[class dragonBones.AnimationConfig]"};t.prototype._onClear=function(){this.pauseFadeOut=true;this.fadeOutMode=4;this.fadeOutTweenType=1;this.fadeOutTime=-1;this.actionEnabled=true;this.additive=false;this.displayControl=true;this.pauseFadeIn=true;this.resetToPose=true;this.fadeInTweenType=1;this.playTimes=-1;this.layer=0;this.position=0;this.duration=-1;this.timeScale=-100;this.weight=1;this.fadeInTime=-1;this.autoFadeOutTime=-1;this.name="";this.animation="";this.group="";this.boneMask.length=0};t.prototype.clear=function(){this._onClear()};t.prototype.copyFrom=function(t){this.pauseFadeOut=t.pauseFadeOut;this.fadeOutMode=t.fadeOutMode;this.autoFadeOutTime=t.autoFadeOutTime;this.fadeOutTweenType=t.fadeOutTweenType;this.actionEnabled=t.actionEnabled;this.additive=t.additive;this.displayControl=t.displayControl;this.pauseFadeIn=t.pauseFadeIn;this.resetToPose=t.resetToPose;this.playTimes=t.playTimes;this.layer=t.layer;this.position=t.position;this.duration=t.duration;this.timeScale=t.timeScale;this.fadeInTime=t.fadeInTime;this.fadeOutTime=t.fadeOutTime;this.fadeInTweenType=t.fadeInTweenType;this.weight=t.weight;this.name=t.name;this.animation=t.animation;this.group=t.group;this.boneMask.length=t.boneMask.length;for(var e=0,a=this.boneMask.length;e<a;++e){this.boneMask[e]=t.boneMask[e]}};return t}(t.BaseObject);t.AnimationConfig=e})(dragonBones||(dragonBones={}));var dragonBones;(function(r){var t=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.textures={};return t}t.prototype._onClear=function(){for(var t in this.textures){this.textures[t].returnToPool();delete this.textures[t]}this.autoSearch=false;this.width=0;this.height=0;this.scale=1;this.name="";this.imagePath=""};t.prototype.copyFrom=function(t){this.autoSearch=t.autoSearch;this.scale=t.scale;this.width=t.width;this.height=t.height;this.name=t.name;this.imagePath=t.imagePath;for(var e in this.textures){this.textures[e].returnToPool();delete this.textures[e]}for(var e in t.textures){var a=this.createTexture();a.copyFrom(t.textures[e]);this.textures[e]=a}};t.prototype.addTexture=function(t){if(t.name in this.textures){console.warn("Same texture: "+t.name);return}t.parent=this;this.textures[t.name]=t};t.prototype.getTexture=function(t){return t in this.textures?this.textures[t]:null};return t}(r.BaseObject);r.TextureAtlasData=t;var e=function(e){__extends(a,e);function a(){var t=e!==null&&e.apply(this,arguments)||this;t.region=new r.Rectangle;t.frame=null;return t}a.createRectangle=function(){return new r.Rectangle};a.prototype._onClear=function(){this.rotated=false;this.name="";this.region.clear();this.parent=null;this.frame=null};a.prototype.copyFrom=function(t){this.rotated=t.rotated;this.name=t.name;this.region.copyFrom(t.region);this.parent=t.parent;if(this.frame===null&&t.frame!==null){this.frame=a.createRectangle()}else if(this.frame!==null&&t.frame===null){this.frame=null}if(this.frame!==null&&t.frame!==null){this.frame.copyFrom(t.frame)}};return a}(r.BaseObject);r.TextureData=e})(dragonBones||(dragonBones={}));var dragonBones;(function(i){var t=function(e){__extends(y,e);function y(){var t=e!==null&&e.apply(this,arguments)||this;t._bones=[];t._slots=[];t._constraints=[];t._actions=[];t._animation=null;t._proxy=null;t._replaceTextureAtlasData=null;t._clock=null;return t}y.toString=function(){return"[class dragonBones.Armature]"};y._onSortSlots=function(t,e){return t._zIndex*1e3+t._zOrder>e._zIndex*1e3+e._zOrder?1:-1};y.prototype._onClear=function(){if(this._clock!==null){this._clock.remove(this)}for(var t=0,e=this._bones;t<e.length;t++){var a=e[t];a.returnToPool()}for(var r=0,i=this._slots;r<i.length;r++){var n=i[r];n.returnToPool()}for(var s=0,o=this._constraints;s<o.length;s++){var l=o[s];l.returnToPool()}for(var h=0,f=this._actions;h<f.length;h++){var u=f[h];u.returnToPool()}if(this._animation!==null){this._animation.returnToPool()}if(this._proxy!==null){this._proxy.dbClear()}if(this._replaceTextureAtlasData!==null){this._replaceTextureAtlasData.returnToPool()}this.inheritAnimation=true;this.userData=null;this._lockUpdate=false;this._slotsDirty=true;this._zOrderDirty=false;this._zIndexDirty=false;this._alphaDirty=true;this._flipX=false;this._flipY=false;this._cacheFrameIndex=-1;this._alpha=1;this._globalAlpha=1;this._bones.length=0;this._slots.length=0;this._constraints.length=0;this._actions.length=0;this._armatureData=null;this._animation=null;this._proxy=null;this._display=null;this._replaceTextureAtlasData=null;this._replacedTexture=null;this._dragonBones=null;this._clock=null;this._parent=null};y.prototype._sortZOrder=function(t,e){var a=this._armatureData.sortedSlots;var r=t===null;if(this._zOrderDirty||!r){for(var i=0,n=a.length;i<n;++i){var s=r?i:t[e+i];if(s<0||s>=n){continue}var o=a[s];var l=this.getSlot(o.name);if(l!==null){l._setZOrder(i)}}this._slotsDirty=true;this._zOrderDirty=!r}};y.prototype._addBone=function(t){if(this._bones.indexOf(t)<0){this._bones.push(t)}};y.prototype._addSlot=function(t){if(this._slots.indexOf(t)<0){this._slots.push(t)}};y.prototype._addConstraint=function(t){if(this._constraints.indexOf(t)<0){this._constraints.push(t)}};y.prototype._bufferAction=function(t,e){if(this._actions.indexOf(t)<0){if(e){this._actions.push(t)}else{this._actions.unshift(t)}}};y.prototype.dispose=function(){if(this._armatureData!==null){this._lockUpdate=true;this._dragonBones.bufferObject(this)}};y.prototype.init=function(t,e,a,r){if(this._armatureData!==null){return}this._armatureData=t;this._animation=i.BaseObject.borrowObject(i.Animation);this._proxy=e;this._display=a;this._dragonBones=r;this._proxy.dbInit(this);this._animation.init(this);this._animation.animations=this._armatureData.animations};y.prototype.advanceTime=function(t){if(this._lockUpdate){return}this._lockUpdate=true;if(this._armatureData===null){console.warn("The armature has been disposed.");return}else if(this._armatureData.parent===null){console.warn("The armature data has been disposed.\nPlease make sure dispose armature before call factory.clear().");return}var e=this._cacheFrameIndex;this._animation.advanceTime(t);if(this._slotsDirty||this._zIndexDirty){this._slots.sort(y._onSortSlots);if(this._zIndexDirty){for(var a=0,r=this._slots.length;a<r;++a){this._slots[a]._setZOrder(a)}}this._slotsDirty=false;this._zIndexDirty=false}if(this._alphaDirty){this._alphaDirty=false;this._globalAlpha=this._alpha*(this._parent!==null?this._parent._globalAlpha:1);for(var i=0,n=this._bones;i<n.length;i++){var s=n[i];s._updateAlpha()}for(var o=0,l=this._slots;o<l.length;o++){var h=l[o];h._updateAlpha()}}if(this._cacheFrameIndex<0||this._cacheFrameIndex!==e){var a=0,r=0;for(a=0,r=this._bones.length;a<r;++a){this._bones[a].update(this._cacheFrameIndex)}for(a=0,r=this._slots.length;a<r;++a){this._slots[a].update(this._cacheFrameIndex)}}if(this._actions.length>0){for(var f=0,u=this._actions;f<u.length;f++){var _=u[f];var m=_.actionData;if(m!==null){if(m.type===0){if(_.slot!==null){var p=_.slot.childArmature;if(p!==null){p.animation.fadeIn(m.name)}}else if(_.bone!==null){for(var c=0,d=this.getSlots();c<d.length;c++){var h=d[c];if(h.parent===_.bone){var p=h.childArmature;if(p!==null){p.animation.fadeIn(m.name)}}}}else{this._animation.fadeIn(m.name)}}}_.returnToPool()}this._actions.length=0}this._lockUpdate=false;this._proxy.dbUpdate()};y.prototype.invalidUpdate=function(t,e){if(t===void 0){t=null}if(e===void 0){e=false}if(t!==null&&t.length>0){var a=this.getBone(t);if(a!==null){a.invalidUpdate();if(e){for(var r=0,i=this._slots;r<i.length;r++){var n=i[r];if(n.parent===a){n.invalidUpdate()}}}}}else{for(var s=0,o=this._bones;s<o.length;s++){var a=o[s];a.invalidUpdate()}if(e){for(var l=0,h=this._slots;l<h.length;l++){var n=h[l];n.invalidUpdate()}}}};y.prototype.containsPoint=function(t,e){for(var a=0,r=this._slots;a<r.length;a++){var i=r[a];if(i.containsPoint(t,e)){return i}}return null};y.prototype.intersectsSegment=function(t,e,a,r,i,n,s){if(i===void 0){i=null}if(n===void 0){n=null}if(s===void 0){s=null}var o=t===a;var l=0;var h=0;var f=0;var u=0;var _=0;var m=0;var p=0;var c=0;var d=null;var y=null;for(var v=0,g=this._slots;v<g.length;v++){var D=g[v];var b=D.intersectsSegment(t,e,a,r,i,n,s);if(b>0){if(i!==null||n!==null){if(i!==null){var T=o?i.y-e:i.x-t;if(T<0){T=-T}if(d===null||T<l){l=T;f=i.x;u=i.y;d=D;if(s){p=s.x}}}if(n!==null){var T=n.x-t;if(T<0){T=-T}if(y===null||T>h){h=T;_=n.x;m=n.y;y=D;if(s!==null){c=s.y}}}}else{d=D;break}}}if(d!==null&&i!==null){i.x=f;i.y=u;if(s!==null){s.x=p}}if(y!==null&&n!==null){n.x=_;n.y=m;if(s!==null){s.y=c}}return d};y.prototype.getBone=function(t){for(var e=0,a=this._bones;e<a.length;e++){var r=a[e];if(r.name===t){return r}}return null};y.prototype.getBoneByDisplay=function(t){var e=this.getSlotByDisplay(t);return e!==null?e.parent:null};y.prototype.getSlot=function(t){for(var e=0,a=this._slots;e<a.length;e++){var r=a[e];if(r.name===t){return r}}return null};y.prototype.getSlotByDisplay=function(t){if(t!==null){for(var e=0,a=this._slots;e<a.length;e++){var r=a[e];if(r.display===t){return r}}}return null};y.prototype.getBones=function(){return this._bones};y.prototype.getSlots=function(){return this._slots};Object.defineProperty(y.prototype,"flipX",{get:function(){return this._flipX},set:function(t){if(this._flipX===t){return}this._flipX=t;this.invalidUpdate()},enumerable:true,configurable:true});Object.defineProperty(y.prototype,"flipY",{get:function(){return this._flipY},set:function(t){if(this._flipY===t){return}this._flipY=t;this.invalidUpdate()},enumerable:true,configurable:true});Object.defineProperty(y.prototype,"cacheFrameRate",{get:function(){return this._armatureData.cacheFrameRate},set:function(t){if(this._armatureData.cacheFrameRate!==t){this._armatureData.cacheFrames(t);for(var e=0,a=this._slots;e<a.length;e++){var r=a[e];var i=r.childArmature;if(i!==null){i.cacheFrameRate=t}}}},enumerable:true,configurable:true});Object.defineProperty(y.prototype,"name",{get:function(){return this._armatureData.name},enumerable:true,configurable:true});Object.defineProperty(y.prototype,"armatureData",{get:function(){return this._armatureData},enumerable:true,configurable:true});Object.defineProperty(y.prototype,"animation",{get:function(){return this._animation},enumerable:true,configurable:true});Object.defineProperty(y.prototype,"proxy",{get:function(){return this._proxy},enumerable:true,configurable:true});Object.defineProperty(y.prototype,"eventDispatcher",{get:function(){return this._proxy},enumerable:true,configurable:true});Object.defineProperty(y.prototype,"display",{get:function(){return this._display},enumerable:true,configurable:true});Object.defineProperty(y.prototype,"replacedTexture",{get:function(){return this._replacedTexture},set:function(t){if(this._replacedTexture===t){return}if(this._replaceTextureAtlasData!==null){this._replaceTextureAtlasData.returnToPool();this._replaceTextureAtlasData=null}this._replacedTexture=t;for(var e=0,a=this._slots;e<a.length;e++){var r=a[e];r.invalidUpdate();r.update(-1)}},enumerable:true,configurable:true});Object.defineProperty(y.prototype,"clock",{get:function(){return this._clock},set:function(t){if(this._clock===t){return}if(this._clock!==null){this._clock.remove(this)}this._clock=t;if(this._clock){this._clock.add(this)}for(var e=0,a=this._slots;e<a.length;e++){var r=a[e];var i=r.childArmature;if(i!==null){i.clock=this._clock}}},enumerable:true,configurable:true});Object.defineProperty(y.prototype,"parent",{get:function(){return this._parent},enumerable:true,configurable:true});y.prototype.getDisplay=function(){return this._display};return y}(i.BaseObject);i.Armature=t})(dragonBones||(dragonBones={}));var dragonBones;(function(a){var t=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.globalTransformMatrix=new a.Matrix;t.global=new a.Transform;t.offset=new a.Transform;return t}t.prototype._onClear=function(){this.globalTransformMatrix.identity();this.global.identity();this.offset.identity();this.origin=null;this.userData=null;this._globalDirty=false;this._alpha=1;this._globalAlpha=1;this._armature=null};t.prototype.updateGlobalTransform=function(){if(this._globalDirty){this._globalDirty=false;this.global.fromMatrix(this.globalTransformMatrix)}};Object.defineProperty(t.prototype,"armature",{get:function(){return this._armature},enumerable:true,configurable:true});t._helpMatrix=new a.Matrix;t._helpTransform=new a.Transform;t._helpPoint=new a.Point;return t}(a.BaseObject);a.TransformObject=t})(dragonBones||(dragonBones={}));var dragonBones;(function(y){var t=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.animationPose=new y.Transform;return t}t.toString=function(){return"[class dragonBones.Bone]"};t.prototype._onClear=function(){e.prototype._onClear.call(this);this.offsetMode=1;this.animationPose.identity();this._transformDirty=false;this._childrenTransformDirty=false;this._localDirty=true;this._hasConstraint=false;this._visible=true;this._cachedFrameIndex=-1;this._boneData=null;this._parent=null;this._cachedFrameIndices=null};t.prototype._updateGlobalTransformMatrix=function(t){var e=this._boneData;var a=this.global;var r=this.globalTransformMatrix;var i=this.origin;var n=this.offset;var s=this.animationPose;var o=this._parent;var l=this._armature.flipX;var h=this._armature.flipY===y.DragonBones.yDown;var f=o!==null;var u=0;if(this.offsetMode===1){if(i!==null){a.x=i.x+n.x+s.x;a.scaleX=i.scaleX*n.scaleX*s.scaleX;a.scaleY=i.scaleY*n.scaleY*s.scaleY;if(y.DragonBones.yDown){a.y=i.y+n.y+s.y;a.skew=i.skew+n.skew+s.skew;a.rotation=i.rotation+n.rotation+s.rotation}else{a.y=i.y-n.y+s.y;a.skew=i.skew-n.skew+s.skew;a.rotation=i.rotation-n.rotation+s.rotation}}else{a.copyFrom(n);if(!y.DragonBones.yDown){a.y=-a.y;a.skew=-a.skew;a.rotation=-a.rotation}a.add(s)}}else if(this.offsetMode===0){if(i!==null){a.copyFrom(i).add(s)}else{a.copyFrom(s)}}else{f=false;a.copyFrom(n);if(!y.DragonBones.yDown){a.y=-a.y;a.skew=-a.skew;a.rotation=-a.rotation}}if(f){var _=o._boneData.type===1;var m=_?o._bone:null;var p=_?o._getGlobalTransformMatrix(a.x,a.y):o.globalTransformMatrix;if(e.inheritScale&&(!_||m!==null)){if(_){if(e.inheritRotation){a.rotation+=o.global.rotation}m.updateGlobalTransform();a.scaleX*=m.global.scaleX;a.scaleY*=m.global.scaleY;p.transformPoint(a.x,a.y,a);a.toMatrix(r);if(e.inheritTranslation){a.x=r.tx;a.y=r.ty}else{r.tx=a.x;r.ty=a.y}}else{if(!e.inheritRotation){o.updateGlobalTransform();if(l&&h){u=a.rotation-(o.global.rotation+Math.PI)}else if(l){u=a.rotation+o.global.rotation+Math.PI}else if(h){u=a.rotation+o.global.rotation}else{u=a.rotation-o.global.rotation}a.rotation=u}a.toMatrix(r);r.concat(p);if(e.inheritTranslation){a.x=r.tx;a.y=r.ty}else{r.tx=a.x;r.ty=a.y}if(t){a.fromMatrix(r)}else{this._globalDirty=true}}}else{if(e.inheritTranslation){var c=a.x;var d=a.y;a.x=p.a*c+p.c*d+p.tx;a.y=p.b*c+p.d*d+p.ty}else{if(l){a.x=-a.x}if(h){a.y=-a.y}}if(e.inheritRotation){o.updateGlobalTransform();if(o.global.scaleX<0){u=a.rotation+o.global.rotation+Math.PI}else{u=a.rotation+o.global.rotation}if(p.a*p.d-p.b*p.c<0){u-=a.rotation*2;if(l!==h||e.inheritReflection){a.skew+=Math.PI}if(!y.DragonBones.yDown){a.skew=-a.skew}}a.rotation=u}else if(l||h){if(l&&h){u=a.rotation+Math.PI}else{if(l){u=Math.PI-a.rotation}else{u=-a.rotation}a.skew+=Math.PI}a.rotation=u}a.toMatrix(r)}}else{if(l||h){if(l){a.x=-a.x}if(h){a.y=-a.y}if(l&&h){u=a.rotation+Math.PI}else{if(l){u=Math.PI-a.rotation}else{u=-a.rotation}a.skew+=Math.PI}a.rotation=u}a.toMatrix(r)}};t.prototype._updateAlpha=function(){if(this._parent!==null){this._globalAlpha=this._alpha*this._parent._globalAlpha}else{this._globalAlpha=this._alpha*this._armature._globalAlpha}};t.prototype.init=function(t,e){if(this._boneData!==null){return}this._boneData=t;this._armature=e;this._alpha=this._boneData.alpha;if(this._boneData.parent!==null){this._parent=this._armature.getBone(this._boneData.parent.name)}this._armature._addBone(this);this.origin=this._boneData.transform};t.prototype.update=function(t){if(t>=0&&this._cachedFrameIndices!==null){var e=this._cachedFrameIndices[t];if(e>=0&&this._cachedFrameIndex===e){this._transformDirty=false}else if(e>=0){this._transformDirty=true;this._cachedFrameIndex=e}else{if(this._hasConstraint){for(var a=0,r=this._armature._constraints;a<r.length;a++){var i=r[a];if(i._root===this){i.update()}}}if(this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty){this._transformDirty=true;this._cachedFrameIndex=-1}else if(this._cachedFrameIndex>=0){this._transformDirty=false;this._cachedFrameIndices[t]=this._cachedFrameIndex}else{this._transformDirty=true;this._cachedFrameIndex=-1}}}else{if(this._hasConstraint){for(var n=0,s=this._armature._constraints;n<s.length;n++){var i=s[n];if(i._root===this){i.update()}}}if(this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty){t=-1;this._transformDirty=true;this._cachedFrameIndex=-1}}if(this._transformDirty){this._transformDirty=false;this._childrenTransformDirty=true;if(this._cachedFrameIndex<0){var o=t>=0;if(this._localDirty){this._updateGlobalTransformMatrix(o)}if(o&&this._cachedFrameIndices!==null){this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global)}}else{this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex)}}else if(this._childrenTransformDirty){this._childrenTransformDirty=false}this._localDirty=true};t.prototype.updateByConstraint=function(){if(this._localDirty){this._localDirty=false;if(this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty){this._updateGlobalTransformMatrix(true)}this._transformDirty=true}};t.prototype.invalidUpdate=function(){this._transformDirty=true};t.prototype.contains=function(t){if(t===this){return false}var e=t;while(e!==this&&e!==null){e=e.parent}return e===this};Object.defineProperty(t.prototype,"boneData",{get:function(){return this._boneData},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},set:function(t){if(this._visible===t){return}this._visible=t;for(var e=0,a=this._armature.getSlots();e<a.length;e++){var r=a[e];if(r.parent===this){r._updateVisible()}}},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"name",{get:function(){return this._boneData.name},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:true,configurable:true});return t}(y.TransformObject);y.Bone=t})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(l){__extends(P,l);function P(){var t=l!==null&&l.apply(this,arguments)||this;t._vertices=[];t._deformVertices=[];t._hullCache=[];t._matrixCahce=[];return t}P.toString=function(){return"[class dragonBones.Surface]"};P.prototype._onClear=function(){l.prototype._onClear.call(this);this._dX=0;this._dY=0;this._k=0;this._kX=0;this._kY=0;this._vertices.length=0;this._deformVertices.length=0;this._matrixCahce.length=0;this._hullCache.length=0;this._bone=null};P.prototype._getAffineTransform=function(t,e,a,r,i,n,s,o,l,h,f,u,_){var m=s-i;var p=o-n;var c=l-i;var d=h-n;f.rotation=Math.atan2(p,m);f.skew=Math.atan2(d,c)-Math.PI*.5-f.rotation;if(_){f.rotation+=Math.PI}f.scaleX=Math.sqrt(m*m+p*p)/a;f.scaleY=Math.sqrt(c*c+d*d)/r;f.toMatrix(u);f.x=u.tx=i-(u.a*t+u.c*e);f.y=u.ty=n-(u.b*t+u.d*e)};P.prototype._updateVertices=function(){var t=this._armature.armatureData.parent;var e=this._boneData.geometry;var a=t.intArray;var r=t.floatArray;var i=a[e.offset+0];var n=a[e.offset+2];var s=this._vertices;var o=this._deformVertices;if(this._parent!==null){if(this._parent._boneData.type===1){for(var l=0,h=i;l<h;++l){var f=l*2;var u=r[n+f]+o[f];var _=r[n+f+1]+o[f+1];var m=this._parent._getGlobalTransformMatrix(u,_);s[f]=m.a*u+m.c*_+m.tx;s[f+1]=m.b*u+m.d*_+m.ty}}else{var p=this._parent.globalTransformMatrix;for(var l=0,h=i;l<h;++l){var f=l*2;var u=r[n+f]+o[f];var _=r[n+f+1]+o[f+1];s[f]=p.a*u+p.c*_+p.tx;s[f+1]=p.b*u+p.d*_+p.ty}}}else{for(var l=0,h=i;l<h;++l){var f=l*2;s[f]=r[n+f]+o[f];s[f+1]=r[n+f+1]+o[f+1]}}};P.prototype._updateGlobalTransformMatrix=function(t){t;var e=this._boneData.segmentX*2;var a=this._vertices.length-2;var r=200;var i=this._vertices[0];var n=this._vertices[1];var s=this._vertices[e];var o=this._vertices[e+1];var l=this._vertices[a];var h=this._vertices[a+1];var f=this._vertices[a-e];var u=this._vertices[a-e+1];var _=i+(l-i)*.5;var m=n+(h-n)*.5;var p=s+(f-s)*.5;var c=o+(u-o)*.5;var d=_+(p-_)*.5;var y=m+(c-m)*.5;var v=s+(l-s)*.5;var g=o+(h-o)*.5;var D=f+(l-f)*.5;var b=u+(h-u)*.5;this._getAffineTransform(0,0,r,r,d,y,v,g,D,b,this.global,this.globalTransformMatrix,false);this._globalDirty=false};P.prototype._getGlobalTransformMatrix=function(t,e){var a=200;var r=1e3;if(t<-r||r<t||e<-r||r<e){return this.globalTransformMatrix}var i=false;var n=this._boneData;var s=n.segmentX;var o=n.segmentY;var l=n.segmentX*2;var h=this._dX;var f=this._dY;var u=Math.floor((t+a)/h);var _=Math.floor((e+a)/f);var m=0;var p=u*h-a;var c=_*f-a;var d=this._matrixCahce;var y=P._helpMatrix;if(t<-a){if(e<-a||e>=a){return this.globalTransformMatrix}i=e>this._kX*(t+a)+c;m=((s*o+s+o+o+_)*2+(i?1:0))*7;if(d[m]>0){y.copyFromArray(d,m+1)}else{var v=_*(l+2);var g=this._hullCache[4];var D=this._hullCache[5];var b=this._hullCache[2]-(o-_)*g;var T=this._hullCache[3]-(o-_)*D;var A=this._vertices;if(i){this._getAffineTransform(-a,c+f,r-a,f,A[v+l+2],A[v+l+3],b+g,T+D,A[v],A[v+1],P._helpTransform,y,true)}else{this._getAffineTransform(-r,c,r-a,f,b,T,A[v],A[v+1],b+g,T+D,P._helpTransform,y,false)}d[m]=1;d[m+1]=y.a;d[m+2]=y.b;d[m+3]=y.c;d[m+4]=y.d;d[m+5]=y.tx;d[m+6]=y.ty}}else if(t>=a){if(e<-a||e>=a){return this.globalTransformMatrix}i=e>this._kX*(t-r)+c;m=((s*o+s+_)*2+(i?1:0))*7;if(d[m]>0){y.copyFromArray(d,m+1)}else{var v=(_+1)*(l+2)-2;var g=this._hullCache[4];var D=this._hullCache[5];var b=this._hullCache[0]+_*g;var T=this._hullCache[1]+_*D;var A=this._vertices;if(i){this._getAffineTransform(r,c+f,r-a,f,b+g,T+D,A[v+l+2],A[v+l+3],b,T,P._helpTransform,y,true)}else{this._getAffineTransform(a,c,r-a,f,A[v],A[v+1],b,T,A[v+l+2],A[v+l+3],P._helpTransform,y,false)}d[m]=1;d[m+1]=y.a;d[m+2]=y.b;d[m+3]=y.c;d[m+4]=y.d;d[m+5]=y.tx;d[m+6]=y.ty}}else if(e<-a){if(t<-a||t>=a){return this.globalTransformMatrix}i=e>this._kY*(t-p-h)-r;m=((s*o+u)*2+(i?1:0))*7;if(d[m]>0){y.copyFromArray(d,m+1)}else{var v=u*2;var g=this._hullCache[10];var D=this._hullCache[11];var b=this._hullCache[8]+u*g;var T=this._hullCache[9]+u*D;var A=this._vertices;if(i){this._getAffineTransform(p+h,-a,h,r-a,A[v+2],A[v+3],A[v],A[v+1],b+g,T+D,P._helpTransform,y,true)}else{this._getAffineTransform(p,-r,h,r-a,b,T,b+g,T+D,A[v],A[v+1],P._helpTransform,y,false)}d[m]=1;d[m+1]=y.a;d[m+2]=y.b;d[m+3]=y.c;d[m+4]=y.d;d[m+5]=y.tx;d[m+6]=y.ty}}else if(e>=a){if(t<-a||t>=a){return this.globalTransformMatrix}i=e>this._kY*(t-p-h)+a;m=((s*o+s+o+u)*2+(i?1:0))*7;if(d[m]>0){y.copyFromArray(d,m+1)}else{var v=o*(l+2)+u*2;var g=this._hullCache[10];var D=this._hullCache[11];var b=this._hullCache[6]-(s-u)*g;var T=this._hullCache[7]-(s-u)*D;var A=this._vertices;if(i){this._getAffineTransform(p+h,r,h,r-a,b+g,T+D,b,T,A[v+2],A[v+3],P._helpTransform,y,true)}else{this._getAffineTransform(p,a,h,r-a,A[v],A[v+1],A[v+2],A[v+3],b,T,P._helpTransform,y,false)}d[m]=1;d[m+1]=y.a;d[m+2]=y.b;d[m+3]=y.c;d[m+4]=y.d;d[m+5]=y.tx;d[m+6]=y.ty}}else{i=e>this._k*(t-p-h)+c;m=((s*_+u)*2+(i?1:0))*7;if(d[m]>0){y.copyFromArray(d,m+1)}else{var v=u*2+_*(l+2);var A=this._vertices;if(i){this._getAffineTransform(p+h,c+f,h,f,A[v+l+4],A[v+l+5],A[v+l+2],A[v+l+3],A[v+2],A[v+3],P._helpTransform,y,true)}else{this._getAffineTransform(p,c,h,f,A[v],A[v+1],A[v+2],A[v+3],A[v+l+2],A[v+l+3],P._helpTransform,y,false)}d[m]=1;d[m+1]=y.a;d[m+2]=y.b;d[m+3]=y.c;d[m+4]=y.d;d[m+5]=y.tx;d[m+6]=y.ty}}return y};P.prototype.init=function(t,e){if(this._boneData!==null){return}l.prototype.init.call(this,t,e);var a=t.segmentX;var r=t.segmentY;var i=this._armature.armatureData.parent.intArray[t.geometry.offset+0];var n=1e3;var s=200;this._dX=s*2/a;this._dY=s*2/r;this._k=-this._dY/this._dX;this._kX=-this._dY/(n-s);this._kY=-(n-s)/this._dX;this._vertices.length=i*2;this._deformVertices.length=i*2;this._matrixCahce.length=(a*r+a*2+r*2)*2*7;this._hullCache.length=10;for(var o=0;o<i*2;++o){this._deformVertices[o]=0}if(this._parent!==null){if(this._parent.boneData.type===0){this._bone=this._parent}else{this._bone=this._parent._bone}}};P.prototype.update=function(t){if(t>=0&&this._cachedFrameIndices!==null){var e=this._cachedFrameIndices[t];if(e>=0&&this._cachedFrameIndex===e){this._transformDirty=false}else if(e>=0){this._transformDirty=true;this._cachedFrameIndex=e}else{if(this._hasConstraint){for(var a=0,r=this._armature._constraints;a<r.length;a++){var i=r[a];if(i._root===this){i.update()}}}if(this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty){this._transformDirty=true;this._cachedFrameIndex=-1}else if(this._cachedFrameIndex>=0){this._transformDirty=false;this._cachedFrameIndices[t]=this._cachedFrameIndex}else{this._transformDirty=true;this._cachedFrameIndex=-1}}}else{if(this._hasConstraint){for(var n=0,s=this._armature._constraints;n<s.length;n++){var i=s[n];if(i._root===this){i.update()}}}if(this._transformDirty||this._parent!==null&&this._parent._childrenTransformDirty){t=-1;this._transformDirty=true;this._cachedFrameIndex=-1}}if(this._transformDirty){this._transformDirty=false;this._childrenTransformDirty=true;for(var o=0,l=this._matrixCahce.length;o<l;o+=7){this._matrixCahce[o]=-1}this._updateVertices();if(this._cachedFrameIndex<0){var h=t>=0;if(this._localDirty){this._updateGlobalTransformMatrix(h)}if(h&&this._cachedFrameIndices!==null){this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global)}}else{this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex)}var f=1e3;var u=200;var _=2*this.global.x;var m=2*this.global.y;var p=P._helpPoint;this.globalTransformMatrix.transformPoint(f,-u,p);this._hullCache[0]=p.x;this._hullCache[1]=p.y;this._hullCache[2]=_-p.x;this._hullCache[3]=m-p.y;this.globalTransformMatrix.transformPoint(0,this._dY,p,true);this._hullCache[4]=p.x;this._hullCache[5]=p.y;this.globalTransformMatrix.transformPoint(u,f,p);this._hullCache[6]=p.x;this._hullCache[7]=p.y;this._hullCache[8]=_-p.x;this._hullCache[9]=m-p.y;this.globalTransformMatrix.transformPoint(this._dX,0,p,true);this._hullCache[10]=p.x;this._hullCache[11]=p.y}else if(this._childrenTransformDirty){this._childrenTransformDirty=false}this._localDirty=true};return P}(t.Bone);t.Surface=e})(dragonBones||(dragonBones={}));var dragonBones;(function(c){var r=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.deformVertices=[];return t}t.toString=function(){return"[class dragonBones.DisplayFrame]"};t.prototype._onClear=function(){this.rawDisplayData=null;this.displayData=null;this.textureData=null;this.display=null;this.deformVertices.length=0};t.prototype.updateDeformVertices=function(){if(this.rawDisplayData===null||this.deformVertices.length!==0){return}var t;if(this.rawDisplayData.type===2){t=this.rawDisplayData.geometry}else if(this.rawDisplayData.type===4){t=this.rawDisplayData.geometry}else{return}var e=0;if(t.weight!==null){e=t.weight.count*2}else{e=t.data.intArray[t.offset+0]*2}this.deformVertices.length=e};t.prototype.getGeometryData=function(){if(this.displayData!==null){if(this.displayData.type===2){return this.displayData.geometry}if(this.displayData.type===4){return this.displayData.geometry}}if(this.rawDisplayData!==null){if(this.rawDisplayData.type===2){return this.rawDisplayData.geometry}if(this.rawDisplayData.type===4){return this.rawDisplayData.geometry}}return null};t.prototype.getBoundingBox=function(){if(this.displayData!==null&&this.displayData.type===3){return this.displayData.boundingBox}if(this.rawDisplayData!==null&&this.rawDisplayData.type===3){return this.rawDisplayData.boundingBox}return null};t.prototype.getTextureData=function(){if(this.displayData!==null){if(this.displayData.type===0){return this.displayData.texture}if(this.displayData.type===2){return this.displayData.texture}}if(this.textureData!==null){return this.textureData}if(this.rawDisplayData!==null){if(this.rawDisplayData.type===0){return this.rawDisplayData.texture}if(this.rawDisplayData.type===2){return this.rawDisplayData.texture}}return null};return t}(c.BaseObject);c.DisplayFrame=r;var t=function(l){__extends(p,l);function p(){var t=l!==null&&l.apply(this,arguments)||this;t._localMatrix=new c.Matrix;t._colorTransform=new c.ColorTransform;t._displayFrames=[];t._geometryBones=[];t._rawDisplay=null;t._meshDisplay=null;t._display=null;return t}p.prototype._onClear=function(){l.prototype._onClear.call(this);var t=[];for(var e=0,a=this._displayFrames;e<a.length;e++){var r=a[e];var i=r.display;if(i!==this._rawDisplay&&i!==this._meshDisplay&&t.indexOf(i)<0){t.push(i)}r.returnToPool()}for(var n=0,s=t;n<s.length;n++){var o=s[n];if(o instanceof c.Armature){o.dispose()}else{this._disposeDisplay(o,true)}}if(this._meshDisplay!==null&&this._meshDisplay!==this._rawDisplay){this._disposeDisplay(this._meshDisplay,false)}if(this._rawDisplay!==null){this._disposeDisplay(this._rawDisplay,false)}this.displayController=null;this._displayDataDirty=false;this._displayDirty=false;this._geometryDirty=false;this._textureDirty=false;this._visibleDirty=false;this._blendModeDirty=false;this._zOrderDirty=false;this._colorDirty=false;this._verticesDirty=false;this._transformDirty=false;this._visible=true;this._blendMode=0;this._displayIndex=-1;this._animationDisplayIndex=-1;this._zOrder=0;this._zIndex=0;this._cachedFrameIndex=-1;this._pivotX=0;this._pivotY=0;this._localMatrix.identity();this._colorTransform.identity();this._displayFrames.length=0;this._geometryBones.length=0;this._slotData=null;this._displayFrame=null;this._geometryData=null;this._boundingBoxData=null;this._textureData=null;this._rawDisplay=null;this._meshDisplay=null;this._display=null;this._childArmature=null;this._parent=null;this._cachedFrameIndices=null};p.prototype._hasDisplay=function(t){for(var e=0,a=this._displayFrames;e<a.length;e++){var r=a[e];if(r.display===t){return true}}return false};p.prototype._isBonesUpdate=function(){for(var t=0,e=this._geometryBones;t<e.length;t++){var a=e[t];if(a!==null&&a._childrenTransformDirty){return true}}return false};p.prototype._updateAlpha=function(){var t=this._alpha*this._parent._globalAlpha;if(this._globalAlpha!==t){this._globalAlpha=t;this._colorDirty=true}};p.prototype._updateDisplayData=function(){var t=this._displayFrame;var e=this._geometryData;var a=this._textureData;var r=null;var i=null;this._displayFrame=null;this._geometryData=null;this._boundingBoxData=null;this._textureData=null;if(this._displayIndex>=0&&this._displayIndex<this._displayFrames.length){this._displayFrame=this._displayFrames[this._displayIndex];r=this._displayFrame.rawDisplayData;i=this._displayFrame.displayData;this._geometryData=this._displayFrame.getGeometryData();this._boundingBoxData=this._displayFrame.getBoundingBox();this._textureData=this._displayFrame.getTextureData()}if(this._displayFrame!==t||this._geometryData!==e||this._textureData!==a){if(this._geometryData===null&&this._textureData!==null){var n=i!==null&&i.type===0?i:r;var s=this._textureData.parent.scale*this._armature._armatureData.scale;var o=this._textureData.frame;this._pivotX=n.pivot.x;this._pivotY=n.pivot.y;var l=o!==null?o:this._textureData.region;var h=l.width;var f=l.height;if(this._textureData.rotated&&o===null){h=l.height;f=l.width}this._pivotX*=h*s;this._pivotY*=f*s;if(o!==null){this._pivotX+=o.x*s;this._pivotY+=o.y*s}if(r!==null&&n!==r){r.transform.toMatrix(p._helpMatrix);p._helpMatrix.invert();p._helpMatrix.transformPoint(0,0,p._helpPoint);this._pivotX-=p._helpPoint.x;this._pivotY-=p._helpPoint.y;n.transform.toMatrix(p._helpMatrix);p._helpMatrix.invert();p._helpMatrix.transformPoint(0,0,p._helpPoint);this._pivotX+=p._helpPoint.x;this._pivotY+=p._helpPoint.y}if(!c.DragonBones.yDown){this._pivotY=(this._textureData.rotated?this._textureData.region.width:this._textureData.region.height)*s-this._pivotY}}else{this._pivotX=0;this._pivotY=0}if(r!==null){this.origin=r.transform}else if(i!==null){this.origin=i.transform}else{this.origin=null}if(this.origin!==null){this.global.copyFrom(this.origin).add(this.offset).toMatrix(this._localMatrix)}else{this.global.copyFrom(this.offset).toMatrix(this._localMatrix)}if(this._geometryData!==e){this._geometryDirty=true;this._verticesDirty=true;if(this._geometryData!==null){this._geometryBones.length=0;if(this._geometryData.weight!==null){for(var u=0,_=this._geometryData.weight.bones.length;u<_;++u){var m=this._armature.getBone(this._geometryData.weight.bones[u].name);this._geometryBones.push(m)}}}else{this._geometryBones.length=0;this._geometryData=null}}this._textureDirty=this._textureData!==a;this._transformDirty=true}};p.prototype._updateDisplay=function(){var t=this._display!==null?this._display:this._rawDisplay;var e=this._childArmature;if(this._displayFrame!==null){this._display=this._displayFrame.display;if(this._display!==null&&this._display instanceof c.Armature){this._childArmature=this._display;this._display=this._childArmature.display}else{this._childArmature=null}}else{this._display=null;this._childArmature=null}var a=this._display!==null?this._display:this._rawDisplay;if(a!==t){this._textureDirty=true;this._visibleDirty=true;this._blendModeDirty=true;this._colorDirty=true;this._transformDirty=true;this._onUpdateDisplay();this._replaceDisplay(t)}if(this._childArmature!==e){if(e!==null){e._parent=null;e.clock=null;if(e.inheritAnimation){e.animation.reset()}}if(this._childArmature!==null){this._childArmature._parent=this;this._childArmature.clock=this._armature.clock;if(this._childArmature.inheritAnimation){if(this._childArmature.cacheFrameRate===0){var r=this._armature.cacheFrameRate;if(r!==0){this._childArmature.cacheFrameRate=r}}if(this._displayFrame!==null){var i=null;var n=this._displayFrame.displayData!==null?this._displayFrame.displayData:this._displayFrame.rawDisplayData;if(n!==null&&n.type===1){i=n.actions}if(i!==null&&i.length>0){for(var s=0,o=i;s<o.length;s++){var l=o[s];var h=c.BaseObject.borrowObject(c.EventObject);c.EventObject.actionDataToInstance(l,h,this._armature);h.slot=this;this._armature._bufferAction(h,false)}}else{this._childArmature.animation.play()}}}}}};p.prototype._updateGlobalTransformMatrix=function(t){var e=this._parent._boneData.type===0?this._parent.globalTransformMatrix:this._parent._getGlobalTransformMatrix(this.global.x,this.global.y);this.globalTransformMatrix.copyFrom(this._localMatrix);this.globalTransformMatrix.concat(e);if(t){this.global.fromMatrix(this.globalTransformMatrix)}else{this._globalDirty=true}};p.prototype._setDisplayIndex=function(t,e){if(e===void 0){e=false}if(e){if(this._animationDisplayIndex===t){return}this._animationDisplayIndex=t}if(this._displayIndex===t){return}this._displayIndex=t<this._displayFrames.length?t:this._displayFrames.length-1;this._displayDataDirty=true;this._displayDirty=this._displayIndex<0||this._display!==this._displayFrames[this._displayIndex].display};p.prototype._setZOrder=function(t){if(this._zOrder===t){}this._zOrder=t;this._zOrderDirty=true;return this._zOrderDirty};p.prototype._setColor=function(t){this._colorTransform.copyFrom(t);return this._colorDirty=true};p.prototype.init=function(t,e,a,r){if(this._slotData!==null){return}this._slotData=t;this._colorDirty=true;this._blendModeDirty=true;this._blendMode=this._slotData.blendMode;this._zOrder=this._slotData.zOrder;this._zIndex=this._slotData.zIndex;this._alpha=this._slotData.alpha;this._colorTransform.copyFrom(this._slotData.color);this._rawDisplay=a;this._meshDisplay=r;this._armature=e;var i=this._armature.getBone(this._slotData.parent.name);if(i!==null){this._parent=i}else{}this._armature._addSlot(this);this._initDisplay(this._rawDisplay,false);if(this._rawDisplay!==this._meshDisplay){this._initDisplay(this._meshDisplay,false)}this._onUpdateDisplay();this._addDisplay()};p.prototype.update=function(t){if(this._displayDataDirty){this._updateDisplayData();this._displayDataDirty=false}if(this._displayDirty){this._updateDisplay();this._displayDirty=false}if(this._geometryDirty||this._textureDirty){if(this._display===null||this._display===this._rawDisplay||this._display===this._meshDisplay){this._updateFrame()}this._geometryDirty=false;this._textureDirty=false}if(this._display===null){return}if(this._visibleDirty){this._updateVisible();this._visibleDirty=false}if(this._blendModeDirty){this._updateBlendMode();this._blendModeDirty=false}if(this._colorDirty){this._updateColor();this._colorDirty=false}if(this._zOrderDirty){this._updateZOrder();this._zOrderDirty=false}if(this._geometryData!==null&&this._display===this._meshDisplay){var e=this._geometryData.weight!==null;var a=this._parent._boneData.type!==0;if(this._verticesDirty||e&&this._isBonesUpdate()||a&&this._parent._childrenTransformDirty){this._verticesDirty=false;this._updateMesh()}if(e||a){return}}if(t>=0&&this._cachedFrameIndices!==null){var r=this._cachedFrameIndices[t];if(r>=0&&this._cachedFrameIndex===r){this._transformDirty=false}else if(r>=0){this._transformDirty=true;this._cachedFrameIndex=r}else if(this._transformDirty||this._parent._childrenTransformDirty){this._transformDirty=true;this._cachedFrameIndex=-1}else if(this._cachedFrameIndex>=0){this._transformDirty=false;this._cachedFrameIndices[t]=this._cachedFrameIndex}else{this._transformDirty=true;this._cachedFrameIndex=-1}}else if(this._transformDirty||this._parent._childrenTransformDirty){t=-1;this._transformDirty=true;this._cachedFrameIndex=-1}if(this._transformDirty){if(this._cachedFrameIndex<0){var i=t>=0;this._updateGlobalTransformMatrix(i);if(i&&this._cachedFrameIndices!==null){this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global)}}else{this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex)}this._updateTransform();this._transformDirty=false}};p.prototype.invalidUpdate=function(){this._displayDataDirty=true;this._displayDirty=true;this._transformDirty=true};p.prototype.updateTransformAndMatrix=function(){if(this._transformDirty){this._updateGlobalTransformMatrix(false);this._transformDirty=false}};p.prototype.replaceRawDisplayData=function(t,e){if(e===void 0){e=-1}if(e<0){e=this._displayIndex<0?0:this._displayIndex}else if(e>=this._displayFrames.length){return}var a=this._displayFrames[e];if(a.rawDisplayData!==t){a.deformVertices.length=0;a.rawDisplayData=t;if(a.rawDisplayData===null){var r=this._armature._armatureData.defaultSkin;if(r!==null){var i=r.getDisplays(this._slotData.name);if(i!==null&&e<i.length){a.rawDisplayData=i[e]}}}if(e===this._displayIndex){this._displayDataDirty=true}}};p.prototype.replaceDisplayData=function(t,e){if(e===void 0){e=-1}if(e<0){e=this._displayIndex<0?0:this._displayIndex}else if(e>=this._displayFrames.length){return}var a=this._displayFrames[e];if(a.displayData!==t&&a.rawDisplayData!==t){a.displayData=t;if(e===this._displayIndex){this._displayDataDirty=true}}};p.prototype.replaceTextureData=function(t,e){if(e===void 0){e=-1}if(e<0){e=this._displayIndex<0?0:this._displayIndex}else if(e>=this._displayFrames.length){return}var a=this._displayFrames[e];if(a.textureData!==t){a.textureData=t;if(e===this._displayIndex){this._displayDataDirty=true}}};p.prototype.replaceDisplay=function(t,e){if(e===void 0){e=-1}if(e<0){e=this._displayIndex<0?0:this._displayIndex}else if(e>=this._displayFrames.length){return}var a=this._displayFrames[e];if(a.display!==t){var r=a.display;a.display=t;if(r!==null&&r!==this._rawDisplay&&r!==this._meshDisplay&&!this._hasDisplay(r)){if(r instanceof c.Armature){}else{this._disposeDisplay(r,true)}}if(t!==null&&t!==this._rawDisplay&&t!==this._meshDisplay&&!this._hasDisplay(r)&&!(t instanceof c.Armature)){this._initDisplay(t,true)}if(e===this._displayIndex){this._displayDirty=true}}};p.prototype.containsPoint=function(t,e){if(this._boundingBoxData===null){return false}this.updateTransformAndMatrix();p._helpMatrix.copyFrom(this.globalTransformMatrix);p._helpMatrix.invert();p._helpMatrix.transformPoint(t,e,p._helpPoint);return this._boundingBoxData.containsPoint(p._helpPoint.x,p._helpPoint.y)};p.prototype.intersectsSegment=function(t,e,a,r,i,n,s){if(i===void 0){i=null}if(n===void 0){n=null}if(s===void 0){s=null}if(this._boundingBoxData===null){return 0}this.updateTransformAndMatrix();p._helpMatrix.copyFrom(this.globalTransformMatrix);p._helpMatrix.invert();p._helpMatrix.transformPoint(t,e,p._helpPoint);t=p._helpPoint.x;e=p._helpPoint.y;p._helpMatrix.transformPoint(a,r,p._helpPoint);a=p._helpPoint.x;r=p._helpPoint.y;var o=this._boundingBoxData.intersectsSegment(t,e,a,r,i,n,s);if(o>0){if(o===1||o===2){if(i!==null){this.globalTransformMatrix.transformPoint(i.x,i.y,i);if(n!==null){n.x=i.x;n.y=i.y}}else if(n!==null){this.globalTransformMatrix.transformPoint(n.x,n.y,n)}}else{if(i!==null){this.globalTransformMatrix.transformPoint(i.x,i.y,i)}if(n!==null){this.globalTransformMatrix.transformPoint(n.x,n.y,n)}}if(s!==null){this.globalTransformMatrix.transformPoint(Math.cos(s.x),Math.sin(s.x),p._helpPoint,true);s.x=Math.atan2(p._helpPoint.y,p._helpPoint.x);this.globalTransformMatrix.transformPoint(Math.cos(s.y),Math.sin(s.y),p._helpPoint,true);s.y=Math.atan2(p._helpPoint.y,p._helpPoint.x)}}return o};p.prototype.getDisplayFrameAt=function(t){return this._displayFrames[t]};Object.defineProperty(p.prototype,"visible",{get:function(){return this._visible},set:function(t){if(this._visible===t){return}this._visible=t;this._updateVisible()},enumerable:true,configurable:true});Object.defineProperty(p.prototype,"displayFrameCount",{get:function(){return this._displayFrames.length},set:function(t){var e=this._displayFrames.length;if(e<t){this._displayFrames.length=t;for(var a=e;a<t;++a){this._displayFrames[a]=c.BaseObject.borrowObject(r)}}else if(e>t){for(var a=e-1;a<t;--a){this.replaceDisplay(null,a);this._displayFrames[a].returnToPool()}this._displayFrames.length=t}},enumerable:true,configurable:true});Object.defineProperty(p.prototype,"displayIndex",{get:function(){return this._displayIndex},set:function(t){this._setDisplayIndex(t);this.update(-1)},enumerable:true,configurable:true});Object.defineProperty(p.prototype,"name",{get:function(){return this._slotData.name},enumerable:true,configurable:true});Object.defineProperty(p.prototype,"displayList",{get:function(){var t=new Array;for(var e=0,a=this._displayFrames;e<a.length;e++){var r=a[e];t.push(r.display)}return t},set:function(t){this.displayFrameCount=t.length;var e=0;for(var a=0,r=t;a<r.length;a++){var i=r[a];this.replaceDisplay(i,e++)}},enumerable:true,configurable:true});Object.defineProperty(p.prototype,"slotData",{get:function(){return this._slotData},enumerable:true,configurable:true});Object.defineProperty(p.prototype,"boundingBoxData",{get:function(){return this._boundingBoxData},enumerable:true,configurable:true});Object.defineProperty(p.prototype,"rawDisplay",{get:function(){return this._rawDisplay},enumerable:true,configurable:true});Object.defineProperty(p.prototype,"meshDisplay",{get:function(){return this._meshDisplay},enumerable:true,configurable:true});Object.defineProperty(p.prototype,"display",{get:function(){return this._display},set:function(t){if(this._display===t){return}if(this._displayFrames.length===0){this.displayFrameCount=1;this._displayIndex=0}this.replaceDisplay(t,this._displayIndex)},enumerable:true,configurable:true});Object.defineProperty(p.prototype,"childArmature",{get:function(){return this._childArmature},set:function(t){if(this._childArmature===t){return}this.display=t},enumerable:true,configurable:true});Object.defineProperty(p.prototype,"parent",{get:function(){return this._parent},enumerable:true,configurable:true});p.prototype.getDisplay=function(){return this._display};p.prototype.setDisplay=function(t){this.display=t};return p}(c.TransformObject);c.Slot=t})(dragonBones||(dragonBones={}));var dragonBones;(function(U){var t=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype._onClear=function(){this._armature=null;this._target=null;this._root=null;this._bone=null};Object.defineProperty(e.prototype,"name",{get:function(){return this._constraintData.name},enumerable:true,configurable:true});e._helpMatrix=new U.Matrix;e._helpTransform=new U.Transform;e._helpPoint=new U.Point;return e}(U.BaseObject);U.Constraint=t;var e=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.IKConstraint]"};e.prototype._onClear=function(){t.prototype._onClear.call(this);this._bendPositive=false;this._weight=1;this._constraintData=null};e.prototype._computeA=function(){var t=this._target.global;var e=this._root.global;var a=this._root.globalTransformMatrix;var r=Math.atan2(t.y-e.y,t.x-e.x);if(e.scaleX<0){r+=Math.PI}e.rotation+=U.Transform.normalizeRadian(r-e.rotation)*this._weight;e.toMatrix(a)};e.prototype._computeB=function(){var t=this._bone._boneData.length;var e=this._root;var a=this._target.global;var r=e.global;var i=this._bone.global;var n=this._bone.globalTransformMatrix;var s=n.a*t;var o=n.b*t;var l=s*s+o*o;var h=Math.sqrt(l);var f=i.x-r.x;var u=i.y-r.y;var _=f*f+u*u;var m=Math.sqrt(_);var p=i.rotation;var c=r.rotation;var d=Math.atan2(u,f);f=a.x-r.x;u=a.y-r.y;var y=f*f+u*u;var v=Math.sqrt(y);var g=0;if(h+m<=v||v+h<=m||v+m<=h){g=Math.atan2(a.y-r.y,a.x-r.x);if(h+m<=v){}else if(m<h){g+=Math.PI}}else{var D=(_-l+y)/(2*y);var b=Math.sqrt(_-D*D*y)/v;var T=r.x+f*D;var A=r.y+u*D;var P=-u*b;var O=f*b;var S=false;var x=e.parent;if(x!==null){var B=x.globalTransformMatrix;S=B.a*B.d-B.b*B.c<0}if(S!==this._bendPositive){i.x=T-P;i.y=A-O}else{i.x=T+P;i.y=A+O}g=Math.atan2(i.y-r.y,i.x-r.x)}var E=U.Transform.normalizeRadian(g-d);r.rotation=c+E*this._weight;r.toMatrix(e.globalTransformMatrix);var M=d+E*this._weight;i.x=r.x+Math.cos(M)*m;i.y=r.y+Math.sin(M)*m;var I=Math.atan2(a.y-i.y,a.x-i.x);if(i.scaleX<0){I+=Math.PI}i.rotation=r.rotation+p-c+U.Transform.normalizeRadian(I-E-p)*this._weight;i.toMatrix(n)};e.prototype.init=function(t,e){if(this._constraintData!==null){return}this._constraintData=t;this._armature=e;this._target=this._armature.getBone(this._constraintData.target.name);this._root=this._armature.getBone(this._constraintData.root.name);this._bone=this._constraintData.bone!==null?this._armature.getBone(this._constraintData.bone.name):null;{var a=this._constraintData;this._bendPositive=a.bendPositive;this._weight=a.weight}this._root._hasConstraint=true};e.prototype.update=function(){this._root.updateByConstraint();if(this._bone!==null){this._bone.updateByConstraint();this._computeB()}else{this._computeA()}};e.prototype.invalidUpdate=function(){this._root.invalidUpdate();if(this._bone!==null){this._bone.invalidUpdate()}};return e}(t);U.IKConstraint=e;var a=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._bones=[];t._spaces=[];t._positions=[];t._curves=[];t._boneLengths=[];t._pathGlobalVertices=[];t._segments=[10];return t}t.toString=function(){return"[class dragonBones.PathConstraint]"};t.prototype._onClear=function(){e.prototype._onClear.call(this);this.dirty=false;this.pathOffset=0;this.position=0;this.spacing=0;this.rotateOffset=0;this.rotateMix=1;this.translateMix=1;this._pathSlot=null;this._bones.length=0;this._spaces.length=0;this._positions.length=0;this._curves.length=0;this._boneLengths.length=0;this._pathGlobalVertices.length=0};t.prototype._updatePathVertices=function(t){var e=this._armature;var a=e.armatureData.parent;var r=e.armatureData.scale;var i=a.intArray;var n=a.floatArray;var s=t.offset;var o=i[s+0];var l=i[s+2];this._pathGlobalVertices.length=o*2;var h=t.weight;if(h===null){var f=this._pathSlot.parent;f.updateByConstraint();var u=f.globalTransformMatrix;for(var _=0,m=l;_<o;_+=2){var p=n[m++]*r;var c=n[m++]*r;var d=u.a*p+u.c*c+u.tx;var y=u.b*p+u.d*c+u.ty;this._pathGlobalVertices[_]=d;this._pathGlobalVertices[_+1]=y}return}var v=this._pathSlot._geometryBones;var g=h.bones.length;var D=h.offset;var b=i[D+1];var T=b;var A=D+2+g;for(var _=0,P=0;_<o;_++){var O=i[A++];var S=0,x=0;for(var B=0,E=O;B<E;B++){var M=i[A++];var I=v[M];if(I===null){continue}I.updateByConstraint();var u=I.globalTransformMatrix;var F=n[T++];var p=n[T++]*r;var c=n[T++]*r;S+=(u.a*p+u.c*c+u.tx)*F;x+=(u.b*p+u.d*c+u.ty)*F}this._pathGlobalVertices[P++]=S;this._pathGlobalVertices[P++]=x}};t.prototype._computeVertices=function(t,e,a,r){for(var i=a,n=t;i<e;i+=2){r[i]=this._pathGlobalVertices[n++];r[i+1]=this._pathGlobalVertices[n++]}};t.prototype._computeBezierCurve=function(t,e,a,r,i){var n=this._armature;var s=n.armatureData.parent.intArray;var o=s[t.geometry.offset+0];var l=this._positions;var h=this._spaces;var f=t.closed;var u=Array();var _=o*2;var m=_/6;var p=-1;var c=this.position;l.length=e*3+2;var d=0;if(!t.constantSpeed){var y=t.curveLengths;m-=f?1:2;d=y[m];if(r){c*=d}if(i){for(var v=0;v<e;v++){h[v]*=d}}u.length=8;for(var v=0,g=0,D=0;v<e;v++,g+=3){var b=h[v];c+=b;if(f){c%=d;if(c<0){c+=d}D=0}else if(c<0){continue}else if(c>d){continue}var T=0;for(;;D++){var A=y[D];if(c>A){continue}if(D===0){T=c/A}else{var P=y[D-1];T=(c-P)/(A-P)}break}if(D!==p){p=D;if(f&&D===m){this._computeVertices(_-4,4,0,u);this._computeVertices(0,4,4,u)}else{this._computeVertices(D*6+2,8,0,u)}}this.addCurvePosition(T,u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],l,g,a)}return}if(f){_+=2;u.length=o;this._computeVertices(2,_-4,0,u);this._computeVertices(0,2,_-4,u);u[_-2]=u[0];u[_-1]=u[1]}else{m--;_-=4;u.length=_;this._computeVertices(2,_,0,u)}var O=new Array(m);d=0;var S=u[0],x=u[1],B=0,E=0,M=0,I=0,F=0,w=0;var C,N,R,j,k,L,V,Y;for(var v=0,U=2;v<m;v++,U+=6){B=u[U];E=u[U+1];M=u[U+2];I=u[U+3];F=u[U+4];w=u[U+5];C=(S-B*2+M)*.1875;N=(x-E*2+I)*.1875;R=((B-M)*3-S+F)*.09375;j=((E-I)*3-x+w)*.09375;k=C*2+R;L=N*2+j;V=(B-S)*.75+C+R*.16666667;Y=(E-x)*.75+N+j*.16666667;d+=Math.sqrt(V*V+Y*Y);V+=k;Y+=L;k+=R;L+=j;d+=Math.sqrt(V*V+Y*Y);V+=k;Y+=L;d+=Math.sqrt(V*V+Y*Y);V+=k+R;Y+=L+j;d+=Math.sqrt(V*V+Y*Y);O[v]=d;S=F;x=w}if(r){c*=d}if(i){for(var v=0;v<e;v++){h[v]*=d}}var X=this._segments;var G=0;for(var v=0,g=0,D=0,H=0;v<e;v++,g+=3){var b=h[v];c+=b;var W=c;if(f){W%=d;if(W<0)W+=d;D=0}else if(W<0){continue}else if(W>d){continue}for(;;D++){var z=O[D];if(W>z)continue;if(D===0)W/=z;else{var $=O[D-1];W=(W-$)/(z-$)}break}if(D!==p){p=D;var K=D*6;S=u[K];x=u[K+1];B=u[K+2];E=u[K+3];M=u[K+4];I=u[K+5];F=u[K+6];w=u[K+7];C=(S-B*2+M)*.03;N=(x-E*2+I)*.03;R=((B-M)*3-S+F)*.006;j=((E-I)*3-x+w)*.006;k=C*2+R;L=N*2+j;V=(B-S)*.3+C+R*.16666667;Y=(E-x)*.3+N+j*.16666667;G=Math.sqrt(V*V+Y*Y);X[0]=G;for(K=1;K<8;K++){V+=k;Y+=L;k+=R;L+=j;G+=Math.sqrt(V*V+Y*Y);X[K]=G}V+=k;Y+=L;G+=Math.sqrt(V*V+Y*Y);X[8]=G;V+=k+R;Y+=L+j;G+=Math.sqrt(V*V+Y*Y);X[9]=G;H=0}W*=G;for(;;H++){var Z=X[H];if(W>Z)continue;if(H===0)W/=Z;else{var $=X[H-1];W=H+(W-$)/(Z-$)}break}this.addCurvePosition(W*.1,S,x,B,E,M,I,F,w,l,g,a)}};t.prototype.addCurvePosition=function(t,e,a,r,i,n,s,o,l,h,f,u){if(t===0){h[f]=e;h[f+1]=a;h[f+2]=0;return}if(t===1){h[f]=o;h[f+1]=l;h[f+2]=0;return}var _=1-t;var m=_*_;var p=t*t;var c=m*_;var d=m*t*3;var y=_*p*3;var v=t*p;var g=c*e+d*r+y*n+v*o;var D=c*a+d*i+y*s+v*l;h[f]=g;h[f+1]=D;if(u){h[f+2]=Math.atan2(D-(c*a+d*i+y*s),g-(c*e+d*r+y*n))}else{h[f+2]=0}};t.prototype.init=function(t,e){this._constraintData=t;this._armature=e;var a=t;this.pathOffset=a.pathDisplayData.geometry.offset;this.position=a.position;this.spacing=a.spacing;this.rotateOffset=a.rotateOffset;this.rotateMix=a.rotateMix;this.translateMix=a.translateMix;this._root=this._armature.getBone(a.root.name);this._target=this._armature.getBone(a.target.name);this._pathSlot=this._armature.getSlot(a.pathSlot.name);for(var r=0,i=a.bones.length;r<i;r++){var n=this._armature.getBone(a.bones[r].name);if(n!==null){this._bones.push(n)}}if(a.rotateMode===2){this._boneLengths.length=this._bones.length}this._root._hasConstraint=true};t.prototype.update=function(){var t=this._pathSlot;if(t._geometryData===null||t._geometryData.offset!==this.pathOffset){return}var e=this._constraintData;var a=false;if(this._root._childrenTransformDirty){this._updatePathVertices(t._geometryData);a=true}else if(t._verticesDirty||t._isBonesUpdate()){this._updatePathVertices(t._geometryData);t._verticesDirty=false;a=true}if(!a&&!this.dirty){return}var r=e.positionMode;var i=e.spacingMode;var n=e.rotateMode;var s=this._bones;var o=i===0;var l=n===2;var h=n===0;var f=s.length;var u=h?f:f+1;var _=this.spacing;var m=this._spaces;m.length=u;if(l||o){m[0]=0;for(var p=0,c=u-1;p<c;p++){var d=s[p];d.updateByConstraint();var y=d._boneData.length;var v=d.globalTransformMatrix;var g=y*v.a;var D=y*v.b;var b=Math.sqrt(g*g+D*D);if(l){this._boneLengths[p]=b}m[p+1]=(y+_)*b/y}}else{for(var p=0;p<u;p++){m[p]=_}}this._computeBezierCurve(t._displayFrame.rawDisplayData,u,h,r===1,i===2);var T=this._positions;var A=this.rotateOffset;var P=T[0],O=T[1];var S;if(A===0){S=n===1}else{S=false;var d=t.parent;if(d!==null){var v=d.globalTransformMatrix;A*=v.a*v.d-v.b*v.c>0?U.Transform.DEG_RAD:-U.Transform.DEG_RAD}}var x=this.rotateMix;var B=this.translateMix;for(var p=0,E=3;p<f;p++,E+=3){var d=s[p];d.updateByConstraint();var v=d.globalTransformMatrix;v.tx+=(P-v.tx)*B;v.ty+=(O-v.ty)*B;var g=T[E],D=T[E+1];var M=g-P,I=D-O;if(l){var F=this._boneLengths[p];var w=(Math.sqrt(M*M+I*I)/F-1)*x+1;v.a*=w;v.b*=w}P=g;O=D;if(x>0){var C=v.a,N=v.b,R=v.c,j=v.d,k=void 0,L=void 0,V=void 0;if(h){k=T[E-1]}else{k=Math.atan2(I,M)}k-=Math.atan2(N,C);if(S){L=Math.cos(k);V=Math.sin(k);var Y=d._boneData.length;P+=(Y*(L*C-V*N)-M)*x;O+=(Y*(V*C+L*N)-I)*x}else{k+=A}if(k>U.Transform.PI){k-=U.Transform.PI_D}else if(k<-U.Transform.PI){k+=U.Transform.PI_D}k*=x;L=Math.cos(k);V=Math.sin(k);v.a=L*C-V*N;v.b=V*C+L*N;v.c=L*R-V*j;v.d=V*R+L*j}d.global.fromMatrix(v)}this.dirty=false};t.prototype.invalidUpdate=function(){};return t}(t);U.PathConstraint=a})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(){function t(t){if(t===void 0){t=0}this.time=0;this.timeScale=1;this._systemTime=0;this._animatebles=[];this._clock=null;this.time=t;this._systemTime=(new Date).getTime()*.001}t.prototype.advanceTime=function(t){if(t!==t){t=0}var e=Date.now()*.001;if(t<0){t=e-this._systemTime}this._systemTime=e;if(this.timeScale!==1){t*=this.timeScale}if(t===0){return}if(t<0){this.time-=t}else{this.time+=t}var a=0,r=0,i=this._animatebles.length;for(;a<i;++a){var n=this._animatebles[a];if(n!==null){if(r>0){this._animatebles[a-r]=n;this._animatebles[a]=null}n.advanceTime(t)}else{r++}}if(r>0){i=this._animatebles.length;for(;a<i;++a){var s=this._animatebles[a];if(s!==null){this._animatebles[a-r]=s}else{r++}}this._animatebles.length-=r}};t.prototype.contains=function(t){if(t===this){return false}var e=t;while(e!==this&&e!==null){e=e.clock}return e===this};t.prototype.add=function(t){if(this._animatebles.indexOf(t)<0){this._animatebles.push(t);t.clock=this}};t.prototype.remove=function(t){var e=this._animatebles.indexOf(t);if(e>=0){this._animatebles[e]=null;t.clock=null}};t.prototype.clear=function(){for(var t=0,e=this._animatebles;t<e.length;t++){var a=e[t];if(a!==null){a.clock=null}}};Object.defineProperty(t.prototype,"clock",{get:function(){return this._clock},set:function(t){if(this._clock===t){return}if(this._clock!==null){this._clock.remove(this)}this._clock=t;if(this._clock!==null){this._clock.add(this)}},enumerable:true,configurable:true});return t}();t.WorldClock=e})(dragonBones||(dragonBones={}));var dragonBones;(function(g){var t=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._animationNames=[];t._animationStates=[];t._animations={};t._blendStates={};t._animationConfig=null;return t}t.toString=function(){return"[class dragonBones.Animation]"};t.prototype._onClear=function(){for(var t=0,e=this._animationStates;t<e.length;t++){var a=e[t];a.returnToPool()}for(var r in this._animations){delete this._animations[r]}for(var r in this._blendStates){var i=this._blendStates[r];for(var n in i){i[n].returnToPool()}delete this._blendStates[r]}if(this._animationConfig!==null){this._animationConfig.returnToPool()}this.timeScale=1;this._animationDirty=false;this._inheritTimeScale=1;this._animationNames.length=0;this._animationStates.length=0;this._armature=null;this._animationConfig=null;this._lastAnimationState=null};t.prototype._fadeOut=function(t){switch(t.fadeOutMode){case 1:for(var e=0,a=this._animationStates;e<a.length;e++){var r=a[e];if(r._parent!==null){continue}if(r.layer===t.layer){r.fadeOut(t.fadeOutTime,t.pauseFadeOut)}}break;case 2:for(var i=0,n=this._animationStates;i<n.length;i++){var r=n[i];if(r._parent!==null){continue}if(r.group===t.group){r.fadeOut(t.fadeOutTime,t.pauseFadeOut)}}break;case 3:for(var s=0,o=this._animationStates;s<o.length;s++){var r=o[s];if(r._parent!==null){continue}if(r.layer===t.layer&&r.group===t.group){r.fadeOut(t.fadeOutTime,t.pauseFadeOut)}}break;case 4:for(var l=0,h=this._animationStates;l<h.length;l++){var r=h[l];if(r._parent!==null){continue}r.fadeOut(t.fadeOutTime,t.pauseFadeOut)}break;case 5:default:break}};t.prototype.init=function(t){if(this._armature!==null){return}this._armature=t;this._animationConfig=g.BaseObject.borrowObject(g.AnimationConfig)};t.prototype.advanceTime=function(t){if(t<0){t=-t}if(this._armature.inheritAnimation&&this._armature._parent!==null){this._inheritTimeScale=this._armature._parent._armature.animation._inheritTimeScale*this.timeScale}else{this._inheritTimeScale=this.timeScale}if(this._inheritTimeScale!==1){t*=this._inheritTimeScale}for(var e in this._blendStates){var a=this._blendStates[e];for(var r in a){a[r].reset()}}var i=this._animationStates.length;if(i===1){var n=this._animationStates[0];if(n._fadeState>0&&n._subFadeState>0){this._armature._dragonBones.bufferObject(n);this._animationStates.length=0;this._lastAnimationState=null}else{var s=n.animationData;var o=s.cacheFrameRate;if(this._animationDirty&&o>0){this._animationDirty=false;for(var l=0,h=this._armature.getBones();l<h.length;l++){var f=h[l];f._cachedFrameIndices=s.getBoneCachedFrameIndices(f.name)}for(var u=0,_=this._armature.getSlots();u<_.length;u++){var m=_[u];if(m.displayFrameCount>0){var p=m.getDisplayFrameAt(0).rawDisplayData;if(p!==null&&p.parent===this._armature.armatureData.defaultSkin){m._cachedFrameIndices=s.getSlotCachedFrameIndices(m.name);continue}}m._cachedFrameIndices=null}}n.advanceTime(t,o)}}else if(i>1){for(var c=0,d=0;c<i;++c){var n=this._animationStates[c];if(n._fadeState>0&&n._subFadeState>0){d++;this._armature._dragonBones.bufferObject(n);this._animationDirty=true;if(this._lastAnimationState===n){this._lastAnimationState=null}}else{if(d>0){this._animationStates[c-d]=n}n.advanceTime(t,0)}if(c===i-1&&d>0){this._animationStates.length-=d;if(this._lastAnimationState===null&&this._animationStates.length>0){this._lastAnimationState=this._animationStates[this._animationStates.length-1]}}}this._armature._cacheFrameIndex=-1}else{this._armature._cacheFrameIndex=-1}};t.prototype.reset=function(){for(var t=0,e=this._animationStates;t<e.length;t++){var a=e[t];a.returnToPool()}this._animationDirty=false;this._animationConfig.clear();this._animationStates.length=0;this._lastAnimationState=null};t.prototype.stop=function(t){if(t===void 0){t=null}if(t!==null){var e=this.getState(t);if(e!==null){e.stop()}}else{for(var a=0,r=this._animationStates;a<r.length;a++){var e=r[a];e.stop()}}};t.prototype.playConfig=function(t){var e=t.animation;if(!(e in this._animations)){console.warn("Non-existent animation.\n","DragonBones name: "+this._armature.armatureData.parent.name,"Armature name: "+this._armature.name,"Animation name: "+e);return null}var a=this._animations[e];if(t.fadeOutMode===5){for(var r=0,i=this._animationStates;r<i.length;r++){var n=i[r];if(n._fadeState<1&&n.layer===t.layer&&n.animationData===a){return n}}}if(this._animationStates.length===0){t.fadeInTime=0}else if(t.fadeInTime<0){t.fadeInTime=a.fadeInTime}if(t.fadeOutTime<0){t.fadeOutTime=t.fadeInTime}if(t.timeScale<=-100){t.timeScale=1/a.scale}if(a.frameCount>0){if(t.position<0){t.position%=a.duration;t.position=a.duration-t.position}else if(t.position===a.duration){t.position-=1e-6}else if(t.position>a.duration){t.position%=a.duration}if(t.duration>0&&t.position+t.duration>a.duration){t.duration=a.duration-t.position}if(t.playTimes<0){t.playTimes=a.playTimes}}else{t.playTimes=1;t.position=0;if(t.duration>0){t.duration=0}}if(t.duration===0){t.duration=-1}this._fadeOut(t);var s=g.BaseObject.borrowObject(g.AnimationState);s.init(this._armature,a,t);this._animationDirty=true;this._armature._cacheFrameIndex=-1;if(this._animationStates.length>0){var o=false;for(var l=0,h=this._animationStates.length;l<h;++l){if(s.layer>this._animationStates[l].layer){o=true;this._animationStates.splice(l,0,s);break}else if(l!==h-1&&s.layer>this._animationStates[l+1].layer){o=true;this._animationStates.splice(l+1,0,s);break}}if(!o){this._animationStates.push(s)}}else{this._animationStates.push(s)}for(var f=0,u=this._armature.getSlots();f<u.length;f++){var _=u[f];var m=_.childArmature;if(m!==null&&m.inheritAnimation&&m.animation.hasAnimation(e)&&m.animation.getState(e)===null){m.animation.fadeIn(e)}}for(var p in a.animationTimelines){var c=this.fadeIn(p,0,1,s.layer,"",5);if(c===null){continue}var d=a.animationTimelines[p];c.actionEnabled=false;c.resetToPose=false;c.stop();s.addState(c,d);var y=this._animationStates.indexOf(s);var v=this._animationStates.indexOf(c);if(v<y){this._animationStates.splice(y,1);this._animationStates.splice(v,0,s)}}this._lastAnimationState=s;return s};t.prototype.play=function(t,e){if(t===void 0){t=null}if(e===void 0){e=-1}this._animationConfig.clear();this._animationConfig.resetToPose=true;this._animationConfig.playTimes=e;this._animationConfig.fadeInTime=0;this._animationConfig.animation=t!==null?t:"";if(t!==null&&t.length>0){this.playConfig(this._animationConfig)}else if(this._lastAnimationState===null){var a=this._armature.armatureData.defaultAnimation;if(a!==null){this._animationConfig.animation=a.name;this.playConfig(this._animationConfig)}}else if(!this._lastAnimationState.isPlaying&&!this._lastAnimationState.isCompleted){this._lastAnimationState.play()}else{this._animationConfig.animation=this._lastAnimationState.name;this.playConfig(this._animationConfig)}return this._lastAnimationState};t.prototype.fadeIn=function(t,e,a,r,i,n){if(e===void 0){e=-1}if(a===void 0){a=-1}if(r===void 0){r=0}if(i===void 0){i=null}if(n===void 0){n=3}this._animationConfig.clear();this._animationConfig.fadeOutMode=n;this._animationConfig.playTimes=a;this._animationConfig.layer=r;this._animationConfig.fadeInTime=e;this._animationConfig.animation=t;this._animationConfig.group=i!==null?i:"";return this.playConfig(this._animationConfig)};t.prototype.gotoAndPlayByTime=function(t,e,a){if(e===void 0){e=0}if(a===void 0){a=-1}this._animationConfig.clear();this._animationConfig.resetToPose=true;this._animationConfig.playTimes=a;this._animationConfig.position=e;this._animationConfig.fadeInTime=0;this._animationConfig.animation=t;return this.playConfig(this._animationConfig)};t.prototype.gotoAndPlayByFrame=function(t,e,a){if(e===void 0){e=0}if(a===void 0){a=-1}this._animationConfig.clear();this._animationConfig.resetToPose=true;this._animationConfig.playTimes=a;this._animationConfig.fadeInTime=0;this._animationConfig.animation=t;var r=t in this._animations?this._animations[t]:null;if(r!==null){this._animationConfig.position=r.frameCount>0?r.duration*e/r.frameCount:0}return this.playConfig(this._animationConfig)};t.prototype.gotoAndPlayByProgress=function(t,e,a){if(e===void 0){e=0}if(a===void 0){a=-1}this._animationConfig.clear();this._animationConfig.resetToPose=true;this._animationConfig.playTimes=a;this._animationConfig.fadeInTime=0;this._animationConfig.animation=t;var r=t in this._animations?this._animations[t]:null;if(r!==null){this._animationConfig.position=r.duration*(e>0?e:0)}return this.playConfig(this._animationConfig)};t.prototype.gotoAndStopByTime=function(t,e){if(e===void 0){e=0}var a=this.gotoAndPlayByTime(t,e,1);if(a!==null){a.stop()}return a};t.prototype.gotoAndStopByFrame=function(t,e){if(e===void 0){e=0}var a=this.gotoAndPlayByFrame(t,e,1);if(a!==null){a.stop()}return a};t.prototype.gotoAndStopByProgress=function(t,e){if(e===void 0){e=0}var a=this.gotoAndPlayByProgress(t,e,1);if(a!==null){a.stop()}return a};t.prototype.getBlendState=function(t,e,a){if(!(t in this._blendStates)){this._blendStates[t]={}}var r=this._blendStates[t];if(!(e in r)){var i=r[e]=g.BaseObject.borrowObject(g.BlendState);i.target=a}return r[e]};t.prototype.getState=function(t,e){if(e===void 0){e=-1}var a=this._animationStates.length;while(a--){var r=this._animationStates[a];if(r.name===t&&(e<0||r.layer===e)){return r}}return null};t.prototype.hasAnimation=function(t){return t in this._animations};t.prototype.getStates=function(){return this._animationStates};Object.defineProperty(t.prototype,"isPlaying",{get:function(){for(var t=0,e=this._animationStates;t<e.length;t++){var a=e[t];if(a.isPlaying){return true}}return false},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"isCompleted",{get:function(){for(var t=0,e=this._animationStates;t<e.length;t++){var a=e[t];if(!a.isCompleted){return false}}return this._animationStates.length>0},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"lastAnimationName",{get:function(){return this._lastAnimationState!==null?this._lastAnimationState.name:""},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"animationNames",{get:function(){return this._animationNames},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"animations",{get:function(){return this._animations},set:function(t){if(this._animations===t){return}this._animationNames.length=0;for(var e in this._animations){delete this._animations[e]}for(var e in t){this._animationNames.push(e);this._animations[e]=t[e]}},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"animationConfig",{get:function(){this._animationConfig.clear();return this._animationConfig},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"lastAnimationState",{get:function(){return this._lastAnimationState},enumerable:true,configurable:true});return t}(g.BaseObject);g.Animation=t})(dragonBones||(dragonBones={}));var dragonBones;(function(G){var t=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._boneMask=[];t._boneTimelines=[];t._boneBlendTimelines=[];t._slotTimelines=[];t._slotBlendTimelines=[];t._constraintTimelines=[];t._animationTimelines=[];t._poseTimelines=[];t._actionTimeline=null;t._zOrderTimeline=null;return t}t.toString=function(){return"[class dragonBones.AnimationState]"};t.prototype._onClear=function(){for(var t=0,e=this._boneTimelines;t<e.length;t++){var a=e[t];a.returnToPool()}for(var r=0,i=this._boneBlendTimelines;r<i.length;r++){var a=i[r];a.returnToPool()}for(var n=0,s=this._slotTimelines;n<s.length;n++){var a=s[n];a.returnToPool()}for(var o=0,l=this._slotBlendTimelines;o<l.length;o++){var a=l[o];a.returnToPool()}for(var h=0,f=this._constraintTimelines;h<f.length;h++){var a=f[h];a.returnToPool()}for(var u=0,_=this._animationTimelines;u<_.length;u++){var a=_[u];var m=a.target;if(m._parent===this){m._fadeState=1;m._subFadeState=1;m._parent=null}a.returnToPool()}if(this._actionTimeline!==null){this._actionTimeline.returnToPool()}if(this._zOrderTimeline!==null){this._zOrderTimeline.returnToPool()}this.actionEnabled=false;this.additive=false;this.displayControl=false;this.resetToPose=false;this.blendType=0;this.playTimes=1;this.layer=0;this.timeScale=1;this._weight=1;this.parameterX=0;this.parameterY=0;this.positionX=0;this.positionY=0;this.autoFadeOutTime=0;this.fadeTotalTime=0;this.name="";this.group="";this._timelineDirty=2;this._playheadState=0;this._fadeState=-1;this._subFadeState=-1;this._position=0;this._duration=0;this._fadeTime=0;this._time=0;this._fadeProgress=0;this._weightResult=0;this._boneMask.length=0;this._boneTimelines.length=0;this._boneBlendTimelines.length=0;this._slotTimelines.length=0;this._slotBlendTimelines.length=0;this._constraintTimelines.length=0;this._animationTimelines.length=0;this._poseTimelines.length=0;this._animationData=null;this._armature=null;this._actionTimeline=null;this._zOrderTimeline=null;this._activeChildA=null;this._activeChildB=null;this._parent=null};t.prototype._updateTimelines=function(){{for(var t=0,e=this._armature._constraints;t<e.length;t++){var a=e[t];var r=this._animationData.getConstraintTimelines(a.name);if(r!==null){for(var i=0,n=r;i<n.length;i++){var s=n[i];switch(s.type){case 30:{var o=G.BaseObject.borrowObject(G.IKConstraintTimelineState);o.target=a;o.init(this._armature,this,s);this._constraintTimelines.push(o);break}default:break}}}else if(this.resetToPose){var o=G.BaseObject.borrowObject(G.IKConstraintTimelineState);o.target=a;o.init(this._armature,this,null);this._constraintTimelines.push(o);this._poseTimelines.push(o)}}}};t.prototype._updateBoneAndSlotTimelines=function(){{var t={};for(var e=0,a=this._boneTimelines;e<a.length;e++){var r=a[e];var i=r.target.target.name;if(!(i in t)){t[i]=[]}t[i].push(r)}for(var n=0,s=this._boneBlendTimelines;n<s.length;n++){var r=s[n];var i=r.target.target.name;if(!(i in t)){t[i]=[]}t[i].push(r)}for(var o=0,l=this._armature.getBones();o<l.length;o++){var h=l[o];var i=h.name;if(!this.containsBoneMask(i)){continue}if(i in t){delete t[i]}else{var f=this._animationData.getBoneTimelines(i);var u=this._armature.animation.getBlendState(H.BONE_TRANSFORM,h.name,h);if(f!==null){for(var _=0,m=f;_<m.length;_++){var p=m[_];switch(p.type){case 10:{var r=G.BaseObject.borrowObject(G.BoneAllTimelineState);r.target=u;r.init(this._armature,this,p);this._boneTimelines.push(r);break}case 11:{var r=G.BaseObject.borrowObject(G.BoneTranslateTimelineState);r.target=u;r.init(this._armature,this,p);this._boneTimelines.push(r);break}case 12:{var r=G.BaseObject.borrowObject(G.BoneRotateTimelineState);r.target=u;r.init(this._armature,this,p);this._boneTimelines.push(r);break}case 13:{var r=G.BaseObject.borrowObject(G.BoneScaleTimelineState);r.target=u;r.init(this._armature,this,p);this._boneTimelines.push(r);break}case 60:{var r=G.BaseObject.borrowObject(G.AlphaTimelineState);r.target=this._armature.animation.getBlendState(H.BONE_ALPHA,h.name,h);r.init(this._armature,this,p);this._boneBlendTimelines.push(r);break}case 50:{var r=G.BaseObject.borrowObject(G.SurfaceTimelineState);r.target=this._armature.animation.getBlendState(H.SURFACE,h.name,h);r.init(this._armature,this,p);this._boneBlendTimelines.push(r);break}default:break}}}else if(this.resetToPose){if(h._boneData.type===0){var r=G.BaseObject.borrowObject(G.BoneAllTimelineState);r.target=u;r.init(this._armature,this,null);this._boneTimelines.push(r);this._poseTimelines.push(r)}else{var r=G.BaseObject.borrowObject(G.SurfaceTimelineState);r.target=this._armature.animation.getBlendState(H.SURFACE,h.name,h);r.init(this._armature,this,null);this._boneBlendTimelines.push(r);this._poseTimelines.push(r)}}}}for(var c in t){for(var d=0,y=t[c];d<y.length;d++){var r=y[d];var v=this._boneTimelines.indexOf(r);if(v>=0){this._boneTimelines.splice(v,1);r.returnToPool()}v=this._boneBlendTimelines.indexOf(r);if(v>=0){this._boneBlendTimelines.splice(v,1);r.returnToPool()}}}}{var g={};var D=[];for(var b=0,T=this._slotTimelines;b<T.length;b++){var r=T[b];var i=r.target.name;if(!(i in g)){g[i]=[]}g[i].push(r)}for(var A=0,P=this._slotBlendTimelines;A<P.length;A++){var r=P[A];var i=r.target.target.name;if(!(i in g)){g[i]=[]}g[i].push(r)}for(var O=0,S=this._armature.getSlots();O<S.length;O++){var x=S[O];var B=x.parent.name;if(!this.containsBoneMask(B)){continue}var i=x.name;if(i in g){delete g[i]}else{var E=false;var M=false;D.length=0;var f=this._animationData.getSlotTimelines(i);if(f!==null){for(var I=0,F=f;I<F.length;I++){var p=F[I];switch(p.type){case 20:{var r=G.BaseObject.borrowObject(G.SlotDisplayTimelineState);r.target=x;r.init(this._armature,this,p);this._slotTimelines.push(r);E=true;break}case 23:{var r=G.BaseObject.borrowObject(G.SlotZIndexTimelineState);r.target=this._armature.animation.getBlendState(H.SLOT_Z_INDEX,x.name,x);r.init(this._armature,this,p);this._slotBlendTimelines.push(r);break}case 21:{var r=G.BaseObject.borrowObject(G.SlotColorTimelineState);r.target=x;r.init(this._armature,this,p);this._slotTimelines.push(r);M=true;break}case 22:{var w=this._animationData.parent.parent;var C=w.timelineArray;var N=this._animationData.frameIntOffset+C[p.offset+3];var R=w.frameIntArray;var j=R[N+0];if(j<0){j+=65536}for(var k=0,L=x.displayFrameCount;k<L;++k){var V=x.getDisplayFrameAt(k);var Y=V.getGeometryData();if(Y===null){continue}if(Y.offset===j){var r=G.BaseObject.borrowObject(G.DeformTimelineState);r.target=this._armature.animation.getBlendState(H.SLOT_DEFORM,V.rawDisplayData.name,x);r.displayFrame=V;r.init(this._armature,this,p);this._slotBlendTimelines.push(r);V.updateDeformVertices();D.push(j);break}}break}case 24:{var r=G.BaseObject.borrowObject(G.AlphaTimelineState);r.target=this._armature.animation.getBlendState(H.SLOT_ALPHA,x.name,x);r.init(this._armature,this,p);this._slotBlendTimelines.push(r);break}default:break}}}if(this.resetToPose){if(!E){var r=G.BaseObject.borrowObject(G.SlotDisplayTimelineState);r.target=x;r.init(this._armature,this,null);this._slotTimelines.push(r);this._poseTimelines.push(r)}if(!M){var r=G.BaseObject.borrowObject(G.SlotColorTimelineState);r.target=x;r.init(this._armature,this,null);this._slotTimelines.push(r);this._poseTimelines.push(r)}for(var k=0,L=x.displayFrameCount;k<L;++k){var V=x.getDisplayFrameAt(k);if(V.deformVertices.length===0){continue}var Y=V.getGeometryData();if(Y!==null&&D.indexOf(Y.offset)<0){var r=G.BaseObject.borrowObject(G.DeformTimelineState);r.displayFrame=V;r.target=this._armature.animation.getBlendState(H.SLOT_DEFORM,x.name,x);r.init(this._armature,this,null);this._slotBlendTimelines.push(r);this._poseTimelines.push(r)}}}}}for(var c in g){for(var U=0,X=g[c];U<X.length;U++){var r=X[U];var v=this._slotTimelines.indexOf(r);if(v>=0){this._slotTimelines.splice(v,1);r.returnToPool()}v=this._slotBlendTimelines.indexOf(r);if(v>=0){this._slotBlendTimelines.splice(v,1);r.returnToPool()}}}}};t.prototype._advanceFadeTime=function(t){var e=this._fadeState>0;if(this._subFadeState<0){this._subFadeState=0;var a=this._parent===null&&this.actionEnabled;if(a){var r=e?G.EventObject.FADE_OUT:G.EventObject.FADE_IN;if(this._armature.eventDispatcher.hasDBEventListener(r)){var i=G.BaseObject.borrowObject(G.EventObject);i.type=r;i.armature=this._armature;i.animationState=this;this._armature._dragonBones.bufferEvent(i)}}}if(t<0){t=-t}this._fadeTime+=t;if(this._fadeTime>=this.fadeTotalTime){this._subFadeState=1;this._fadeProgress=e?0:1}else if(this._fadeTime>0){this._fadeProgress=e?1-this._fadeTime/this.fadeTotalTime:this._fadeTime/this.fadeTotalTime}else{this._fadeProgress=e?1:0}if(this._subFadeState>0){if(!e){this._playheadState|=1;this._fadeState=0}var a=this._parent===null&&this.actionEnabled;if(a){var r=e?G.EventObject.FADE_OUT_COMPLETE:G.EventObject.FADE_IN_COMPLETE;if(this._armature.eventDispatcher.hasDBEventListener(r)){var i=G.BaseObject.borrowObject(G.EventObject);i.type=r;i.armature=this._armature;i.animationState=this;this._armature._dragonBones.bufferEvent(i)}}}};t.prototype.init=function(t,e,a){if(this._armature!==null){return}this._armature=t;this._animationData=e;this.resetToPose=a.resetToPose;this.additive=a.additive;this.displayControl=a.displayControl;this.actionEnabled=a.actionEnabled;this.blendType=e.blendType;this.layer=a.layer;this.playTimes=a.playTimes;this.timeScale=a.timeScale;this.fadeTotalTime=a.fadeInTime;this.autoFadeOutTime=a.autoFadeOutTime;this.name=a.name.length>0?a.name:a.animation;this.group=a.group;this._weight=a.weight;if(a.pauseFadeIn){this._playheadState=2}else{this._playheadState=3}if(a.duration<0){this._position=0;this._duration=this._animationData.duration;if(a.position!==0){if(this.timeScale>=0){this._time=a.position}else{this._time=a.position-this._duration}}else{this._time=0}}else{this._position=a.position;this._duration=a.duration;this._time=0}if(this.timeScale<0&&this._time===0){this._time=-1e-6}if(this.fadeTotalTime<=0){this._fadeProgress=.999999}if(a.boneMask.length>0){this._boneMask.length=a.boneMask.length;for(var r=0,i=this._boneMask.length;r<i;++r){this._boneMask[r]=a.boneMask[r]}}this._actionTimeline=G.BaseObject.borrowObject(G.ActionTimelineState);this._actionTimeline.init(this._armature,this,this._animationData.actionTimeline);this._actionTimeline.currentTime=this._time;if(this._actionTimeline.currentTime<0){this._actionTimeline.currentTime=this._duration-this._actionTimeline.currentTime}if(this._animationData.zOrderTimeline!==null){this._zOrderTimeline=G.BaseObject.borrowObject(G.ZOrderTimelineState);this._zOrderTimeline.init(this._armature,this,this._animationData.zOrderTimeline)}};t.prototype.advanceTime=function(t,e){if(this._fadeState!==0||this._subFadeState!==0){this._advanceFadeTime(t)}if(this._playheadState===3){if(this.timeScale!==1){t*=this.timeScale}this._time+=t}if(this._timelineDirty!==0){if(this._timelineDirty===2){this._updateTimelines()}this._timelineDirty=0;this._updateBoneAndSlotTimelines()}var a=this._fadeState!==0||this._subFadeState===0;var r=this._fadeState===0&&e>0;var i=true;var n=true;var s=this._time;this._weightResult=this._weight*this._fadeProgress;if(this._parent!==null){this._weightResult*=this._parent._weightResult}if(this._actionTimeline.playState<=0){this._actionTimeline.update(s)}if(this._weight===0){return}if(r){var o=e*2;this._actionTimeline.currentTime=Math.floor(this._actionTimeline.currentTime*o)/o}if(this._zOrderTimeline!==null&&this._zOrderTimeline.playState<=0){this._zOrderTimeline.update(s)}if(r){var l=Math.floor(this._actionTimeline.currentTime*e);if(this._armature._cacheFrameIndex===l){i=false;n=false}else{this._armature._cacheFrameIndex=l;if(this._animationData.cachedFrames[l]){n=false}else{this._animationData.cachedFrames[l]=true}}}if(i){var h=false;var f=null;if(n){for(var u=0,_=this._boneTimelines.length;u<_;++u){var m=this._boneTimelines[u];if(m.playState<=0){m.update(s)}if(m.target!==f){var p=m.target;h=p.update(this);f=p;if(p.dirty===1){var c=p.target.animationPose;c.x=0;c.y=0;c.rotation=0;c.skew=0;c.scaleX=1;c.scaleY=1}}if(h){m.blend(a)}}}for(var u=0,_=this._boneBlendTimelines.length;u<_;++u){var m=this._boneBlendTimelines[u];if(m.playState<=0){m.update(s)}if(m.target.update(this)){m.blend(a)}}if(this.displayControl){for(var u=0,_=this._slotTimelines.length;u<_;++u){var m=this._slotTimelines[u];if(m.playState<=0){var d=m.target;var y=d.displayController;if(y===null||y===this.name||y===this.group){m.update(s)}}}}for(var u=0,_=this._slotBlendTimelines.length;u<_;++u){var m=this._slotBlendTimelines[u];if(m.playState<=0){var p=m.target;m.update(s);if(p.update(this)){m.blend(a)}}}for(var u=0,_=this._constraintTimelines.length;u<_;++u){var m=this._constraintTimelines[u];if(m.playState<=0){m.update(s)}}if(this._animationTimelines.length>0){var v=100;var g=100;var D=null;var b=null;for(var u=0,_=this._animationTimelines.length;u<_;++u){var m=this._animationTimelines[u];if(m.playState<=0){m.update(s)}if(this.blendType===1){var T=m.target;var A=this.parameterX-T.positionX;if(A>=0){if(A<v){v=A;D=T}}else{if(-A<g){g=-A;b=T}}}}if(D!==null){if(this._activeChildA!==D){if(this._activeChildA!==null){this._activeChildA.weight=0}this._activeChildA=D;this._activeChildA.activeTimeline()}if(this._activeChildB!==b){if(this._activeChildB!==null){this._activeChildB.weight=0}this._activeChildB=b}D.weight=g/(v+g);if(b){b.weight=1-D.weight}}}}if(this._fadeState===0){if(this._subFadeState>0){this._subFadeState=0;if(this._poseTimelines.length>0){for(var P=0,O=this._poseTimelines;P<O.length;P++){var m=O[P];var S=this._boneTimelines.indexOf(m);if(S>=0){this._boneTimelines.splice(S,1);m.returnToPool();continue}S=this._boneBlendTimelines.indexOf(m);if(S>=0){this._boneBlendTimelines.splice(S,1);m.returnToPool();continue}S=this._slotTimelines.indexOf(m);if(S>=0){this._slotTimelines.splice(S,1);m.returnToPool();continue}S=this._slotBlendTimelines.indexOf(m);if(S>=0){this._slotBlendTimelines.splice(S,1);m.returnToPool();continue}S=this._constraintTimelines.indexOf(m);if(S>=0){this._constraintTimelines.splice(S,1);m.returnToPool();continue}}this._poseTimelines.length=0}}if(this._actionTimeline.playState>0){if(this.autoFadeOutTime>=0){this.fadeOut(this.autoFadeOutTime)}}}};t.prototype.play=function(){this._playheadState=3};t.prototype.stop=function(){this._playheadState&=1};t.prototype.fadeOut=function(t,e){if(e===void 0){e=true}if(t<0){t=0}if(e){this._playheadState&=2}if(this._fadeState>0){if(t>this.fadeTotalTime-this._fadeTime){return}}else{this._fadeState=1;this._subFadeState=-1;if(t<=0||this._fadeProgress<=0){this._fadeProgress=1e-6}for(var a=0,r=this._boneTimelines;a<r.length;a++){var i=r[a];i.fadeOut()}for(var n=0,s=this._boneBlendTimelines;n<s.length;n++){var i=s[n];i.fadeOut()}for(var o=0,l=this._slotTimelines;o<l.length;o++){var i=l[o];i.fadeOut()}for(var h=0,f=this._slotBlendTimelines;h<f.length;h++){var i=f[h];i.fadeOut()}for(var u=0,_=this._constraintTimelines;u<_.length;u++){var i=_[u];i.fadeOut()}for(var m=0,p=this._animationTimelines;m<p.length;m++){var i=p[m];i.fadeOut();var c=i.target;c.fadeOut(999999,true)}}this.displayControl=false;this.fadeTotalTime=this._fadeProgress>1e-6?t/this._fadeProgress:0;this._fadeTime=this.fadeTotalTime*(1-this._fadeProgress)};t.prototype.containsBoneMask=function(t){return this._boneMask.length===0||this._boneMask.indexOf(t)>=0};t.prototype.addBoneMask=function(t,e){if(e===void 0){e=true}var a=this._armature.getBone(t);if(a===null){return}if(this._boneMask.indexOf(t)<0){this._boneMask.push(t)}if(e){for(var r=0,i=this._armature.getBones();r<i.length;r++){var n=i[r];if(this._boneMask.indexOf(n.name)<0&&a.contains(n)){this._boneMask.push(n.name)}}}this._timelineDirty=1};t.prototype.removeBoneMask=function(t,e){if(e===void 0){e=true}var a=this._boneMask.indexOf(t);if(a>=0){this._boneMask.splice(a,1)}if(e){var r=this._armature.getBone(t);if(r!==null){var i=this._armature.getBones();if(this._boneMask.length>0){for(var n=0,s=i;n<s.length;n++){var o=s[n];var l=this._boneMask.indexOf(o.name);if(l>=0&&r.contains(o)){this._boneMask.splice(l,1)}}}else{for(var h=0,f=i;h<f.length;h++){var o=f[h];if(o===r){continue}if(!r.contains(o)){this._boneMask.push(o.name)}}}}}this._timelineDirty=1};t.prototype.removeAllBoneMask=function(){this._boneMask.length=0;this._timelineDirty=1};t.prototype.addState=function(t,e){if(e===void 0){e=null}if(e!==null){for(var a=0,r=e;a<r.length;a++){var i=r[a];switch(i.type){case 40:{var n=G.BaseObject.borrowObject(G.AnimationProgressTimelineState);n.target=t;n.init(this._armature,this,i);this._animationTimelines.push(n);if(this.blendType!==0){var s=i;t.positionX=s.x;t.positionY=s.y;t.weight=0}t._parent=this;this.resetToPose=false;break}case 41:{var n=G.BaseObject.borrowObject(G.AnimationWeightTimelineState);n.target=t;n.init(this._armature,this,i);this._animationTimelines.push(n);break}case 42:{var n=G.BaseObject.borrowObject(G.AnimationParametersTimelineState);n.target=t;n.init(this._armature,this,i);this._animationTimelines.push(n);break}default:break}}}if(t._parent===null){t._parent=this}};t.prototype.activeTimeline=function(){for(var t=0,e=this._slotTimelines;t<e.length;t++){var a=e[t];a.dirty=true;a.currentTime=-1}};Object.defineProperty(t.prototype,"isFadeIn",{get:function(){return this._fadeState<0},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"isFadeOut",{get:function(){return this._fadeState>0},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"isFadeComplete",{get:function(){return this._fadeState===0},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"isPlaying",{get:function(){return(this._playheadState&2)!==0&&this._actionTimeline.playState<=0},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"isCompleted",{get:function(){return this._actionTimeline.playState>0},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"currentPlayTimes",{get:function(){return this._actionTimeline.currentPlayTimes},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"totalTime",{get:function(){return this._duration},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"currentTime",{get:function(){return this._actionTimeline.currentTime},set:function(t){var e=this._actionTimeline.currentPlayTimes-(this._actionTimeline.playState>0?1:0);if(t<0||this._duration<t){t=t%this._duration+e*this._duration;if(t<0){t+=this._duration}}if(this.playTimes>0&&e===this.playTimes-1&&t===this._duration&&this._parent===null){t=this._duration-1e-6}if(this._time===t){return}this._time=t;this._actionTimeline.setCurrentTime(this._time);if(this._zOrderTimeline!==null){this._zOrderTimeline.playState=-1}for(var a=0,r=this._boneTimelines;a<r.length;a++){var i=r[a];i.playState=-1}for(var n=0,s=this._slotTimelines;n<s.length;n++){var i=s[n];i.playState=-1}},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"weight",{get:function(){return this._weight},set:function(t){if(this._weight===t){return}this._weight=t;for(var e=0,a=this._boneTimelines;e<a.length;e++){var r=a[e];r.dirty=true}for(var i=0,n=this._boneBlendTimelines;i<n.length;i++){var r=n[i];r.dirty=true}for(var s=0,o=this._slotBlendTimelines;s<o.length;s++){var r=o[s];r.dirty=true}},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"animationData",{get:function(){return this._animationData},enumerable:true,configurable:true});return t}(G.BaseObject);G.AnimationState=t;var H=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.BlendState]"};e.prototype._onClear=function(){this.reset();this.target=null};e.prototype.update=function(t){var e=t.layer;var a=t._weightResult;if(this.dirty>0){if(this.leftWeight>0){if(this.layer!==e){if(this.layerWeight>=this.leftWeight){this.dirty++;this.layer=e;this.leftWeight=0;this.blendWeight=0;return false}this.layer=e;this.leftWeight-=this.layerWeight;this.layerWeight=0}a*=this.leftWeight;this.dirty++;this.blendWeight=a;this.layerWeight+=this.blendWeight;return true}return false}this.dirty++;this.layer=e;this.leftWeight=1;this.blendWeight=a;this.layerWeight=a;return true};e.prototype.reset=function(){this.dirty=0;this.layer=0;this.leftWeight=0;this.layerWeight=0;this.blendWeight=0};e.BONE_TRANSFORM="boneTransform";e.BONE_ALPHA="boneAlpha";e.SURFACE="surface";e.SLOT_DEFORM="slotDeform";e.SLOT_ALPHA="slotAlpha";e.SLOT_Z_INDEX="slotZIndex";return e}(G.BaseObject);G.BlendState=H})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.prototype._onClear=function(){this.dirty=false;this.playState=-1;this.currentPlayTimes=0;this.currentTime=-1;this.target=null;this._isTween=false;this._valueOffset=0;this._frameValueOffset=0;this._frameOffset=0;this._frameRate=0;this._frameCount=0;this._frameIndex=-1;this._frameRateR=0;this._position=0;this._duration=0;this._timeScale=1;this._timeOffset=0;this._animationData=null;this._timelineData=null;this._armature=null;this._animationState=null;this._actionTimeline=null;this._frameArray=null;this._valueArray=null;this._timelineArray=null;this._frameIndices=null};e.prototype._setCurrentTime=function(t){var e=this.playState;var a=this.currentPlayTimes;var r=this.currentTime;if(this._actionTimeline!==null&&this._frameCount<=1){this.playState=this._actionTimeline.playState>=0?1:-1;this.currentPlayTimes=1;this.currentTime=this._actionTimeline.currentTime}else if(this._actionTimeline===null||this._timeScale!==1||this._timeOffset!==0){var i=this._animationState.playTimes;var n=i*this._duration;t*=this._timeScale;if(this._timeOffset!==0){t+=this._timeOffset*this._animationData.duration}if(i>0&&(t>=n||t<=-n)){if(this.playState<=0&&this._animationState._playheadState===3){this.playState=1}this.currentPlayTimes=i;if(t<0){this.currentTime=0}else{this.currentTime=this.playState===1?this._duration+1e-6:this._duration}}else{if(this.playState!==0&&this._animationState._playheadState===3){this.playState=0}if(t<0){t=-t;this.currentPlayTimes=Math.floor(t/this._duration);this.currentTime=this._duration-t%this._duration}else{this.currentPlayTimes=Math.floor(t/this._duration);this.currentTime=t%this._duration}}this.currentTime+=this._position}else{this.playState=this._actionTimeline.playState;this.currentPlayTimes=this._actionTimeline.currentPlayTimes;this.currentTime=this._actionTimeline.currentTime}if(this.currentPlayTimes===a&&this.currentTime===r){return false}if(e<0&&this.playState!==e||this.playState<=0&&this.currentPlayTimes!==a){this._frameIndex=-1}return true};e.prototype.init=function(t,e,a){this._armature=t;this._animationState=e;this._timelineData=a;this._actionTimeline=this._animationState._actionTimeline;if(this===this._actionTimeline){this._actionTimeline=null}this._animationData=this._animationState.animationData;this._frameRate=this._animationData.parent.frameRate;this._frameRateR=1/this._frameRate;this._position=this._animationState._position;this._duration=this._animationState._duration;if(this._timelineData!==null){var r=this._animationData.parent.parent;this._frameArray=r.frameArray;this._timelineArray=r.timelineArray;this._frameIndices=r.frameIndices;this._frameCount=this._timelineArray[this._timelineData.offset+2];this._frameValueOffset=this._timelineArray[this._timelineData.offset+4];this._timeScale=100/this._timelineArray[this._timelineData.offset+0];this._timeOffset=this._timelineArray[this._timelineData.offset+1]*.01}};e.prototype.fadeOut=function(){this.dirty=false};e.prototype.update=function(t){if(this._setCurrentTime(t)){if(this._frameCount>1){var e=Math.floor(this.currentTime*this._frameRate);var a=this._frameIndices[this._timelineData.frameIndicesOffset+e];if(this._frameIndex!==a){this._frameIndex=a;this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex];this._onArriveAtFrame()}}else if(this._frameIndex<0){this._frameIndex=0;if(this._timelineData!==null){this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5]}this._onArriveAtFrame()}if(this._isTween||this.dirty){this._onUpdateFrame()}}};e.prototype.blend=function(t){};return e}(t.BaseObject);t.TimelineState=e;var a=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e._getEasingValue=function(t,e,a){var r=e;switch(t){case 3:r=Math.pow(e,2);break;case 4:r=1-Math.pow(1-e,2);break;case 5:r=.5*(1-Math.cos(e*Math.PI));break}return(r-e)*a+e};e._getEasingCurveValue=function(t,e,a,r){if(t<=0){return 0}else if(t>=1){return 1}var i=a>0;var n=a+1;var s=Math.floor(t*n);var o=0;var l=0;if(i){o=s===0?0:e[r+s-1];l=s===n-1?1e4:e[r+s]}else{o=e[r+s-1];l=e[r+s]}return(o+(l-o)*(t*n-s))*1e-4};e.prototype._onClear=function(){t.prototype._onClear.call(this);this._tweenType=0;this._curveCount=0;this._framePosition=0;this._frameDurationR=0;this._tweenEasing=0;this._tweenProgress=0;this._valueScale=1};e.prototype._onArriveAtFrame=function(){if(this._frameCount>1&&(this._frameIndex!==this._frameCount-1||this._animationState.playTimes===0||this._animationState.currentPlayTimes<this._animationState.playTimes-1)){this._tweenType=this._frameArray[this._frameOffset+1];this._isTween=this._tweenType!==0;if(this._isTween){if(this._tweenType===2){this._curveCount=this._frameArray[this._frameOffset+2]}else if(this._tweenType!==0&&this._tweenType!==1){this._tweenEasing=this._frameArray[this._frameOffset+2]*.01}}else{this.dirty=true}this._framePosition=this._frameArray[this._frameOffset]*this._frameRateR;if(this._frameIndex===this._frameCount-1){this._frameDurationR=1/(this._animationData.duration-this._framePosition)}else{var t=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex+1];var e=this._frameArray[t]*this._frameRateR-this._framePosition;if(e>0){this._frameDurationR=1/e}else{this._frameDurationR=0}}}else{this.dirty=true;this._isTween=false}};e.prototype._onUpdateFrame=function(){if(this._isTween){this.dirty=true;this._tweenProgress=(this.currentTime-this._framePosition)*this._frameDurationR;if(this._tweenType===2){this._tweenProgress=e._getEasingCurveValue(this._tweenProgress,this._frameArray,this._curveCount,this._frameOffset+3)}else if(this._tweenType!==1){this._tweenProgress=e._getEasingValue(this._tweenType,this._tweenProgress,this._tweenEasing)}}};return e}(e);t.TweenTimelineState=a;var r=function(i){__extends(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}t.prototype._onClear=function(){i.prototype._onClear.call(this);this._current=0;this._difference=0;this._result=0};t.prototype._onArriveAtFrame=function(){i.prototype._onArriveAtFrame.call(this);if(this._timelineData!==null){var t=this._valueScale;var e=this._valueArray;var a=this._valueOffset+this._frameValueOffset+this._frameIndex;if(this._isTween){var r=this._frameIndex===this._frameCount-1?this._valueOffset+this._frameValueOffset:a+1;if(t===1){this._current=e[a];this._difference=e[r]-this._current}else{this._current=e[a]*t;this._difference=e[r]*t-this._current}}else{this._result=e[a]*t}}else{this._result=0}};t.prototype._onUpdateFrame=function(){i.prototype._onUpdateFrame.call(this);if(this._isTween){this._result=this._current+this._difference*this._tweenProgress}};return t}(a);t.SingleValueTimelineState=r;var i=function(i){__extends(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}t.prototype._onClear=function(){i.prototype._onClear.call(this);this._currentA=0;this._currentB=0;this._differenceA=0;this._differenceB=0;this._resultA=0;this._resultB=0};t.prototype._onArriveAtFrame=function(){i.prototype._onArriveAtFrame.call(this);if(this._timelineData!==null){var t=this._valueScale;var e=this._valueArray;var a=this._valueOffset+this._frameValueOffset+this._frameIndex*2;if(this._isTween){var r=this._frameIndex===this._frameCount-1?this._valueOffset+this._frameValueOffset:a+2;if(t===1){this._currentA=e[a];this._currentB=e[a+1];this._differenceA=e[r]-this._currentA;this._differenceB=e[r+1]-this._currentB}else{this._currentA=e[a]*t;this._currentB=e[a+1]*t;this._differenceA=e[r]*t-this._currentA;this._differenceB=e[r+1]*t-this._currentB}}else{this._resultA=e[a]*t;this._resultB=e[a+1]*t}}else{this._resultA=0;this._resultB=0}};t.prototype._onUpdateFrame=function(){i.prototype._onUpdateFrame.call(this);if(this._isTween){this._resultA=this._currentA+this._differenceA*this._tweenProgress;this._resultB=this._currentB+this._differenceB*this._tweenProgress}};return t}(a);t.DoubleValueTimelineState=i;var n=function(o){__extends(t,o);function t(){var t=o!==null&&o.apply(this,arguments)||this;t._rd=[];return t}t.prototype._onClear=function(){o.prototype._onClear.call(this);this._valueCount=0;this._rd.length=0};t.prototype._onArriveAtFrame=function(){o.prototype._onArriveAtFrame.call(this);var t=this._valueCount;var e=this._rd;if(this._timelineData!==null){var a=this._valueScale;var r=this._valueArray;var i=this._valueOffset+this._frameValueOffset+this._frameIndex*t;if(this._isTween){var n=this._frameIndex===this._frameCount-1?this._valueOffset+this._frameValueOffset:i+t;if(a===1){for(var s=0;s<t;++s){e[t+s]=r[n+s]-r[i+s]}}else{for(var s=0;s<t;++s){e[t+s]=(r[n+s]-r[i+s])*a}}}else if(a===1){for(var s=0;s<t;++s){e[s]=r[i+s]}}else{for(var s=0;s<t;++s){e[s]=r[i+s]*a}}}else{for(var s=0;s<t;++s){e[s]=0}}};t.prototype._onUpdateFrame=function(){o.prototype._onUpdateFrame.call(this);if(this._isTween){var t=this._valueCount;var e=this._valueScale;var a=this._tweenProgress;var r=this._valueArray;var i=this._rd;var n=this._valueOffset+this._frameValueOffset+this._frameIndex*t;if(e===1){for(var s=0;s<t;++s){i[s]=r[n+s]+i[t+s]*a}}else{for(var s=0;s<t;++s){i[s]=r[n+s]*e+i[t+s]*a}}}};return t}(a);t.MutilpleValueTimelineState=n})(dragonBones||(dragonBones={}));var dragonBones;(function(y){var t=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.ActionTimelineState]"};e.prototype._onCrossFrame=function(t){var e=this._armature.eventDispatcher;if(this._animationState.actionEnabled){var a=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+t];var r=this._frameArray[a+1];var i=this._animationData.parent.actions;for(var n=0;n<r;++n){var s=this._frameArray[a+2+n];var o=i[s];if(o.type===0){var l=y.BaseObject.borrowObject(y.EventObject);l.time=this._frameArray[a]/this._frameRate;l.animationState=this._animationState;y.EventObject.actionDataToInstance(o,l,this._armature);this._armature._bufferAction(l,true)}else{var h=o.type===10?y.EventObject.FRAME_EVENT:y.EventObject.SOUND_EVENT;if(o.type===11||e.hasDBEventListener(h)){var l=y.BaseObject.borrowObject(y.EventObject);l.time=this._frameArray[a]/this._frameRate;l.animationState=this._animationState;y.EventObject.actionDataToInstance(o,l,this._armature);this._armature._dragonBones.bufferEvent(l)}}}}};e.prototype._onArriveAtFrame=function(){};e.prototype._onUpdateFrame=function(){};e.prototype.update=function(t){var e=this.playState;var a=this.currentPlayTimes;var r=this.currentTime;if(this._setCurrentTime(t)){var i=this._animationState._parent===null&&this._animationState.actionEnabled;var n=this._armature.eventDispatcher;if(e<0){if(this.playState!==e){if(this._animationState.displayControl&&this._animationState.resetToPose){this._armature._sortZOrder(null,0)}if(i&&n.hasDBEventListener(y.EventObject.START)){var s=y.BaseObject.borrowObject(y.EventObject);s.type=y.EventObject.START;s.armature=this._armature;s.animationState=this._animationState;this._armature._dragonBones.bufferEvent(s)}}else{return}}var o=this._animationState.timeScale<0;var l=null;var h=null;if(i&&this.currentPlayTimes!==a){if(n.hasDBEventListener(y.EventObject.LOOP_COMPLETE)){l=y.BaseObject.borrowObject(y.EventObject);l.type=y.EventObject.LOOP_COMPLETE;l.armature=this._armature;l.animationState=this._animationState}if(this.playState>0){if(n.hasDBEventListener(y.EventObject.COMPLETE)){h=y.BaseObject.borrowObject(y.EventObject);h.type=y.EventObject.COMPLETE;h.armature=this._armature;h.animationState=this._animationState}}}if(this._frameCount>1){var f=this._timelineData;var u=Math.floor(this.currentTime*this._frameRate);var _=this._frameIndices[f.frameIndicesOffset+u];if(this._frameIndex!==_){var m=this._frameIndex;this._frameIndex=_;if(this._timelineArray!==null){this._frameOffset=this._animationData.frameOffset+this._timelineArray[f.offset+5+this._frameIndex];if(o){if(m<0){var p=Math.floor(r*this._frameRate);m=this._frameIndices[f.frameIndicesOffset+p];if(this.currentPlayTimes===a){if(m===_){m=-1}}}while(m>=0){var c=this._animationData.frameOffset+this._timelineArray[f.offset+5+m];var d=this._frameArray[c]/this._frameRate;if(this._position<=d&&d<=this._position+this._duration){this._onCrossFrame(m)}if(l!==null&&m===0){this._armature._dragonBones.bufferEvent(l);l=null}if(m>0){m--}else{m=this._frameCount-1}if(m===_){break}}}else{if(m<0){var p=Math.floor(r*this._frameRate);m=this._frameIndices[f.frameIndicesOffset+p];var c=this._animationData.frameOffset+this._timelineArray[f.offset+5+m];var d=this._frameArray[c]/this._frameRate;if(this.currentPlayTimes===a){if(r<=d){if(m>0){m--}else{m=this._frameCount-1}}else if(m===_){m=-1}}}while(m>=0){if(m<this._frameCount-1){m++}else{m=0}var c=this._animationData.frameOffset+this._timelineArray[f.offset+5+m];var d=this._frameArray[c]/this._frameRate;if(this._position<=d&&d<=this._position+this._duration){this._onCrossFrame(m)}if(l!==null&&m===0){this._armature._dragonBones.bufferEvent(l);l=null}if(m===_){break}}}}}}else if(this._frameIndex<0){this._frameIndex=0;if(this._timelineData!==null){this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5];var d=this._frameArray[this._frameOffset]/this._frameRate;if(this.currentPlayTimes===a){if(r<=d){this._onCrossFrame(this._frameIndex)}}else if(this._position<=d){if(!o&&l!==null){this._armature._dragonBones.bufferEvent(l);l=null}this._onCrossFrame(this._frameIndex)}}}if(l!==null){this._armature._dragonBones.bufferEvent(l)}if(h!==null){this._armature._dragonBones.bufferEvent(h)}}};e.prototype.setCurrentTime=function(t){this._setCurrentTime(t);this._frameIndex=-1};return e}(y.TimelineState);y.ActionTimelineState=t;var e=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.ZOrderTimelineState]"};e.prototype._onArriveAtFrame=function(){if(this.playState>=0){var t=this._frameArray[this._frameOffset+1];if(t>0){this._armature._sortZOrder(this._frameArray,this._frameOffset+2)}else{this._armature._sortZOrder(null,0)}}};e.prototype._onUpdateFrame=function(){};return e}(y.TimelineState);y.ZOrderTimelineState=e;var a=function(r){__extends(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}t.toString=function(){return"[class dragonBones.BoneAllTimelineState]"};t.prototype._onArriveAtFrame=function(){r.prototype._onArriveAtFrame.call(this);if(this._isTween&&this._frameIndex===this._frameCount-1){this._rd[2]=y.Transform.normalizeRadian(this._rd[2]);this._rd[3]=y.Transform.normalizeRadian(this._rd[3])}if(this._timelineData===null){this._rd[4]=1;this._rd[5]=1}};t.prototype.init=function(t,e,a){r.prototype.init.call(this,t,e,a);this._valueOffset=this._animationData.frameFloatOffset;this._valueCount=6;this._valueArray=this._animationData.parent.parent.frameFloatArray};t.prototype.fadeOut=function(){this.dirty=false;this._rd[2]=y.Transform.normalizeRadian(this._rd[2]);this._rd[3]=y.Transform.normalizeRadian(this._rd[3])};t.prototype.blend=function(t){var e=this._armature.armatureData.scale;var a=this._rd;var r=this.target;var i=r.target;var n=r.blendWeight;var s=i.animationPose;if(r.dirty>1){s.x+=a[0]*n*e;s.y+=a[1]*n*e;s.rotation+=a[2]*n;s.skew+=a[3]*n;s.scaleX+=(a[4]-1)*n;s.scaleY+=(a[5]-1)*n}else{s.x=a[0]*n*e;s.y=a[1]*n*e;s.rotation=a[2]*n;s.skew=a[3]*n;s.scaleX=(a[4]-1)*n+1;s.scaleY=(a[5]-1)*n+1}if(t||this.dirty){this.dirty=false;i._transformDirty=true}};return t}(y.MutilpleValueTimelineState);y.BoneAllTimelineState=a;var r=function(r){__extends(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}t.toString=function(){return"[class dragonBones.BoneTranslateTimelineState]"};t.prototype.init=function(t,e,a){r.prototype.init.call(this,t,e,a);this._valueOffset=this._animationData.frameFloatOffset;this._valueScale=this._armature.armatureData.scale;this._valueArray=this._animationData.parent.parent.frameFloatArray};t.prototype.blend=function(t){var e=this.target;var a=e.target;var r=e.blendWeight;var i=a.animationPose;if(e.dirty>1){i.x+=this._resultA*r;i.y+=this._resultB*r}else if(r!==1){i.x=this._resultA*r;i.y=this._resultB*r}else{i.x=this._resultA;i.y=this._resultB}if(t||this.dirty){this.dirty=false;a._transformDirty=true}};return t}(y.DoubleValueTimelineState);y.BoneTranslateTimelineState=r;var i=function(r){__extends(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}t.toString=function(){return"[class dragonBones.BoneRotateTimelineState]"};t.prototype._onArriveAtFrame=function(){r.prototype._onArriveAtFrame.call(this);if(this._isTween&&this._frameIndex===this._frameCount-1){this._differenceA=y.Transform.normalizeRadian(this._differenceA);this._differenceB=y.Transform.normalizeRadian(this._differenceB)}};t.prototype.init=function(t,e,a){r.prototype.init.call(this,t,e,a);this._valueOffset=this._animationData.frameFloatOffset;this._valueArray=this._animationData.parent.parent.frameFloatArray};t.prototype.fadeOut=function(){this.dirty=false;this._resultA=y.Transform.normalizeRadian(this._resultA);this._resultB=y.Transform.normalizeRadian(this._resultB)};t.prototype.blend=function(t){var e=this.target;var a=e.target;var r=e.blendWeight;var i=a.animationPose;if(e.dirty>1){i.rotation+=this._resultA*r;i.skew+=this._resultB*r}else if(r!==1){i.rotation=this._resultA*r;i.skew=this._resultB*r}else{i.rotation=this._resultA;i.skew=this._resultB}if(t||this.dirty){this.dirty=false;a._transformDirty=true}};return t}(y.DoubleValueTimelineState);y.BoneRotateTimelineState=i;var n=function(r){__extends(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}t.toString=function(){return"[class dragonBones.BoneScaleTimelineState]"};t.prototype._onArriveAtFrame=function(){r.prototype._onArriveAtFrame.call(this);if(this._timelineData===null){this._resultA=1;this._resultB=1}};t.prototype.init=function(t,e,a){r.prototype.init.call(this,t,e,a);this._valueOffset=this._animationData.frameFloatOffset;this._valueArray=this._animationData.parent.parent.frameFloatArray};t.prototype.blend=function(t){var e=this.target;var a=e.target;var r=e.blendWeight;var i=a.animationPose;if(e.dirty>1){i.scaleX+=(this._resultA-1)*r;i.scaleY+=(this._resultB-1)*r}else if(r!==1){i.scaleX=(this._resultA-1)*r+1;i.scaleY=(this._resultB-1)*r+1}else{i.scaleX=this._resultA;i.scaleY=this._resultB}if(t||this.dirty){this.dirty=false;a._transformDirty=true}};return t}(y.DoubleValueTimelineState);y.BoneScaleTimelineState=n;var s=function(s){__extends(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}t.toString=function(){return"[class dragonBones.SurfaceTimelineState]"};t.prototype._onClear=function(){s.prototype._onClear.call(this);this._deformCount=0;this._deformOffset=0;this._sameValueOffset=0};t.prototype.init=function(t,e,a){s.prototype.init.call(this,t,e,a);if(this._timelineData!==null){var r=this._animationData.parent.parent;var i=r.frameIntArray;var n=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+3];this._valueOffset=this._animationData.frameFloatOffset;this._valueCount=i[n+2];this._deformCount=i[n+1];this._deformOffset=i[n+3];this._sameValueOffset=i[n+4]+this._animationData.frameFloatOffset;this._valueScale=this._armature.armatureData.scale;this._valueArray=r.frameFloatArray;this._rd.length=this._valueCount*2}else{this._deformCount=this.target.target._deformVertices.length}};t.prototype.blend=function(t){var e=this.target;var a=e.target;var r=e.blendWeight;var i=a._deformVertices;var n=this._valueArray;if(n!==null){var s=this._valueCount;var o=this._deformOffset;var l=this._sameValueOffset;var h=this._rd;for(var f=0;f<this._deformCount;++f){var u=0;if(f<o){u=n[l+f]}else if(f<o+s){u=h[f-o]}else{u=n[l+f-s]}if(e.dirty>1){i[f]+=u*r}else{i[f]=u*r}}}else if(e.dirty===1){for(var f=0;f<this._deformCount;++f){i[f]=0}}if(t||this.dirty){this.dirty=false;a._transformDirty=true}};return t}(y.MutilpleValueTimelineState);y.SurfaceTimelineState=s;var o=function(r){__extends(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}t.toString=function(){return"[class dragonBones.AlphaTimelineState]"};t.prototype._onArriveAtFrame=function(){r.prototype._onArriveAtFrame.call(this);if(this._timelineData===null){this._result=1}};t.prototype.init=function(t,e,a){r.prototype.init.call(this,t,e,a);this._valueOffset=this._animationData.frameIntOffset;this._valueScale=.01;this._valueArray=this._animationData.parent.parent.frameIntArray};t.prototype.blend=function(t){var e=this.target;var a=e.target;var r=e.blendWeight;if(e.dirty>1){a._alpha+=this._result*r;if(a._alpha>1){a._alpha=1}}else{a._alpha=this._result*r}if(t||this.dirty){this.dirty=false;this._armature._alphaDirty=true}};return t}(y.SingleValueTimelineState);y.AlphaTimelineState=o;var l=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}e.toString=function(){return"[class dragonBones.SlotDisplayTimelineState]"};e.prototype._onArriveAtFrame=function(){if(this.playState>=0){var t=this.target;var e=this._timelineData!==null?this._frameArray[this._frameOffset+1]:t._slotData.displayIndex;if(t.displayIndex!==e){t._setDisplayIndex(e,true)}}};e.prototype._onUpdateFrame=function(){};return e}(y.TimelineState);y.SlotDisplayTimelineState=l;var h=function(o){__extends(t,o);function t(){var t=o!==null&&o.apply(this,arguments)||this;t._current=[0,0,0,0,0,0,0,0];t._difference=[0,0,0,0,0,0,0,0];t._result=[0,0,0,0,0,0,0,0];return t}t.toString=function(){return"[class dragonBones.SlotColorTimelineState]"};t.prototype._onArriveAtFrame=function(){o.prototype._onArriveAtFrame.call(this);if(this._timelineData!==null){var t=this._animationData.parent.parent;var e=t.colorArray;var a=t.frameIntArray;var r=this._animationData.frameIntOffset+this._frameValueOffset+this._frameIndex;var i=a[r];if(i<0){i+=65536}if(this._isTween){this._current[0]=e[i++];this._current[1]=e[i++];this._current[2]=e[i++];this._current[3]=e[i++];this._current[4]=e[i++];this._current[5]=e[i++];this._current[6]=e[i++];this._current[7]=e[i++];if(this._frameIndex===this._frameCount-1){i=a[this._animationData.frameIntOffset+this._frameValueOffset]}else{i=a[r+1]}if(i<0){i+=65536}this._difference[0]=e[i++]-this._current[0];this._difference[1]=e[i++]-this._current[1];this._difference[2]=e[i++]-this._current[2];this._difference[3]=e[i++]-this._current[3];this._difference[4]=e[i++]-this._current[4];this._difference[5]=e[i++]-this._current[5];this._difference[6]=e[i++]-this._current[6];this._difference[7]=e[i++]-this._current[7]}else{this._result[0]=e[i++]*.01;this._result[1]=e[i++]*.01;this._result[2]=e[i++]*.01;this._result[3]=e[i++]*.01;this._result[4]=e[i++];this._result[5]=e[i++];this._result[6]=e[i++];this._result[7]=e[i++]}}else{var n=this.target;var s=n.slotData.color;this._result[0]=s.alphaMultiplier;this._result[1]=s.redMultiplier;this._result[2]=s.greenMultiplier;this._result[3]=s.blueMultiplier;this._result[4]=s.alphaOffset;this._result[5]=s.redOffset;this._result[6]=s.greenOffset;this._result[7]=s.blueOffset}};t.prototype._onUpdateFrame=function(){o.prototype._onUpdateFrame.call(this);if(this._isTween){this._result[0]=(this._current[0]+this._difference[0]*this._tweenProgress)*.01;this._result[1]=(this._current[1]+this._difference[1]*this._tweenProgress)*.01;this._result[2]=(this._current[2]+this._difference[2]*this._tweenProgress)*.01;this._result[3]=(this._current[3]+this._difference[3]*this._tweenProgress)*.01;this._result[4]=this._current[4]+this._difference[4]*this._tweenProgress;this._result[5]=this._current[5]+this._difference[5]*this._tweenProgress;this._result[6]=this._current[6]+this._difference[6]*this._tweenProgress;this._result[7]=this._current[7]+this._difference[7]*this._tweenProgress}};t.prototype.fadeOut=function(){this._isTween=false};t.prototype.update=function(t){o.prototype.update.call(this,t);if(this._isTween||this.dirty){var e=this.target;var a=e._colorTransform;if(this._animationState._fadeState!==0||this._animationState._subFadeState!==0){if(a.alphaMultiplier!==this._result[0]||a.redMultiplier!==this._result[1]||a.greenMultiplier!==this._result[2]||a.blueMultiplier!==this._result[3]||a.alphaOffset!==this._result[4]||a.redOffset!==this._result[5]||a.greenOffset!==this._result[6]||a.blueOffset!==this._result[7]){var r=Math.pow(this._animationState._fadeProgress,4);a.alphaMultiplier+=(this._result[0]-a.alphaMultiplier)*r;a.redMultiplier+=(this._result[1]-a.redMultiplier)*r;a.greenMultiplier+=(this._result[2]-a.greenMultiplier)*r;a.blueMultiplier+=(this._result[3]-a.blueMultiplier)*r;a.alphaOffset+=(this._result[4]-a.alphaOffset)*r;a.redOffset+=(this._result[5]-a.redOffset)*r;a.greenOffset+=(this._result[6]-a.greenOffset)*r;a.blueOffset+=(this._result[7]-a.blueOffset)*r;e._colorDirty=true}}else if(this.dirty){this.dirty=false;if(a.alphaMultiplier!==this._result[0]||a.redMultiplier!==this._result[1]||a.greenMultiplier!==this._result[2]||a.blueMultiplier!==this._result[3]||a.alphaOffset!==this._result[4]||a.redOffset!==this._result[5]||a.greenOffset!==this._result[6]||a.blueOffset!==this._result[7]){a.alphaMultiplier=this._result[0];a.redMultiplier=this._result[1];a.greenMultiplier=this._result[2];a.blueMultiplier=this._result[3];a.alphaOffset=this._result[4];a.redOffset=this._result[5];a.greenOffset=this._result[6];a.blueOffset=this._result[7];e._colorDirty=true}}}};return t}(y.TweenTimelineState);y.SlotColorTimelineState=h;var f=function(r){__extends(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}t.toString=function(){return"[class dragonBones.SlotZIndexTimelineState]"};t.prototype._onArriveAtFrame=function(){r.prototype._onArriveAtFrame.call(this);if(this._timelineData===null){var t=this.target;var e=t.target;this._result=e.slotData.zIndex}};t.prototype.init=function(t,e,a){r.prototype.init.call(this,t,e,a);this._valueOffset=this._animationData.frameIntOffset;this._valueArray=this._animationData.parent.parent.frameIntArray};t.prototype.blend=function(t){var e=this.target;var a=e.target;var r=e.blendWeight;if(e.dirty>1){a._zIndex+=this._result*r}else{a._zIndex=this._result*r}if(t||this.dirty){this.dirty=false;this._armature._zIndexDirty=true}};return t}(y.SingleValueTimelineState);y.SlotZIndexTimelineState=f;var u=function(s){__extends(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}t.toString=function(){return"[class dragonBones.DeformTimelineState]"};t.prototype._onClear=function(){s.prototype._onClear.call(this);this.displayFrame=null;this._deformCount=0;this._deformOffset=0;this._sameValueOffset=0};t.prototype.init=function(t,e,a){s.prototype.init.call(this,t,e,a);if(this._timelineData!==null){var r=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+3];var i=this._animationData.parent.parent;var n=i.frameIntArray;this._valueOffset=this._animationData.frameFloatOffset;this._valueCount=n[r+2];this._deformCount=n[r+1];this._deformOffset=n[r+3];this._sameValueOffset=n[r+4];if(this._sameValueOffset<0){this._sameValueOffset+=65536}this._sameValueOffset+=this._animationData.frameFloatOffset;this._valueScale=this._armature.armatureData.scale;this._valueArray=i.frameFloatArray;this._rd.length=this._valueCount*2}else{this._deformCount=this.displayFrame.deformVertices.length}};t.prototype.blend=function(t){var e=this.target;var a=e.target;var r=e.blendWeight;var i=this.displayFrame.deformVertices;var n=this._valueArray;if(n!==null){var s=this._valueCount;var o=this._deformOffset;var l=this._sameValueOffset;var h=this._rd;for(var f=0;f<this._deformCount;++f){var u=0;if(f<o){u=n[l+f]}else if(f<o+s){u=h[f-o]}else{u=n[l+f-s]}if(e.dirty>1){i[f]+=u*r}else{i[f]=u*r}}}else if(e.dirty===1){for(var f=0;f<this._deformCount;++f){i[f]=0}}if(t||this.dirty){this.dirty=false;if(a._geometryData===this.displayFrame.getGeometryData()){a._verticesDirty=true}}};return t}(y.MutilpleValueTimelineState);y.DeformTimelineState=u;var _=function(r){__extends(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}t.toString=function(){return"[class dragonBones.IKConstraintTimelineState]"};t.prototype._onUpdateFrame=function(){r.prototype._onUpdateFrame.call(this);var t=this.target;if(this._timelineData!==null){t._bendPositive=this._currentA>0;t._weight=this._currentB}else{var e=t._constraintData;t._bendPositive=e.bendPositive;t._weight=e.weight}t.invalidUpdate();this.dirty=false};t.prototype.init=function(t,e,a){r.prototype.init.call(this,t,e,a);this._valueOffset=this._animationData.frameIntOffset;this._valueScale=.01;this._valueArray=this._animationData.parent.parent.frameIntArray};return t}(y.DoubleValueTimelineState);y.IKConstraintTimelineState=_;var m=function(r){__extends(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}t.toString=function(){return"[class dragonBones.AnimationProgressTimelineState]"};t.prototype._onUpdateFrame=function(){r.prototype._onUpdateFrame.call(this);var t=this.target;if(t._parent!==null){t.currentTime=this._result*t.totalTime}this.dirty=false};t.prototype.init=function(t,e,a){r.prototype.init.call(this,t,e,a);this._valueOffset=this._animationData.frameIntOffset;this._valueScale=1e-4;this._valueArray=this._animationData.parent.parent.frameIntArray};return t}(y.SingleValueTimelineState);y.AnimationProgressTimelineState=m;var p=function(r){__extends(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}t.toString=function(){return"[class dragonBones.AnimationWeightTimelineState]"};t.prototype._onUpdateFrame=function(){r.prototype._onUpdateFrame.call(this);var t=this.target;if(t._parent!==null){t.weight=this._result}this.dirty=false};t.prototype.init=function(t,e,a){r.prototype.init.call(this,t,e,a);this._valueOffset=this._animationData.frameIntOffset;this._valueScale=1e-4;this._valueArray=this._animationData.parent.parent.frameIntArray};return t}(y.SingleValueTimelineState);y.AnimationWeightTimelineState=p;var c=function(r){__extends(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}t.toString=function(){return"[class dragonBones.AnimationParametersTimelineState]"};t.prototype._onUpdateFrame=function(){r.prototype._onUpdateFrame.call(this);var t=this.target;if(t._parent!==null){t.parameterX=this._resultA;t.parameterY=this._resultB}this.dirty=false};t.prototype.init=function(t,e,a){r.prototype.init.call(this,t,e,a);this._valueOffset=this._animationData.frameIntOffset;this._valueScale=1e-4;this._valueArray=this._animationData.parent.parent.frameIntArray};return t}(y.DoubleValueTimelineState);y.AnimationParametersTimelineState=c})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}r.actionDataToInstance=function(t,e,a){if(t.type===0){e.type=r.FRAME_EVENT}else{e.type=t.type===10?r.FRAME_EVENT:r.SOUND_EVENT}e.name=t.name;e.armature=a;e.actionData=t;e.data=t.data;if(t.bone!==null){e.bone=a.getBone(t.bone.name)}if(t.slot!==null){e.slot=a.getSlot(t.slot.name)}};r.toString=function(){return"[class dragonBones.EventObject]"};r.prototype._onClear=function(){this.time=0;this.type="";this.name="";this.armature=null;this.bone=null;this.slot=null;this.animationState=null;this.actionData=null;this.data=null};r.START="start";r.LOOP_COMPLETE="loopComplete";r.COMPLETE="complete";r.FADE_IN="fadeIn";r.FADE_IN_COMPLETE="fadeInComplete";r.FADE_OUT="fadeOut";r.FADE_OUT_COMPLETE="fadeOutComplete";r.FRAME_EVENT="frameEvent";r.SOUND_EVENT="soundEvent";return r}(t.BaseObject);t.EventObject=e})(dragonBones||(dragonBones={}));var dragonBones;(function(t){var e=function(){function t(){}t._getArmatureType=function(t){switch(t.toLowerCase()){case"stage":return 2;case"armature":return 0;case"movieclip":return 1;default:return 0}};t._getBoneType=function(t){switch(t.toLowerCase()){case"bone":return 0;case"surface":return 1;default:return 0}};t._getPositionMode=function(t){switch(t.toLocaleLowerCase()){case"percent":return 1;case"fixed":return 0;default:return 1}};t._getSpacingMode=function(t){switch(t.toLocaleLowerCase()){case"length":return 0;case"percent":return 2;case"fixed":return 1;default:return 0}};t._getRotateMode=function(t){switch(t.toLocaleLowerCase()){case"tangent":return 0;case"chain":return 1;case"chainscale":return 2;default:return 0}};t._getDisplayType=function(t){switch(t.toLowerCase()){case"image":return 0;case"mesh":return 2;case"armature":return 1;case"boundingbox":return 3;case"path":return 4;default:return 0}};t._getBoundingBoxType=function(t){switch(t.toLowerCase()){case"rectangle":return 0;case"ellipse":return 1;case"polygon":return 2;default:return 0}};t._getBlendMode=function(t){switch(t.toLowerCase()){case"normal":return 0;case"add":return 1;case"alpha":return 2;case"darken":return 3;case"difference":return 4;case"erase":return 5;case"hardlight":return 6;case"invert":return 7;case"layer":return 8;case"lighten":return 9;case"multiply":return 10;case"overlay":return 11;case"screen":return 12;case"subtract":return 13;default:return 0}};t._getAnimationBlendType=function(t){switch(t.toLowerCase()){case"none":return 0;case"1d":return 1;default:return 0}};t._getActionType=function(t){switch(t.toLowerCase()){case"play":return 0;case"frame":return 10;case"sound":return 11;default:return 0}};t.DATA_VERSION_2_3="2.3";t.DATA_VERSION_3_0="3.0";t.DATA_VERSION_4_0="4.0";t.DATA_VERSION_4_5="4.5";t.DATA_VERSION_5_0="5.0";t.DATA_VERSION_5_5="5.5";t.DATA_VERSION_5_6="5.6";t.DATA_VERSION=t.DATA_VERSION_5_6;t.DATA_VERSIONS=[t.DATA_VERSION_4_0,t.DATA_VERSION_4_5,t.DATA_VERSION_5_0,t.DATA_VERSION_5_5,t.DATA_VERSION_5_6];t.TEXTURE_ATLAS="textureAtlas";t.SUB_TEXTURE="SubTexture";t.FORMAT="format";t.IMAGE_PATH="imagePath";t.WIDTH="width";t.HEIGHT="height";t.ROTATED="rotated";t.FRAME_X="frameX";t.FRAME_Y="frameY";t.FRAME_WIDTH="frameWidth";t.FRAME_HEIGHT="frameHeight";t.DRADON_BONES="dragonBones";t.USER_DATA="userData";t.ARMATURE="armature";t.CANVAS="canvas";t.BONE="bone";t.SURFACE="surface";t.SLOT="slot";t.CONSTRAINT="constraint";t.SKIN="skin";t.DISPLAY="display";t.FRAME="frame";t.IK="ik";t.PATH_CONSTRAINT="path";t.ANIMATION="animation";t.TIMELINE="timeline";t.FFD="ffd";t.TRANSLATE_FRAME="translateFrame";t.ROTATE_FRAME="rotateFrame";t.SCALE_FRAME="scaleFrame";t.DISPLAY_FRAME="displayFrame";t.COLOR_FRAME="colorFrame";t.DEFAULT_ACTIONS="defaultActions";t.ACTIONS="actions";t.EVENTS="events";t.INTS="ints";t.FLOATS="floats";t.STRINGS="strings";t.TRANSFORM="transform";t.PIVOT="pivot";t.AABB="aabb";t.COLOR="color";t.VERSION="version";t.COMPATIBLE_VERSION="compatibleVersion";t.FRAME_RATE="frameRate";t.TYPE="type";t.SUB_TYPE="subType";t.NAME="name";t.PARENT="parent";t.TARGET="target";t.STAGE="stage";t.SHARE="share";t.PATH="path";t.LENGTH="length";t.DISPLAY_INDEX="displayIndex";t.Z_ORDER="zOrder";t.Z_INDEX="zIndex";t.BLEND_MODE="blendMode";t.INHERIT_TRANSLATION="inheritTranslation";t.INHERIT_ROTATION="inheritRotation";t.INHERIT_SCALE="inheritScale";t.INHERIT_REFLECTION="inheritReflection";t.INHERIT_ANIMATION="inheritAnimation";t.INHERIT_DEFORM="inheritDeform";t.SEGMENT_X="segmentX";t.SEGMENT_Y="segmentY";t.BEND_POSITIVE="bendPositive";t.CHAIN="chain";t.WEIGHT="weight";t.BLEND_TYPE="blendType";t.FADE_IN_TIME="fadeInTime";t.PLAY_TIMES="playTimes";t.SCALE="scale";t.OFFSET="offset";t.POSITION="position";t.DURATION="duration";t.TWEEN_EASING="tweenEasing";t.TWEEN_ROTATE="tweenRotate";t.TWEEN_SCALE="tweenScale";t.CLOCK_WISE="clockwise";t.CURVE="curve";t.SOUND="sound";t.EVENT="event";t.ACTION="action";t.X="x";t.Y="y";t.SKEW_X="skX";t.SKEW_Y="skY";t.SCALE_X="scX";t.SCALE_Y="scY";t.VALUE="value";t.ROTATE="rotate";t.SKEW="skew";t.ALPHA="alpha";t.ALPHA_OFFSET="aO";t.RED_OFFSET="rO";t.GREEN_OFFSET="gO";t.BLUE_OFFSET="bO";t.ALPHA_MULTIPLIER="aM";t.RED_MULTIPLIER="rM";t.GREEN_MULTIPLIER="gM";t.BLUE_MULTIPLIER="bM";t.UVS="uvs";t.VERTICES="vertices";t.TRIANGLES="triangles";t.WEIGHTS="weights";t.SLOT_POSE="slotPose";t.BONE_POSE="bonePose";t.BONES="bones";t.POSITION_MODE="positionMode";t.SPACING_MODE="spacingMode";t.ROTATE_MODE="rotateMode";t.SPACING="spacing";t.ROTATE_OFFSET="rotateOffset";t.ROTATE_MIX="rotateMix";t.TRANSLATE_MIX="translateMix";t.TARGET_DISPLAY="targetDisplay";t.CLOSED="closed";t.CONSTANT_SPEED="constantSpeed";t.VERTEX_COUNT="vertexCount";t.LENGTHS="lengths";t.GOTO_AND_PLAY="gotoAndPlay";t.DEFAULT_NAME="default";return t}();t.DataParser=e})(dragonBones||(dragonBones={}));var dragonBones;(function(tt){var t=function(e){__extends(J,e);function J(){var t=e!==null&&e.apply(this,arguments)||this;t._rawTextureAtlasIndex=0;t._rawBones=[];t._data=null;t._armature=null;t._bone=null;t._geometry=null;t._slot=null;t._skin=null;t._mesh=null;t._animation=null;t._timeline=null;t._rawTextureAtlases=null;t._frameValueType=0;t._defaultColorOffset=-1;t._prevClockwise=0;t._prevRotation=0;t._frameDefaultValue=0;t._frameValueScale=1;t._helpMatrixA=new tt.Matrix;t._helpMatrixB=new tt.Matrix;t._helpTransform=new tt.Transform;t._helpColorTransform=new tt.ColorTransform;t._helpPoint=new tt.Point;t._helpArray=[];t._intArray=[];t._floatArray=[];t._frameIntArray=[];t._frameFloatArray=[];t._frameArray=[];t._timelineArray=[];t._colorArray=[];t._cacheRawMeshes=[];t._cacheMeshes=[];t._actionFrames=[];t._weightSlotPose={};t._weightBonePoses={};t._cacheBones={};t._slotChildActions={};return t}J._getBoolean=function(t,e,a){if(e in t){var r=t[e];var i=typeof r;if(i==="boolean"){return r}else if(i==="string"){switch(r){case"0":case"NaN":case"":case"false":case"null":case"undefined":return false;default:return true}}else{return!!r}}return a};J._getNumber=function(t,e,a){if(e in t){var r=t[e];if(r===null||r==="NaN"){return a}return+r||0}return a};J._getString=function(t,e,a){if(e in t){var r=t[e];var i=typeof r;if(i==="string"){return r}return String(r)}return a};J.prototype._getCurvePoint=function(t,e,a,r,i,n,s,o,l,h){var f=1-l;var u=f*f;var _=l*l;var m=f*u;var p=3*l*u;var c=3*f*_;var d=l*_;h.x=m*t+p*a+c*i+d*s;h.y=m*e+p*r+c*n+d*o};J.prototype._samplingEasingCurve=function(t,e){var a=t.length;if(a%3===1){var r=-2;for(var i=0,n=e.length;i<n;++i){var s=(i+1)/(n+1);while((r+6<a?t[r+6]:1)<s){r+=6}var o=r>=0&&r+6<a;var l=o?t[r]:0;var h=o?t[r+1]:0;var f=t[r+2];var u=t[r+3];var _=t[r+4];var m=t[r+5];var p=o?t[r+6]:1;var c=o?t[r+7]:1;var d=0;var y=1;while(y-d>1e-4){var v=(y+d)*.5;this._getCurvePoint(l,h,f,u,_,m,p,c,v,this._helpPoint);if(s-this._helpPoint.x>0){d=v}else{y=v}}e[i]=this._helpPoint.y}return true}else{var r=0;for(var i=0,n=e.length;i<n;++i){var s=(i+1)/(n+1);while(t[r+6]<s){r+=6}var l=t[r];var h=t[r+1];var f=t[r+2];var u=t[r+3];var _=t[r+4];var m=t[r+5];var p=t[r+6];var c=t[r+7];var d=0;var y=1;while(y-d>1e-4){var v=(y+d)*.5;this._getCurvePoint(l,h,f,u,_,m,p,c,v,this._helpPoint);if(s-this._helpPoint.x>0){d=v}else{y=v}}e[i]=this._helpPoint.y}return false}};J.prototype._parseActionDataInFrame=function(t,e,a,r){if(tt.DataParser.EVENT in t){this._mergeActionFrame(t[tt.DataParser.EVENT],e,10,a,r)}if(tt.DataParser.SOUND in t){this._mergeActionFrame(t[tt.DataParser.SOUND],e,11,a,r)}if(tt.DataParser.ACTION in t){this._mergeActionFrame(t[tt.DataParser.ACTION],e,0,a,r)}if(tt.DataParser.EVENTS in t){this._mergeActionFrame(t[tt.DataParser.EVENTS],e,10,a,r)}if(tt.DataParser.ACTIONS in t){this._mergeActionFrame(t[tt.DataParser.ACTIONS],e,0,a,r)}};J.prototype._mergeActionFrame=function(t,e,a,r,i){var n=this._armature.actions.length;var s=this._parseActionData(t,a,r,i);var o=0;var l=null;for(var h=0,f=s;h<f.length;h++){var u=f[h];this._armature.addAction(u,false)}if(this._actionFrames.length===0){l=new D;l.frameStart=0;this._actionFrames.push(l);l=null}for(var _=0,m=this._actionFrames;_<m.length;_++){var p=m[_];if(p.frameStart===e){l=p;break}else if(p.frameStart>e){break}o++}if(l===null){l=new D;l.frameStart=e;this._actionFrames.splice(o,0,l)}for(var c=0;c<s.length;++c){l.actions.push(n+c)}};J.prototype._parseArmature=function(t,e){var a=tt.BaseObject.borrowObject(tt.ArmatureData);a.name=J._getString(t,tt.DataParser.NAME,"");a.frameRate=J._getNumber(t,tt.DataParser.FRAME_RATE,this._data.frameRate);a.scale=e;if(tt.DataParser.TYPE in t&&typeof t[tt.DataParser.TYPE]==="string"){a.type=tt.DataParser._getArmatureType(t[tt.DataParser.TYPE])}else{a.type=J._getNumber(t,tt.DataParser.TYPE,0)}if(a.frameRate===0){a.frameRate=24}this._armature=a;if(tt.DataParser.CANVAS in t){var r=t[tt.DataParser.CANVAS];var i=tt.BaseObject.borrowObject(tt.CanvasData);if(tt.DataParser.COLOR in r){i.hasBackground=true}else{i.hasBackground=false}i.color=J._getNumber(r,tt.DataParser.COLOR,0);i.x=J._getNumber(r,tt.DataParser.X,0)*a.scale;i.y=J._getNumber(r,tt.DataParser.Y,0)*a.scale;i.width=J._getNumber(r,tt.DataParser.WIDTH,0)*a.scale;i.height=J._getNumber(r,tt.DataParser.HEIGHT,0)*a.scale;a.canvas=i}if(tt.DataParser.AABB in t){var n=t[tt.DataParser.AABB];a.aabb.x=J._getNumber(n,tt.DataParser.X,0)*a.scale;a.aabb.y=J._getNumber(n,tt.DataParser.Y,0)*a.scale;a.aabb.width=J._getNumber(n,tt.DataParser.WIDTH,0)*a.scale;a.aabb.height=J._getNumber(n,tt.DataParser.HEIGHT,0)*a.scale}if(tt.DataParser.BONE in t){var s=t[tt.DataParser.BONE];for(var o=0,l=s;o<l.length;o++){var h=l[o];var f=J._getString(h,tt.DataParser.PARENT,"");var u=this._parseBone(h);if(f.length>0){var _=a.getBone(f);if(_!==null){u.parent=_}else{if(!(f in this._cacheBones)){this._cacheBones[f]=[]}this._cacheBones[f].push(u)}}if(u.name in this._cacheBones){for(var m=0,p=this._cacheBones[u.name];m<p.length;m++){var c=p[m];c.parent=u}delete this._cacheBones[u.name]}a.addBone(u);this._rawBones.push(u)}}if(tt.DataParser.IK in t){var d=t[tt.DataParser.IK];for(var y=0,v=d;y<v.length;y++){var g=v[y];var D=this._parseIKConstraint(g);if(D){a.addConstraint(D)}}}a.sortBones();if(tt.DataParser.SLOT in t){var b=0;var T=t[tt.DataParser.SLOT];for(var A=0,P=T;A<P.length;A++){var O=P[A];a.addSlot(this._parseSlot(O,b++))}}if(tt.DataParser.SKIN in t){var S=t[tt.DataParser.SKIN];for(var x=0,B=S;x<B.length;x++){var E=B[x];a.addSkin(this._parseSkin(E))}}if(tt.DataParser.PATH_CONSTRAINT in t){var M=t[tt.DataParser.PATH_CONSTRAINT];for(var I=0,F=M;I<F.length;I++){var w=F[I];var D=this._parsePathConstraint(w);if(D){a.addConstraint(D)}}}for(var C=0,N=this._cacheRawMeshes.length;C<N;++C){var R=this._cacheRawMeshes[C];var j=J._getString(R,tt.DataParser.SHARE,"");if(j.length===0){continue}var k=J._getString(R,tt.DataParser.SKIN,tt.DataParser.DEFAULT_NAME);if(k.length===0){k=tt.DataParser.DEFAULT_NAME}var L=a.getMesh(k,"",j);if(L===null){continue}var V=this._cacheMeshes[C];V.geometry.shareFrom(L.geometry)}if(tt.DataParser.ANIMATION in t){var Y=t[tt.DataParser.ANIMATION];for(var U=0,X=Y;U<X.length;U++){var G=X[U];var H=this._parseAnimation(G);a.addAnimation(H)}}if(tt.DataParser.DEFAULT_ACTIONS in t){var W=this._parseActionData(t[tt.DataParser.DEFAULT_ACTIONS],0,null,null);for(var z=0,$=W;z<$.length;z++){var K=$[z];a.addAction(K,true);if(K.type===0){var H=a.getAnimation(K.name);if(H!==null){a.defaultAnimation=H}}}}if(tt.DataParser.ACTIONS in t){var W=this._parseActionData(t[tt.DataParser.ACTIONS],0,null,null);for(var Z=0,q=W;Z<q.length;Z++){var K=q[Z];a.addAction(K,false)}}this._rawBones.length=0;this._cacheRawMeshes.length=0;this._cacheMeshes.length=0;this._armature=null;for(var Q in this._weightSlotPose){delete this._weightSlotPose[Q]}for(var Q in this._weightBonePoses){delete this._weightBonePoses[Q]}for(var Q in this._cacheBones){delete this._cacheBones[Q]}for(var Q in this._slotChildActions){delete this._slotChildActions[Q]}return a};J.prototype._parseBone=function(t){var e=0;if(tt.DataParser.TYPE in t&&typeof t[tt.DataParser.TYPE]==="string"){e=tt.DataParser._getBoneType(t[tt.DataParser.TYPE])}else{e=J._getNumber(t,tt.DataParser.TYPE,0)}if(e===0){var a=this._armature.scale;var r=tt.BaseObject.borrowObject(tt.BoneData);r.inheritTranslation=J._getBoolean(t,tt.DataParser.INHERIT_TRANSLATION,true);r.inheritRotation=J._getBoolean(t,tt.DataParser.INHERIT_ROTATION,true);r.inheritScale=J._getBoolean(t,tt.DataParser.INHERIT_SCALE,true);r.inheritReflection=J._getBoolean(t,tt.DataParser.INHERIT_REFLECTION,true);r.length=J._getNumber(t,tt.DataParser.LENGTH,0)*a;r.alpha=J._getNumber(t,tt.DataParser.ALPHA,1);r.name=J._getString(t,tt.DataParser.NAME,"");if(tt.DataParser.TRANSFORM in t){this._parseTransform(t[tt.DataParser.TRANSFORM],r.transform,a)}return r}var i=tt.BaseObject.borrowObject(tt.SurfaceData);i.alpha=J._getNumber(t,tt.DataParser.ALPHA,1);i.name=J._getString(t,tt.DataParser.NAME,"");i.segmentX=J._getNumber(t,tt.DataParser.SEGMENT_X,0);i.segmentY=J._getNumber(t,tt.DataParser.SEGMENT_Y,0);this._parseGeometry(t,i.geometry);return i};J.prototype._parseIKConstraint=function(t){var e=this._armature.getBone(J._getString(t,tt.DataParser.BONE,""));if(e===null){return null}var a=this._armature.getBone(J._getString(t,tt.DataParser.TARGET,""));if(a===null){return null}var r=J._getNumber(t,tt.DataParser.CHAIN,0);var i=tt.BaseObject.borrowObject(tt.IKConstraintData);i.scaleEnabled=J._getBoolean(t,tt.DataParser.SCALE,false);i.bendPositive=J._getBoolean(t,tt.DataParser.BEND_POSITIVE,true);i.weight=J._getNumber(t,tt.DataParser.WEIGHT,1);i.name=J._getString(t,tt.DataParser.NAME,"");i.type=0;i.target=a;if(r>0&&e.parent!==null){i.root=e.parent;i.bone=e}else{i.root=e;i.bone=null}return i};J.prototype._parsePathConstraint=function(t){var e=this._armature.getSlot(J._getString(t,tt.DataParser.TARGET,""));if(e===null){return null}var a=this._armature.defaultSkin;if(a===null){return null}var r=a.getDisplay(e.name,J._getString(t,tt.DataParser.TARGET_DISPLAY,e.name));if(r===null||!(r instanceof tt.PathDisplayData)){return null}var i=t[tt.DataParser.BONES];if(i===null||i.length===0){return null}var n=tt.BaseObject.borrowObject(tt.PathConstraintData);n.name=J._getString(t,tt.DataParser.NAME,"");n.type=1;n.pathSlot=e;n.pathDisplayData=r;n.target=e.parent;n.positionMode=tt.DataParser._getPositionMode(J._getString(t,tt.DataParser.POSITION_MODE,""));n.spacingMode=tt.DataParser._getSpacingMode(J._getString(t,tt.DataParser.SPACING_MODE,""));n.rotateMode=tt.DataParser._getRotateMode(J._getString(t,tt.DataParser.ROTATE_MODE,""));n.position=J._getNumber(t,tt.DataParser.POSITION,0);n.spacing=J._getNumber(t,tt.DataParser.SPACING,0);n.rotateOffset=J._getNumber(t,tt.DataParser.ROTATE_OFFSET,0);n.rotateMix=J._getNumber(t,tt.DataParser.ROTATE_MIX,1);n.translateMix=J._getNumber(t,tt.DataParser.TRANSLATE_MIX,1);for(var s=0,o=i;s<o.length;s++){var l=o[s];var h=this._armature.getBone(l);if(h!==null){n.AddBone(h);if(n.root===null){n.root=h}}}return n};J.prototype._parseSlot=function(t,e){var a=tt.BaseObject.borrowObject(tt.SlotData);a.displayIndex=J._getNumber(t,tt.DataParser.DISPLAY_INDEX,0);a.zOrder=e;a.zIndex=J._getNumber(t,tt.DataParser.Z_INDEX,0);a.alpha=J._getNumber(t,tt.DataParser.ALPHA,1);a.name=J._getString(t,tt.DataParser.NAME,"");a.parent=this._armature.getBone(J._getString(t,tt.DataParser.PARENT,""));if(tt.DataParser.BLEND_MODE in t&&typeof t[tt.DataParser.BLEND_MODE]==="string"){a.blendMode=tt.DataParser._getBlendMode(t[tt.DataParser.BLEND_MODE])}else{a.blendMode=J._getNumber(t,tt.DataParser.BLEND_MODE,0)}if(tt.DataParser.COLOR in t){a.color=tt.SlotData.createColor();this._parseColorTransform(t[tt.DataParser.COLOR],a.color)}else{a.color=tt.SlotData.DEFAULT_COLOR}if(tt.DataParser.ACTIONS in t){this._slotChildActions[a.name]=this._parseActionData(t[tt.DataParser.ACTIONS],0,null,null)}return a};J.prototype._parseSkin=function(t){var e=tt.BaseObject.borrowObject(tt.SkinData);e.name=J._getString(t,tt.DataParser.NAME,tt.DataParser.DEFAULT_NAME);if(e.name.length===0){e.name=tt.DataParser.DEFAULT_NAME}if(tt.DataParser.SLOT in t){var a=t[tt.DataParser.SLOT];this._skin=e;for(var r=0,i=a;r<i.length;r++){var n=i[r];var s=J._getString(n,tt.DataParser.NAME,"");var o=this._armature.getSlot(s);if(o!==null){this._slot=o;if(tt.DataParser.DISPLAY in n){var l=n[tt.DataParser.DISPLAY];for(var h=0,f=l;h<f.length;h++){var u=f[h];if(u){e.addDisplay(s,this._parseDisplay(u))}else{e.addDisplay(s,null)}}}this._slot=null}}this._skin=null}return e};J.prototype._parseDisplay=function(t){var e=J._getString(t,tt.DataParser.NAME,"");var a=J._getString(t,tt.DataParser.PATH,"");var r=0;var i=null;if(tt.DataParser.TYPE in t&&typeof t[tt.DataParser.TYPE]==="string"){r=tt.DataParser._getDisplayType(t[tt.DataParser.TYPE])}else{r=J._getNumber(t,tt.DataParser.TYPE,r)}switch(r){case 0:{var n=i=tt.BaseObject.borrowObject(tt.ImageDisplayData);n.name=e;n.path=a.length>0?a:e;this._parsePivot(t,n);break}case 1:{var s=i=tt.BaseObject.borrowObject(tt.ArmatureDisplayData);s.name=e;s.path=a.length>0?a:e;s.inheritAnimation=true;if(tt.DataParser.ACTIONS in t){var o=this._parseActionData(t[tt.DataParser.ACTIONS],0,null,null);for(var l=0,h=o;l<h.length;l++){var f=h[l];s.addAction(f)}}else if(this._slot.name in this._slotChildActions){var u=this._skin.getDisplays(this._slot.name);if(u===null?this._slot.displayIndex===0:this._slot.displayIndex===u.length){for(var _=0,m=this._slotChildActions[this._slot.name];_<m.length;_++){var f=m[_];s.addAction(f)}delete this._slotChildActions[this._slot.name]}}break}case 2:{var p=i=tt.BaseObject.borrowObject(tt.MeshDisplayData);p.geometry.inheritDeform=J._getBoolean(t,tt.DataParser.INHERIT_DEFORM,true);p.name=e;p.path=a.length>0?a:e;if(tt.DataParser.SHARE in t){p.geometry.data=this._data;this._cacheRawMeshes.push(t);this._cacheMeshes.push(p)}else{this._parseMesh(t,p)}break}case 3:{var c=this._parseBoundingBox(t);if(c!==null){var d=i=tt.BaseObject.borrowObject(tt.BoundingBoxDisplayData);d.name=e;d.path=a.length>0?a:e;d.boundingBox=c}break}case 4:{var y=t[tt.DataParser.LENGTHS];var v=i=tt.BaseObject.borrowObject(tt.PathDisplayData);v.closed=J._getBoolean(t,tt.DataParser.CLOSED,false);v.constantSpeed=J._getBoolean(t,tt.DataParser.CONSTANT_SPEED,false);v.name=e;v.path=a.length>0?a:e;v.curveLengths.length=y.length;for(var g=0,D=y.length;g<D;++g){v.curveLengths[g]=y[g]}this._parsePath(t,v);break}}if(i!==null&&tt.DataParser.TRANSFORM in t){this._parseTransform(t[tt.DataParser.TRANSFORM],i.transform,this._armature.scale)}return i};J.prototype._parsePath=function(t,e){this._parseGeometry(t,e.geometry)};J.prototype._parsePivot=function(t,e){if(tt.DataParser.PIVOT in t){var a=t[tt.DataParser.PIVOT];e.pivot.x=J._getNumber(a,tt.DataParser.X,0);e.pivot.y=J._getNumber(a,tt.DataParser.Y,0)}else{e.pivot.x=.5;e.pivot.y=.5}};J.prototype._parseMesh=function(t,e){this._parseGeometry(t,e.geometry);if(tt.DataParser.WEIGHTS in t){var a=t[tt.DataParser.SLOT_POSE];var r=t[tt.DataParser.BONE_POSE];var i=this._skin.name+"_"+this._slot.name+"_"+e.name;this._weightSlotPose[i]=a;this._weightBonePoses[i]=r}};J.prototype._parseBoundingBox=function(t){var e=null;var a=0;if(tt.DataParser.SUB_TYPE in t&&typeof t[tt.DataParser.SUB_TYPE]==="string"){a=tt.DataParser._getBoundingBoxType(t[tt.DataParser.SUB_TYPE])}else{a=J._getNumber(t,tt.DataParser.SUB_TYPE,a)}switch(a){case 0:e=tt.BaseObject.borrowObject(tt.RectangleBoundingBoxData);break;case 1:e=tt.BaseObject.borrowObject(tt.EllipseBoundingBoxData);break;case 2:e=this._parsePolygonBoundingBox(t);break}if(e!==null){e.color=J._getNumber(t,tt.DataParser.COLOR,0);if(e.type===0||e.type===1){e.width=J._getNumber(t,tt.DataParser.WIDTH,0);e.height=J._getNumber(t,tt.DataParser.HEIGHT,0)}}return e};J.prototype._parsePolygonBoundingBox=function(t){var e=tt.BaseObject.borrowObject(tt.PolygonBoundingBoxData);if(tt.DataParser.VERTICES in t){var a=this._armature.scale;var r=t[tt.DataParser.VERTICES];var i=e.vertices;i.length=r.length;for(var n=0,s=r.length;n<s;n+=2){var o=r[n]*a;var l=r[n+1]*a;i[n]=o;i[n+1]=l;if(n===0){e.x=o;e.y=l;e.width=o;e.height=l}else{if(o<e.x){e.x=o}else if(o>e.width){e.width=o}if(l<e.y){e.y=l}else if(l>e.height){e.height=l}}}e.width-=e.x;e.height-=e.y}else{console.warn("Data error.\n Please reexport DragonBones Data to fixed the bug.")}return e};J.prototype._parseAnimation=function(t){var e=tt.BaseObject.borrowObject(tt.AnimationData);e.blendType=tt.DataParser._getAnimationBlendType(J._getString(t,tt.DataParser.BLEND_TYPE,""));e.frameCount=J._getNumber(t,tt.DataParser.DURATION,0);e.playTimes=J._getNumber(t,tt.DataParser.PLAY_TIMES,1);e.duration=e.frameCount/this._armature.frameRate;e.fadeInTime=J._getNumber(t,tt.DataParser.FADE_IN_TIME,0);e.scale=J._getNumber(t,tt.DataParser.SCALE,1);e.name=J._getString(t,tt.DataParser.NAME,tt.DataParser.DEFAULT_NAME);if(e.name.length===0){e.name=tt.DataParser.DEFAULT_NAME}e.frameIntOffset=this._frameIntArray.length;e.frameFloatOffset=this._frameFloatArray.length;e.frameOffset=this._frameArray.length;this._animation=e;if(tt.DataParser.FRAME in t){var a=t[tt.DataParser.FRAME];var r=a.length;if(r>0){for(var i=0,n=0;i<r;++i){var s=a[i];this._parseActionDataInFrame(s,n,null,null);n+=J._getNumber(s,tt.DataParser.DURATION,1)}}}if(tt.DataParser.Z_ORDER in t){this._animation.zOrderTimeline=this._parseTimeline(t[tt.DataParser.Z_ORDER],null,tt.DataParser.FRAME,1,0,0,this._parseZOrderFrame)}if(tt.DataParser.BONE in t){var o=t[tt.DataParser.BONE];for(var l=0,h=o;l<h.length;l++){var f=h[l];this._parseBoneTimeline(f)}}if(tt.DataParser.SLOT in t){var o=t[tt.DataParser.SLOT];for(var u=0,_=o;u<_.length;u++){var f=_[u];this._parseSlotTimeline(f)}}if(tt.DataParser.FFD in t){var o=t[tt.DataParser.FFD];for(var m=0,p=o;m<p.length;m++){var f=p[m];var c=J._getString(f,tt.DataParser.SKIN,tt.DataParser.DEFAULT_NAME);var d=J._getString(f,tt.DataParser.SLOT,"");var y=J._getString(f,tt.DataParser.NAME,"");if(c.length===0){c=tt.DataParser.DEFAULT_NAME}this._slot=this._armature.getSlot(d);this._mesh=this._armature.getMesh(c,d,y);if(this._slot===null||this._mesh===null){continue}var v=this._parseTimeline(f,null,tt.DataParser.FRAME,22,2,0,this._parseSlotDeformFrame);if(v!==null){this._animation.addSlotTimeline(d,v)}this._slot=null;this._mesh=null}}if(tt.DataParser.IK in t){var o=t[tt.DataParser.IK];for(var g=0,D=o;g<D.length;g++){var f=D[g];var b=J._getString(f,tt.DataParser.NAME,"");var T=this._armature.getConstraint(b);if(T===null){continue}var v=this._parseTimeline(f,null,tt.DataParser.FRAME,30,1,2,this._parseIKConstraintFrame);if(v!==null){this._animation.addConstraintTimeline(b,v)}}}if(this._actionFrames.length>0){this._animation.actionTimeline=this._parseTimeline(null,this._actionFrames,"",0,0,0,this._parseActionFrame);this._actionFrames.length=0}if(tt.DataParser.TIMELINE in t){var o=t[tt.DataParser.TIMELINE];for(var A=0,P=o;A<P.length;A++){var f=P[A];var O=J._getNumber(f,tt.DataParser.TYPE,0);var S=J._getString(f,tt.DataParser.NAME,"");var v=null;switch(O){case 0:break;case 20:case 23:case 60:case 24:case 40:case 41:if(O===20){this._frameValueType=0;this._frameValueScale=1}else{this._frameValueType=1;if(O===23){this._frameValueScale=1}else if(O===40||O===41){this._frameValueScale=1e4}else{this._frameValueScale=100}}if(O===60||O===24||O===41){this._frameDefaultValue=1}else{this._frameDefaultValue=0}if(O===40&&e.blendType!==0){v=tt.BaseObject.borrowObject(tt.AnimationTimelineData);var x=v;x.x=J._getNumber(f,tt.DataParser.X,0);x.y=J._getNumber(f,tt.DataParser.Y,0)}v=this._parseTimeline(f,null,tt.DataParser.FRAME,O,this._frameValueType,1,this._parseSingleValueFrame,v);break;case 11:case 12:case 13:case 30:case 42:if(O===30||O===42){this._frameValueType=1;if(O===42){this._frameValueScale=1e4}else{this._frameValueScale=100}}else{if(O===12){this._frameValueScale=tt.Transform.DEG_RAD}else{this._frameValueScale=1}this._frameValueType=2}if(O===13||O===30){this._frameDefaultValue=1}else{this._frameDefaultValue=0}v=this._parseTimeline(f,null,tt.DataParser.FRAME,O,this._frameValueType,2,this._parseDoubleValueFrame);break;case 1:break;case 50:{var B=this._armature.getBone(S);if(B===null){continue}this._geometry=B.geometry;v=this._parseTimeline(f,null,tt.DataParser.FRAME,O,2,0,this._parseDeformFrame);this._geometry=null;break}case 22:{this._geometry=null;for(var c in this._armature.skins){var E=this._armature.skins[c];for(var M in E.displays){var I=E.displays[M];for(var F=0,w=I;F<w.length;F++){var C=w[F];if(C!==null&&C.name===S){this._geometry=C.geometry;break}}}}if(this._geometry===null){continue}v=this._parseTimeline(f,null,tt.DataParser.FRAME,O,2,0,this._parseDeformFrame);this._geometry=null;break}case 21:v=this._parseTimeline(f,null,tt.DataParser.FRAME,O,1,1,this._parseSlotColorFrame);break}if(v!==null){switch(O){case 0:break;case 1:break;case 11:case 12:case 13:case 50:case 60:this._animation.addBoneTimeline(S,v);break;case 20:case 21:case 22:case 23:case 24:this._animation.addSlotTimeline(S,v);break;case 30:this._animation.addConstraintTimeline(S,v);break;case 40:case 41:case 42:this._animation.addAnimationTimeline(S,v);break}}}}this._animation=null;return e};J.prototype._parseTimeline=function(t,e,a,r,i,n,s,o){if(o===void 0){o=null}if(t!==null&&a.length>0&&a in t){e=t[a]}if(e===null){return null}var l=e.length;if(l===0){return null}var h=this._frameIntArray.length;var f=this._frameFloatArray.length;var u=this._timelineArray.length;if(o===null){o=tt.BaseObject.borrowObject(tt.TimelineData)}o.type=r;o.offset=u;this._frameValueType=i;this._timeline=o;this._timelineArray.length+=1+1+1+1+1+l;if(t!==null){this._timelineArray[u+0]=Math.round(J._getNumber(t,tt.DataParser.SCALE,1)*100);this._timelineArray[u+1]=Math.round(J._getNumber(t,tt.DataParser.OFFSET,0)*100)}else{this._timelineArray[u+0]=100;this._timelineArray[u+1]=0}this._timelineArray[u+2]=l;this._timelineArray[u+3]=n;switch(this._frameValueType){case 0:this._timelineArray[u+4]=0;break;case 1:this._timelineArray[u+4]=h-this._animation.frameIntOffset;break;case 2:this._timelineArray[u+4]=f-this._animation.frameFloatOffset;break}if(l===1){o.frameIndicesOffset=-1;this._timelineArray[u+5+0]=s.call(this,e[0],0,0)-this._animation.frameOffset}else{var _=this._animation.frameCount+1;var m=this._data.frameIndices;var p=m.length;m.length+=_;o.frameIndicesOffset=p;for(var c=0,d=0,y=0,v=0;c<_;++c){if(y+v<=c&&d<l){var g=e[d];y=c;if(d===l-1){v=this._animation.frameCount-y}else{if(g instanceof D){v=this._actionFrames[d+1].frameStart-y}else{v=J._getNumber(g,tt.DataParser.DURATION,1)}}this._timelineArray[u+5+d]=s.call(this,g,y,v)-this._animation.frameOffset;d++}m[p+c]=d-1}}this._timeline=null;return o};J.prototype._parseBoneTimeline=function(t){var e=this._armature.getBone(J._getString(t,tt.DataParser.NAME,""));if(e===null){return}this._bone=e;this._slot=this._armature.getSlot(this._bone.name);if(tt.DataParser.TRANSLATE_FRAME in t){this._frameDefaultValue=0;this._frameValueScale=1;var a=this._parseTimeline(t,null,tt.DataParser.TRANSLATE_FRAME,11,2,2,this._parseDoubleValueFrame);if(a!==null){this._animation.addBoneTimeline(e.name,a)}}if(tt.DataParser.ROTATE_FRAME in t){this._frameDefaultValue=0;this._frameValueScale=1;var a=this._parseTimeline(t,null,tt.DataParser.ROTATE_FRAME,12,2,2,this._parseBoneRotateFrame);if(a!==null){this._animation.addBoneTimeline(e.name,a)}}if(tt.DataParser.SCALE_FRAME in t){this._frameDefaultValue=1;this._frameValueScale=1;var a=this._parseTimeline(t,null,tt.DataParser.SCALE_FRAME,13,2,2,this._parseBoneScaleFrame);if(a!==null){this._animation.addBoneTimeline(e.name,a)}}if(tt.DataParser.FRAME in t){var a=this._parseTimeline(t,null,tt.DataParser.FRAME,10,2,6,this._parseBoneAllFrame);if(a!==null){this._animation.addBoneTimeline(e.name,a)}}this._bone=null;this._slot=null};J.prototype._parseSlotTimeline=function(t){var e=this._armature.getSlot(J._getString(t,tt.DataParser.NAME,""));if(e===null){return}var a=null;var r=null;this._slot=e;if(tt.DataParser.DISPLAY_FRAME in t){a=this._parseTimeline(t,null,tt.DataParser.DISPLAY_FRAME,20,0,0,this._parseSlotDisplayFrame)}else{a=this._parseTimeline(t,null,tt.DataParser.FRAME,20,0,0,this._parseSlotDisplayFrame)}if(tt.DataParser.COLOR_FRAME in t){r=this._parseTimeline(t,null,tt.DataParser.COLOR_FRAME,21,1,1,this._parseSlotColorFrame)}else{r=this._parseTimeline(t,null,tt.DataParser.FRAME,21,1,1,this._parseSlotColorFrame)}if(a!==null){this._animation.addSlotTimeline(e.name,a)}if(r!==null){this._animation.addSlotTimeline(e.name,r)}this._slot=null};J.prototype._parseFrame=function(t,e,a){t;a;var r=this._frameArray.length;this._frameArray.length+=1;this._frameArray[r+0]=e;return r};J.prototype._parseTweenFrame=function(t,e,a){var r=this._parseFrame(t,e,a);if(a>0){if(tt.DataParser.CURVE in t){var i=a+1;this._helpArray.length=i;var n=this._samplingEasingCurve(t[tt.DataParser.CURVE],this._helpArray);this._frameArray.length+=1+1+this._helpArray.length;this._frameArray[r+1]=2;this._frameArray[r+2]=n?i:-i;for(var s=0;s<i;++s){this._frameArray[r+3+s]=Math.round(this._helpArray[s]*1e4)}}else{var o=-2;var l=o;if(tt.DataParser.TWEEN_EASING in t){l=J._getNumber(t,tt.DataParser.TWEEN_EASING,o)}if(l===o){this._frameArray.length+=1;this._frameArray[r+1]=0}else if(l===0){this._frameArray.length+=1;this._frameArray[r+1]=1}else if(l<0){this._frameArray.length+=1+1;this._frameArray[r+1]=3;this._frameArray[r+2]=Math.round(-l*100)}else if(l<=1){this._frameArray.length+=1+1;this._frameArray[r+1]=4;this._frameArray[r+2]=Math.round(l*100)}else{this._frameArray.length+=1+1;this._frameArray[r+1]=5;this._frameArray[r+2]=Math.round(l*100-100)}}}else{this._frameArray.length+=1;this._frameArray[r+1]=0}return r};J.prototype._parseSingleValueFrame=function(t,e,a){var r=0;switch(this._frameValueType){case 0:{r=this._parseFrame(t,e,a);this._frameArray.length+=1;this._frameArray[r+1]=J._getNumber(t,tt.DataParser.VALUE,this._frameDefaultValue);break}case 1:{r=this._parseTweenFrame(t,e,a);var i=this._frameIntArray.length;this._frameIntArray.length+=1;this._frameIntArray[i]=Math.round(J._getNumber(t,tt.DataParser.VALUE,this._frameDefaultValue)*this._frameValueScale);break}case 2:{r=this._parseTweenFrame(t,e,a);var i=this._frameFloatArray.length;this._frameFloatArray.length+=1;this._frameFloatArray[i]=J._getNumber(t,tt.DataParser.VALUE,this._frameDefaultValue)*this._frameValueScale;break}}return r};J.prototype._parseDoubleValueFrame=function(t,e,a){var r=0;switch(this._frameValueType){case 0:{r=this._parseFrame(t,e,a);this._frameArray.length+=2;this._frameArray[r+1]=J._getNumber(t,tt.DataParser.X,this._frameDefaultValue);this._frameArray[r+2]=J._getNumber(t,tt.DataParser.Y,this._frameDefaultValue);break}case 1:{r=this._parseTweenFrame(t,e,a);var i=this._frameIntArray.length;this._frameIntArray.length+=2;this._frameIntArray[i]=Math.round(J._getNumber(t,tt.DataParser.X,this._frameDefaultValue)*this._frameValueScale);this._frameIntArray[i+1]=Math.round(J._getNumber(t,tt.DataParser.Y,this._frameDefaultValue)*this._frameValueScale);break}case 2:{r=this._parseTweenFrame(t,e,a);var i=this._frameFloatArray.length;this._frameFloatArray.length+=2;this._frameFloatArray[i]=J._getNumber(t,tt.DataParser.X,this._frameDefaultValue)*this._frameValueScale;this._frameFloatArray[i+1]=J._getNumber(t,tt.DataParser.Y,this._frameDefaultValue)*this._frameValueScale;break}}return r};J.prototype._parseActionFrame=function(t,e,a){a;var r=this._frameArray.length;var i=t.actions.length;this._frameArray.length+=1+1+i;this._frameArray[r+0]=e;this._frameArray[r+0+1]=i;for(var n=0;n<i;++n){this._frameArray[r+0+2+n]=t.actions[n]}return r};J.prototype._parseZOrderFrame=function(t,e,a){var r=this._parseFrame(t,e,a);if(tt.DataParser.Z_ORDER in t){var i=t[tt.DataParser.Z_ORDER];if(i.length>0){var n=this._armature.sortedSlots.length;var s=new Array(n-i.length/2);var o=new Array(n);for(var l=0;l<s.length;++l){s[l]=0}for(var h=0;h<n;++h){o[h]=-1}var f=0;var u=0;for(var _=0,m=i.length;_<m;_+=2){var p=i[_];var c=i[_+1];while(f!==p){s[u++]=f++}var d=f+c;o[d]=f++}while(f<n){s[u++]=f++}this._frameArray.length+=1+n;this._frameArray[r+1]=n;var y=n;while(y--){if(o[y]===-1){this._frameArray[r+2+y]=s[--u]||0}else{this._frameArray[r+2+y]=o[y]||0}}return r}}this._frameArray.length+=1;this._frameArray[r+1]=0;return r};J.prototype._parseBoneAllFrame=function(t,e,a){this._helpTransform.identity();if(tt.DataParser.TRANSFORM in t){this._parseTransform(t[tt.DataParser.TRANSFORM],this._helpTransform,1)}var r=this._helpTransform.rotation;if(e!==0){if(this._prevClockwise===0){r=this._prevRotation+tt.Transform.normalizeRadian(r-this._prevRotation)}else{if(this._prevClockwise>0?r>=this._prevRotation:r<=this._prevRotation){this._prevClockwise=this._prevClockwise>0?this._prevClockwise-1:this._prevClockwise+1}r=this._prevRotation+r-this._prevRotation+tt.Transform.PI_D*this._prevClockwise}}this._prevClockwise=J._getNumber(t,tt.DataParser.TWEEN_ROTATE,0);this._prevRotation=r;var i=this._parseTweenFrame(t,e,a);var n=this._frameFloatArray.length;this._frameFloatArray.length+=6;this._frameFloatArray[n++]=this._helpTransform.x;this._frameFloatArray[n++]=this._helpTransform.y;this._frameFloatArray[n++]=r;this._frameFloatArray[n++]=this._helpTransform.skew;this._frameFloatArray[n++]=this._helpTransform.scaleX;this._frameFloatArray[n++]=this._helpTransform.scaleY;this._parseActionDataInFrame(t,e,this._bone,this._slot);return i};J.prototype._parseBoneTranslateFrame=function(t,e,a){var r=this._parseTweenFrame(t,e,a);var i=this._frameFloatArray.length;this._frameFloatArray.length+=2;this._frameFloatArray[i++]=J._getNumber(t,tt.DataParser.X,0);this._frameFloatArray[i++]=J._getNumber(t,tt.DataParser.Y,0);return r};J.prototype._parseBoneRotateFrame=function(t,e,a){var r=J._getNumber(t,tt.DataParser.ROTATE,0)*tt.Transform.DEG_RAD;if(e!==0){if(this._prevClockwise===0){r=this._prevRotation+tt.Transform.normalizeRadian(r-this._prevRotation)}else{if(this._prevClockwise>0?r>=this._prevRotation:r<=this._prevRotation){this._prevClockwise=this._prevClockwise>0?this._prevClockwise-1:this._prevClockwise+1}r=this._prevRotation+r-this._prevRotation+tt.Transform.PI_D*this._prevClockwise}}this._prevClockwise=J._getNumber(t,tt.DataParser.CLOCK_WISE,0);this._prevRotation=r;var i=this._parseTweenFrame(t,e,a);var n=this._frameFloatArray.length;this._frameFloatArray.length+=2;this._frameFloatArray[n++]=r;this._frameFloatArray[n++]=J._getNumber(t,tt.DataParser.SKEW,0)*tt.Transform.DEG_RAD;return i};J.prototype._parseBoneScaleFrame=function(t,e,a){var r=this._parseTweenFrame(t,e,a);var i=this._frameFloatArray.length;this._frameFloatArray.length+=2;this._frameFloatArray[i++]=J._getNumber(t,tt.DataParser.X,1);this._frameFloatArray[i++]=J._getNumber(t,tt.DataParser.Y,1);return r};J.prototype._parseSlotDisplayFrame=function(t,e,a){var r=this._parseFrame(t,e,a);this._frameArray.length+=1;if(tt.DataParser.VALUE in t){this._frameArray[r+1]=J._getNumber(t,tt.DataParser.VALUE,0)}else{this._frameArray[r+1]=J._getNumber(t,tt.DataParser.DISPLAY_INDEX,0)}this._parseActionDataInFrame(t,e,this._slot.parent,this._slot);return r};J.prototype._parseSlotColorFrame=function(t,e,a){var r=this._parseTweenFrame(t,e,a);var i=-1;if(tt.DataParser.VALUE in t||tt.DataParser.COLOR in t){var n=tt.DataParser.VALUE in t?t[tt.DataParser.VALUE]:t[tt.DataParser.COLOR];for(var s in n){s;this._parseColorTransform(n,this._helpColorTransform);i=this._colorArray.length;this._colorArray.length+=8;this._colorArray[i++]=Math.round(this._helpColorTransform.alphaMultiplier*100);this._colorArray[i++]=Math.round(this._helpColorTransform.redMultiplier*100);this._colorArray[i++]=Math.round(this._helpColorTransform.greenMultiplier*100);this._colorArray[i++]=Math.round(this._helpColorTransform.blueMultiplier*100);this._colorArray[i++]=Math.round(this._helpColorTransform.alphaOffset);this._colorArray[i++]=Math.round(this._helpColorTransform.redOffset);this._colorArray[i++]=Math.round(this._helpColorTransform.greenOffset);this._colorArray[i++]=Math.round(this._helpColorTransform.blueOffset);i-=8;break}}if(i<0){if(this._defaultColorOffset<0){this._defaultColorOffset=i=this._colorArray.length;this._colorArray.length+=8;this._colorArray[i++]=100;this._colorArray[i++]=100;this._colorArray[i++]=100;this._colorArray[i++]=100;this._colorArray[i++]=0;this._colorArray[i++]=0;this._colorArray[i++]=0;this._colorArray[i++]=0}i=this._defaultColorOffset}var o=this._frameIntArray.length;this._frameIntArray.length+=1;this._frameIntArray[o]=i;return r};J.prototype._parseSlotDeformFrame=function(t,e,a){var r=this._frameFloatArray.length;var i=this._parseTweenFrame(t,e,a);var n=tt.DataParser.VERTICES in t?t[tt.DataParser.VERTICES]:null;var s=J._getNumber(t,tt.DataParser.OFFSET,0);var o=this._intArray[this._mesh.geometry.offset+0];var l=this._mesh.parent.name+"_"+this._slot.name+"_"+this._mesh.name;var h=this._mesh.geometry.weight;var f=0;var u=0;var _=0;var m=0;if(h!==null){var p=this._weightSlotPose[l];this._helpMatrixA.copyFromArray(p,0);this._frameFloatArray.length+=h.count*2;_=h.offset+2+h.bones.length}else{this._frameFloatArray.length+=o*2}for(var c=0;c<o*2;c+=2){if(n===null){f=0;u=0}else{if(c<s||c-s>=n.length){f=0}else{f=n[c-s]}if(c+1<s||c+1-s>=n.length){u=0}else{u=n[c+1-s]}}if(h!==null){var d=this._weightBonePoses[l];var y=this._intArray[_++];this._helpMatrixA.transformPoint(f,u,this._helpPoint,true);f=this._helpPoint.x;u=this._helpPoint.y;for(var v=0;v<y;++v){var g=this._intArray[_++];this._helpMatrixB.copyFromArray(d,g*7+1);this._helpMatrixB.invert();this._helpMatrixB.transformPoint(f,u,this._helpPoint,true);this._frameFloatArray[r+m++]=this._helpPoint.x;this._frameFloatArray[r+m++]=this._helpPoint.y}}else{this._frameFloatArray[r+c]=f;this._frameFloatArray[r+c+1]=u}}if(e===0){var D=this._frameIntArray.length;this._frameIntArray.length+=1+1+1+1+1;this._frameIntArray[D+0]=this._mesh.geometry.offset;this._frameIntArray[D+1]=this._frameFloatArray.length-r;this._frameIntArray[D+2]=this._frameFloatArray.length-r;this._frameIntArray[D+3]=0;this._frameIntArray[D+4]=r-this._animation.frameFloatOffset;this._timelineArray[this._timeline.offset+3]=D-this._animation.frameIntOffset}return i};J.prototype._parseIKConstraintFrame=function(t,e,a){var r=this._parseTweenFrame(t,e,a);var i=this._frameIntArray.length;this._frameIntArray.length+=2;this._frameIntArray[i++]=J._getBoolean(t,tt.DataParser.BEND_POSITIVE,true)?1:0;this._frameIntArray[i++]=Math.round(J._getNumber(t,tt.DataParser.WEIGHT,1)*100);return r};J.prototype._parseActionData=function(t,e,a,r){var i=new Array;if(typeof t==="string"){var n=tt.BaseObject.borrowObject(tt.ActionData);n.type=e;n.name=t;n.bone=a;n.slot=r;i.push(n)}else if(t instanceof Array){for(var s=0,o=t;s<o.length;s++){var l=o[s];var n=tt.BaseObject.borrowObject(tt.ActionData);if(tt.DataParser.GOTO_AND_PLAY in l){n.type=0;n.name=J._getString(l,tt.DataParser.GOTO_AND_PLAY,"")}else{if(tt.DataParser.TYPE in l&&typeof l[tt.DataParser.TYPE]==="string"){n.type=tt.DataParser._getActionType(l[tt.DataParser.TYPE])}else{n.type=J._getNumber(l,tt.DataParser.TYPE,e)}n.name=J._getString(l,tt.DataParser.NAME,"")}if(tt.DataParser.BONE in l){var h=J._getString(l,tt.DataParser.BONE,"");n.bone=this._armature.getBone(h)}else{n.bone=a}if(tt.DataParser.SLOT in l){var f=J._getString(l,tt.DataParser.SLOT,"");n.slot=this._armature.getSlot(f)}else{n.slot=r}var u=null;if(tt.DataParser.INTS in l){if(u===null){u=tt.BaseObject.borrowObject(tt.UserData)}var _=l[tt.DataParser.INTS];for(var m=0,p=_;m<p.length;m++){var c=p[m];u.addInt(c)}}if(tt.DataParser.FLOATS in l){if(u===null){u=tt.BaseObject.borrowObject(tt.UserData)}var d=l[tt.DataParser.FLOATS];for(var y=0,v=d;y<v.length;y++){var c=v[y];u.addFloat(c)}}if(tt.DataParser.STRINGS in l){if(u===null){u=tt.BaseObject.borrowObject(tt.UserData)}var g=l[tt.DataParser.STRINGS];for(var D=0,b=g;D<b.length;D++){var c=b[D];u.addString(c)}}n.data=u;i.push(n)}}return i};J.prototype._parseDeformFrame=function(t,e,a){var r=this._frameFloatArray.length;var i=this._parseTweenFrame(t,e,a);var n=tt.DataParser.VERTICES in t?t[tt.DataParser.VERTICES]:tt.DataParser.VALUE in t?t[tt.DataParser.VALUE]:null;var s=J._getNumber(t,tt.DataParser.OFFSET,0);var o=this._intArray[this._geometry.offset+0];var l=this._geometry.weight;var h=0;var f=0;if(l!==null){}else{this._frameFloatArray.length+=o*2;for(var u=0;u<o*2;u+=2){if(n!==null){if(u<s||u-s>=n.length){h=0}else{h=n[u-s]}if(u+1<s||u+1-s>=n.length){f=0}else{f=n[u+1-s]}}else{h=0;f=0}this._frameFloatArray[r+u]=h;this._frameFloatArray[r+u+1]=f}}if(e===0){var _=this._frameIntArray.length;this._frameIntArray.length+=1+1+1+1+1;this._frameIntArray[_+0]=this._geometry.offset;this._frameIntArray[_+1]=this._frameFloatArray.length-r;this._frameIntArray[_+2]=this._frameFloatArray.length-r;this._frameIntArray[_+3]=0;this._frameIntArray[_+4]=r-this._animation.frameFloatOffset;this._timelineArray[this._timeline.offset+3]=_-this._animation.frameIntOffset}return i};J.prototype._parseTransform=function(t,e,a){e.x=J._getNumber(t,tt.DataParser.X,0)*a;e.y=J._getNumber(t,tt.DataParser.Y,0)*a;if(tt.DataParser.ROTATE in t||tt.DataParser.SKEW in t){e.rotation=tt.Transform.normalizeRadian(J._getNumber(t,tt.DataParser.ROTATE,0)*tt.Transform.DEG_RAD);e.skew=tt.Transform.normalizeRadian(J._getNumber(t,tt.DataParser.SKEW,0)*tt.Transform.DEG_RAD)}else if(tt.DataParser.SKEW_X in t||tt.DataParser.SKEW_Y in t){e.rotation=tt.Transform.normalizeRadian(J._getNumber(t,tt.DataParser.SKEW_Y,0)*tt.Transform.DEG_RAD);e.skew=tt.Transform.normalizeRadian(J._getNumber(t,tt.DataParser.SKEW_X,0)*tt.Transform.DEG_RAD)-e.rotation}e.scaleX=J._getNumber(t,tt.DataParser.SCALE_X,1);e.scaleY=J._getNumber(t,tt.DataParser.SCALE_Y,1)};J.prototype._parseColorTransform=function(t,e){e.alphaMultiplier=J._getNumber(t,tt.DataParser.ALPHA_MULTIPLIER,100)*.01;e.redMultiplier=J._getNumber(t,tt.DataParser.RED_MULTIPLIER,100)*.01;e.greenMultiplier=J._getNumber(t,tt.DataParser.GREEN_MULTIPLIER,100)*.01;e.blueMultiplier=J._getNumber(t,tt.DataParser.BLUE_MULTIPLIER,100)*.01;e.alphaOffset=J._getNumber(t,tt.DataParser.ALPHA_OFFSET,0);e.redOffset=J._getNumber(t,tt.DataParser.RED_OFFSET,0);e.greenOffset=J._getNumber(t,tt.DataParser.GREEN_OFFSET,0);e.blueOffset=J._getNumber(t,tt.DataParser.BLUE_OFFSET,0)};J.prototype._parseGeometry=function(t,e){var a=t[tt.DataParser.VERTICES];var r=Math.floor(a.length/2);var i=0;var n=this._intArray.length;var s=this._floatArray.length;e.offset=n;e.data=this._data;this._intArray.length+=1+1+1+1;this._intArray[n+0]=r;this._intArray[n+2]=s;this._intArray[n+3]=-1;this._floatArray.length+=r*2;for(var o=0,l=r*2;o<l;++o){this._floatArray[s+o]=a[o]}if(tt.DataParser.TRIANGLES in t){var h=t[tt.DataParser.TRIANGLES];i=Math.floor(h.length/3);this._intArray.length+=i*3;for(var o=0,l=i*3;o<l;++o){this._intArray[n+4+o]=h[o]}}this._intArray[n+1]=i;if(tt.DataParser.UVS in t){var f=t[tt.DataParser.UVS];var u=s+r*2;this._floatArray.length+=r*2;for(var o=0,l=r*2;o<l;++o){this._floatArray[u+o]=f[o]}}if(tt.DataParser.WEIGHTS in t){var _=t[tt.DataParser.WEIGHTS];var m=Math.floor(_.length-r)/2;var p=this._intArray.length;var c=this._floatArray.length;var d=0;var y=this._armature.sortedBones;var v=tt.BaseObject.borrowObject(tt.WeightData);v.count=m;v.offset=p;this._intArray.length+=1+1+d+r+m;this._intArray[p+1]=c;if(tt.DataParser.BONE_POSE in t){var g=t[tt.DataParser.SLOT_POSE];var D=t[tt.DataParser.BONE_POSE];var b=new Array;d=Math.floor(D.length/7);b.length=d;for(var o=0;o<d;++o){var T=D[o*7];var A=this._rawBones[T];v.addBone(A);b[o]=T;this._intArray[p+2+o]=y.indexOf(A)}this._floatArray.length+=m*3;this._helpMatrixA.copyFromArray(g,0);for(var o=0,P=0,O=p+2+d,S=c;o<r;++o){var x=o*2;var B=this._intArray[O++]=_[P++];var E=this._floatArray[s+x];var M=this._floatArray[s+x+1];this._helpMatrixA.transformPoint(E,M,this._helpPoint);E=this._helpPoint.x;M=this._helpPoint.y;for(var I=0;I<B;++I){var T=_[P++];var F=b.indexOf(T);this._helpMatrixB.copyFromArray(D,F*7+1);this._helpMatrixB.invert();this._helpMatrixB.transformPoint(E,M,this._helpPoint);this._intArray[O++]=F;this._floatArray[S++]=_[P++];this._floatArray[S++]=this._helpPoint.x;this._floatArray[S++]=this._helpPoint.y}}}else{var w=t[tt.DataParser.BONES];d=w.length;for(var o=0;o<d;o++){var T=w[o];var A=this._rawBones[T];v.addBone(A);this._intArray[p+2+o]=y.indexOf(A)}this._floatArray.length+=m*3;for(var o=0,P=0,S=0,O=p+2+d,C=c;o<m;o++){var B=_[P++];this._intArray[O++]=B;for(var I=0;I<B;I++){var F=_[P++];var N=_[P++];var E=a[S++];var M=a[S++];this._intArray[O++]=w.indexOf(F);this._floatArray[C++]=N;this._floatArray[C++]=E;this._floatArray[C++]=M}}}e.weight=v}};J.prototype._parseArray=function(t){t;this._intArray.length=0;this._floatArray.length=0;this._frameIntArray.length=0;this._frameFloatArray.length=0;this._frameArray.length=0;this._timelineArray.length=0;this._colorArray.length=0};J.prototype._modifyArray=function(){if(this._intArray.length%Int16Array.BYTES_PER_ELEMENT!==0){this._intArray.push(0)}if(this._frameIntArray.length%Int16Array.BYTES_PER_ELEMENT!==0){this._frameIntArray.push(0)}if(this._frameArray.length%Int16Array.BYTES_PER_ELEMENT!==0){this._frameArray.push(0)}if(this._timelineArray.length%Uint16Array.BYTES_PER_ELEMENT!==0){this._timelineArray.push(0)}if(this._timelineArray.length%Int16Array.BYTES_PER_ELEMENT!==0){this._colorArray.push(0)}var t=this._intArray.length*Int16Array.BYTES_PER_ELEMENT;var e=this._floatArray.length*Float32Array.BYTES_PER_ELEMENT;var a=this._frameIntArray.length*Int16Array.BYTES_PER_ELEMENT;var r=this._frameFloatArray.length*Float32Array.BYTES_PER_ELEMENT;var i=this._frameArray.length*Int16Array.BYTES_PER_ELEMENT;var n=this._timelineArray.length*Uint16Array.BYTES_PER_ELEMENT;var s=this._colorArray.length*Int16Array.BYTES_PER_ELEMENT;var o=t+e+a+r+i+n+s;var l=new ArrayBuffer(o);var h=new Int16Array(l,0,this._intArray.length);var f=new Float32Array(l,t,this._floatArray.length);var u=new Int16Array(l,t+e,this._frameIntArray.length);var _=new Float32Array(l,t+e+a,this._frameFloatArray.length);var m=new Int16Array(l,t+e+a+r,this._frameArray.length);var p=new Uint16Array(l,t+e+a+r+i,this._timelineArray.length);var c=new Int16Array(l,t+e+a+r+i+n,this._colorArray.length);for(var d=0,y=this._intArray.length;d<y;++d){h[d]=this._intArray[d]}for(var d=0,y=this._floatArray.length;d<y;++d){f[d]=this._floatArray[d]}for(var d=0,y=this._frameIntArray.length;d<y;++d){u[d]=this._frameIntArray[d]}for(var d=0,y=this._frameFloatArray.length;d<y;++d){_[d]=this._frameFloatArray[d]}for(var d=0,y=this._frameArray.length;d<y;++d){m[d]=this._frameArray[d]}for(var d=0,y=this._timelineArray.length;d<y;++d){p[d]=this._timelineArray[d]}for(var d=0,y=this._colorArray.length;d<y;++d){c[d]=this._colorArray[d]}this._data.binary=l;this._data.intArray=h;this._data.floatArray=f;this._data.frameIntArray=u;this._data.frameFloatArray=_;this._data.frameArray=m;this._data.timelineArray=p;this._data.colorArray=c;this._defaultColorOffset=-1};J.prototype.parseDragonBonesData=function(t,e){if(e===void 0){e=1}console.assert(t!==null&&t!==undefined,"Data error.");var a=J._getString(t,tt.DataParser.VERSION,"");var r=J._getString(t,tt.DataParser.COMPATIBLE_VERSION,"");if(tt.DataParser.DATA_VERSIONS.indexOf(a)>=0||tt.DataParser.DATA_VERSIONS.indexOf(r)>=0){var i=tt.BaseObject.borrowObject(tt.DragonBonesData);i.version=a;i.name=J._getString(t,tt.DataParser.NAME,"");i.frameRate=J._getNumber(t,tt.DataParser.FRAME_RATE,24);if(i.frameRate===0){i.frameRate=24}if(tt.DataParser.ARMATURE in t){this._data=i;this._parseArray(t);var n=t[tt.DataParser.ARMATURE];for(var s=0,o=n;s<o.length;s++){var l=o[s];i.addArmature(this._parseArmature(l,e))}if(!this._data.binary){this._modifyArray()}if(tt.DataParser.STAGE in t){i.stage=i.getArmature(J._getString(t,tt.DataParser.STAGE,""))}else if(i.armatureNames.length>0){i.stage=i.getArmature(i.armatureNames[0])}this._data=null}if(tt.DataParser.TEXTURE_ATLAS in t){this._rawTextureAtlases=t[tt.DataParser.TEXTURE_ATLAS]}return i}else{console.assert(false,"Nonsupport data version: "+a+"\n"+"Please convert DragonBones data to support version.\n"+"Read more: https://github.com/DragonBones/Tools/")}return null};J.prototype.parseTextureAtlasData=function(t,e,a){if(a===void 0){a=1}console.assert(t!==undefined);if(t===null){if(this._rawTextureAtlases===null||this._rawTextureAtlases.length===0){return false}var r=this._rawTextureAtlases[this._rawTextureAtlasIndex++];this.parseTextureAtlasData(r,e,a);if(this._rawTextureAtlasIndex>=this._rawTextureAtlases.length){this._rawTextureAtlasIndex=0;this._rawTextureAtlases=null}return true}e.width=J._getNumber(t,tt.DataParser.WIDTH,0);e.height=J._getNumber(t,tt.DataParser.HEIGHT,0);e.scale=a===1?1/J._getNumber(t,tt.DataParser.SCALE,1):a;e.name=J._getString(t,tt.DataParser.NAME,"");e.imagePath=J._getString(t,tt.DataParser.IMAGE_PATH,"");if(tt.DataParser.SUB_TEXTURE in t){var i=t[tt.DataParser.SUB_TEXTURE];for(var n=0,s=i.length;n<s;++n){var o=i[n];var l=J._getNumber(o,tt.DataParser.FRAME_WIDTH,-1);var h=J._getNumber(o,tt.DataParser.FRAME_HEIGHT,-1);var f=e.createTexture();f.rotated=J._getBoolean(o,tt.DataParser.ROTATED,false);f.name=J._getString(o,tt.DataParser.NAME,"");f.region.x=J._getNumber(o,tt.DataParser.X,0);f.region.y=J._getNumber(o,tt.DataParser.Y,0);f.region.width=J._getNumber(o,tt.DataParser.WIDTH,0);f.region.height=J._getNumber(o,tt.DataParser.HEIGHT,0);if(l>0&&h>0){f.frame=tt.TextureData.createRectangle();f.frame.x=J._getNumber(o,tt.DataParser.FRAME_X,0);f.frame.y=J._getNumber(o,tt.DataParser.FRAME_Y,0);f.frame.width=l;f.frame.height=h}e.addTexture(f)}}return true};J.getInstance=function(){if(J._objectDataParserInstance===null){J._objectDataParserInstance=new J}return J._objectDataParserInstance};J._objectDataParserInstance=null;return J}(tt.DataParser);tt.ObjectDataParser=t;var D=function(){function t(){this.frameStart=0;this.actions=[]}return t}();tt.ActionFrame=D})(dragonBones||(dragonBones={}));var dragonBones;(function(g){var t=function(o){__extends(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}t.prototype._inRange=function(t,e,a){return e<=t&&t<=a};t.prototype._decodeUTF8=function(t){var e=-1;var a=-1;var r=65533;var i=0;var n="";var s;var o=0;var l=0;var h=0;var f=0;while(t.length>i){var u=t[i++];if(u===e){if(l!==0){s=r}else{s=a}}else{if(l===0){if(this._inRange(u,0,127)){s=u}else{if(this._inRange(u,194,223)){l=1;f=128;o=u-192}else if(this._inRange(u,224,239)){l=2;f=2048;o=u-224}else if(this._inRange(u,240,244)){l=3;f=65536;o=u-240}else{}o=o*Math.pow(64,l);s=null}}else if(!this._inRange(u,128,191)){o=0;l=0;h=0;f=0;i--;s=u}else{h+=1;o=o+(u-128)*Math.pow(64,l-h);if(h!==l){s=null}else{var _=o;var m=f;o=0;l=0;h=0;f=0;if(this._inRange(_,m,1114111)&&!this._inRange(_,55296,57343)){s=_}else{s=u}}}}if(s!==null&&s!==a){if(s<=65535){if(s>0)n+=String.fromCharCode(s)}else{s-=65536;n+=String.fromCharCode(55296+(s>>10&1023));n+=String.fromCharCode(56320+(s&1023))}}}return n};t.prototype._parseBinaryTimeline=function(t,e,a){if(a===void 0){a=null}var r=a!==null?a:g.BaseObject.borrowObject(g.TimelineData);r.type=t;r.offset=e;this._timeline=r;var i=this._timelineArrayBuffer[r.offset+2];if(i===1){r.frameIndicesOffset=-1}else{var n=0;var s=this._animation.frameCount+1;var o=this._data.frameIndices;n=o.length;o.length+=s;r.frameIndicesOffset=n;for(var l=0,h=0,f=0,u=0;l<s;++l){if(f+u<=l&&h<i){f=this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[r.offset+5+h]];if(h===i-1){u=this._animation.frameCount-f}else{u=this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[r.offset+5+h+1]]-f}h++}o[n+l]=h-1}}this._timeline=null;return r};t.prototype._parseAnimation=function(t){var e=g.BaseObject.borrowObject(g.AnimationData);e.blendType=g.DataParser._getAnimationBlendType(g.ObjectDataParser._getString(t,g.DataParser.BLEND_TYPE,""));e.frameCount=g.ObjectDataParser._getNumber(t,g.DataParser.DURATION,0);e.playTimes=g.ObjectDataParser._getNumber(t,g.DataParser.PLAY_TIMES,1);e.duration=e.frameCount/this._armature.frameRate;e.fadeInTime=g.ObjectDataParser._getNumber(t,g.DataParser.FADE_IN_TIME,0);e.scale=g.ObjectDataParser._getNumber(t,g.DataParser.SCALE,1);e.name=g.ObjectDataParser._getString(t,g.DataParser.NAME,g.DataParser.DEFAULT_NAME);if(e.name.length===0){e.name=g.DataParser.DEFAULT_NAME}var a=t[g.DataParser.OFFSET];e.frameIntOffset=a[0];e.frameFloatOffset=a[1];e.frameOffset=a[2];this._animation=e;if(g.DataParser.ACTION in t){e.actionTimeline=this._parseBinaryTimeline(0,t[g.DataParser.ACTION])}if(g.DataParser.Z_ORDER in t){e.zOrderTimeline=this._parseBinaryTimeline(1,t[g.DataParser.Z_ORDER])}if(g.DataParser.BONE in t){var r=t[g.DataParser.BONE];for(var i in r){var n=r[i];var s=this._armature.getBone(i);if(s===null){continue}for(var o=0,l=n.length;o<l;o+=2){var h=n[o];var f=n[o+1];var u=this._parseBinaryTimeline(h,f);this._animation.addBoneTimeline(s.name,u)}}}if(g.DataParser.SLOT in t){var r=t[g.DataParser.SLOT];for(var i in r){var n=r[i];var _=this._armature.getSlot(i);if(_===null){continue}for(var o=0,l=n.length;o<l;o+=2){var h=n[o];var f=n[o+1];var u=this._parseBinaryTimeline(h,f);this._animation.addSlotTimeline(_.name,u)}}}if(g.DataParser.CONSTRAINT in t){var r=t[g.DataParser.CONSTRAINT];for(var i in r){var n=r[i];var m=this._armature.getConstraint(i);if(m===null){continue}for(var o=0,l=n.length;o<l;o+=2){var h=n[o];var f=n[o+1];var u=this._parseBinaryTimeline(h,f);this._animation.addConstraintTimeline(m.name,u)}}}if(g.DataParser.TIMELINE in t){var n=t[g.DataParser.TIMELINE];for(var p=0,c=n;p<c.length;p++){var d=c[p];var f=g.ObjectDataParser._getNumber(d,g.DataParser.OFFSET,0);if(f>=0){var h=g.ObjectDataParser._getNumber(d,g.DataParser.TYPE,0);var y=g.ObjectDataParser._getString(d,g.DataParser.NAME,"");var u=null;if(h===40&&e.blendType!==0){u=g.BaseObject.borrowObject(g.AnimationTimelineData);var v=u;v.x=g.ObjectDataParser._getNumber(d,g.DataParser.X,0);v.y=g.ObjectDataParser._getNumber(d,g.DataParser.Y,0)}u=this._parseBinaryTimeline(h,f,u);switch(h){case 0:break;case 1:break;case 11:case 12:case 13:case 50:case 60:this._animation.addBoneTimeline(y,u);break;case 20:case 21:case 22:case 23:case 24:this._animation.addSlotTimeline(y,u);break;case 30:this._animation.addConstraintTimeline(y,u);break;case 40:case 41:case 42:this._animation.addAnimationTimeline(y,u);break}}}}this._animation=null;return e};t.prototype._parseGeometry=function(t,e){e.offset=t[g.DataParser.OFFSET];e.data=this._data;var a=this._intArrayBuffer[e.offset+3];if(a<-1){a+=65536}if(a>=0){var r=g.BaseObject.borrowObject(g.WeightData);var i=this._intArrayBuffer[e.offset+0];var n=this._intArrayBuffer[a+0];r.offset=a;for(var s=0;s<n;++s){var o=this._intArrayBuffer[a+2+s];r.addBone(this._rawBones[o])}var l=a+2+n;var h=0;for(var s=0,f=i;s<f;++s){var u=this._intArrayBuffer[l++];h+=u;l+=u}r.count=h;e.weight=r}};t.prototype._parseArray=function(t){var e=t[g.DataParser.OFFSET];var a=e[1];var r=e[3];var i=e[5];var n=e[7];var s=e[9];var o=e[11];var l=e.length>12?e[13]:0;var h=new Int16Array(this._binary,this._binaryOffset+e[0],a/Int16Array.BYTES_PER_ELEMENT);var f=new Float32Array(this._binary,this._binaryOffset+e[2],r/Float32Array.BYTES_PER_ELEMENT);var u=new Int16Array(this._binary,this._binaryOffset+e[4],i/Int16Array.BYTES_PER_ELEMENT);var _=new Float32Array(this._binary,this._binaryOffset+e[6],n/Float32Array.BYTES_PER_ELEMENT);var m=new Int16Array(this._binary,this._binaryOffset+e[8],s/Int16Array.BYTES_PER_ELEMENT);var p=new Uint16Array(this._binary,this._binaryOffset+e[10],o/Uint16Array.BYTES_PER_ELEMENT);var c=l>0?new Int16Array(this._binary,this._binaryOffset+e[12],l/Uint16Array.BYTES_PER_ELEMENT):h;this._data.binary=this._binary;this._data.intArray=this._intArrayBuffer=h;this._data.floatArray=f;this._data.frameIntArray=u;this._data.frameFloatArray=_;this._data.frameArray=this._frameArrayBuffer=m;this._data.timelineArray=this._timelineArrayBuffer=p;this._data.colorArray=c};t.prototype.parseDragonBonesData=function(t,e){if(e===void 0){e=1}console.assert(t!==null&&t!==undefined&&t instanceof ArrayBuffer,"Data error.");var a=new Uint8Array(t,0,8);if(a[0]!=="D".charCodeAt(0)||a[1]!=="B".charCodeAt(0)||a[2]!=="D".charCodeAt(0)||a[3]!=="T".charCodeAt(0)){console.assert(false,"Nonsupport data.");return null}var r=new Uint32Array(t,8,1)[0];var i=new Uint8Array(t,8+4,r);var n=this._decodeUTF8(i);var s=JSON.parse(n);this._binaryOffset=8+4+r;this._binary=t;return o.prototype.parseDragonBonesData.call(this,s,e)};t.getInstance=function(){if(t._binaryDataParserInstance===null){t._binaryDataParserInstance=new t}return t._binaryDataParserInstance};t._binaryDataParserInstance=null;return t}(g.ObjectDataParser);g.BinaryDataParser=t})(dragonBones||(dragonBones={}));var dragonBones;(function(y){var t=function(){function s(t){if(t===void 0){t=null}this.autoSearch=false;this._dragonBonesDataMap={};this._textureAtlasDataMap={};this._dragonBones=null;this._dataParser=null;if(s._objectParser===null){s._objectParser=new y.ObjectDataParser}if(s._binaryParser===null){s._binaryParser=new y.BinaryDataParser}this._dataParser=t!==null?t:s._objectParser}s.prototype._isSupportMesh=function(){return true};s.prototype._getTextureData=function(t,e){if(t in this._textureAtlasDataMap){for(var a=0,r=this._textureAtlasDataMap[t];a<r.length;a++){var i=r[a];var n=i.getTexture(e);if(n!==null){return n}}}if(this.autoSearch){for(var s in this._textureAtlasDataMap){for(var o=0,l=this._textureAtlasDataMap[s];o<l.length;o++){var i=l[o];if(i.autoSearch){var n=i.getTexture(e);if(n!==null){return n}}}}}return null};s.prototype._fillBuildArmaturePackage=function(t,e,a,r,i){var n=null;var s=null;if(e.length>0){if(e in this._dragonBonesDataMap){n=this._dragonBonesDataMap[e];s=n.getArmature(a)}}if(s===null&&(e.length===0||this.autoSearch)){for(var o in this._dragonBonesDataMap){n=this._dragonBonesDataMap[o];if(e.length===0||n.autoSearch){s=n.getArmature(a);if(s!==null){e=o;break}}}}if(s!==null){t.dataName=e;t.textureAtlasName=i;t.data=n;t.armature=s;t.skin=null;if(r.length>0){t.skin=s.getSkin(r);if(t.skin===null&&this.autoSearch){for(var o in this._dragonBonesDataMap){var l=this._dragonBonesDataMap[o];var h=l.getArmature(r);if(h!==null){t.skin=h.defaultSkin;break}}}}if(t.skin===null){t.skin=s.defaultSkin}return true}return false};s.prototype._buildBones=function(t,e){for(var a=0,r=t.armature.sortedBones;a<r.length;a++){var i=r[a];var n=y.BaseObject.borrowObject(i.type===0?y.Bone:y.Surface);n.init(i,e)}};s.prototype._buildSlots=function(t,e){var a=t.skin;var r=t.armature.defaultSkin;if(a===null||r===null){return}var i={};for(var n in r.displays){var s=r.getDisplays(n);i[n]=s}if(a!==r){for(var n in a.displays){var s=a.getDisplays(n);i[n]=s}}for(var o=0,l=t.armature.sortedSlots;o<l.length;o++){var h=l[o];var f=h.name in i?i[h.name]:null;var u=this._buildSlot(t,h,e);if(f!==null){u.displayFrameCount=f.length;for(var _=0,m=u.displayFrameCount;_<m;++_){var p=f[_];u.replaceRawDisplayData(p,_);if(p!==null){if(t.textureAtlasName.length>0){var c=this._getTextureData(t.textureAtlasName,p.path);u.replaceTextureData(c,_)}var d=this._getSlotDisplay(t,p,u);u.replaceDisplay(d,_)}else{u.replaceDisplay(null)}}}u._setDisplayIndex(h.displayIndex,true)}};s.prototype._buildConstraints=function(t,e){var a=t.armature.constraints;for(var r in a){var i=a[r];switch(i.type){case 0:var n=y.BaseObject.borrowObject(y.IKConstraint);n.init(i,e);e._addConstraint(n);break;case 1:var s=y.BaseObject.borrowObject(y.PathConstraint);s.init(i,e);e._addConstraint(s);break;default:var o=y.BaseObject.borrowObject(y.IKConstraint);o.init(i,e);e._addConstraint(o);break}}};s.prototype._buildChildArmature=function(t,e,a){return this.buildArmature(a.path,t!==null?t.dataName:"","",t!==null?t.textureAtlasName:"")};s.prototype._getSlotDisplay=function(t,e,a){var r=t!==null?t.dataName:e.parent.parent.parent.name;var i=null;switch(e.type){case 0:{var n=e;if(n.texture===null){n.texture=this._getTextureData(r,e.path)}i=a.rawDisplay;break}case 2:{var s=e;if(s.texture===null){s.texture=this._getTextureData(r,s.path)}if(this._isSupportMesh()){i=a.meshDisplay}else{i=a.rawDisplay}break}case 1:{var o=e;var l=this._buildChildArmature(t,a,o);if(l!==null){l.inheritAnimation=o.inheritAnimation;if(!l.inheritAnimation){var h=o.actions.length>0?o.actions:l.armatureData.defaultActions;if(h.length>0){for(var f=0,u=h;f<u.length;f++){var _=u[f];var m=y.BaseObject.borrowObject(y.EventObject);y.EventObject.actionDataToInstance(_,m,a.armature);m.slot=a;a.armature._bufferAction(m,false)}}else{l.animation.play()}}o.armature=l.armatureData}i=l;break}case 3:break;default:break}return i};s.prototype.parseDragonBonesData=function(t,e,a){if(e===void 0){e=null}if(a===void 0){a=1}var r=t instanceof ArrayBuffer?s._binaryParser:this._dataParser;var i=r.parseDragonBonesData(t,a);while(true){var n=this._buildTextureAtlasData(null,null);if(r.parseTextureAtlasData(null,n,a)){this.addTextureAtlasData(n,e)}else{n.returnToPool();break}}if(i!==null){this.addDragonBonesData(i,e)}return i};s.prototype.parseTextureAtlasData=function(t,e,a,r){if(a===void 0){a=null}if(r===void 0){r=1}var i=this._buildTextureAtlasData(null,null);this._dataParser.parseTextureAtlasData(t,i,r);this._buildTextureAtlasData(i,e||null);this.addTextureAtlasData(i,a);return i};s.prototype.updateTextureAtlases=function(t,e){var a=this.getTextureAtlasData(e);if(a!==null){for(var r=0,i=a.length;r<i;++r){if(r<t.length){this._buildTextureAtlasData(a[r],t[r])}}}};s.prototype.getDragonBonesData=function(t){return t in this._dragonBonesDataMap?this._dragonBonesDataMap[t]:null};s.prototype.addDragonBonesData=function(t,e){if(e===void 0){e=null}e=e!==null?e:t.name;if(e in this._dragonBonesDataMap){if(this._dragonBonesDataMap[e]===t){return}console.warn("Can not add same name data: "+e);return}this._dragonBonesDataMap[e]=t};s.prototype.removeDragonBonesData=function(t,e){if(e===void 0){e=true}if(t in this._dragonBonesDataMap){if(e){this._dragonBones.bufferObject(this._dragonBonesDataMap[t])}delete this._dragonBonesDataMap[t]}};s.prototype.getTextureAtlasData=function(t){return t in this._textureAtlasDataMap?this._textureAtlasDataMap[t]:null};s.prototype.addTextureAtlasData=function(t,e){if(e===void 0){e=null}e=e!==null?e:t.name;var a=e in this._textureAtlasDataMap?this._textureAtlasDataMap[e]:this._textureAtlasDataMap[e]=[];if(a.indexOf(t)<0){a.push(t)}};s.prototype.removeTextureAtlasData=function(t,e){if(e===void 0){e=true}if(t in this._textureAtlasDataMap){var a=this._textureAtlasDataMap[t];if(e){for(var r=0,i=a;r<i.length;r++){var n=i[r];this._dragonBones.bufferObject(n)}}delete this._textureAtlasDataMap[t]}};s.prototype.getArmatureData=function(t,e){if(e===void 0){e=""}var a=new o;if(!this._fillBuildArmaturePackage(a,e,t,"","")){return null}return a.armature};s.prototype.clear=function(t){if(t===void 0){t=true}for(var e in this._dragonBonesDataMap){if(t){this._dragonBones.bufferObject(this._dragonBonesDataMap[e])}delete this._dragonBonesDataMap[e]}for(var e in this._textureAtlasDataMap){if(t){var a=this._textureAtlasDataMap[e];for(var r=0,i=a;r<i.length;r++){var n=i[r];this._dragonBones.bufferObject(n)}}delete this._textureAtlasDataMap[e]}};s.prototype.buildArmature=function(t,e,a,r){if(e===void 0){e=""}if(a===void 0){a=""}if(r===void 0){r=""}var i=new o;if(!this._fillBuildArmaturePackage(i,e||"",t,a||"",r||"")){console.warn("No armature data: "+t+", "+(e!==null?e:""));return null}var n=this._buildArmature(i);this._buildBones(i,n);this._buildSlots(i,n);this._buildConstraints(i,n);n.invalidUpdate(null,true);n.advanceTime(0);return n};s.prototype.replaceDisplay=function(t,e,a){if(a===void 0){a=-1}if(a<0){a=t.displayIndex}if(a<0){a=0}t.replaceDisplayData(e,a);if(e!==null){var r=this._getSlotDisplay(null,e,t);if(e.type===0){var i=t.getDisplayFrameAt(a).rawDisplayData;if(i!==null&&i.type===2){r=t.meshDisplay}}t.replaceDisplay(r,a)}else{t.replaceDisplay(null,a)}};s.prototype.replaceSlotDisplay=function(t,e,a,r,i,n){if(n===void 0){n=-1}var s=this.getArmatureData(e,t||"");if(s===null||s.defaultSkin===null){return false}var o=s.defaultSkin.getDisplay(a,r);this.replaceDisplay(i,o,n);return true};s.prototype.replaceSlotDisplayList=function(t,e,a,r){var i=this.getArmatureData(e,t||"");if(!i||!i.defaultSkin){return false}var n=i.defaultSkin.getDisplays(a);if(!n){return false}r.displayFrameCount=n.length;for(var s=0,o=r.displayFrameCount;s<o;++s){var l=n[s];this.replaceDisplay(r,l,s)}return true};s.prototype.replaceSkin=function(t,e,a,r){if(a===void 0){a=false}if(r===void 0){r=null}var i=false;var n=e.parent.defaultSkin;for(var s=0,o=t.getSlots();s<o.length;s++){var l=o[s];if(r!==null&&r.indexOf(l.name)>=0){continue}var h=e.getDisplays(l.name);if(h===null){if(n!==null&&e!==n){h=n.getDisplays(l.name)}if(h===null){if(a){l.displayFrameCount=0}continue}}l.displayFrameCount=h.length;for(var f=0,u=l.displayFrameCount;f<u;++f){var _=h[f];l.replaceRawDisplayData(_,f);if(_!==null){l.replaceDisplay(this._getSlotDisplay(null,_,l),f)}else{l.replaceDisplay(null,f)}}i=true}return i};s.prototype.replaceAnimation=function(t,e,a){if(a===void 0){a=true}var r=e.defaultSkin;if(r===null){return false}if(a){t.animation.animations=e.animations}else{var i=t.animation.animations;var n={};for(var s in i){n[s]=i[s]}for(var s in e.animations){n[s]=e.animations[s]}t.animation.animations=n}for(var o=0,l=t.getSlots();o<l.length;o++){var h=l[o];var f=0;for(var u=0,_=h.displayList;u<_.length;u++){var m=_[u];if(m instanceof y.Armature){var p=r.getDisplays(h.name);if(p!==null&&f<p.length){var c=p[f];if(c!==null&&c.type===1){var d=this.getArmatureData(c.path,c.parent.parent.parent.name);if(d){this.replaceAnimation(m,d,a)}}}}f++}}return true};s.prototype.getAllDragonBonesData=function(){return this._dragonBonesDataMap};s.prototype.getAllTextureAtlasData=function(){return this._textureAtlasDataMap};Object.defineProperty(s.prototype,"clock",{get:function(){return this._dragonBones.clock},enumerable:true,configurable:true});Object.defineProperty(s.prototype,"dragonBones",{get:function(){return this._dragonBones},enumerable:true,configurable:true});s._objectParser=null;s._binaryParser=null;return s}();y.BaseFactory=t;var o=function(){function t(){this.dataName="";this.textureAtlasName="";this.skin=null}return t}();y.BuildArmaturePackage=o})(dragonBones||(dragonBones={}));var dragonBones;(function(a){var t=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._renderTexture=null;return t}t.toString=function(){return"[class dragonBones.EgretTextureAtlasData]"};t.prototype._onClear=function(){e.prototype._onClear.call(this);if(this.disposeEnabled&&this._renderTexture!==null){this._renderTexture.dispose()}this.disposeEnabled=false;this._renderTexture=null};t.prototype.createTexture=function(){return a.BaseObject.borrowObject(r)};Object.defineProperty(t.prototype,"renderTexture",{get:function(){return this._renderTexture},set:function(t){if(this._renderTexture===t){return}this._renderTexture=t;if(this._renderTexture!==null){var e=this._renderTexture.bitmapData;var a=this.width>0?this.width:e.width;var r=this.height>0?this.height:e.height;for(var i in this.textures){var n=egret.$TextureScaleFactor;var s=this.textures[i];var o=s.region.width;var l=s.region.height;if(s.renderTexture===null){s.renderTexture=new egret.Texture}s.renderTexture.bitmapData=e;if(s.rotated){s.renderTexture.$initData(s.region.x*n,s.region.y*n,l*n,o*n,0,0,l*n,o*n,a,r,s.rotated)}else{s.renderTexture.$initData(s.region.x*n,s.region.y*n,o*n,l*n,0,0,o*n,l*n,a,r)}}}else{for(var i in this.textures){var s=this.textures[i];s.renderTexture=null}}},enumerable:true,configurable:true});return t}(a.TextureAtlasData);a.EgretTextureAtlasData=t;var r=function(e){__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.renderTexture=null;return t}t.toString=function(){return"[class dragonBones.EgretTextureData]"};t.prototype._onClear=function(){e.prototype._onClear.call(this);if(this.renderTexture!==null){}this.renderTexture=null};return t}(a.TextureData);a.EgretTextureData=r})(dragonBones||(dragonBones={}));var dragonBones;(function(w){var r=function(t){__extends(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}Object.defineProperty(e.prototype,"eventObject",{get:function(){return this.data},enumerable:true,configurable:true});return e}(egret.Event);w.EgretEvent=r;var t=function(g){__extends(e,g);function e(){var t=g!==null&&g.apply(this,arguments)||this;t.debugDraw=false;t._batchEnabled=!(global["nativeRender"]||global["bricks"]);t._childDirty=true;t._debugDraw=false;t._armature=null;t._bounds=null;t._debugDrawer=null;return t}e._cleanBeforeRender=function(){};e.prototype.dbInit=function(t){this._armature=t;if(this._batchEnabled){this.$renderNode=new egret.sys.GroupNode;this.$renderNode.cleanBeforeRender=e._cleanBeforeRender}};e.prototype.dbClear=function(){this._armature=null;this._bounds=null;this._debugDrawer=null};e.prototype.dbUpdate=function(){var t=w.DragonBones.debugDraw||this.debugDraw;if(t||this._debugDraw){this._debugDraw=t;if(this._debugDraw){if(this._debugDrawer===null){this._debugDrawer=new egret.Sprite}if(this._debugDrawer.parent!==this){this.addChild(this._debugDrawer)}var e=2;var a=this._debugDrawer.graphics;a.clear();for(var r=0,i=this._armature.getBones();r<i.length;r++){var n=i[r];if(n.boneData.type===0){var s=Math.max(n.boneData.length,e);var o=n.globalTransformMatrix.tx;var l=n.globalTransformMatrix.ty;var h=o-n.globalTransformMatrix.a*e;var f=l-n.globalTransformMatrix.b*e;var u=o+n.globalTransformMatrix.a*s;var _=l+n.globalTransformMatrix.b*s;var m=o+f-l;var p=l+h-o;var c=o-f+l;var d=l-h+o;a.lineStyle(2,65535,.7);a.moveTo(h,f);a.lineTo(u,_);a.moveTo(m,p);a.lineTo(c,d)}else{var y=n;var v=y._boneData;var g=v.segmentX;var D=v.segmentY;var b=y._vertices;a.lineStyle(2,16776960,.3);for(var T=0;T<D;++T){for(var A=0;A<g;++A){var P=(A+T*(g+1))*2;var O=b[P];var S=b[P+1];a.moveTo(O,S);a.lineTo(b[P+2],b[P+3]);a.moveTo(O,S);a.lineTo(b[P+(g+1)*2],b[P+(g+1)*2+1]);if(A===g-1){a.moveTo(b[P+2],b[P+3]);a.lineTo(b[P+(g+2)*2],b[P+(g+2)*2+1])}if(T===D-1){a.moveTo(b[P+(g+1)*2],b[P+(g+1)*2+1]);a.lineTo(b[P+(g+2)*2],b[P+(g+2)*2+1])}}}}}for(var x=0,B=this._armature.getSlots();x<B.length;x++){var E=B[x];var M=E.boundingBoxData;if(M!==null){var I=this._debugDrawer.getChildByName(E.name);if(I===null){I=new egret.Shape;I.name=E.name;this._debugDrawer.addChild(I)}I.graphics.clear();I.graphics.lineStyle(2,16711935,.7);switch(M.type){case 0:I.graphics.drawRect(-M.width*.5,-M.height*.5,M.width,M.height);break;case 1:I.graphics.drawEllipse(-M.width*.5,-M.height*.5,M.width,M.height);break;case 2:var b=M.vertices;for(var F=0;F<b.length;F+=2){var O=b[F];var S=b[F+1];if(F===0){I.graphics.moveTo(O,S)}else{I.graphics.lineTo(O,S)}}I.graphics.lineTo(b[0],b[1]);break;default:break}E.updateTransformAndMatrix();E.updateGlobalTransform();I.$setMatrix(E.globalTransformMatrix,false)}else{var I=this._debugDrawer.getChildByName(E.name);if(I!==null){this._debugDrawer.removeChild(I)}}}}else if(this._debugDrawer!==null&&this._debugDrawer.parent===this){this.removeChild(this._debugDrawer)}}if(!w.isV5&&this._batchEnabled&&this._childDirty){this.$invalidateContentBounds()}};e.prototype.dispose=function(t){if(t===void 0){t=true}t;if(this._armature!==null){this._armature.dispose();this._armature=null}};e.prototype.dispatchDBEvent=function(t,e){var a=egret.Event.create(r,t);a.data=e;g.prototype.dispatchEvent.call(this,a);egret.Event.release(a)};e.prototype.hasDBEventListener=function(t){return this.hasEventListener(t)};e.prototype.addDBEventListener=function(t,e,a){this.addEventListener(t,e,a)};e.prototype.removeDBEventListener=function(t,e,a){this.removeEventListener(t,e,a)};e.prototype.disableBatch=function(){if(!this._batchEnabled||!this._armature){return}for(var t=0,e=this._armature.getSlots();t<e.length;t++){var a=e[t];var r=a._geometryData?a.meshDisplay:a.rawDisplay;if(!a.display&&r===a.meshDisplay){r=a.rawDisplay}var i=r.$renderNode;if(i.matrix){r.$setMatrix(a.globalTransformMatrix,false)}i.alpha=1;i.filter=null;this.addChild(r)}this._batchEnabled=false;this.$renderNode.cleanBeforeRender=null;this.$renderNode=null;this.armature.invalidUpdate(null,true)};Object.defineProperty(e.prototype,"armature",{get:function(){return this._armature},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"animation",{get:function(){return this._armature.animation},enumerable:true,configurable:true});e.prototype.$measureContentBounds=function(t){if(this._batchEnabled&&this._armature){if(this._childDirty){this._childDirty=false;var e=true;var a=new egret.Rectangle;for(var r=0,i=this._armature.getSlots();r<i.length;r++){var n=i[r];var s=n.display;if(!s||!s.$renderNode||!s.$renderNode.image){continue}var o=s.$renderNode.matrix;if(s===n.meshDisplay){var l=s.$renderNode.vertices;if(l&&l.length>0){a.setTo(999999,999999,-999999,-999999);for(var h=0,f=l.length;h<f;h+=2){var u=l[h];var _=l[h+1];if(a.x>u)a.x=u;if(a.width<u)a.width=u;if(a.y>_)a.y=_;if(a.height<_)a.height=_}a.width-=a.x;a.height-=a.y}else{continue}}else if(n._displayFrame){var m=n._displayFrame.getTextureData();if(m){var p=m.parent.scale;a.x=0;a.y=0;a.width=m.region.width*p;a.height=m.region.height*p}else{continue}}o.$transformBounds(a);var c=a.x;var d=a.y;var y=a.x+a.width;var v=a.y+a.height;if(e){e=false;t.x=c;t.y=d;t.width=y;t.height=v}else{if(c<t.x){t.x=c}if(d<t.y){t.y=d}if(y>t.width){t.width=y}if(v>t.height){t.height=v}}}t.width-=t.x;t.height-=t.y;if(w.isV5){if(this._bounds===null){this._bounds=new egret.Rectangle}this._bounds.copyFrom(t)}}else if(w.isV5){if(this._bounds===null){this._bounds=new egret.Rectangle}t.copyFrom(this._bounds)}return t}return g.prototype.$measureContentBounds.call(this,t)};e.prototype.createNativeDisplayObject=function(){if(egret_native.NativeCreateArmatureDisplay){this.$nativeDisplayObject=egret_native.NativeCreateArmatureDisplay()}else{g.prototype.createNativeDisplayObject.call(this)}};return e}(egret.DisplayObjectContainer);w.EgretArmatureDisplay=t})(dragonBones||(dragonBones={}));var dragonBones;(function(w){var t=function(i){__extends(t,i);function t(){var t=i!==null&&i.apply(this,arguments)||this;t.transformUpdateEnabled=false;t._armatureDisplay=null;t._renderDisplay=null;t._colorFilter=null;return t}t.toString=function(){return"[class dragonBones.EgretSlot]"};t.prototype.init=function(t,e,a,r){i.prototype.init.call(this,t,e,a,r);if(w.isV5){this._updateTransform=this._updateTransformV5}else{this._updateTransform=this._updateTransformV4}};t.prototype._onClear=function(){i.prototype._onClear.call(this);this._armatureDisplay=null;this._renderDisplay=null;this._colorFilter=null};t.prototype._initDisplay=function(t,e){t;e};t.prototype._disposeDisplay=function(t,e){t;e};t.prototype._onUpdateDisplay=function(){this._armatureDisplay=this._armature.display;this._renderDisplay=this._display!==null?this._display:this._rawDisplay;if(w.isV5&&this._armatureDisplay._batchEnabled){if(this._renderDisplay===this._rawDisplay&&!(this._renderDisplay.$renderNode instanceof egret.sys.BitmapNode)){this._renderDisplay.$renderNode=new egret.sys.BitmapNode}}if(this._armatureDisplay._batchEnabled){if(this._renderDisplay!==this._rawDisplay&&this._renderDisplay!==this._meshDisplay){this._armatureDisplay.disableBatch()}else{var t=this._renderDisplay.$renderNode;if(!t.matrix){t.matrix=new egret.Matrix}}}};t.prototype._addDisplay=function(){if(this._armatureDisplay._batchEnabled){this._armatureDisplay.$renderNode.addNode(this._renderDisplay.$renderNode)}else{this._armatureDisplay.addChild(this._renderDisplay)}};t.prototype._replaceDisplay=function(t){var e=t;if(this._armatureDisplay._batchEnabled){var a=this._armatureDisplay.$renderNode.drawData;var r=a.indexOf(e.$renderNode);a[r]=this._renderDisplay.$renderNode}else{this._armatureDisplay.addChild(this._renderDisplay);this._armatureDisplay.swapChildren(this._renderDisplay,e);this._armatureDisplay.removeChild(e)}};t.prototype._removeDisplay=function(){if(this._armatureDisplay._batchEnabled){var t=this._armatureDisplay.$renderNode.drawData;t.splice(t.indexOf(this._renderDisplay.$renderNode),1)}else{this._renderDisplay.parent.removeChild(this._renderDisplay)}};t.prototype._updateZOrder=function(){if(this._armatureDisplay._batchEnabled){var t=this._armatureDisplay.$renderNode.drawData;var e=t.indexOf(this._renderDisplay.$renderNode);if(e===this._zOrder){return}t[this._zOrder]=this._renderDisplay.$renderNode}else{var e=this._armatureDisplay.getChildIndex(this._renderDisplay);if(e===this._zOrder){return}this._armatureDisplay.addChildAt(this._renderDisplay,this._zOrder)}};t.prototype._updateVisible=function(){var t=this._parent.visible&&this._visible;if(this._armatureDisplay._batchEnabled){var e=this._renderDisplay.$renderNode;e.alpha=t?1:0}else{this._renderDisplay.visible=t}};t.prototype._updateBlendMode=function(){switch(this._blendMode){case 0:this._renderDisplay.blendMode=egret.BlendMode.NORMAL;break;case 1:this._renderDisplay.blendMode=egret.BlendMode.ADD;break;case 5:this._renderDisplay.blendMode=egret.BlendMode.ERASE;break;default:break}if(this._armatureDisplay._batchEnabled){var t=this._renderDisplay.$renderNode;t.blendMode=egret.sys.blendModeToNumber(this._renderDisplay.blendMode)}};t.prototype._updateColor=function(){var t=this._colorTransform.alphaMultiplier*this._globalAlpha;if(this._colorTransform.redMultiplier!==1||this._colorTransform.greenMultiplier!==1||this._colorTransform.blueMultiplier!==1||this._colorTransform.redOffset!==0||this._colorTransform.greenOffset!==0||this._colorTransform.blueOffset!==0||this._colorTransform.alphaOffset!==0){if(this._colorFilter===null){this._colorFilter=new egret.ColorMatrixFilter}var e=this._colorFilter.matrix;e[0]=this._colorTransform.redMultiplier;e[6]=this._colorTransform.greenMultiplier;e[12]=this._colorTransform.blueMultiplier;e[18]=t;e[4]=this._colorTransform.redOffset;e[9]=this._colorTransform.greenOffset;e[14]=this._colorTransform.blueOffset;e[19]=this._colorTransform.alphaOffset;this._colorFilter.matrix=e;if(this._armatureDisplay._batchEnabled){var a=this._renderDisplay.$renderNode;a.filter=this._colorFilter;a.alpha=1}var r=this._renderDisplay.filters;if(!r){r=[]}if(r.indexOf(this._colorFilter)<0){r.push(this._colorFilter)}this._renderDisplay.filters=r;this._renderDisplay.alpha=1}else{if(this._armatureDisplay._batchEnabled){var a=this._renderDisplay.$renderNode;a.filter=null;a.alpha=t}this._renderDisplay.filters=null;this._renderDisplay.alpha=t}};t.prototype._updateFrame=function(){var t=this._textureData;if(this._displayFrame!==null&&this._display!==null&&t!==null){var e=t.parent;if(this._armature.replacedTexture!==null){if(this._armature._replaceTextureAtlasData===null){e=w.BaseObject.borrowObject(w.EgretTextureAtlasData);e.copyFrom(t.parent);e.renderTexture=this._armature.replacedTexture;this._armature._replaceTextureAtlasData=e}else{e=this._armature._replaceTextureAtlasData}t=e.getTexture(t.name)}if(t.renderTexture!==null){if(this._geometryData!==null){var a=this._geometryData.data;var r=a.intArray;var i=a.floatArray;var n=r[this._geometryData.offset+0];var s=r[this._geometryData.offset+1];var o=r[this._geometryData.offset+2];if(o<0){o+=65536}var l=o+n*2;var h=this._armature._armatureData.scale;var f=this._renderDisplay;var u=f.$renderNode;u.uvs.length=n*2;u.vertices.length=n*2;u.indices.length=s*3;for(var _=0,m=n*2;_<m;++_){u.vertices[_]=i[o+_]*h;u.uvs[_]=i[l+_]}for(var _=0;_<s*3;++_){u.indices[_]=r[this._geometryData.offset+4+_]}if(this._armatureDisplay._batchEnabled){var p=t.renderTexture;var c=this._renderDisplay.$renderNode;egret.sys.RenderNode.prototype.cleanBeforeRender.call(c);c.image=p.bitmapData;if(w.isV5){c.drawMesh(p.$bitmapX,p.$bitmapY,p.$bitmapWidth,p.$bitmapHeight,p.$offsetX,p.$offsetY,p.textureWidth,p.textureHeight);c.imageWidth=p.$sourceWidth;c.imageHeight=p.$sourceHeight}else{var d=p;c.drawMesh(d._bitmapX,d._bitmapY,d._bitmapWidth,d._bitmapHeight,d._offsetX,d._offsetY,d.textureWidth,d.textureHeight);c.imageWidth=d._sourceWidth;c.imageHeight=d._sourceHeight}this._blendModeDirty=true;this._colorDirty=true}f.texture=t.renderTexture;f.anchorOffsetX=this._pivotX;f.anchorOffsetY=this._pivotY;f.$updateVertices();if(!w.isV5){f.$invalidateTransform()}var y=this._geometryData.weight!==null;var v=this._parent._boneData.type!==0;if(y||v){this._identityTransform()}}else{var h=t.parent.scale*this._armature._armatureData.scale;var g=(t.rotated?t.region.height:t.region.width)*h;var D=(t.rotated?t.region.width:t.region.height)*h;var b=this._renderDisplay;var p=t.renderTexture;b.texture=p;if(this._armatureDisplay._batchEnabled){var c=this._renderDisplay.$renderNode;egret.sys.RenderNode.prototype.cleanBeforeRender.call(c);c.image=p.bitmapData;if(w.isV5){c.drawImage(p.$bitmapX,p.$bitmapY,p.$bitmapWidth,p.$bitmapHeight,p.$offsetX,p.$offsetY,g,D);c.imageWidth=p.$sourceWidth;c.imageHeight=p.$sourceHeight}else{var d=p;c.drawImage(d._bitmapX,d._bitmapY,d._bitmapWidth,d._bitmapHeight,d._offsetX,d._offsetY,g,D);c.imageWidth=d._sourceWidth;c.imageHeight=d._sourceHeight}this._blendModeDirty=true;this._colorDirty=true}else{b.width=g;b.height=D}b.anchorOffsetX=this._pivotX;b.anchorOffsetY=this._pivotY}this._visibleDirty=true;return}}if(this._armatureDisplay._batchEnabled){this._renderDisplay.$renderNode.image=null}var T=this._renderDisplay;T.texture=null;T.x=0;T.y=0;T.visible=false};t.prototype._updateMesh=function(){var t=this._armature._armatureData.scale;var e=this._displayFrame.deformVertices;var a=this._geometryBones;var r=this._geometryData;var i=r.weight;var n=e.length>0&&r.inheritDeform;var s=this._renderDisplay;var o=s.$renderNode;if(i!==null){var l=r.data;var h=l.intArray;var f=l.floatArray;var u=h[r.offset+0];var _=h[i.offset+1];if(_<0){_+=65536}for(var m=0,p=0,c=i.offset+2+a.length,d=_,y=0;m<u;++m){var v=h[c++];var g=0,D=0;for(var b=0;b<v;++b){var T=h[c++];var A=a[T];if(A!==null){var P=A.globalTransformMatrix;var O=f[d++];var S=f[d++]*t;var x=f[d++]*t;if(n){S+=e[y++];x+=e[y++]}g+=(P.a*S+P.c*x+P.tx)*O;D+=(P.b*S+P.d*x+P.ty)*O}}o.vertices[p++]=g;o.vertices[p++]=D}s.$updateVertices();if(!w.isV5){s.$invalidateTransform()}}else{var B=this._parent._boneData.type!==0;var l=r.data;var h=l.intArray;var f=l.floatArray;var u=h[r.offset+0];var E=h[r.offset+2];if(E<0){E+=65536}for(var m=0,M=u*2;m<M;m+=2){var I=f[E+m]*t;var F=f[E+m+1]*t;if(n){I+=e[m];F+=e[m+1]}if(B){var P=this._parent._getGlobalTransformMatrix(I,F);o.vertices[m]=P.a*I+P.c*F+P.tx;o.vertices[m+1]=P.b*I+P.d*F+P.ty}else{o.vertices[m]=I;o.vertices[m+1]=F}}s.$updateVertices();if(!w.isV5){s.$invalidateTransform()}}if(this._armatureDisplay._batchEnabled){this._armatureDisplay._childDirty=true}};t.prototype._updateTransform=function(){throw new Error};t.prototype._identityTransform=function(){if(this._armatureDisplay._batchEnabled){this._armatureDisplay._childDirty=true;var t=this._renderDisplay.$renderNode.matrix;t.a=1;t.b=0;t.c=0;t.d=1;t.tx=0;t.ty=0}else{egret.$TempMatrix.identity();this._renderDisplay.$setMatrix(egret.$TempMatrix,this.transformUpdateEnabled)}};t.prototype._updateTransformV4=function(){var t=this.globalTransformMatrix;if(this._armatureDisplay._batchEnabled){this._armatureDisplay._childDirty=true;var e=this._renderDisplay.$renderNode.matrix;e.a=t.a;e.b=t.b;e.c=t.c;e.d=t.d;e.tx=this.globalTransformMatrix.tx-(this.globalTransformMatrix.a*this._pivotX+this.globalTransformMatrix.c*this._pivotY);e.ty=this.globalTransformMatrix.ty-(this.globalTransformMatrix.b*this._pivotX+this.globalTransformMatrix.d*this._pivotY)}else if(this.transformUpdateEnabled){this._renderDisplay.$setMatrix(t,true)}else{var a=this._renderDisplay.$DisplayObject;var e=a[6];e.a=this.globalTransformMatrix.a;e.b=this.globalTransformMatrix.b;e.c=this.globalTransformMatrix.c;e.d=this.globalTransformMatrix.d;e.tx=this.globalTransformMatrix.tx;e.ty=this.globalTransformMatrix.ty;this._renderDisplay.$removeFlags(8);this._renderDisplay.$invalidatePosition()}};t.prototype._updateTransformV5=function(){var t=this.globalTransformMatrix;if(this._armatureDisplay._batchEnabled){this._armatureDisplay._childDirty=true;var e=this._renderDisplay.$renderNode.matrix;e.a=t.a;e.b=t.b;e.c=t.c;e.d=t.d;e.tx=this.globalTransformMatrix.tx-(this.globalTransformMatrix.a*this._pivotX+this.globalTransformMatrix.c*this._pivotY);e.ty=this.globalTransformMatrix.ty-(this.globalTransformMatrix.b*this._pivotX+this.globalTransformMatrix.d*this._pivotY)}else{this._renderDisplay.$setMatrix(t,this.transformUpdateEnabled)}};return t}(w.Slot);w.EgretSlot=t})(dragonBones||(dragonBones={}));var dragonBones;(function(n){n.isV5=Number(egret.Capabilities.engineVersion.substr(0,3))>=5.1;var t=function(r){__extends(i,r);function i(t){if(t===void 0){t=null}var e=r.call(this,t)||this;if(i._dragonBonesInstance===null){var a=new n.EgretArmatureDisplay;i._dragonBonesInstance=new n.DragonBones(a);i._time=egret.getTimer()*.001;egret.startTick(i._clockHandler,i)}e._dragonBones=i._dragonBonesInstance;return e}i._clockHandler=function(t){t*=.001;var e=t-this._time;this._dragonBonesInstance.advanceTime(e);this._time=t;return false};Object.defineProperty(i,"factory",{get:function(){if(this._factory===null){this._factory=new i}return this._factory},enumerable:true,configurable:true});i.prototype._isSupportMesh=function(){if(egret.Capabilities.renderMode==="webgl"||egret.Capabilities.runtimeType===egret.RuntimeType.NATIVE){return true}console.warn("Canvas can not support mesh, please change renderMode to webgl.");return false};i.prototype._buildTextureAtlasData=function(t,e){if(t!==null){if(e instanceof egret.Texture){t.renderTexture=e}else if(e){var a=new egret.Texture;a.bitmapData=new egret.BitmapData(e);t.disposeEnabled=true;t.renderTexture=a}}else{t=n.BaseObject.borrowObject(n.EgretTextureAtlasData)}return t};i.prototype._buildArmature=function(t){var e=n.BaseObject.borrowObject(n.Armature);var a=new n.EgretArmatureDisplay;e.init(t.armature,a,a,this._dragonBones);return e};i.prototype._buildSlot=function(t,e,a){var r=n.BaseObject.borrowObject(n.EgretSlot);r.init(e,a,new egret.Bitmap,new egret.Mesh);return r};i.prototype.buildArmatureDisplay=function(t,e,a,r){if(e===void 0){e=""}if(a===void 0){a=""}if(r===void 0){r=""}var i=this.buildArmature(t,e||"",a||"",r||"");if(i!==null){this._dragonBones.clock.add(i);return i.display}return null};i.prototype.getTextureDisplay=function(t,e){if(e===void 0){e=null}var a=this._getTextureData(e!==null?e:"",t);if(a!==null&&a.renderTexture!==null){var r=a.renderTexture;var i=new egret.Bitmap(r);i.width=r.textureWidth*a.parent.scale;i.height=r.textureHeight*a.parent.scale;return i}return null};Object.defineProperty(i.prototype,"soundEventManager",{get:function(){return this._dragonBones.eventManager},enumerable:true,configurable:true});i._time=0;i._dragonBonesInstance=null;i._factory=null;return i}(n.BaseFactory);n.EgretFactory=t})(dragonBones||(dragonBones={}));

 //js/game.min_fc12b653.js
var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);r.prototype=e.prototype,t.prototype=new r},egret;!function(t){var e=function(){function t(){}return t.BINARY="binary",t.TEXT="text",t.VARIABLES="variables",t.TEXTURE="texture",t.SOUND="sound",t}();t.URLLoaderDataFormat=e,__reflect(e.prototype,"egret.URLLoaderDataFormat")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,r,i){var o=t.call(this)||this;return o._name=e,o._frame=0|r,i&&(o._end=0|i),o}return __extends(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._end},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._name,this._frame,this._end)},e}(t.EventDispatcher);t.FrameLabel=e,__reflect(e.prototype,"egret.FrameLabel")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var t=e.call(this)||this;return t.$mcData=null,t.numFrames=1,t.frames=[],t.labels=null,t.events=[],t.frameRate=0,t.textureData=null,t.spriteSheet=null,t}return __extends(r,e),r.prototype.$init=function(t,e,r){this.textureData=e,this.spriteSheet=r,this.setMCData(t)},r.prototype.getKeyFrameData=function(t){var e=this.frames[t-1];return e.frame&&(e=this.frames[e.frame-1]),e},r.prototype.getTextureByFrame=function(t){var e=this.getKeyFrameData(t);if(e.res){var r=this.getTextureByResName(e.res);return r}return null},r.prototype.$getOffsetByFrame=function(t,e){var r=this.getKeyFrameData(t);r.res&&e.setTo(0|r.x,0|r.y)},r.prototype.getTextureByResName=function(t){if(null==this.spriteSheet)return null;var e=this.spriteSheet.getTexture(t);if(!e){var r=this.textureData[t];e=this.spriteSheet.createTexture(t,r.x,r.y,r.w,r.h)}return e},r.prototype.$isDataValid=function(){return this.frames.length>0},r.prototype.$isTextureValid=function(){return null!=this.textureData&&null!=this.spriteSheet},r.prototype.$fillMCData=function(t){this.frameRate=t.frameRate||24,this.fillFramesData(t.frames),this.fillFrameLabelsData(t.labels),this.fillFrameEventsData(t.events)},r.prototype.fillFramesData=function(t){for(var e,r=this.frames,i=t?t.length:0,o=0;i>o;o++){var n=t[o];if(r.push(n),n.duration){var s=parseInt(n.duration);if(s>1){e=r.length;for(var a=1;s>a;a++)r.push({frame:e})}}}this.numFrames=r.length},r.prototype.fillFrameLabelsData=function(e){if(e){var r=e.length;if(r>0){this.labels=[];for(var i=0;r>i;i++){var o=e[i];this.labels.push(new t.FrameLabel(o.name,o.frame,o.end))}}}},r.prototype.fillFrameEventsData=function(t){if(t){var e=t.length;if(e>0){this.events=[];for(var r=0;e>r;r++){var i=t[r];this.events[i.frame]=i.name}}}},Object.defineProperty(r.prototype,"mcData",{get:function(){return this.$mcData},set:function(t){this.setMCData(t)},enumerable:!0,configurable:!0}),r.prototype.setMCData=function(t){this.$mcData!=t&&(this.$mcData=t,t&&this.$fillMCData(t))},r}(t.HashObject);t.MovieClipData=e,__reflect(e.prototype,"egret.MovieClipData")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r){var i=e.call(this)||this;return i.enableCache=!0,i.$mcDataCache={},i.$mcDataSet=t,i.setTexture(r),i}return __extends(r,e),r.prototype.clearCache=function(){this.$mcDataCache={}},r.prototype.generateMovieClipData=function(e){if(void 0===e&&(e=""),""==e&&this.$mcDataSet)for(e in this.$mcDataSet.mc)break;if(""==e)return null;var r=this.findFromCache(e,this.$mcDataCache);return r||(r=new t.MovieClipData,this.fillData(e,r,this.$mcDataCache)),r},r.prototype.findFromCache=function(t,e){return this.enableCache&&e[t]?e[t]:null},r.prototype.fillData=function(t,e,r){if(this.$mcDataSet){var i=this.$mcDataSet.mc[t];i&&(e.$init(i,this.$mcDataSet.res,this.$spriteSheet),this.enableCache&&(r[t]=e))}},Object.defineProperty(r.prototype,"mcDataSet",{get:function(){return this.$mcDataSet},set:function(t){this.$mcDataSet=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"texture",{set:function(t){this.setTexture(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"spriteSheet",{get:function(){return this.$spriteSheet},enumerable:!0,configurable:!0}),r.prototype.setTexture=function(e){this.$spriteSheet=e?new t.SpriteSheet(e):null},r}(t.EventDispatcher);t.MovieClipDataFactory=e,__reflect(e.prototype,"egret.MovieClipDataFactory")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(t,r,i,o){void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===o&&(o=null);var n=e.call(this,t,r,i)||this;return n.frameLabel=null,n.frameLabel=o,n}return __extends(r,e),r.dispatchMovieClipEvent=function(e,i,o){void 0===o&&(o=null);var n=t.Event.create(r,i);n.frameLabel=o;var s=e.dispatchEvent(n);return t.Event.release(n),s},r.FRAME_LABEL="frame_label",r}(t.Event);t.MovieClipEvent=e,__reflect(e.prototype,"egret.MovieClipEvent")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){t.$error(1014)}return e.get=function(t){return-1>t&&(t=-1),t>1&&(t=1),function(e){return 0==t?e:0>t?e*(e*-t+1+t):e*((2-e)*t+(1-t))}},e.getPowOut=function(t){return function(e){return 1-Math.pow(1-e,t)}},e.quintOut=e.getPowOut(5),e.quartOut=e.getPowOut(4),e}();t.ScrollEase=e,__reflect(e.prototype,"egret.ScrollEase");var r=function(e){function r(t,r,i){var o=e.call(this)||this;return o._target=null,o._useTicks=!1,o.ignoreGlobalPause=!1,o.loop=!1,o.pluginData=null,o._steps=null,o._actions=null,o.paused=!1,o.duration=0,o._prevPos=-1,o.position=null,o._prevPosition=0,o._stepPosition=0,o.passive=!1,o.initialize(t,r,i),o}return __extends(r,e),r.get=function(t,e,i,o){return void 0===e&&(e=null),void 0===i&&(i=null),void 0===o&&(o=!1),o&&r.removeTweens(t),new r(t,e,i)},r.removeTweens=function(t){if(t.tween_count){for(var e=r._tweens,i=e.length-1;i>=0;i--)e[i]._target==t&&(e[i].paused=!0,e.splice(i,1));t.tween_count=0}},r.tick=function(t,e){void 0===e&&(e=!1);var i=t-r._lastTime;r._lastTime=t;for(var o=r._tweens.concat(),n=o.length-1;n>=0;n--){var s=o[n];e&&!s.ignoreGlobalPause||s.paused||s.tick(s._useTicks?1:i)}return!1},r._register=function(e,i){var o=e._target,n=r._tweens;if(i)o&&(o.tween_count=o.tween_count>0?o.tween_count+1:1),n.push(e),r._inited||(r._lastTime=t.getTimer(),t.ticker.$startTick(r.tick,null),r._inited=!0);else{o&&o.tween_count--;for(var s=n.length;s--;)if(n[s]==e)return void n.splice(s,1)}},r.prototype.initialize=function(t,e,i){this._target=t,e&&(this._useTicks=e.useTicks,this.ignoreGlobalPause=e.ignoreGlobalPause,this.loop=e.loop,e.onChange&&this.addEventListener("change",e.onChange,e.onChangeObj),e.override&&r.removeTweens(t)),this.pluginData=i||{},this._curQueueProps={},this._initQueueProps={},this._steps=[],this._actions=[],e&&e.paused?this.paused=!0:r._register(this,!0),e&&null!=e.position&&this.setPosition(e.position)},r.prototype.setPosition=function(t,e){void 0===e&&(e=1),0>t&&(t=0);var r=t,i=!1;if(r>=this.duration&&(this.loop?r%=this.duration:(r=this.duration,i=!0)),r==this._prevPos)return i;var o=this._prevPos;if(this.position=this._prevPos=r,this._prevPosition=t,this._target)if(i)this._updateTargetProps(null,1);else if(this._steps.length>0){var n=void 0,s=this._steps.length;for(n=0;s>n&&!(this._steps[n].t>r);n++);var a=this._steps[n-1];this._updateTargetProps(a,(this._stepPosition=r-a.t)/a.d)}return i&&this.setPaused(!0),0!=e&&this._actions.length>0&&(this._useTicks?this._runActions(r,r):1==e&&o>r?(o!=this.duration&&this._runActions(o,this.duration),this._runActions(0,r,!0)):this._runActions(o,r)),this.dispatchEventWith("change"),i},r.prototype._runActions=function(t,e,r){void 0===r&&(r=!1);var i=t,o=e,n=-1,s=this._actions.length,a=1;for(t>e&&(i=e,o=t,n=s,s=a=-1);(n+=a)!=s;){var h=this._actions[n],c=h.t;(c==o||c>i&&o>c||r&&c==t)&&h.f.apply(h.o,h.p)}},r.prototype._updateTargetProps=function(t,e){var i,o,n,s,a,h;if(t||1!=e){if(this.passive=!!t.v,this.passive)return;t.e&&(e=t.e(e,0,1,1)),i=t.p0,o=t.p1}else this.passive=!1,i=o=this._curQueueProps;for(var c in this._initQueueProps){null==(s=i[c])&&(i[c]=s=this._initQueueProps[c]),null==(a=o[c])&&(o[c]=a=s),n=s==a||0==e||1==e||"number"!=typeof s?1==e?a:s:s+(a-s)*e;var l=!1;if(h=r._plugins[c])for(var u=0,p=h.length;p>u;u++){var _=h[u].tween(this,c,n,i,o,e,!!t&&i==o,!t);_==r.IGNORE?l=!0:n=_}l||(this._target[c]=n)}},r.prototype.setPaused=function(t){return this.paused=t,r._register(this,!t),this},r.prototype._cloneProps=function(t){var e={};for(var r in t)e[r]=t[r];return e},r.prototype._addStep=function(t){return t.d>0&&(this._steps.push(t),t.t=this.duration,this.duration+=t.d),this},r.prototype._appendQueueProps=function(t){var e,i,o,n,s;for(var a in t)if(void 0===this._initQueueProps[a]){if(i=this._target[a],e=r._plugins[a])for(o=0,n=e.length;n>o;o++)i=e[o].init(this,a,i);this._initQueueProps[a]=this._curQueueProps[a]=void 0===i?null:i}else i=this._curQueueProps[a];for(var a in t){if(i=this._curQueueProps[a],e=r._plugins[a])for(s=s||{},o=0,n=e.length;n>o;o++)e[o].step&&e[o].step(this,a,i,t[a],s);this._curQueueProps[a]=t[a]}return s&&this._appendQueueProps(s),this._curQueueProps},r.prototype._addAction=function(t){return t.t=this.duration,this._actions.push(t),this},r.prototype.to=function(t,e,r){return void 0===r&&(r=void 0),(isNaN(e)||0>e)&&(e=0),this._addStep({d:e||0,p0:this._cloneProps(this._curQueueProps),e:r,p1:this._cloneProps(this._appendQueueProps(t))})},r.prototype.call=function(t,e,r){return void 0===e&&(e=void 0),void 0===r&&(r=void 0),this._addAction({f:t,p:r?r:[],o:e?e:this._target})},r.prototype.tick=function(t){this.paused||this.setPosition(this._prevPosition+t)},r._tweens=[],r.IGNORE={},r._plugins={},r._inited=!1,r._lastTime=0,r}(t.EventDispatcher);t.ScrollTween=r,__reflect(r.prototype,"egret.ScrollTween")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(r){void 0===r&&(r=null);var i=e.call(this)||this;return i.scrollBeginThreshold=10,i.scrollSpeed=1,i._content=null,i.delayTouchBeginEvent=null,i.touchBeginTimer=null,i.touchEnabled=!0,i._ScrV_Props_=new t.ScrollViewProperties,r&&i.setContent(r),i}return __extends(r,e),Object.defineProperty(r.prototype,"bounces",{get:function(){return this._ScrV_Props_._bounces},set:function(t){this._ScrV_Props_._bounces=!!t},enumerable:!0,configurable:!0}),r.prototype.setContent=function(t){this._content!==t&&(this.removeContent(),t&&(this._content=t,e.prototype.addChild.call(this,t),this._addEvents()))},r.prototype.removeContent=function(){this._content&&(this._removeEvents(),e.prototype.removeChildAt.call(this,0)),this._content=null},Object.defineProperty(r.prototype,"verticalScrollPolicy",{get:function(){return this._ScrV_Props_._verticalScrollPolicy},set:function(t){t!=this._ScrV_Props_._verticalScrollPolicy&&(this._ScrV_Props_._verticalScrollPolicy=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"horizontalScrollPolicy",{get:function(){return this._ScrV_Props_._horizontalScrollPolicy},set:function(t){t!=this._ScrV_Props_._horizontalScrollPolicy&&(this._ScrV_Props_._horizontalScrollPolicy=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scrollLeft",{get:function(){return this._ScrV_Props_._scrollLeft},set:function(t){t!=this._ScrV_Props_._scrollLeft&&(this._ScrV_Props_._scrollLeft=t,this._validatePosition(!1,!0),this._updateContentPosition())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scrollTop",{get:function(){return this._ScrV_Props_._scrollTop},set:function(t){t!=this._ScrV_Props_._scrollTop&&(this._ScrV_Props_._scrollTop=t,this._validatePosition(!0,!1),this._updateContentPosition())},enumerable:!0,configurable:!0}),r.prototype.setScrollPosition=function(t,e,r){if(void 0===r&&(r=!1),(!r||0!=t||0!=e)&&(r||this._ScrV_Props_._scrollTop!=t||this._ScrV_Props_._scrollLeft!=e)){var i=this._ScrV_Props_._scrollTop,o=this._ScrV_Props_._scrollLeft;if(r){var n=this.getMaxScrollLeft(),s=this.getMaxScrollTop();(0>=i||i>=s)&&(t/=2),(0>=o||o>=n)&&(e/=2);var a=i+t,h=o+e,c=this._ScrV_Props_._bounces;c||((0>=a||a>=s)&&(a=Math.max(0,Math.min(a,s))),(0>=h||h>=n)&&(h=Math.max(0,Math.min(h,n)))),this._ScrV_Props_._scrollTop=a,this._ScrV_Props_._scrollLeft=h}else this._ScrV_Props_._scrollTop=t,this._ScrV_Props_._scrollLeft=e;this._validatePosition(!0,!0),this._updateContentPosition()}},r.prototype._validatePosition=function(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=!1),t){var r=this.height,i=this._getContentHeight();this._ScrV_Props_._scrollTop=Math.max(this._ScrV_Props_._scrollTop,(0-r)/2),this._ScrV_Props_._scrollTop=Math.min(this._ScrV_Props_._scrollTop,i>r?i-r/2:r/2)}if(e){var o=this.width,n=this._getContentWidth();this._ScrV_Props_._scrollLeft=Math.max(this._ScrV_Props_._scrollLeft,(0-o)/2),this._ScrV_Props_._scrollLeft=Math.min(this._ScrV_Props_._scrollLeft,n>o?n-o/2:o/2)}},r.prototype.$setWidth=function(t){this.$explicitWidth!=t&&(e.prototype.$setWidth.call(this,t),this._updateContentPosition())},r.prototype.$setHeight=function(t){this.$explicitHeight!=t&&(e.prototype.$setHeight.call(this,t),this._updateContentPosition())},r.prototype._updateContentPosition=function(){var e=this.height,r=this.width;this.scrollRect=new t.Rectangle(Math.round(this._ScrV_Props_._scrollLeft),Math.round(this._ScrV_Props_._scrollTop),r,e),this.dispatchEvent(new t.Event(t.Event.CHANGE))},r.prototype._checkScrollPolicy=function(){var t=this._ScrV_Props_._horizontalScrollPolicy,e=this.__checkScrollPolicy(t,this._getContentWidth(),this.width);this._ScrV_Props_._hCanScroll=e;var r=this._ScrV_Props_._verticalScrollPolicy,i=this.__checkScrollPolicy(r,this._getContentHeight(),this.height);return this._ScrV_Props_._vCanScroll=i,e||i},r.prototype.__checkScrollPolicy=function(t,e,r){return"on"==t?!0:"off"==t?!1:e>r},r.prototype._addEvents=function(){this.addEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBegin,this),this.addEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBeginCapture,this,!0),this.addEventListener(t.TouchEvent.TOUCH_END,this._onTouchEndCapture,this,!0)},r.prototype._removeEvents=function(){this.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBegin,this),this.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBeginCapture,this,!0),this.removeEventListener(t.TouchEvent.TOUCH_END,this._onTouchEndCapture,this,!0)},r.prototype._onTouchBegin=function(e){if(!e.$isDefaultPrevented){var r=this._checkScrollPolicy();r&&(this._ScrV_Props_._touchStartPosition.x=e.stageX,this._ScrV_Props_._touchStartPosition.y=e.stageY,(this._ScrV_Props_._isHTweenPlaying||this._ScrV_Props_._isVTweenPlaying)&&this._onScrollFinished(),this._tempStage=this.stage,this._tempStage.addEventListener(t.TouchEvent.TOUCH_MOVE,this._onTouchMove,this),this._tempStage.addEventListener(t.TouchEvent.TOUCH_END,this._onTouchEnd,this),this._tempStage.addEventListener(t.TouchEvent.LEAVE_STAGE,this._onTouchEnd,this),this.addEventListener(t.Event.ENTER_FRAME,this._onEnterFrame,this),this._logTouchEvent(e),e.preventDefault())}},r.prototype._onTouchBeginCapture=function(e){var r=this._checkScrollPolicy();if(r){for(var i=e.target;i!=this;){if("_checkScrollPolicy"in i&&(r=i._checkScrollPolicy()))return;i=i.parent}e.stopPropagation();var o=this.cloneTouchEvent(e);this.delayTouchBeginEvent=o,this.touchBeginTimer||(this.touchBeginTimer=new t.Timer(100,1),this.touchBeginTimer.addEventListener(t.TimerEvent.TIMER_COMPLETE,this._onTouchBeginTimer,this)),this.touchBeginTimer.start(),this._onTouchBegin(e)}},r.prototype._onTouchEndCapture=function(e){var r=this;if(this.delayTouchBeginEvent){this._onTouchBeginTimer(),e.stopPropagation();var i=this.cloneTouchEvent(e);t.callLater(function(){r.stage&&r.dispatchPropagationEvent(i)},this)}},r.prototype._onTouchBeginTimer=function(){this.touchBeginTimer.stop();var t=this.delayTouchBeginEvent;this.delayTouchBeginEvent=null,this.stage&&this.dispatchPropagationEvent(t)},r.prototype.dispatchPropagationEvent=function(e){for(var r=e.$target,i=this.$getPropagationList(r),o=i.length,n=.5*i.length,s=-1,a=0;o>a;a++)if(i[a]===this._content){s=a;break}i.splice(0,s+1),n-=s+1,this.$dispatchPropagationEvent(e,i,n),t.Event.release(e)},r.prototype._onTouchMove=function(t){if(this._ScrV_Props_._lastTouchPosition.x!=t.stageX||this._ScrV_Props_._lastTouchPosition.y!=t.stageY){if(!this._ScrV_Props_._scrollStarted){var e=t.stageX-this._ScrV_Props_._touchStartPosition.x,r=t.stageY-this._ScrV_Props_._touchStartPosition.y,i=Math.sqrt(e*e+r*r);if(i<this.scrollBeginThreshold)return void this._logTouchEvent(t)}this._ScrV_Props_._scrollStarted=!0,this.delayTouchBeginEvent&&(this.delayTouchBeginEvent=null,this.touchBeginTimer.stop()),this.touchChildren=!1;var o=this._getPointChange(t);this.setScrollPosition(o.y,o.x,!0),this._calcVelocitys(t),this._logTouchEvent(t)}},r.prototype._onTouchEnd=function(e){this.touchChildren=!0,this._ScrV_Props_._scrollStarted=!1,this._tempStage.removeEventListener(t.TouchEvent.TOUCH_MOVE,this._onTouchMove,this),this._tempStage.removeEventListener(t.TouchEvent.TOUCH_END,this._onTouchEnd,this),this._tempStage.removeEventListener(t.TouchEvent.LEAVE_STAGE,this._onTouchEnd,this),this.removeEventListener(t.Event.ENTER_FRAME,this._onEnterFrame,this),this._moveAfterTouchEnd()},r.prototype._onEnterFrame=function(e){var r=t.getTimer();r-this._ScrV_Props_._lastTouchTime>100&&r-this._ScrV_Props_._lastTouchTime<300&&this._calcVelocitys(this._ScrV_Props_._lastTouchEvent)},r.prototype._logTouchEvent=function(e){this._ScrV_Props_._lastTouchPosition.x=e.stageX,this._ScrV_Props_._lastTouchPosition.y=e.stageY,this._ScrV_Props_._lastTouchEvent=this.cloneTouchEvent(e),this._ScrV_Props_._lastTouchTime=t.getTimer()},r.prototype._getPointChange=function(t){return{x:this._ScrV_Props_._hCanScroll===!1?0:this._ScrV_Props_._lastTouchPosition.x-t.stageX,y:this._ScrV_Props_._vCanScroll===!1?0:this._ScrV_Props_._lastTouchPosition.y-t.stageY}},r.prototype._calcVelocitys=function(e){var r=t.getTimer();if(0==this._ScrV_Props_._lastTouchTime)return void(this._ScrV_Props_._lastTouchTime=r);var i=this._getPointChange(e),o=r-this._ScrV_Props_._lastTouchTime;i.x/=o,i.y/=o,this._ScrV_Props_._velocitys.push(i),this._ScrV_Props_._velocitys.length>5&&this._ScrV_Props_._velocitys.shift(),this._ScrV_Props_._lastTouchPosition.x=e.stageX,this._ScrV_Props_._lastTouchPosition.y=e.stageY},r.prototype._getContentWidth=function(){return this._content.$explicitWidth||this._content.width},r.prototype._getContentHeight=function(){return this._content.$explicitHeight||this._content.height},r.prototype.getMaxScrollLeft=function(){var t=this._getContentWidth()-this.width;return Math.max(0,t)},r.prototype.getMaxScrollTop=function(){var t=this._getContentHeight()-this.height;return Math.max(0,t)},r.prototype._moveAfterTouchEnd=function(){if(0!=this._ScrV_Props_._velocitys.length){for(var t={x:0,y:0},e=0,i=0;i<this._ScrV_Props_._velocitys.length;i++){var o=this._ScrV_Props_._velocitys[i],n=r.weight[i];t.x+=o.x*n,t.y+=o.y*n,e+=n}this._ScrV_Props_._velocitys.length=0,this.scrollSpeed<=0&&(this.scrollSpeed=1);var s=t.x/e*this.scrollSpeed,a=t.y/e*this.scrollSpeed,h=Math.abs(s),c=Math.abs(a),l=this.getMaxScrollLeft(),u=this.getMaxScrollTop(),p=h>.02?this.getAnimationDatas(s,this._ScrV_Props_._scrollLeft,l):{position:this._ScrV_Props_._scrollLeft,duration:1},_=c>.02?this.getAnimationDatas(a,this._ScrV_Props_._scrollTop,u):{position:this._ScrV_Props_._scrollTop,duration:1};this.setScrollLeft(p.position,p.duration),this.setScrollTop(_.position,_.duration)}},r.prototype.onTweenFinished=function(t){t==this._ScrV_Props_._vScrollTween&&(this._ScrV_Props_._isVTweenPlaying=!1),t==this._ScrV_Props_._hScrollTween&&(this._ScrV_Props_._isHTweenPlaying=!1),0==this._ScrV_Props_._isHTweenPlaying&&0==this._ScrV_Props_._isVTweenPlaying&&this._onScrollFinished()},r.prototype._onScrollStarted=function(){},r.prototype._onScrollFinished=function(){t.ScrollTween.removeTweens(this),this._ScrV_Props_._hScrollTween=null,this._ScrV_Props_._vScrollTween=null,this._ScrV_Props_._isHTweenPlaying=!1,this._ScrV_Props_._isVTweenPlaying=!1,this.dispatchEvent(new t.Event(t.Event.COMPLETE))},r.prototype.setScrollTop=function(e,r){void 0===r&&(r=0);var i=Math.min(this.getMaxScrollTop(),Math.max(e,0));if(0==r)return void(this.scrollTop=i);0==this._ScrV_Props_._bounces&&(e=i);var o=t.ScrollTween.get(this).to({scrollTop:e},r,t.ScrollEase.quartOut);i!=e&&o.to({scrollTop:i},300,t.ScrollEase.quintOut),this._ScrV_Props_._isVTweenPlaying=!0,this._ScrV_Props_._vScrollTween=o,o.call(this.onTweenFinished,this,[o]),this._ScrV_Props_._isHTweenPlaying||this._onScrollStarted()},r.prototype.setScrollLeft=function(e,r){void 0===r&&(r=0);var i=Math.min(this.getMaxScrollLeft(),Math.max(e,0));if(0==r)return void(this.scrollLeft=i);0==this._ScrV_Props_._bounces&&(e=i);var o=t.ScrollTween.get(this).to({scrollLeft:e},r,t.ScrollEase.quartOut);i!=e&&o.to({scrollLeft:i},300,t.ScrollEase.quintOut),this._ScrV_Props_._isHTweenPlaying=!0,this._ScrV_Props_._hScrollTween=o,o.call(this.onTweenFinished,this,[o]),this._ScrV_Props_._isVTweenPlaying||this._onScrollStarted()},r.prototype.getAnimationDatas=function(t,e,r){var i=Math.abs(t),o=.95,n=0,s=.998,a=.02,h=e+500*t;if(0>h||h>r)for(h=e;Math.abs(t)!=1/0&&Math.abs(t)>a;)h+=t,t*=0>h||h>r?s*o:s,n++;else n=500*-Math.log(a/i);var c={position:Math.min(r+50,Math.max(h,-50)),duration:n};return c},r.prototype.cloneTouchEvent=function(e){var r=new t.TouchEvent(e.type,e.bubbles,e.cancelable);return r.touchPointID=e.touchPointID,r.$stageX=e.stageX,r.$stageY=e.stageY,r.touchDown=e.touchDown,r.$isDefaultPrevented=!1,r.$target=e.target,r},r.prototype.throwNotSupportedError=function(){t.$error(1023)},r.prototype.addChild=function(t){return this.throwNotSupportedError(),null},r.prototype.addChildAt=function(t,e){return this.throwNotSupportedError(),null},r.prototype.removeChild=function(t){return this.throwNotSupportedError(),null},r.prototype.removeChildAt=function(t){return this.throwNotSupportedError(),null},r.prototype.setChildIndex=function(t,e){this.throwNotSupportedError()},r.prototype.swapChildren=function(t,e){this.throwNotSupportedError()},r.prototype.swapChildrenAt=function(t,e){this.throwNotSupportedError()},r.weight=[1,1.33,1.66,2,2.33],r}(t.DisplayObjectContainer);t.ScrollView=e,__reflect(e.prototype,"egret.ScrollView")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){this._verticalScrollPolicy="auto",this._horizontalScrollPolicy="auto",this._scrollLeft=0,this._scrollTop=0,this._hCanScroll=!1,this._vCanScroll=!1,this._lastTouchPosition=new t.Point(0,0),this._touchStartPosition=new t.Point(0,0),this._scrollStarted=!1,this._lastTouchTime=0,this._lastTouchEvent=null,this._velocitys=[],this._isHTweenPlaying=!1,this._isVTweenPlaying=!1,this._hScrollTween=null,this._vScrollTween=null,this._bounces=!0}return e}();t.ScrollViewProperties=e,__reflect(e.prototype,"egret.ScrollViewProperties")}(egret||(egret={}));var egret;!function(t){function e(e){var r=e.url;return-1==r.indexOf("?")&&e.method==t.URLRequestMethod.GET&&e.data&&e.data instanceof t.URLVariables&&(r=r+"?"+e.data.toString()),r}var r=function(r){function i(e){void 0===e&&(e=null);var i=r.call(this)||this;return i.dataFormat=t.URLLoaderDataFormat.TEXT,i.data=null,i._request=null,i._status=-1,e&&i.load(e),i}return __extends(i,r),i.prototype.load=function(r){this._request=r,this.data=null;var i=this;if(i.dataFormat==t.URLLoaderDataFormat.TEXTURE)return void this.loadTexture(i);if(i.dataFormat==t.URLLoaderDataFormat.SOUND)return void this.loadSound(i);var o=e(r),n=new t.HttpRequest;n.open(o,r.method==t.URLRequestMethod.POST?t.HttpMethod.POST:t.HttpMethod.GET);var s;if(r.method!=t.URLRequestMethod.GET&&r.data)if(r.data instanceof t.URLVariables){n.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var a=r.data;s=a.toString()}else n.setRequestHeader("Content-Type","multipart/form-data"),s=r.data;else;for(var h=r.requestHeaders.length,c=0;h>c;c++){var l=r.requestHeaders[c];n.setRequestHeader(l.name,l.value)}n.addEventListener(t.Event.COMPLETE,function(){i.data=n.response,t.Event.dispatchEvent(i,t.Event.COMPLETE)},this),n.addEventListener(t.IOErrorEvent.IO_ERROR,function(){t.IOErrorEvent.dispatchIOErrorEvent(i)},this),n.responseType=i.dataFormat==t.URLLoaderDataFormat.BINARY?t.HttpResponseType.ARRAY_BUFFER:t.HttpResponseType.TEXT,n.send(s)},i.prototype.getResponseType=function(e){switch(e){case t.URLLoaderDataFormat.TEXT:case t.URLLoaderDataFormat.VARIABLES:return t.URLLoaderDataFormat.TEXT;case t.URLLoaderDataFormat.BINARY:return"arraybuffer";default:return e}},i.prototype.loadSound=function(e){var r=e._request.url,i=new t.Sound;this.sound=i,i.addEventListener(t.Event.COMPLETE,this.onSoundoadComplete,this),i.addEventListener(t.IOErrorEvent.IO_ERROR,this.onSoundLoaderError,this),i.addEventListener(t.ProgressEvent.PROGRESS,this.onSoundLoaderPostProgress,this),i.load(r)},i.prototype.onSoundoadComplete=function(e){var r=this;this.removeSoundLoaderListeners(),this.data=this.sound,window.setTimeout(function(){r.dispatchEventWith(t.Event.COMPLETE)},0)},i.prototype.onSoundLoaderPostProgress=function(t){this.dispatchEvent(t)},i.prototype.onSoundLoaderError=function(t){this.dispatchEvent(t)},i.prototype.removeSoundLoaderListeners=function(){this.sound.removeEventListener(t.Event.COMPLETE,this.onSoundoadComplete,this),this.sound.removeEventListener(t.IOErrorEvent.IO_ERROR,this.onSoundLoaderError,this),this.sound.removeEventListener(t.ProgressEvent.PROGRESS,this.onSoundLoaderPostProgress,this)},i.prototype.loadTexture=function(e){this.virtualUrl=e._request.url;var r=new t.ImageLoader;this.imageLoader=r,r.addEventListener(t.Event.COMPLETE,this.onImageLoadComplete,this),r.addEventListener(t.IOErrorEvent.IO_ERROR,this.onImageLoaderError,this),r.addEventListener(t.ProgressEvent.PROGRESS,this.onImageLoaderPostProgress,this),r.load(this.virtualUrl)},i.prototype.onImageLoadComplete=function(e){var r=this;this.removeImageLoaderListeners();var i=new t.Texture,o=this.imageLoader.data;o.source.setAttribute&&o.source.setAttribute("bitmapSrc",this.virtualUrl),i._setBitmapData(o),this.data=i,window.setTimeout(function(){r.dispatchEventWith(t.Event.COMPLETE)},0)},i.prototype.onImageLoaderPostProgress=function(t){this.dispatchEvent(t)},i.prototype.onImageLoaderError=function(t){this.dispatchEvent(t)},i.prototype.removeImageLoaderListeners=function(){this.imageLoader.removeEventListener(t.Event.COMPLETE,this.onImageLoadComplete,this),this.imageLoader.removeEventListener(t.IOErrorEvent.IO_ERROR,this.onImageLoaderError,this),this.imageLoader.removeEventListener(t.ProgressEvent.PROGRESS,this.onImageLoaderPostProgress,this)},i.prototype.__recycle=function(){this._request=null,this.data=null},i}(t.EventDispatcher);t.URLLoader=r,__reflect(r.prototype,"egret.URLLoader")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(r){var i=e.call(this)||this;return i.$texture=null,i.offsetPoint=t.Point.create(0,0),i.$movieClipData=null,i.frames=null,i.$totalFrames=0,i.frameLabels=null,i.$frameLabelStart=0,i.$frameLabelEnd=0,i.frameEvents=null,i.frameIntervalTime=0,i.$eventPool=null,i.$isPlaying=!1,i.isStopped=!0,i.playTimes=0,i.$currentFrameNum=0,i.$nextFrameNum=1,i.displayedKeyFrameNum=0,i.passedTime=0,i.$frameRate=0/0,i.lastTime=0,i.$smoothing=t.Bitmap.defaultSmoothing,i.setMovieClipData(r),t.nativeRender||(i.$renderNode=new t.sys.NormalBitmapNode),i}return __extends(r,e),r.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(11)},Object.defineProperty(r.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(t){t!=this.$smoothing&&(this.$smoothing=t)},enumerable:!0,configurable:!0}),r.prototype.$init=function(){this.$reset();var t=this.$movieClipData;t&&t.$isDataValid()&&(this.frames=t.frames,this.$totalFrames=t.numFrames,this.frameLabels=t.labels,this.frameEvents=t.events,this.$frameRate=t.frameRate,this.frameIntervalTime=1e3/this.$frameRate,this._initFrame())},r.prototype.$reset=function(){this.frames=null,this.playTimes=0,this.$isPlaying=!1,this.setIsStopped(!0),this.$currentFrameNum=0,this.$nextFrameNum=1,this.displayedKeyFrameNum=0,this.passedTime=0,this.$eventPool=[]},r.prototype._initFrame=function(){this.$movieClipData.$isTextureValid()&&(this.advanceFrame(),this.constructFrame())},r.prototype.$updateRenderNode=function(){var e=this.$texture;if(e){var r=Math.round(this.offsetPoint.x),i=Math.round(this.offsetPoint.y),o=e.$bitmapWidth,n=e.$bitmapHeight,s=e.$getTextureWidth(),a=e.$getTextureHeight(),h=Math.round(e.$getScaleBitmapWidth()),c=Math.round(e.$getScaleBitmapHeight()),l=e.$sourceWidth,u=e.$sourceHeight;t.sys.BitmapNode.$updateTextureData(this.$renderNode,e.$bitmapData,e.$bitmapX,e.$bitmapY,o,n,r,i,s,a,h,c,l,u,t.BitmapFillMode.SCALE,this.$smoothing)}},r.prototype.$measureContentBounds=function(t){var e=this.$texture;if(e){var r=this.offsetPoint.x,i=this.offsetPoint.y,o=e.$getTextureWidth(),n=e.$getTextureHeight();t.setTo(r,i,o,n)}else t.setEmpty()},r.prototype.$onAddToStage=function(t,r){e.prototype.$onAddToStage.call(this,t,r),this.$isPlaying&&this.$totalFrames>1&&this.setIsStopped(!1)},r.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.setIsStopped(!0)},r.prototype.getFrameLabelByName=function(t,e){void 0===e&&(e=!1),e&&(t=t.toLowerCase());var r=this.frameLabels;if(r)for(var i=null,o=0;o<r.length;o++)if(i=r[o],e?i.name.toLowerCase()==t:i.name==t)return i;return null},r.prototype.getFrameStartEnd=function(t){var e=this.frameLabels;if(e)for(var r=null,i=0;i<e.length;i++)if(r=e[i],t==r.name){this.$frameLabelStart=r.frame,this.$frameLabelEnd=r.end;break}},r.prototype.getFrameLabelByFrame=function(t){var e=this.frameLabels;if(e)for(var r=null,i=0;i<e.length;i++)if(r=e[i],r.frame==t)return r;return null},r.prototype.getFrameLabelForFrame=function(t){var e=null,r=null,i=this.frameLabels;if(i)for(var o=0;o<i.length;o++){if(r=i[o],r.frame>t)return e;e=r}return e},r.prototype.play=function(e){void 0===e&&(e=0),this.lastTime=t.getTimer(),this.passedTime=0,this.$isPlaying=!0,this.setPlayTimes(e),this.$totalFrames>1&&this.$stage&&this.setIsStopped(!1)},r.prototype.stop=function(){this.$isPlaying=!1,this.setIsStopped(!0)},r.prototype.prevFrame=function(){this.gotoAndStop(this.$currentFrameNum-1)},r.prototype.nextFrame=function(){this.gotoAndStop(this.$currentFrameNum+1)},r.prototype.gotoAndPlay=function(e,r){void 0===r&&(r=0),(0==arguments.length||arguments.length>2)&&t.$error(1022,"MovieClip.gotoAndPlay()"),"string"==typeof e?this.getFrameStartEnd(e):(this.$frameLabelStart=0,this.$frameLabelEnd=0),this.play(r),this.gotoFrame(e)},r.prototype.gotoAndStop=function(e){1!=arguments.length&&t.$error(1022,"MovieClip.gotoAndStop()"),this.stop(),this.gotoFrame(e)},r.prototype.gotoFrame=function(e){var r;"string"==typeof e?r=this.getFrameLabelByName(e).frame:(r=parseInt(e+"",10),r!=e&&t.$error(1022,"Frame Label Not Found")),1>r?r=1:r>this.$totalFrames&&(r=this.$totalFrames),r!=this.$nextFrameNum&&(this.$nextFrameNum=r,this.advanceFrame(),this.constructFrame(),this.handlePendingEvent())},r.prototype.advanceTime=function(e){var r=this,i=e-r.lastTime;r.lastTime=e;var o=r.frameIntervalTime,n=r.passedTime+i;r.passedTime=n%o;var s=n/o;if(1>s)return!1;for(;s>=1;){if(s--,r.$nextFrameNum++,r.$nextFrameNum>r.$totalFrames||r.$frameLabelStart>0&&r.$nextFrameNum>r.$frameLabelEnd)if(-1==r.playTimes)r.$eventPool.push(t.Event.LOOP_COMPLETE),r.$nextFrameNum=1;else{if(r.playTimes--,!(r.playTimes>0)){r.$nextFrameNum=r.$totalFrames,r.$eventPool.push(t.Event.COMPLETE),r.stop();break}r.$eventPool.push(t.Event.LOOP_COMPLETE),r.$nextFrameNum=1}r.$currentFrameNum==r.$frameLabelEnd&&(r.$nextFrameNum=r.$frameLabelStart),r.advanceFrame()}return r.constructFrame(),r.handlePendingEvent(),!1},r.prototype.advanceFrame=function(){this.$currentFrameNum=this.$nextFrameNum;
var e=this.frameEvents[this.$nextFrameNum];e&&""!=e&&t.MovieClipEvent.dispatchMovieClipEvent(this,t.MovieClipEvent.FRAME_LABEL,e)},r.prototype.constructFrame=function(){var e=this,r=e.$currentFrameNum;if(e.displayedKeyFrameNum!=r){var i=e.$movieClipData.getTextureByFrame(r);if(e.$texture=i,e.$movieClipData.$getOffsetByFrame(r,e.offsetPoint),e.displayedKeyFrameNum=r,e.$renderDirty=!0,t.nativeRender)e.$nativeDisplayObject.setDataToBitmapNode(e.$nativeDisplayObject.id,i,[i.$bitmapX,i.$bitmapY,i.$bitmapWidth,i.$bitmapHeight,e.offsetPoint.x,e.offsetPoint.y,i.$getScaleBitmapWidth(),i.$getScaleBitmapHeight(),i.$sourceWidth,i.$sourceHeight]),e.$nativeDisplayObject.setWidth(i.$getTextureWidth()),e.$nativeDisplayObject.setHeight(i.$getTextureHeight());else{var o=e.$parent;o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp());var n=e.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}}},r.prototype.$renderFrame=function(){var t=this;t.$texture=t.$movieClipData.getTextureByFrame(t.$currentFrameNum),t.$renderDirty=!0;var e=t.$parent;e&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp());var r=t.$maskedObject;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())},r.prototype.handlePendingEvent=function(){if(0!=this.$eventPool.length){this.$eventPool.reverse();for(var e=this.$eventPool,r=e.length,i=!1,o=!1,n=0;r>n;n++){var s=e.pop();s==t.Event.LOOP_COMPLETE?o=!0:s==t.Event.COMPLETE?i=!0:this.dispatchEventWith(s)}o&&this.dispatchEventWith(t.Event.LOOP_COMPLETE),i&&this.dispatchEventWith(t.Event.COMPLETE)}},Object.defineProperty(r.prototype,"totalFrames",{get:function(){return this.$totalFrames},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentFrame",{get:function(){return this.$currentFrameNum},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentFrameLabel",{get:function(){var t=this.getFrameLabelByFrame(this.$currentFrameNum);return t&&t.name},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentLabel",{get:function(){var t=this.getFrameLabelForFrame(this.$currentFrameNum);return t?t.name:null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"frameRate",{get:function(){return this.$frameRate},set:function(t){t!=this.$frameRate&&(this.$frameRate=t,this.frameIntervalTime=1e3/this.$frameRate)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isPlaying",{get:function(){return this.$isPlaying},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"movieClipData",{get:function(){return this.$movieClipData},set:function(t){this.setMovieClipData(t)},enumerable:!0,configurable:!0}),r.prototype.setMovieClipData=function(t){this.$movieClipData!=t&&(this.$movieClipData=t,this.$init())},r.prototype.setPlayTimes=function(t){(0>t||t>=1)&&(this.playTimes=0>t?-1:Math.floor(t))},r.prototype.setIsStopped=function(e){this.isStopped!=e&&(this.isStopped=e,e?t.ticker.$stopTick(this.advanceTime,this):(this.playTimes=0==this.playTimes?1:this.playTimes,this.lastTime=t.getTimer(),t.ticker.$startTick(this.advanceTime,this)))},r}(t.DisplayObject);t.MovieClip=e,__reflect(e.prototype,"egret.MovieClip")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(r){void 0===r&&(r=null);var i=e.call(this)||this;return i.data=null,i.method=t.URLRequestMethod.GET,i.url="",i.requestHeaders=[],i.url=r,i}return __extends(r,e),r}(t.HashObject);t.URLRequest=e,__reflect(e.prototype,"egret.URLRequest")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(t,e){this.name="",this.value="",this.name=t,this.value=e}return t}();t.URLRequestHeader=e,__reflect(e.prototype,"egret.URLRequestHeader")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.GET="get",t.POST="post",t}();t.URLRequestMethod=e,__reflect(e.prototype,"egret.URLRequestMethod")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e){void 0===e&&(e=null);var r=t.call(this)||this;return r.variables=null,null!==e&&r.decode(e),r}return __extends(e,t),e.prototype.decode=function(t){this.variables||(this.variables={}),t=t.split("+").join(" ");for(var e,r=/[?&]?([^=]+)=([^&]*)/g;e=r.exec(t);){var i=decodeURIComponent(e[1]),o=decodeURIComponent(e[2]);if(i in this.variables!=0){var n=this.variables[i];n instanceof Array?n.push(o):this.variables[i]=[n,o]}else this.variables[i]=o}},e.prototype.toString=function(){if(!this.variables)return"";var t=this.variables,e=[];for(var r in t)e.push(this.encodeValue(r,t[r]));return e.join("&")},e.prototype.encodeValue=function(t,e){return e instanceof Array?this.encodeArray(t,e):encodeURIComponent(t)+"="+encodeURIComponent(e)},e.prototype.encodeArray=function(t,e){return t?0==e.length?encodeURIComponent(t)+"=":e.map(function(e){return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&"):""},e}(t.HashObject);t.URLVariables=e,__reflect(e.prototype,"egret.URLVariables")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){var i=e.call(this)||this;return i._timeScale=1,i._paused=!1,i._callIndex=-1,i._lastTime=0,i.callBackList=[],null!=r.instance,t.ticker.$startTick(i.update,i),i._lastTime=t.getTimer(),i}return __extends(r,e),r.prototype.update=function(t){var e=t-this._lastTime;if(this._lastTime=t,this._paused)return!1;var r=e*this._timeScale;for(this._callList=this.callBackList.concat(),this._callIndex=0;this._callIndex<this._callList.length;this._callIndex++){var i=this._callList[this._callIndex];i.listener.call(i.thisObject,r)}return this._callIndex=-1,this._callList=null,!1},r.prototype.register=function(t,e,r){void 0===r&&(r=0),this.$insertEventBin(this.callBackList,"",t,e,!1,r,!1)},r.prototype.unregister=function(t,e){this.$removeEventBin(this.callBackList,t,e)},r.prototype.setTimeScale=function(t){this._timeScale=t},r.prototype.getTimeScale=function(){return this._timeScale},r.prototype.pause=function(){this._paused=!0},r.prototype.resume=function(){this._paused=!1},r.getInstance=function(){return null==r.instance&&(r.instance=new r),r.instance},r}(t.EventDispatcher);t.Ticker=e,__reflect(e.prototype,"egret.Ticker")}(egret||(egret={}));var egret;!function(t){var e=function(e){function r(){return e.call(this)||this}return __extends(r,e),Object.defineProperty(r.prototype,"stage",{get:function(){return t.sys.$TempStage},enumerable:!0,configurable:!0}),Object.defineProperty(r,"instance",{get:function(){return null==r._instance&&(r._instance=new r),r._instance},enumerable:!0,configurable:!0}),r.deviceType=null,r.DEVICE_PC="web",r.DEVICE_MOBILE="native",r}(t.EventDispatcher);t.MainContext=e,__reflect(e.prototype,"egret.MainContext")}(egret||(egret={})),egret.testDeviceType1=function(){if(!window.navigator||!navigator)return!0;var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("mobile")||-1!=t.indexOf("android")},egret.MainContext.deviceType=egret.testDeviceType1()?egret.MainContext.DEVICE_MOBILE:egret.MainContext.DEVICE_PC,delete egret.testDeviceType1;var egret;!function(t){var e=function(e){function r(t){void 0===t&&(t=300);var r=e.call(this)||this;return r.objectPool=[],r._length=0,1>t&&(t=1),r.autoDisposeTime=t,r.frameCount=0,r}return __extends(r,e),r.$init=function(){t.ticker.$startTick(r.onUpdate,r)},r.onUpdate=function(t){for(var e=r._callBackList,i=e.length-1;i>=0;i--)e[i].$checkFrame();return!1},r.prototype.$checkFrame=function(){this.frameCount--,this.frameCount<=0&&this.dispose()},Object.defineProperty(r.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),r.prototype.push=function(t){var e=this.objectPool;-1==e.indexOf(t)&&(e.push(t),t.__recycle&&t.__recycle(),this._length++,0==this.frameCount&&(this.frameCount=this.autoDisposeTime,r._callBackList.push(this)))},r.prototype.pop=function(){return 0==this._length?null:(this._length--,this.objectPool.pop())},r.prototype.dispose=function(){this._length>0&&(this.objectPool=[],this._length=0),this.frameCount=0;var t=r._callBackList,e=t.indexOf(this);-1!=e&&t.splice(e,1)},r._callBackList=[],r}(t.HashObject);t.Recycler=e,__reflect(e.prototype,"egret.Recycler"),e.$init()}(egret||(egret={}));var egret;!function(t){function e(e,r,h){for(var c=[],l=3;l<arguments.length;l++)c[l-3]=arguments[l];var u={listener:e,thisObject:r,delay:h,originDelay:h,params:c};return s++,1==s&&(a=t.getTimer(),t.ticker.$startTick(i,null)),n++,o[n]=u,n}function r(e){o[e]&&(s--,delete o[e],0==s&&t.ticker.$stopTick(i,null))}function i(t){var e=t-a;a=t;for(var r in o){var i=o[r];i.delay-=e,i.delay<=0&&(i.delay=i.originDelay,i.listener.apply(i.thisObject,i.params))}return!1}var o={},n=0,s=0,a=0;t.setInterval=e,t.clearInterval=r}(egret||(egret={}));var egret;!function(t){function e(e,r,h){for(var c=[],l=3;l<arguments.length;l++)c[l-3]=arguments[l];var u={listener:e,thisObject:r,delay:h,params:c};return s++,1==s&&t.ticker&&(a=t.getTimer(),t.ticker.$startTick(i,null)),n++,o[n]=u,n}function r(e){o[e]&&(s--,delete o[e],0==s&&t.ticker&&t.ticker.$stopTick(i,null))}function i(t){var e=t-a;a=t;for(var i in o){var n=i,s=o[n];s.delay-=e,s.delay<=0&&(r(n),s.listener.apply(s.thisObject,s.params))}return!1}var o={},n=0,s=0,a=0;t.setTimeout=e,t.clearTimeout=r}(egret||(egret={}));

 //js/tween.min_6c5a88f9.js
var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},egret;!function(t){var e=function(){function e(){t.$error(1014)}return e.get=function(t){return-1>t&&(t=-1),t>1&&(t=1),function(e){return 0==t?e:0>t?e*(e*-t+1+t):e*((2-e)*t+(1-t))}},e.getPowIn=function(t){return function(e){return Math.pow(e,t)}},e.getPowOut=function(t){return function(e){return 1-Math.pow(1-e,t)}},e.getPowInOut=function(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}},e.sineIn=function(t){return 1-Math.cos(t*Math.PI/2)},e.sineOut=function(t){return Math.sin(t*Math.PI/2)},e.sineInOut=function(t){return-.5*(Math.cos(Math.PI*t)-1)},e.getBackIn=function(t){return function(e){return e*e*((t+1)*e-t)}},e.getBackOut=function(t){return function(e){return--e*e*((t+1)*e+t)+1}},e.getBackInOut=function(t){return t*=1.525,function(e){return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)}},e.circIn=function(t){return-(Math.sqrt(1-t*t)-1)},e.circOut=function(t){return Math.sqrt(1- --t*t)},e.circInOut=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},e.bounceIn=function(t){return 1-e.bounceOut(1-t)},e.bounceOut=function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},e.bounceInOut=function(t){return.5>t?.5*e.bounceIn(2*t):.5*e.bounceOut(2*t-1)+.5},e.getElasticIn=function(t,e){var n=2*Math.PI;return function(i){if(0==i||1==i)return i;var s=e/n*Math.asin(1/t);return-(t*Math.pow(2,10*(i-=1))*Math.sin((i-s)*n/e))}},e.getElasticOut=function(t,e){var n=2*Math.PI;return function(i){if(0==i||1==i)return i;var s=e/n*Math.asin(1/t);return t*Math.pow(2,-10*i)*Math.sin((i-s)*n/e)+1}},e.getElasticInOut=function(t,e){var n=2*Math.PI;return function(i){var s=e/n*Math.asin(1/t);return(i*=2)<1?-.5*(t*Math.pow(2,10*(i-=1))*Math.sin((i-s)*n/e)):t*Math.pow(2,-10*(i-=1))*Math.sin((i-s)*n/e)*.5+1}},e.quadIn=e.getPowIn(2),e.quadOut=e.getPowOut(2),e.quadInOut=e.getPowInOut(2),e.cubicIn=e.getPowIn(3),e.cubicOut=e.getPowOut(3),e.cubicInOut=e.getPowInOut(3),e.quartIn=e.getPowIn(4),e.quartOut=e.getPowOut(4),e.quartInOut=e.getPowInOut(4),e.quintIn=e.getPowIn(5),e.quintOut=e.getPowOut(5),e.quintInOut=e.getPowInOut(5),e.backIn=e.getBackIn(1.7),e.backOut=e.getBackOut(1.7),e.backInOut=e.getBackInOut(1.7),e.elasticIn=e.getElasticIn(1,.3),e.elasticOut=e.getElasticOut(1,.3),e.elasticInOut=e.getElasticInOut(1,.3*1.5),e}();t.Ease=e,__reflect(e.prototype,"egret.Ease")}(egret||(egret={}));var egret;!function(t){var e=function(e){function n(t,n,i){var s=e.call(this)||this;return s._target=null,s._useTicks=!1,s.ignoreGlobalPause=!1,s.loop=!1,s.pluginData=null,s._steps=null,s.paused=!1,s.duration=0,s._prevPos=-1,s.position=null,s._prevPosition=0,s._stepPosition=0,s.passive=!1,s.initialize(t,n,i),s}return __extends(n,e),n.get=function(t,e,i,s){return void 0===i&&(i=null),void 0===s&&(s=!1),s&&n.removeTweens(t),new n(t,e,i)},n.removeTweens=function(t){if(t.tween_count){for(var e=n._tweens,i=e.length-1;i>=0;i--)e[i]._target==t&&(e[i].paused=!0,e.splice(i,1));t.tween_count=0}},n.pauseTweens=function(e){if(e.tween_count)for(var n=t.Tween._tweens,i=n.length-1;i>=0;i--)n[i]._target==e&&(n[i].paused=!0)},n.resumeTweens=function(e){if(e.tween_count)for(var n=t.Tween._tweens,i=n.length-1;i>=0;i--)n[i]._target==e&&(n[i].paused=!1)},n.tick=function(t,e){void 0===e&&(e=!1);var i=t-n._lastTime;n._lastTime=t;for(var s=n._tweens.concat(),r=s.length-1;r>=0;r--){var o=s[r];e&&!o.ignoreGlobalPause||o.paused||o.$tick(o._useTicks?1:i)}return!1},n._register=function(e,i){var s=e._target,r=n._tweens;if(i)s&&(s.tween_count=s.tween_count>0?s.tween_count+1:1),r.push(e),n._inited||(n._lastTime=t.getTimer(),t.ticker.$startTick(n.tick,null),n._inited=!0);else{s&&s.tween_count--;for(var o=r.length;o--;)if(r[o]==e)return void r.splice(o,1)}},n.removeAllTweens=function(){for(var t=n._tweens,e=0,i=t.length;i>e;e++){var s=t[e];s.paused=!0,s._target.tween_count=0}t.length=0},n.prototype.initialize=function(t,e,i){this._target=t,e&&(this._useTicks=e.useTicks,this.ignoreGlobalPause=e.ignoreGlobalPause,this.loop=e.loop,e.onChange&&this.addEventListener("change",e.onChange,e.onChangeObj),e.override&&n.removeTweens(t)),this.pluginData=i||{},this._curQueueProps={},this._initQueueProps={},this._steps=[],e&&e.paused?this.paused=!0:n._register(this,!0),e&&null!=e.position&&this.setPosition(e.position,n.NONE)},n.prototype.setPosition=function(t,e){void 0===e&&(e=1),0>t&&(t=0);var n=t,i=!1;if(n>=this.duration)if(this.loop){var s=n%this.duration;n=n>0&&0===s?this.duration:s}else n=this.duration,i=!0;if(n==this._prevPos)return i;i&&this.setPaused(!0);var r=this._prevPos;if(this.position=this._prevPos=n,this._prevPosition=t,this._target&&this._steps.length>0){for(var o=this._steps.length,u=-1,a=0;o>a&&!("step"==this._steps[a].type&&(u=a,this._steps[a].t<=n&&this._steps[a].t+this._steps[a].d>=n));a++);for(var a=0;o>a;a++)if("action"==this._steps[a].type)0!=e&&(this._useTicks?this._runAction(this._steps[a],n,n):1==e&&r>n?(r!=this.duration&&this._runAction(this._steps[a],r,this.duration),this._runAction(this._steps[a],0,n,!0)):this._runAction(this._steps[a],r,n));else if("step"==this._steps[a].type&&u==a){var p=this._steps[u];this._updateTargetProps(p,Math.min((this._stepPosition=n-p.t)/p.d,1))}}return this.dispatchEventWith("change"),i},n.prototype._runAction=function(t,e,n,i){void 0===i&&(i=!1);var s=e,r=n;e>n&&(s=n,r=e);var o=t.t;(o==r||o>s&&r>o||i&&o==e)&&t.f.apply(t.o,t.p)},n.prototype._updateTargetProps=function(t,e){var i,s,r,o,u,a;if(t||1!=e){if(this.passive=!!t.v,this.passive)return;t.e&&(e=t.e(e,0,1,1)),i=t.p0,s=t.p1}else this.passive=!1,i=s=this._curQueueProps;for(var p in this._initQueueProps){null==(o=i[p])&&(i[p]=o=this._initQueueProps[p]),null==(u=s[p])&&(s[p]=u=o),r=o==u||0==e||1==e||"number"!=typeof o?1==e?u:o:o+(u-o)*e;var h=!1;if(a=n._plugins[p])for(var c=0,_=a.length;_>c;c++){var f=a[c].tween(this,p,r,i,s,e,!!t&&i==s,!t);f==n.IGNORE?h=!0:r=f}h||(this._target[p]=r)}},n.prototype.setPaused=function(t){return this.paused==t?this:(this.paused=t,n._register(this,!t),this)},n.prototype._cloneProps=function(t){var e={};for(var n in t)e[n]=t[n];return e},n.prototype._addStep=function(t){return t.d>0&&(t.type="step",this._steps.push(t),t.t=this.duration,this.duration+=t.d),this},n.prototype._appendQueueProps=function(t){var e,i,s,r,o;for(var u in t)if(void 0===this._initQueueProps[u]){if(i=this._target[u],e=n._plugins[u])for(s=0,r=e.length;r>s;s++)i=e[s].init(this,u,i);this._initQueueProps[u]=this._curQueueProps[u]=void 0===i?null:i}else i=this._curQueueProps[u];for(var u in t){if(i=this._curQueueProps[u],e=n._plugins[u])for(o=o||{},s=0,r=e.length;r>s;s++)e[s].step&&e[s].step(this,u,i,t[u],o);this._curQueueProps[u]=t[u]}return o&&this._appendQueueProps(o),this._curQueueProps},n.prototype._addAction=function(t){return t.t=this.duration,t.type="action",this._steps.push(t),this},n.prototype._set=function(t,e){for(var n in t)e[n]=t[n]},n.prototype.wait=function(t,e){if(null==t||0>=t)return this;var n=this._cloneProps(this._curQueueProps);return this._addStep({d:t,p0:n,p1:n,v:e})},n.prototype.to=function(t,e,n){return void 0===n&&(n=void 0),(isNaN(e)||0>e)&&(e=0),this._addStep({d:e||0,p0:this._cloneProps(this._curQueueProps),e:n,p1:this._cloneProps(this._appendQueueProps(t))}),this.set(t)},n.prototype.call=function(t,e,n){return void 0===e&&(e=void 0),void 0===n&&(n=void 0),this._addAction({f:t,p:n?n:[],o:e?e:this._target})},n.prototype.set=function(t,e){return void 0===e&&(e=null),this._appendQueueProps(t),this._addAction({f:this._set,o:this,p:[t,e?e:this._target]})},n.prototype.play=function(t){return t||(t=this),this.call(t.setPaused,t,[!1])},n.prototype.pause=function(t){return t||(t=this),this.call(t.setPaused,t,[!0])},n.prototype.$tick=function(t){this.paused||this.setPosition(this._prevPosition+t)},n.NONE=0,n.LOOP=1,n.REVERSE=2,n._tweens=[],n.IGNORE={},n._plugins={},n._inited=!1,n._lastTime=0,n}(t.EventDispatcher);t.Tween=e,__reflect(e.prototype,"egret.Tween")}(egret||(egret={}));var egret;!function(t){var e;!function(e){function n(e){if("function"==typeof e)return e;var n=t.Ease[e];return"function"==typeof n?n:null}function i(t,e,n,i){var s=t.prototype;s.__meta__=s.__meta__||{},s.__meta__[e]=n,i&&(s.__defaultProperty__=e)}var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="",e}return __extends(e,t),e}(t.EventDispatcher);e.BasePath=s,__reflect(s.prototype,"egret.tween.BasePath");var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.props=void 0,e.duration=500,e.ease=void 0,e}return __extends(e,t),e}(s);e.To=r,__reflect(r.prototype,"egret.tween.To");var o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.duration=500,e.passive=void 0,e}return __extends(e,t),e}(s);e.Wait=o,__reflect(o.prototype,"egret.tween.Wait");var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.props=void 0,e}return __extends(e,t),e}(s);e.Set=u,__reflect(u.prototype,"egret.tween.Set");var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delta=0,e}return __extends(e,t),e}(s);e.Tick=a,__reflect(a.prototype,"egret.tween.Tick");var p=function(e){function i(){var t=e.call(this)||this;return t.isStop=!1,t}return __extends(i,e),Object.defineProperty(i.prototype,"props",{get:function(){return this._props},set:function(t){this._props=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"paths",{get:function(){return this._paths},set:function(t){this._paths=t||[]},enumerable:!0,configurable:!0}),i.prototype.play=function(t){this.tween?(this.tween.setPaused(!1),this.isStop&&void 0==t&&(t=0,this.isStop=!1),void 0!==t&&null!==t&&this.tween.setPosition(t)):this.createTween(t)},i.prototype.pause=function(){this.tween&&this.tween.setPaused(!0)},i.prototype.stop=function(){this.pause(),this.isStop=!0},i.prototype.createTween=function(e){this.tween=t.Tween.get(this._target,this._props),this._paths&&this.applyPaths(),void 0!==e&&null!==e&&this.tween.setPosition(e)},i.prototype.applyPaths=function(){for(var t=0;t<this._paths.length;t++){var e=this._paths[t];this.applyPath(e)}},i.prototype.applyPath=function(t){var e=this;t instanceof r?this.tween.to(t.props,t.duration,n(t.ease)):t instanceof o?this.tween.wait(t.duration,t.passive):t instanceof u?this.tween.set(t.props):t instanceof a&&this.tween.$tick(t.delta),this.tween.call(function(){return e.pathComplete(t)})},i.prototype.pathComplete=function(t){t.dispatchEventWith("complete"),this.dispatchEventWith("pathComplete",!1,t);var e=this._paths.indexOf(t);e>=0&&e===this._paths.length-1&&this.dispatchEventWith("complete")},i}(t.EventDispatcher);e.TweenItem=p,__reflect(p.prototype,"egret.tween.TweenItem"),i(p,"paths","Array",!0);var h=function(t){function e(){var e=t.call(this)||this;return e.completeCount=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"items",{get:function(){return this._items},set:function(t){this.completeCount=0,this.registerEvent(!1),this._items=t,this.registerEvent(!0)},enumerable:!0,configurable:!0}),e.prototype.registerEvent=function(t){var e=this;this._items&&this._items.forEach(function(n){t?n.addEventListener("complete",e.itemComplete,e):n.removeEventListener("complete",e.itemComplete,e)})},e.prototype.play=function(t){if(this._items)for(var e=0;e<this._items.length;e++){var n=this._items[e];n.play(t)}},e.prototype.pause=function(){if(this._items)for(var t=0;t<this._items.length;t++){var e=this._items[t];e.pause()}},e.prototype.stop=function(){if(this._items)for(var t=0;t<this._items.length;t++){var e=this._items[t];e.stop()}},e.prototype.itemComplete=function(t){var e=t.currentTarget;this.completeCount++,this.dispatchEventWith("itemComplete",!1,e),this.completeCount===this.items.length&&(this.dispatchEventWith("complete"),this.completeCount=0)},e}(t.EventDispatcher);e.TweenGroup=h,__reflect(h.prototype,"egret.tween.TweenGroup"),i(h,"items","Array",!0)}(e=t.tween||(t.tween={}))}(egret||(egret={}));

 //js/socket.min_afab9be.js
var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);n.prototype=e.prototype,t.prototype=new n},egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(e){function n(o,i){void 0===o&&(o=""),void 0===i&&(i=0);var s=e.call(this)||this;return s._writeMessage="",s._readMessage="",s._connected=!1,s._connecting=!1,s._isReadySend=!1,s._bytesWrite=!1,s._type=n.TYPE_STRING,s._connected=!1,s._writeMessage="",s._readMessage="",s.socket=new t.ISocket,s.socket.addCallBacks(s.onConnect,s.onClose,s.onSocketData,s.onError,s),s}return __extends(n,e),n.prototype.connect=function(t,e){this._connecting||this._connected||(this._connecting=!0,this.socket.connect(t,e))},n.prototype.connectByUrl=function(t){this._connecting||this._connected||(this._connecting=!0,this.socket.connectByUrl(t))},n.prototype.close=function(){this._connected&&this.socket.close()},n.prototype.onConnect=function(){this._connected=!0,this._connecting=!1,this.dispatchEventWith(t.Event.CONNECT)},n.prototype.onClose=function(){this._connected=!1,this.dispatchEventWith(t.Event.CLOSE)},n.prototype.onError=function(){this._connecting&&(this._connecting=!1),this.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},n.prototype.onSocketData=function(e){"string"==typeof e?this._readMessage+=e:this._readByte._writeUint8Array(new Uint8Array(e)),t.ProgressEvent.dispatchProgressEvent(this,t.ProgressEvent.SOCKET_DATA)},n.prototype.flush=function(){return this._connected?(this._writeMessage&&(this.socket.send(this._writeMessage),this._writeMessage=""),this._bytesWrite&&(this.socket.send(this._writeByte.buffer),this._bytesWrite=!1,this._writeByte.clear()),void(this._isReadySend=!1)):void t.$warn(3101)},n.prototype.writeUTF=function(e){return this._connected?(this._type==n.TYPE_BINARY?(this._bytesWrite=!0,this._writeByte.writeUTF(e)):this._writeMessage+=e,void this.flush()):void t.$warn(3101)},n.prototype.readUTF=function(){var t;return this._type==n.TYPE_BINARY?(this._readByte.position=0,t=this._readByte.readUTF(),this._readByte.clear()):(t=this._readMessage,this._readMessage=""),t},n.prototype.writeBytes=function(e,n,o){return void 0===n&&(n=0),void 0===o&&(o=0),this._connected?this._writeByte?(this._bytesWrite=!0,this._writeByte.writeBytes(e,n,o),void this.flush()):void t.$warn(3102):void t.$warn(3101)},n.prototype.readBytes=function(e,n,o){return void 0===n&&(n=0),void 0===o&&(o=0),this._readByte?(this._readByte.position=0,this._readByte.readBytes(e,n,o),void this._readByte.clear()):void t.$warn(3102)},Object.defineProperty(n.prototype,"connected",{get:function(){return this._connected},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e,e!=n.TYPE_BINARY||this._writeByte||(this._readByte=new t.ByteArray,this._writeByte=new t.ByteArray)},enumerable:!0,configurable:!0}),n.TYPE_STRING="webSocketTypeString",n.TYPE_BINARY="webSocketTypeBinary",n}(t.EventDispatcher);t.WebSocket=e,__reflect(e.prototype,"egret.WebSocket")}(egret||(egret={}));var egret;!function(t){var e;!function(e){var n=function(){function e(){this.host="",this.port=0,window.WebSocket||t.$error(3100)}return e.prototype.addCallBacks=function(t,e,n,o,i){this.onConnect=t,this.onClose=e,this.onSocketData=n,this.onError=o,this.thisObject=i},e.prototype.connect=function(t,e){this.host=t,this.port=e;var n="ws://"+this.host+":"+this.port;this.socket=new window.WebSocket(n),this.socket.binaryType="arraybuffer",this._bindEvent()},e.prototype.connectByUrl=function(t){this.socket=new window.WebSocket(t),this.socket.binaryType="arraybuffer",this._bindEvent()},e.prototype._bindEvent=function(){var t=this,e=this.socket;e.onopen=function(){t.onConnect&&t.onConnect.call(t.thisObject)},e.onclose=function(e){t.onClose&&t.onClose.call(t.thisObject)},e.onerror=function(e){t.onError&&t.onError.call(t.thisObject)},e.onmessage=function(e){t.onSocketData&&(e.data?t.onSocketData.call(t.thisObject,e.data):t.onSocketData.call(t.thisObject,e))}},e.prototype.send=function(t){this.socket.send(t)},e.prototype.close=function(){this.socket.close()},e.prototype.disconnect=function(){this.socket.disconnect&&this.socket.disconnect()},e}();e.HTML5WebSocket=n,__reflect(n.prototype,"egret.web.HTML5WebSocket",["egret.ISocket"]),t.ISocket=n}(e=t.web||(t.web={}))}(egret||(egret={}));

 //js/particle.min_d717ba80.js
var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);i.prototype=e.prototype,t.prototype=new i},particle;!function(t){var e=function(){function t(){this.matrix=new egret.Matrix,this.reset()}return t.prototype.reset=function(){this.x=0,this.y=0,this.scale=1,this.rotation=0,this.alpha=1,this.currentTime=0,this.totalTime=1e3},t.prototype.$getMatrix=function(t,e){var i=this.matrix;if(i.identity(),this.rotation%360)var a=this.rotation,r=egret.NumberUtils.cos(a),s=egret.NumberUtils.sin(a);else r=1,s=0;return i.append(r*this.scale,s*this.scale,-s*this.scale,r*this.scale,this.x,this.y),(t||e)&&(i.tx-=t*i.a+e*i.c,i.ty-=t*i.b+e*i.d),i},t}();t.Particle=e,__reflect(e.prototype,"particle.Particle");var i=1;if(egret.nativeRender)if(egret_native.nrParticleABIVersion){var a=egret_native.nrParticleABIVersion;i>a?(egret.warn("runtime"),egret.nativeRender=!1):a>i&&(egret.warn(""),egret.nativeRender=!1)}else egret.warn(""),egret.nativeRender=!1}(particle||(particle={}));var particle;!function(t){var e=function(e){function i(t,i){var a=e.call(this)||this;return a._pool=[],a.frameTime=0,a.particles=[],a._emitterX=0,a._emitterY=0,a.emissionTime=-1,a.maxParticles=200,a.numParticles=0,a.particleClass=null,a.$particleConfig=null,a.particleMeasureRect=new egret.Rectangle,a.transformForMeasure=new egret.Matrix,a.bitmapNodeList=[],egret.nativeRender?(a.initConfig(i,0,0),a.changeTexture(t),a.$nativeDisplayObject.addCallBack("on"+egret.Event.COMPLETE,function(){a.dispatchEventWith(egret.Event.COMPLETE)},a)):(a.emissionRate=i,a.texture=t,a.$renderNode=new egret.sys.GroupNode,a.$renderNode.cleanBeforeRender=function(){}),a}return __extends(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(10)},i.prototype.initConfig=function(t,e,i){this.$particleConfig=[t,e,i,0,200],this.emissionRate=t,this._emitterX=e,this._emitterY=i},i.prototype.getParticle=function(){var e;return e=this._pool.length?this._pool.pop():this.particleClass?new this.particleClass:new t.Particle},i.prototype.removeParticle=function(t){var e=this.particles.indexOf(t);return-1!=e?(t.reset(),this.particles.splice(e,1),this._pool.push(t),this.numParticles--,this.bitmapNodeList.length>this.numParticles&&(this.bitmapNodeList.length=this.numParticles,this.$renderNode.drawData.length=this.numParticles),!0):!1},i.prototype.initParticle=function(t){t.x=this.emitterX,t.y=this.emitterY,t.currentTime=0,t.totalTime=1e3},i.prototype.updateRelativeBounds=function(t){t?(null==this.relativeContentBounds&&(this.relativeContentBounds=new egret.Rectangle),this.relativeContentBounds.copyFrom(t),this.relativeContentBounds.x+=this.emitterX,this.relativeContentBounds.y+=this.emitterY):this.relativeContentBounds=null,this.mask=this.relativeContentBounds},Object.defineProperty(i.prototype,"emitterBounds",{get:function(){return this._emitterBounds},set:function(t){this._emitterBounds=t,this.updateRelativeBounds(t),egret.nativeRender&&this.onPropertyChanges()},enumerable:!0,configurable:!0}),i.prototype.onPropertyChanges=function(){this.$nativeDisplayObject.setParticleConfig(this.$particleConfig)},Object.defineProperty(i.prototype,"emitterX",{get:function(){return this._emitterX},set:function(t){this._emitterX=t,this.updateRelativeBounds(this.emitterBounds),egret.nativeRender&&this.onPropertyChanges()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"emitterY",{get:function(){return this._emitterY},set:function(t){this._emitterY=t,this.updateRelativeBounds(this.emitterBounds),egret.nativeRender&&this.onPropertyChanges()},enumerable:!0,configurable:!0}),i.prototype.start=function(t){void 0===t&&(t=-1),0!=this.emissionRate&&(this.emissionTime=t,egret.nativeRender?(this.$particleConfig[3]=t,this.$nativeDisplayObject.setStartToParticle(this.$particleConfig)):(this.timeStamp=egret.getTimer(),egret.startTick(this.update,this)))},i.prototype.stop=function(t){return void 0===t&&(t=!1),egret.nativeRender?void this.$nativeDisplayObject.setStopToParticle(t):(this.emissionTime=0,void(t&&(this.clear(),egret.stopTick(this.update,this))))},i.prototype.update=function(t){var e=t-this.timeStamp;if(this.timeStamp=t,-1==this.emissionTime||this.emissionTime>0){for(this.frameTime+=e;this.frameTime>0;)this.numParticles<this.maxParticles&&this.addOneParticle(),this.frameTime-=this.emissionRate;-1!=this.emissionTime&&(this.emissionTime-=e,this.emissionTime<0&&(this.emissionTime=0))}for(var i,a=0;a<this.numParticles;)i=this.particles[a],i.currentTime<i.totalTime?(this.advanceParticle(i,e),i.currentTime+=e,a++):this.removeParticle(i);return this.$renderDirty=!0,0==this.numParticles&&0==this.emissionTime&&(egret.stopTick(this.update,this),this.dispatchEventWith(egret.Event.COMPLETE)),!1},i.prototype.$measureContentBounds=function(t){if(this.relativeContentBounds)return void t.copyFrom(this.relativeContentBounds);if(this.numParticles>0){for(var e,i=this.texture,a=Math.round(i.$getScaleBitmapWidth()),r=Math.round(i.$getScaleBitmapHeight()),s=egret.Rectangle.create(),n=0;n<this.numParticles;n++){e=this.particles[n],this.transformForMeasure.identity(),this.appendTransform(this.transformForMeasure,e.x,e.y,e.scale,e.scale,e.rotation,0,0,a/2,r/2),this.particleMeasureRect.setEmpty(),this.particleMeasureRect.width=a,this.particleMeasureRect.height=r;var o=Region.create();if(o.updateRegion(this.particleMeasureRect,this.transformForMeasure),0==n)s.setTo(o.minX,o.minY,o.maxX-o.minX,o.maxY-o.minY);else{var h=Math.min(s.x,o.minX),l=Math.min(s.y,o.minY),c=Math.max(s.right,o.maxX),p=Math.max(s.bottom,o.maxY);s.setTo(h,l,c-h,p-l)}Region.release(o)}this.lastRect=s,t.setTo(s.x,s.y,s.width,s.height),egret.Rectangle.release(s)}else this.lastRect&&(s=this.lastRect,t.setTo(s.x,s.y,s.width,s.height),egret.Rectangle.release(s),this.lastRect=null)},i.prototype.setCurrentParticles=function(t){if(!egret.nativeRender)for(var e=this.numParticles;t>e&&this.numParticles<this.maxParticles;e++)this.addOneParticle()},i.prototype.changeTexture=function(t){this.texture!=t&&(this.texture=t,egret.nativeRender?this.$nativeDisplayObject.setBitmapDataToParticle(t):(this.bitmapNodeList.length=0,this.$renderNode.drawData.length=0))},i.prototype.clear=function(){for(;this.particles.length;)this.removeParticle(this.particles[0]);this.numParticles=0,this.$renderNode.drawData.length=0,this.bitmapNodeList.length=0,this.$renderDirty=!0,this._pool.length=0},i.prototype.addOneParticle=function(){var t=this.getParticle();this.initParticle(t),t.totalTime>0&&(this.particles.push(t),this.numParticles++)},i.prototype.advanceParticle=function(t,e){t.y-=e/6},i.prototype.$updateRenderNode=function(){if(!egret.nativeRender&&this.numParticles>0)for(var t,e=this.texture,i=Math.round(e.$getScaleBitmapWidth()),a=Math.round(e.$getScaleBitmapHeight()),r=e.$offsetX,s=e.$offsetY,n=e.$bitmapX,o=e.$bitmapY,h=e.$bitmapWidth,l=e.$bitmapHeight,c=0;c<this.numParticles;c++){t=this.particles[c];var p;this.bitmapNodeList[c]||(p=new egret.sys.BitmapNode,this.bitmapNodeList[c]=p,this.$renderNode.addNode(this.bitmapNodeList[c]),p.image=e.$bitmapData,p.imageWidth=e.$sourceWidth,p.imageHeight=e.$sourceHeight,p.drawImage(n,o,h,l,r,s,i,a)),p=this.bitmapNodeList[c],p.matrix=t.$getMatrix(i/2,a/2),p.blendMode=t.blendMode,p.alpha=t.alpha}},i.prototype.appendTransform=function(t,e,i,a,r,s,n,o,h,l){if(s%360)var c=s,p=egret.NumberUtils.cos(c),u=egret.NumberUtils.sin(c);else p=1,u=0;return n||o?(t.append(egret.NumberUtils.cos(o),egret.NumberUtils.sin(o),-egret.NumberUtils.sin(n),egret.NumberUtils.cos(n),e,i),t.append(p*a,u*a,-u*r,p*r,0,0)):t.append(p*a,u*a,-u*r,p*r,e,i),(h||l)&&(t.tx-=h*t.a+l*t.c,t.ty-=h*t.b+l*t.d),t},i}(egret.DisplayObject);t.ParticleSystem=e,__reflect(e.prototype,"particle.ParticleSystem")}(particle||(particle={}));var regionPool=[],Region=function(){function t(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.width=0,this.height=0,this.area=0}return t.release=function(t){regionPool.push(t)},t.create=function(){var e=regionPool.pop();return e||(e=new t),e},t.prototype.setEmpty=function(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.width=0,this.height=0,this.area=0},t.prototype.updateRegion=function(t,e){if(0==t.width||0==t.height)return void this.setEmpty();var i,a,r,s,n=e,o=n.a,h=n.b,l=n.c,c=n.d,p=n.tx,u=n.ty,m=t.x,d=t.y,g=m+t.width,f=d+t.height;if(1==o&&0==h&&0==l&&1==c)i=m+p-1,a=d+u-1,r=g+p+1,s=f+u+1;else{var v=o*m+l*d+p,y=h*m+c*d+u,P=o*g+l*d+p,R=h*g+c*d+u,V=o*g+l*f+p,x=h*g+c*f+u,_=o*m+l*f+p,C=h*m+c*f+u,b=0;v>P&&(b=v,v=P,P=b),V>_&&(b=V,V=_,_=b),i=(V>v?v:V)-1,r=(P>_?P:_)+1,y>R&&(b=y,y=R,R=b),x>C&&(b=x,x=C,C=b),a=(x>y?y:x)-1,s=(R>C?R:C)+1}this.minX=i,this.minY=a,this.maxX=r,this.maxY=s,this.width=r-i,this.height=s-a,this.area=this.width*this.height},t}();__reflect(Region.prototype,"Region");var particle;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.reset=function(){t.prototype.reset.call(this),this.startX=0,this.startY=0,this.velocityX=0,this.velocityY=0,this.radialAcceleration=0,this.tangentialAcceleration=0,this.rotationDelta=0,this.scaleDelta=0},e}(t.Particle);t.GravityParticle=e,__reflect(e.prototype,"particle.GravityParticle")}(particle||(particle={}));var particle;!function(t){var e=function(e){function i(i,a){var r=e.call(this,i,200)||this;return r.$init=!1,r.parseConfig(a),r.emissionRate=r.lifespan/r.maxParticles,r.particleClass=t.GravityParticle,r.$init=!0,r}return __extends(i,e),i.prototype.start=function(t){if(void 0===t&&(t=-1),egret.nativeRender){0!=this.emissionRate&&(this.emissionTime=t),this.$particleConfig[2]=t;var i=[],a=0;for(var r in this.$particleConfig)i.push(a++),i.push(this.$particleConfig[r]);this.$nativeDisplayObject.setStartToParticle(i)}else e.prototype.start.call(this,t)},i.prototype.setCurrentParticles=function(t){if(!(t>this.maxParticles)){var e=[];e.push(35),e.push(t),this.$nativeDisplayObject.setParticleConfig(e)}},i.prototype.onPropertyChanges=function(){if(0!=this.$init){var t=[];t.push(0),this.$particleConfig[0]=this._emitterX,t.push(this._emitterX),t.push(1),this.$particleConfig[1]=this._emitterY,t.push(this._emitterY),this.relativeContentBounds&&(t.push(31),this.$particleConfig[31]=this.relativeContentBounds.x,t.push(this.relativeContentBounds.x),t.push(32),this.$particleConfig[32]=this.relativeContentBounds.y,t.push(this.relativeContentBounds.y),t.push(33),this.$particleConfig[33]=this.relativeContentBounds.width,t.push(this.relativeContentBounds.width),t.push(34),this.$particleConfig[34]=this.relativeContentBounds.height,t.push(this.relativeContentBounds.height)),this.$nativeDisplayObject.setParticleConfig(t)}},i.prototype.parseConfig=function(t){function e(t){return"undefined"==typeof t?0:t}if(egret.nativeRender?(this._emitterX=e(t.emitter.x),this._emitterY=e(t.emitter.y)):(this.emitterX=e(t.emitter.x),this.emitterY=e(t.emitter.y)),this.emitterXVariance=e(t.emitterVariance.x),this.emitterYVariance=e(t.emitterVariance.y),this.gravityX=e(t.gravity.x),this.gravityY=e(t.gravity.y),1==t.useEmitterRect){var i=new egret.Rectangle;i.x=e(t.emitterRect.x),i.y=e(t.emitterRect.y),i.width=e(t.emitterRect.width),i.height=e(t.emitterRect.height),this.emitterBounds=i}this.maxParticles=e(t.maxParticles),this.speed=e(t.speed),this.speedVariance=e(t.speedVariance),this.lifespan=Math.max(.01,e(t.lifespan)),this.lifespanVariance=e(t.lifespanVariance),this.emitAngle=e(t.emitAngle),this.emitAngleVariance=e(t.emitAngleVariance),this.startSize=e(t.startSize),this.startSizeVariance=e(t.startSizeVariance),this.endSize=e(t.endSize),this.endSizeVariance=e(t.endSizeVariance),this.startRotation=e(t.startRotation),this.startRotationVariance=e(t.startRotationVariance),this.endRotation=e(t.endRotation),this.endRotationVariance=e(t.endRotationVariance),this.radialAcceleration=e(t.radialAcceleration),this.radialAccelerationVariance=e(t.radialAccelerationVariance),this.tangentialAcceleration=e(t.tangentialAcceleration),this.tangentialAccelerationVariance=e(t.tangentialAccelerationVariance),this.startAlpha=e(t.startAlpha),this.startAlphaVariance=e(t.startAlphaVariance),this.endAlpha=e(t.endAlpha),this.endAlphaVariance=e(t.endAlphaVariance),egret.nativeRender?t.blendMode&&(this.particleBlendMode=t.blendMode):this.particleBlendMode=t.blendMode,this.$particleConfig={0:this.emitterX,1:this.emitterY,2:-1,3:this.maxParticles,4:this.emitterXVariance,5:this.emitterYVariance,6:this.gravityX,7:this.gravityY,8:this.speed,9:this.speedVariance,10:this.lifespan,11:this.lifespanVariance,12:this.emitAngle,13:this.emitAngleVariance,14:this.startSize,15:this.startSizeVariance,16:this.endSize,17:this.endSizeVariance,18:this.startRotation,19:this.startRotationVariance,20:this.endRotation,21:this.endRotationVariance,22:this.radialAcceleration,23:this.radialAccelerationVariance,24:this.tangentialAcceleration,25:this.tangentialAccelerationVariance,26:this.startAlpha,27:this.startAlphaVariance,28:this.endAlpha,29:this.endAlphaVariance,30:this.particleBlendMode,31:t.useEmitterRect?this.relativeContentBounds.x:0,32:t.useEmitterRect?this.relativeContentBounds.y:0,33:t.useEmitterRect?this.relativeContentBounds.width:0,34:t.useEmitterRect?this.relativeContentBounds.height:0,35:0}},i.prototype.initParticle=function(t){var e=t,a=i.getValue(this.lifespan,this.lifespanVariance);if(e.currentTime=0,e.totalTime=a>0?a:0,!(0>=a)){e.x=i.getValue(this.emitterX,this.emitterXVariance),e.y=i.getValue(this.emitterY,this.emitterYVariance),e.startX=this.emitterX,e.startY=this.emitterY;var r=i.getValue(this.emitAngle,this.emitAngleVariance),s=i.getValue(this.speed,this.speedVariance);e.velocityX=s*egret.NumberUtils.cos(r),e.velocityY=s*egret.NumberUtils.sin(r),e.radialAcceleration=i.getValue(this.radialAcceleration,this.radialAccelerationVariance),e.tangentialAcceleration=i.getValue(this.tangentialAcceleration,this.tangentialAccelerationVariance);var n=i.getValue(this.startSize,this.startSizeVariance);.1>n&&(n=.1);var o=i.getValue(this.endSize,this.endSizeVariance);.1>o&&(o=.1);var h=this.texture.textureWidth;e.scale=n/h,e.scaleDelta=(o-n)/a/h;var l=i.getValue(this.startRotation,this.startRotationVariance),c=i.getValue(this.endRotation,this.endRotationVariance);e.rotation=l,e.rotationDelta=(c-l)/a;var p=i.getValue(this.startAlpha,this.startAlphaVariance),u=i.getValue(this.endAlpha,this.endAlphaVariance);e.alpha=p,e.alphaDelta=(u-p)/a,e.blendMode=this.particleBlendMode}},i.getValue=function(t,e){return t+e*(2*Math.random()-1)},i.prototype.advanceParticle=function(t,e){var i=t;e/=1e3;var a=i.totalTime-i.currentTime;e=a>e?e:a,i.currentTime+=e;var r=i.x-i.startX,s=i.y-i.startY,n=Math.sqrt(r*r+s*s);.01>n&&(n=.01);var o=r/n,h=s/n,l=o,c=h;o*=i.radialAcceleration,h*=i.radialAcceleration;var p=l;l=-c*i.tangentialAcceleration,c=p*i.tangentialAcceleration,i.velocityX+=e*(this.gravityX+o+l),i.velocityY+=e*(this.gravityY+h+c),i.x+=i.velocityX*e,i.y+=i.velocityY*e,i.scale+=i.scaleDelta*e*1e3,i.scale<0&&(i.scale=0),i.rotation+=i.rotationDelta*e*1e3,i.alpha+=i.alphaDelta*e*1e3},i}(t.ParticleSystem);t.GravityParticleSystem=e,__reflect(e.prototype,"particle.GravityParticleSystem")}(particle||(particle={}));

 //js/physics.min_2fdcf68e.js
!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define,1){var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.p2=t()}else define(t)}(function(){return function t(e,o,i){function n(a,s){if(!o[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+a+"'")}var h=o[a]={exports:{}};e[a][0].call(h.exports,function(t){var o=e[a][1][t];return n(o?o:t)},h,h.exports,t,e,o,i)}return o[a].exports}for(var r="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(t,e,o){function i(){}var n=t("./Scalar");e.exports=i,i.lineInt=function(t,e,o){o=o||0;var i,r,a,s,c,h,l,p=[0,0];return i=t[1][1]-t[0][1],r=t[0][0]-t[1][0],a=i*t[0][0]+r*t[0][1],s=e[1][1]-e[0][1],c=e[0][0]-e[1][0],h=s*e[0][0]+c*e[0][1],l=i*c-s*r,n.eq(l,0,o)||(p[0]=(c*a-r*h)/l,p[1]=(i*h-s*a)/l),p},i.segmentsIntersect=function(t,e,o,i){var n=e[0]-t[0],r=e[1]-t[1],a=i[0]-o[0],s=i[1]-o[1];if(a*r-s*n==0)return!1;var c=(n*(o[1]-t[1])+r*(t[0]-o[0]))/(a*r-s*n),h=(a*(t[1]-o[1])+s*(o[0]-t[0]))/(s*n-a*r);return c>=0&&1>=c&&h>=0&&1>=h}},{"./Scalar":4}],2:[function(t,e,o){function i(){}e.exports=i,i.area=function(t,e,o){return(e[0]-t[0])*(o[1]-t[1])-(o[0]-t[0])*(e[1]-t[1])},i.left=function(t,e,o){return i.area(t,e,o)>0},i.leftOn=function(t,e,o){return i.area(t,e,o)>=0},i.right=function(t,e,o){return i.area(t,e,o)<0},i.rightOn=function(t,e,o){return i.area(t,e,o)<=0};var n=[],r=[];i.collinear=function(t,e,o,a){if(a){var s=n,c=r;s[0]=e[0]-t[0],s[1]=e[1]-t[1],c[0]=o[0]-e[0],c[1]=o[1]-e[1];var h=s[0]*c[0]+s[1]*c[1],l=Math.sqrt(s[0]*s[0]+s[1]*s[1]),p=Math.sqrt(c[0]*c[0]+c[1]*c[1]),u=Math.acos(h/(l*p));return a>u}return 0==i.area(t,e,o)},i.sqdist=function(t,e){var o=e[0]-t[0],i=e[1]-t[1];return o*o+i*i}},{}],3:[function(t,e,o){function i(){this.vertices=[]}function n(t,e,o,i,n){n=n||0;var r=e[1]-t[1],a=t[0]-e[0],c=r*t[0]+a*t[1],h=i[1]-o[1],l=o[0]-i[0],p=h*o[0]+l*o[1],u=r*l-h*a;return s.eq(u,0,n)?[0,0]:[(l*c-a*p)/u,(r*p-h*c)/u]}var r=t("./Line"),a=t("./Point"),s=t("./Scalar");e.exports=i,i.prototype.at=function(t){var e=this.vertices,o=e.length;return e[0>t?t%o+o:t%o]},i.prototype.first=function(){return this.vertices[0]},i.prototype.last=function(){return this.vertices[this.vertices.length-1]},i.prototype.clear=function(){this.vertices.length=0},i.prototype.append=function(t,e,o){if("undefined"==typeof e)throw new Error("From is not given!");if("undefined"==typeof o)throw new Error("To is not given!");if(e>o-1)throw new Error("lol1");if(o>t.vertices.length)throw new Error("lol2");if(0>e)throw new Error("lol3");for(var i=e;o>i;i++)this.vertices.push(t.vertices[i])},i.prototype.makeCCW=function(){for(var t=0,e=this.vertices,o=1;o<this.vertices.length;++o)(e[o][1]<e[t][1]||e[o][1]==e[t][1]&&e[o][0]>e[t][0])&&(t=o);a.left(this.at(t-1),this.at(t),this.at(t+1))||this.reverse()},i.prototype.reverse=function(){for(var t=[],e=0,o=this.vertices.length;e!==o;e++)t.push(this.vertices.pop());this.vertices=t},i.prototype.isReflex=function(t){return a.right(this.at(t-1),this.at(t),this.at(t+1))};var c=[],h=[];i.prototype.canSee=function(t,e){var o,i,n=c,s=h;if(a.leftOn(this.at(t+1),this.at(t),this.at(e))&&a.rightOn(this.at(t-1),this.at(t),this.at(e)))return!1;i=a.sqdist(this.at(t),this.at(e));for(var l=0;l!==this.vertices.length;++l)if((l+1)%this.vertices.length!==t&&l!==t&&a.leftOn(this.at(t),this.at(e),this.at(l+1))&&a.rightOn(this.at(t),this.at(e),this.at(l))&&(n[0]=this.at(t),n[1]=this.at(e),s[0]=this.at(l),s[1]=this.at(l+1),o=r.lineInt(n,s),a.sqdist(this.at(t),o)<i))return!1;return!0},i.prototype.copy=function(t,e,o){var n=o||new i;if(n.clear(),e>t)for(var r=t;e>=r;r++)n.vertices.push(this.vertices[r]);else{for(var r=0;e>=r;r++)n.vertices.push(this.vertices[r]);for(var r=t;r<this.vertices.length;r++)n.vertices.push(this.vertices[r])}return n},i.prototype.getCutEdges=function(){for(var t=[],e=[],o=[],n=new i,r=Number.MAX_VALUE,a=0;a<this.vertices.length;++a)if(this.isReflex(a))for(var s=0;s<this.vertices.length;++s)if(this.canSee(a,s)){e=this.copy(a,s,n).getCutEdges(),o=this.copy(s,a,n).getCutEdges();for(var c=0;c<o.length;c++)e.push(o[c]);e.length<r&&(t=e,r=e.length,t.push([this.at(a),this.at(s)]))}return t},i.prototype.decomp=function(){var t=this.getCutEdges();return t.length>0?this.slice(t):[this]},i.prototype.slice=function(t){if(0==t.length)return[this];if(t instanceof Array&&t.length&&t[0]instanceof Array&&2==t[0].length&&t[0][0]instanceof Array){for(var e=[this],o=0;o<t.length;o++)for(var i=t[o],n=0;n<e.length;n++){var r=e[n],a=r.slice(i);if(a){e.splice(n,1),e.push(a[0],a[1]);break}}return e}var i=t,o=this.vertices.indexOf(i[0]),n=this.vertices.indexOf(i[1]);return-1!=o&&-1!=n?[this.copy(o,n),this.copy(n,o)]:!1},i.prototype.isSimple=function(){for(var t=this.vertices,e=0;e<t.length-1;e++)for(var o=0;e-1>o;o++)if(r.segmentsIntersect(t[e],t[e+1],t[o],t[o+1]))return!1;for(var e=1;e<t.length-2;e++)if(r.segmentsIntersect(t[0],t[t.length-1],t[e],t[e+1]))return!1;return!0},i.prototype.quickDecomp=function(t,e,o,r,s,c){s=s||100,c=c||0,r=r||25,t="undefined"!=typeof t?t:[],e=e||[],o=o||[];var h=[0,0],l=[0,0],p=[0,0],u=0,d=0,f=0,v=0,y=0,m=0,g=0,A=new i,b=new i,E=this,B=this.vertices;if(B.length<3)return t;if(c++,c>s)return console.warn("quickDecomp: max level ("+s+") reached."),t;for(var q=0;q<this.vertices.length;++q)if(E.isReflex(q)){e.push(E.vertices[q]),u=d=Number.MAX_VALUE;for(var P=0;P<this.vertices.length;++P)a.left(E.at(q-1),E.at(q),E.at(P))&&a.rightOn(E.at(q-1),E.at(q),E.at(P-1))&&(p=n(E.at(q-1),E.at(q),E.at(P),E.at(P-1)),a.right(E.at(q+1),E.at(q),p)&&(f=a.sqdist(E.vertices[q],p),d>f&&(d=f,l=p,m=P))),a.left(E.at(q+1),E.at(q),E.at(P+1))&&a.rightOn(E.at(q+1),E.at(q),E.at(P))&&(p=n(E.at(q+1),E.at(q),E.at(P),E.at(P+1)),a.left(E.at(q-1),E.at(q),p)&&(f=a.sqdist(E.vertices[q],p),u>f&&(u=f,h=p,y=P)));if(m==(y+1)%this.vertices.length)p[0]=(l[0]+h[0])/2,p[1]=(l[1]+h[1])/2,o.push(p),y>q?(A.append(E,q,y+1),A.vertices.push(p),b.vertices.push(p),0!=m&&b.append(E,m,E.vertices.length),b.append(E,0,q+1)):(0!=q&&A.append(E,q,E.vertices.length),A.append(E,0,y+1),A.vertices.push(p),b.vertices.push(p),b.append(E,m,q+1));else{if(m>y&&(y+=this.vertices.length),v=Number.MAX_VALUE,m>y)return t;for(var P=m;y>=P;++P)a.leftOn(E.at(q-1),E.at(q),E.at(P))&&a.rightOn(E.at(q+1),E.at(q),E.at(P))&&(f=a.sqdist(E.at(q),E.at(P)),v>f&&(v=f,g=P%this.vertices.length));g>q?(A.append(E,q,g+1),0!=g&&b.append(E,g,B.length),b.append(E,0,q+1)):(0!=q&&A.append(E,q,B.length),A.append(E,0,g+1),b.append(E,g,q+1))}return A.vertices.length<b.vertices.length?(A.quickDecomp(t,e,o,r,s,c),b.quickDecomp(t,e,o,r,s,c)):(b.quickDecomp(t,e,o,r,s,c),A.quickDecomp(t,e,o,r,s,c)),t}return t.push(this),t},i.prototype.removeCollinearPoints=function(t){for(var e=0,o=this.vertices.length-1;this.vertices.length>3&&o>=0;--o)a.collinear(this.at(o-1),this.at(o),this.at(o+1),t)&&(this.vertices.splice(o%this.vertices.length,1),o--,e++);return e}},{"./Line":1,"./Point":2,"./Scalar":4}],4:[function(t,e,o){function i(){}e.exports=i,i.eq=function(t,e,o){return o=o||0,Math.abs(t-e)<o}},{}],5:[function(t,e,o){e.exports={Polygon:t("./Polygon"),Point:t("./Point")}},{"./Point":2,"./Polygon":3}],6:[function(t,e,o){e.exports={name:"p2",version:"0.7.0",description:"A JavaScript 2D physics engine.",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["p2.js","p2","physics","engine","2d"],main:"./src/p2.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/p2.js.git"},bugs:{url:"https://github.com/schteppe/p2.js/issues"},licenses:[{type:"MIT"}],devDependencies:{grunt:"^0.4.5","grunt-contrib-jshint":"^0.11.2","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-uglify":"~0.4.0","grunt-contrib-watch":"~0.5.0","grunt-browserify":"~2.0.1","grunt-contrib-concat":"^0.4.0"},dependencies:{"poly-decomp":"0.1.0"}}},{}],7:[function(t,e,o){function i(t){this.lowerBound=n.create(),t&&t.lowerBound&&n.copy(this.lowerBound,t.lowerBound),this.upperBound=n.create(),t&&t.upperBound&&n.copy(this.upperBound,t.upperBound)}var n=t("../math/vec2");t("../utils/Utils"),e.exports=i;var r=n.create();i.prototype.setFromPoints=function(t,e,o,i){var a=this.lowerBound,s=this.upperBound;"number"!=typeof o&&(o=0),0!==o?n.rotate(a,t[0],o):n.copy(a,t[0]),n.copy(s,a);for(var c=Math.cos(o),h=Math.sin(o),l=1;l<t.length;l++){var p=t[l];if(0!==o){var u=p[0],d=p[1];r[0]=c*u-h*d,r[1]=h*u+c*d,p=r}for(var f=0;2>f;f++)p[f]>s[f]&&(s[f]=p[f]),p[f]<a[f]&&(a[f]=p[f])}e&&(n.add(this.lowerBound,this.lowerBound,e),n.add(this.upperBound,this.upperBound,e)),i&&(this.lowerBound[0]-=i,this.lowerBound[1]-=i,this.upperBound[0]+=i,this.upperBound[1]+=i)},i.prototype.copy=function(t){n.copy(this.lowerBound,t.lowerBound),n.copy(this.upperBound,t.upperBound)},i.prototype.extend=function(t){for(var e=2;e--;){var o=t.lowerBound[e];this.lowerBound[e]>o&&(this.lowerBound[e]=o);var i=t.upperBound[e];this.upperBound[e]<i&&(this.upperBound[e]=i)}},i.prototype.overlaps=function(t){var e=this.lowerBound,o=this.upperBound,i=t.lowerBound,n=t.upperBound;return(i[0]<=o[0]&&o[0]<=n[0]||e[0]<=n[0]&&n[0]<=o[0])&&(i[1]<=o[1]&&o[1]<=n[1]||e[1]<=n[1]&&n[1]<=o[1])},i.prototype.containsPoint=function(t){var e=this.lowerBound,o=this.upperBound;return e[0]<=t[0]&&t[0]<=o[0]&&e[1]<=t[1]&&t[1]<=o[1]},i.prototype.overlapsRay=function(t){var e=1/t.direction[0],o=1/t.direction[1],i=(this.lowerBound[0]-t.from[0])*e,n=(this.upperBound[0]-t.from[0])*e,r=(this.lowerBound[1]-t.from[1])*o,a=(this.upperBound[1]-t.from[1])*o,s=Math.max(Math.max(Math.min(i,n),Math.min(r,a))),c=Math.min(Math.min(Math.max(i,n),Math.max(r,a)));return 0>c?-1:s>c?-1:s}},{"../math/vec2":30,"../utils/Utils":57}],8:[function(t,e,o){function i(t){this.type=t,this.result=[],this.world=null,this.boundingVolumeType=i.AABB}var n=t("../math/vec2"),r=t("../objects/Body");e.exports=i,i.AABB=1,i.BOUNDING_CIRCLE=2,i.prototype.setWorld=function(t){this.world=t},i.prototype.getCollisionPairs=function(t){};var a=n.create();i.boundingRadiusCheck=function(t,e){n.sub(a,t.position,e.position);var o=n.squaredLength(a),i=t.boundingRadius+e.boundingRadius;return i*i>=o},i.aabbCheck=function(t,e){return t.getAABB().overlaps(e.getAABB())},i.prototype.boundingVolumeCheck=function(t,e){var o;switch(this.boundingVolumeType){case i.BOUNDING_CIRCLE:o=i.boundingRadiusCheck(t,e);break;case i.AABB:o=i.aabbCheck(t,e);break;default:throw new Error("Bounding volume type not recognized: "+this.boundingVolumeType)}return o},i.canCollide=function(t,e){var o=r.KINEMATIC,i=r.STATIC;return t.type===i&&e.type===i?!1:t.type===o&&e.type===i||t.type===i&&e.type===o?!1:t.type===o&&e.type===o?!1:t.sleepState===r.SLEEPING&&e.sleepState===r.SLEEPING?!1:t.sleepState===r.SLEEPING&&e.type===i||e.sleepState===r.SLEEPING&&t.type===i?!1:!0},i.NAIVE=1,i.SAP=2},{"../math/vec2":30,"../objects/Body":31}],9:[function(t,e,o){function i(){n.call(this,n.NAIVE)}var n=(t("../shapes/Circle"),t("../shapes/Plane"),t("../shapes/Shape"),t("../shapes/Particle"),t("../collision/Broadphase"));t("../math/vec2"),e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.getCollisionPairs=function(t){var e=t.bodies,o=this.result;o.length=0;for(var i=0,r=e.length;i!==r;i++)for(var a=e[i],s=0;i>s;s++){var c=e[s];n.canCollide(a,c)&&this.boundingVolumeCheck(a,c)&&o.push(a,c)}return o},i.prototype.aabbQuery=function(t,e,o){o=o||[];for(var i=t.bodies,n=0;n<i.length;n++){var r=i[n];r.aabbNeedsUpdate&&r.updateAABB(),r.aabb.overlaps(e)&&o.push(r)}return o}},{"../collision/Broadphase":8,"../math/vec2":30,"../shapes/Circle":39,"../shapes/Particle":43,"../shapes/Plane":44,"../shapes/Shape":45}],10:[function(t,e,o){function i(){this.contactEquations=[],this.frictionEquations=[],this.enableFriction=!0,this.enabledEquations=!0,this.slipForce=10,this.frictionCoefficient=.3,this.surfaceVelocity=0,this.contactEquationPool=new l({size:32}),this.frictionEquationPool=new p({size:64}),this.restitution=0,this.stiffness=d.DEFAULT_STIFFNESS,this.relaxation=d.DEFAULT_RELAXATION,this.frictionStiffness=d.DEFAULT_STIFFNESS,this.frictionRelaxation=d.DEFAULT_RELAXATION,this.enableFrictionReduction=!0,this.collidingBodiesLastStep=new u,this.contactSkinSize=.01}function n(t,e){a.set(t.vertices[0],.5*-e.length,-e.radius),a.set(t.vertices[1],.5*e.length,-e.radius),a.set(t.vertices[2],.5*e.length,e.radius),a.set(t.vertices[3],.5*-e.length,e.radius)}function r(t,e,o,i){for(var n=j,r=z,h=Y,l=K,p=t,u=e.vertices,d=null,f=0;f!==u.length+1;f++){var v=u[f%u.length],y=u[(f+1)%u.length];a.rotate(n,v,i),a.rotate(r,y,i),c(n,n,o),c(r,r,o),s(h,n,p),s(l,r,p);var m=a.crossLength(h,l);if(null===d&&(d=m),0>=m*d)return!1;d=m}return!0}var a=t("../math/vec2"),s=a.sub,c=a.add,h=a.dot,l=(t("../utils/Utils"),t("../utils/ContactEquationPool")),p=t("../utils/FrictionEquationPool"),u=t("../utils/TupleDictionary"),d=t("../equations/Equation"),f=(t("../equations/ContactEquation"),t("../equations/FrictionEquation"),t("../shapes/Circle")),v=t("../shapes/Convex"),y=t("../shapes/Shape"),m=(t("../objects/Body"),t("../shapes/Box"));e.exports=i;var g=a.fromValues(0,1),A=a.fromValues(0,0),b=a.fromValues(0,0),E=a.fromValues(0,0),B=a.fromValues(0,0),q=a.fromValues(0,0),P=a.fromValues(0,0),w=a.fromValues(0,0),S=a.fromValues(0,0),C=a.fromValues(0,0),L=a.fromValues(0,0),x=a.fromValues(0,0),F=a.fromValues(0,0),M=a.fromValues(0,0),I=a.fromValues(0,0),R=a.fromValues(0,0),V=a.fromValues(0,0),T=a.fromValues(0,0),N=a.fromValues(0,0),G=[],O=a.create(),U=a.create();i.prototype.bodiesOverlap=function(t,e){for(var o=O,i=U,n=0,r=t.shapes.length;n!==r;n++){var a=t.shapes[n];t.toWorldFrame(o,a.position);for(var s=0,c=e.shapes.length;s!==c;s++){var h=e.shapes[s];if(e.toWorldFrame(i,h.position),this[a.type|h.type](t,a,o,a.angle+t.angle,e,h,i,h.angle+e.angle,!0))return!0}}return!1},i.prototype.collidedLastStep=function(t,e){var o=0|t.id,i=0|e.id;return!!this.collidingBodiesLastStep.get(o,i)},i.prototype.reset=function(){this.collidingBodiesLastStep.reset();for(var t=this.contactEquations,e=t.length;e--;){var o=t[e],i=o.bodyA.id,n=o.bodyB.id;this.collidingBodiesLastStep.set(i,n,!0)}for(var r=this.contactEquations,a=this.frictionEquations,s=0;s<r.length;s++)this.contactEquationPool.release(r[s]);for(var s=0;s<a.length;s++)this.frictionEquationPool.release(a[s]);this.contactEquations.length=this.frictionEquations.length=0},i.prototype.createContactEquation=function(t,e,o,i){var n=this.contactEquationPool.get();return n.bodyA=t,n.bodyB=e,n.shapeA=o,n.shapeB=i,n.restitution=this.restitution,n.firstImpact=!this.collidedLastStep(t,e),n.stiffness=this.stiffness,n.relaxation=this.relaxation,n.needsUpdate=!0,n.enabled=this.enabledEquations,n.offset=this.contactSkinSize,n},i.prototype.createFrictionEquation=function(t,e,o,i){var n=this.frictionEquationPool.get();return n.bodyA=t,n.bodyB=e,n.shapeA=o,n.shapeB=i,n.setSlipForce(this.slipForce),n.frictionCoefficient=this.frictionCoefficient,n.relativeVelocity=this.surfaceVelocity,n.enabled=this.enabledEquations,n.needsUpdate=!0,n.stiffness=this.frictionStiffness,n.relaxation=this.frictionRelaxation,n.contactEquations.length=0,n},i.prototype.createFrictionFromContact=function(t){var e=this.createFrictionEquation(t.bodyA,t.bodyB,t.shapeA,t.shapeB);return a.copy(e.contactPointA,t.contactPointA),a.copy(e.contactPointB,t.contactPointB),a.rotate90cw(e.t,t.normalA),e.contactEquations.push(t),e},i.prototype.createFrictionFromAverage=function(t){var e=this.contactEquations[this.contactEquations.length-1],o=this.createFrictionEquation(e.bodyA,e.bodyB,e.shapeA,e.shapeB),i=e.bodyA;e.bodyB,a.set(o.contactPointA,0,0),a.set(o.contactPointB,0,0),a.set(o.t,0,0);for(var n=0;n!==t;n++)e=this.contactEquations[this.contactEquations.length-1-n],e.bodyA===i?(a.add(o.t,o.t,e.normalA),a.add(o.contactPointA,o.contactPointA,e.contactPointA),a.add(o.contactPointB,o.contactPointB,e.contactPointB)):(a.sub(o.t,o.t,e.normalA),a.add(o.contactPointA,o.contactPointA,e.contactPointB),a.add(o.contactPointB,o.contactPointB,e.contactPointA)),o.contactEquations.push(e);var r=1/t;return a.scale(o.contactPointA,o.contactPointA,r),a.scale(o.contactPointB,o.contactPointB,r),a.normalize(o.t,o.t),a.rotate90cw(o.t,o.t),o},i.prototype[y.LINE|y.CONVEX]=i.prototype.convexLine=function(t,e,o,i,n,r,a,s,c){return c?!1:0},i.prototype[y.LINE|y.BOX]=i.prototype.lineBox=function(t,e,o,i,n,r,a,s,c){return c?!1:0};var k=new m({width:1,height:1}),_=a.create();i.prototype[y.CAPSULE|y.CONVEX]=i.prototype[y.CAPSULE|y.BOX]=i.prototype.convexCapsule=function(t,e,o,i,r,s,c,h,l){var p=_;a.set(p,s.length/2,0),a.rotate(p,p,h),a.add(p,p,c);var u=this.circleConvex(r,s,p,h,t,e,o,i,l,s.radius);a.set(p,-s.length/2,0),a.rotate(p,p,h),a.add(p,p,c);var d=this.circleConvex(r,s,p,h,t,e,o,i,l,s.radius);if(l&&(u||d))return!0;var f=k;n(f,s);var v=this.convexConvex(t,e,o,i,r,f,c,h,l);return v+u+d},i.prototype[y.CAPSULE|y.LINE]=i.prototype.lineCapsule=function(t,e,o,i,n,r,a,s,c){return c?!1:0};var D=a.create(),W=a.create(),X=new m({width:1,height:1});i.prototype[y.CAPSULE|y.CAPSULE]=i.prototype.capsuleCapsule=function(t,e,o,i,r,s,c,h,l){for(var p,u=D,d=W,f=0,v=0;2>v;v++){a.set(u,(0===v?-1:1)*e.length/2,0),a.rotate(u,u,i),a.add(u,u,o);for(var y=0;2>y;y++){a.set(d,(0===y?-1:1)*s.length/2,0),a.rotate(d,d,h),a.add(d,d,c),this.enableFrictionReduction&&(p=this.enableFriction,this.enableFriction=!1);var m=this.circleCircle(t,e,u,i,r,s,d,h,l,e.radius,s.radius);if(this.enableFrictionReduction&&(this.enableFriction=p),l&&m)return!0;f+=m}}this.enableFrictionReduction&&(p=this.enableFriction,this.enableFriction=!1);var g=X;n(g,e);var A=this.convexCapsule(t,g,o,i,r,s,c,h,l);if(this.enableFrictionReduction&&(this.enableFriction=p),l&&A)return!0;if(f+=A,this.enableFrictionReduction){var p=this.enableFriction;this.enableFriction=!1}n(g,s);var b=this.convexCapsule(r,g,c,h,t,e,o,i,l);return this.enableFrictionReduction&&(this.enableFriction=p),l&&b?!0:(f+=b,this.enableFrictionReduction&&f&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(f)),f)},i.prototype[y.LINE|y.LINE]=i.prototype.lineLine=function(t,e,o,i,n,r,a,s,c){return c?!1:0},i.prototype[y.PLANE|y.LINE]=i.prototype.planeLine=function(t,e,o,i,n,r,l,p,u){var d=A,f=b,v=E,y=B,m=q,L=P,x=w,F=S,M=C,I=G,R=0;a.set(d,-r.length/2,0),a.set(f,r.length/2,0),a.rotate(v,d,p),a.rotate(y,f,p),c(v,v,l),c(y,y,l),a.copy(d,v),a.copy(f,y),s(m,f,d),a.normalize(L,m),a.rotate90cw(M,L),a.rotate(F,g,i),I[0]=d,I[1]=f;for(var V=0;V<I.length;V++){var T=I[V];s(x,T,o);var N=h(x,F);if(0>N){if(u)return!0;var O=this.createContactEquation(t,n,e,r);R++,a.copy(O.normalA,F),a.normalize(O.normalA,O.normalA),a.scale(x,F,N),s(O.contactPointA,T,x),s(O.contactPointA,O.contactPointA,t.position),s(O.contactPointB,T,l),c(O.contactPointB,O.contactPointB,l),s(O.contactPointB,O.contactPointB,n.position),this.contactEquations.push(O),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(O))}}return u?!1:(this.enableFrictionReduction||R&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(R)),R)},i.prototype[y.PARTICLE|y.CAPSULE]=i.prototype.particleCapsule=function(t,e,o,i,n,r,a,s,c){return this.circleLine(t,e,o,i,n,r,a,s,c,r.radius,0)},i.prototype[y.CIRCLE|y.LINE]=i.prototype.circleLine=function(t,e,o,i,n,r,l,p,u,d,f){var d=d||0,f="undefined"!=typeof f?f:e.radius,v=A,y=b,m=E,g=B,R=q,V=P,T=w,N=S,O=C,U=L,k=x,_=F,D=M,W=I,X=G;a.set(N,-r.length/2,0),a.set(O,r.length/2,0),a.rotate(U,N,p),a.rotate(k,O,p),c(U,U,l),c(k,k,l),a.copy(N,U),a.copy(O,k),s(V,O,N),a.normalize(T,V),a.rotate90cw(R,T),s(_,o,N);var j=h(_,R);s(g,N,l),s(D,o,l);var z=f+d;if(Math.abs(j)<z){a.scale(v,R,j),s(m,o,v),a.scale(y,R,h(R,D)),a.normalize(y,y),a.scale(y,y,d),c(m,m,y);var Y=h(T,m),K=h(T,N),H=h(T,O);if(Y>K&&H>Y){if(u)return!0;var Z=this.createContactEquation(t,n,e,r);return a.scale(Z.normalA,v,-1),a.normalize(Z.normalA,Z.normalA),a.scale(Z.contactPointA,Z.normalA,f),c(Z.contactPointA,Z.contactPointA,o),s(Z.contactPointA,Z.contactPointA,t.position),s(Z.contactPointB,m,l),c(Z.contactPointB,Z.contactPointB,l),s(Z.contactPointB,Z.contactPointB,n.position),this.contactEquations.push(Z),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(Z)),1}}X[0]=N,X[1]=O;for(var J=0;J<X.length;J++){var Q=X[J];if(s(_,Q,o),a.squaredLength(_)<Math.pow(z,2)){if(u)return!0;var Z=this.createContactEquation(t,n,e,r);return a.copy(Z.normalA,_),a.normalize(Z.normalA,Z.normalA),a.scale(Z.contactPointA,Z.normalA,f),c(Z.contactPointA,Z.contactPointA,o),s(Z.contactPointA,Z.contactPointA,t.position),s(Z.contactPointB,Q,l),a.scale(W,Z.normalA,-d),c(Z.contactPointB,Z.contactPointB,W),c(Z.contactPointB,Z.contactPointB,l),s(Z.contactPointB,Z.contactPointB,n.position),this.contactEquations.push(Z),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(Z)),1}}return 0},i.prototype[y.CIRCLE|y.CAPSULE]=i.prototype.circleCapsule=function(t,e,o,i,n,r,a,s,c){return this.circleLine(t,e,o,i,n,r,a,s,c,r.radius)},i.prototype[y.CIRCLE|y.CONVEX]=i.prototype[y.CIRCLE|y.BOX]=i.prototype.circleConvex=function(t,e,o,i,n,h,l,p,u,d){for(var d="number"==typeof d?d:e.radius,f=A,v=b,y=E,m=B,g=q,P=L,w=x,S=M,C=I,F=R,T=V,N=!1,G=Number.MAX_VALUE,O=h.vertices,U=0;U!==O.length+1;U++){var k=O[U%O.length],_=O[(U+1)%O.length];if(a.rotate(f,k,p),a.rotate(v,_,p),c(f,f,l),c(v,v,l),s(y,v,f),a.normalize(m,y),a.rotate90cw(g,m),a.scale(C,g,-e.radius),c(C,C,o),r(C,h,l,p)){a.sub(F,f,C);var D=Math.abs(a.dot(F,g));G>D&&(a.copy(T,C),G=D,a.scale(S,g,D),a.add(S,S,C),N=!0)}}if(N){if(u)return!0;var W=this.createContactEquation(t,n,e,h);return a.sub(W.normalA,T,o),a.normalize(W.normalA,W.normalA),a.scale(W.contactPointA,W.normalA,d),c(W.contactPointA,W.contactPointA,o),s(W.contactPointA,W.contactPointA,t.position),s(W.contactPointB,S,l),c(W.contactPointB,W.contactPointB,l),s(W.contactPointB,W.contactPointB,n.position),this.contactEquations.push(W),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(W)),1}if(d>0)for(var U=0;U<O.length;U++){var X=O[U];if(a.rotate(w,X,p),c(w,w,l),s(P,w,o),a.squaredLength(P)<Math.pow(d,2)){if(u)return!0;var W=this.createContactEquation(t,n,e,h);return a.copy(W.normalA,P),a.normalize(W.normalA,W.normalA),a.scale(W.contactPointA,W.normalA,d),c(W.contactPointA,W.contactPointA,o),s(W.contactPointA,W.contactPointA,t.position),s(W.contactPointB,w,l),c(W.contactPointB,W.contactPointB,l),s(W.contactPointB,W.contactPointB,n.position),this.contactEquations.push(W),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(W)),1}}return 0};var j=a.create(),z=a.create(),Y=a.create(),K=a.create();i.prototype[y.PARTICLE|y.CONVEX]=i.prototype[y.PARTICLE|y.BOX]=i.prototype.particleConvex=function(t,e,o,i,n,l,p,u,d){var f=A,v=b,y=E,m=B,g=q,S=P,C=w,x=L,F=M,I=T,R=N,V=Number.MAX_VALUE,G=!1,O=l.vertices;if(!r(o,l,p,u))return 0;if(d)return!0;for(var U=0;U!==O.length+1;U++){var k=O[U%O.length],_=O[(U+1)%O.length];a.rotate(f,k,u),a.rotate(v,_,u),c(f,f,p),c(v,v,p),s(y,v,f),a.normalize(m,y),a.rotate90cw(g,m),s(x,o,f),h(x,g),s(S,f,p),s(C,o,p),a.sub(I,f,o);var D=Math.abs(a.dot(I,g));V>D&&(V=D,a.scale(F,g,D),a.add(F,F,o),a.copy(R,g),G=!0)}if(G){var W=this.createContactEquation(t,n,e,l);return a.scale(W.normalA,R,-1),a.normalize(W.normalA,W.normalA),a.set(W.contactPointA,0,0),c(W.contactPointA,W.contactPointA,o),s(W.contactPointA,W.contactPointA,t.position),s(W.contactPointB,F,p),c(W.contactPointB,W.contactPointB,p),s(W.contactPointB,W.contactPointB,n.position),this.contactEquations.push(W),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(W)),1}return 0},i.prototype[y.CIRCLE]=i.prototype.circleCircle=function(t,e,o,i,n,r,h,l,p,u,d){var f=A,u=u||e.radius,d=d||r.radius;s(f,o,h);var v=u+d;if(a.squaredLength(f)>Math.pow(v,2))return 0;if(p)return!0;var y=this.createContactEquation(t,n,e,r);return s(y.normalA,h,o),a.normalize(y.normalA,y.normalA),a.scale(y.contactPointA,y.normalA,u),a.scale(y.contactPointB,y.normalA,-d),c(y.contactPointA,y.contactPointA,o),s(y.contactPointA,y.contactPointA,t.position),c(y.contactPointB,y.contactPointB,h),s(y.contactPointB,y.contactPointB,n.position),this.contactEquations.push(y),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(y)),1},i.prototype[y.PLANE|y.CONVEX]=i.prototype[y.PLANE|y.BOX]=i.prototype.planeConvex=function(t,e,o,i,n,r,l,p,u){var d=A,f=b,v=E,y=0;a.rotate(f,g,i);for(var m=0;m!==r.vertices.length;m++){var B=r.vertices[m];if(a.rotate(d,B,p),c(d,d,l),s(v,d,o),h(v,f)<=0){if(u)return!0;y++;var q=this.createContactEquation(t,n,e,r);s(v,d,o),a.copy(q.normalA,f);var P=h(v,q.normalA);a.scale(v,q.normalA,P),s(q.contactPointB,d,n.position),s(q.contactPointA,d,v),s(q.contactPointA,q.contactPointA,t.position),this.contactEquations.push(q),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(q))}}return this.enableFrictionReduction&&this.enableFriction&&y&&this.frictionEquations.push(this.createFrictionFromAverage(y)),y},i.prototype[y.PARTICLE|y.PLANE]=i.prototype.particlePlane=function(t,e,o,i,n,r,c,l,p){var u=A,d=b;l=l||0,s(u,o,c),a.rotate(d,g,l);var f=h(u,d);if(f>0)return 0;if(p)return!0;var v=this.createContactEquation(n,t,r,e);return a.copy(v.normalA,d),a.scale(u,v.normalA,f),s(v.contactPointA,o,u),s(v.contactPointA,v.contactPointA,n.position),s(v.contactPointB,o,t.position),this.contactEquations.push(v),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(v)),1},i.prototype[y.CIRCLE|y.PARTICLE]=i.prototype.circleParticle=function(t,e,o,i,n,r,h,l,p){var u=A;if(s(u,h,o),a.squaredLength(u)>Math.pow(e.radius,2))return 0;if(p)return!0;var d=this.createContactEquation(t,n,e,r);return a.copy(d.normalA,u),a.normalize(d.normalA,d.normalA),a.scale(d.contactPointA,d.normalA,e.radius),c(d.contactPointA,d.contactPointA,o),s(d.contactPointA,d.contactPointA,t.position),s(d.contactPointB,h,n.position),this.contactEquations.push(d),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(d)),1};var H=new f({radius:1}),Z=a.create(),J=a.create();a.create(),i.prototype[y.PLANE|y.CAPSULE]=i.prototype.planeCapsule=function(t,e,o,i,n,r,s,h,l){var p=Z,u=J,d=H;a.set(p,-r.length/2,0),a.rotate(p,p,h),c(p,p,s),a.set(u,r.length/2,0),a.rotate(u,u,h),c(u,u,s),d.radius=r.radius;var f;this.enableFrictionReduction&&(f=this.enableFriction,this.enableFriction=!1);var v=this.circlePlane(n,d,p,0,t,e,o,i,l),y=this.circlePlane(n,d,u,0,t,e,o,i,l);if(this.enableFrictionReduction&&(this.enableFriction=f),l)return v||y;var m=v+y;return this.enableFrictionReduction&&m&&this.frictionEquations.push(this.createFrictionFromAverage(m)),m},i.prototype[y.CIRCLE|y.PLANE]=i.prototype.circlePlane=function(t,e,o,i,n,r,l,p,u){var d=t,f=e,v=o,y=n,m=l,B=p;B=B||0;var q=A,P=b,w=E;s(q,v,m),a.rotate(P,g,B);var S=h(P,q);if(S>f.radius)return 0;if(u)return!0;var C=this.createContactEquation(y,d,r,e);return a.copy(C.normalA,P),a.scale(C.contactPointB,C.normalA,-f.radius),c(C.contactPointB,C.contactPointB,v),s(C.contactPointB,C.contactPointB,d.position),a.scale(w,C.normalA,S),s(C.contactPointA,q,w),c(C.contactPointA,C.contactPointA,m),s(C.contactPointA,C.contactPointA,y.position),this.contactEquations.push(C),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(C)),1},i.prototype[y.CONVEX]=i.prototype[y.CONVEX|y.BOX]=i.prototype[y.BOX]=i.prototype.convexConvex=function(t,e,o,n,r,l,p,u,d,f){var v=A,y=b,m=E,g=B,P=q,L=w,x=S,F=C,M=0,f="number"==typeof f?f:0,I=i.findSeparatingAxis(e,o,n,l,p,u,v);if(!I)return 0;s(x,p,o),h(v,x)>0&&a.scale(v,v,-1);var R=i.getClosestEdge(e,n,v,!0),V=i.getClosestEdge(l,u,v);if(-1===R||-1===V)return 0;for(var T=0;2>T;T++){var N=R,G=V,O=e,U=l,k=o,_=p,D=n,W=u,X=t,j=r;if(0===T){var z;z=N,N=G,G=z,z=O,O=U,U=z,z=k,k=_,_=z,z=D,D=W,W=z,z=X,X=j,j=z}for(var Y=G;G+2>Y;Y++){var K=U.vertices[(Y+U.vertices.length)%U.vertices.length];a.rotate(y,K,W),c(y,y,_);for(var H=0,Z=N-1;N+2>Z;Z++){var J=O.vertices[(Z+O.vertices.length)%O.vertices.length],Q=O.vertices[(Z+1+O.vertices.length)%O.vertices.length];a.rotate(m,J,D),a.rotate(g,Q,D),c(m,m,k),c(g,g,k),s(P,g,m),a.rotate90cw(F,P),a.normalize(F,F),s(x,y,m);var $=h(F,x);(Z===N&&f>=$||Z!==N&&0>=$)&&H++}if(H>=3){if(d)return!0;var te=this.createContactEquation(X,j,O,U);M++;var J=O.vertices[N%O.vertices.length],Q=O.vertices[(N+1)%O.vertices.length];a.rotate(m,J,D),a.rotate(g,Q,D),c(m,m,k),c(g,g,k),s(P,g,m),a.rotate90cw(te.normalA,P),a.normalize(te.normalA,te.normalA),s(x,y,m);var $=h(te.normalA,x);a.scale(L,te.normalA,$),s(te.contactPointA,y,k),s(te.contactPointA,te.contactPointA,L),c(te.contactPointA,te.contactPointA,k),s(te.contactPointA,te.contactPointA,X.position),s(te.contactPointB,y,_),c(te.contactPointB,te.contactPointB,_),s(te.contactPointB,te.contactPointB,j.position),this.contactEquations.push(te),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(te))}}}return this.enableFrictionReduction&&this.enableFriction&&M&&this.frictionEquations.push(this.createFrictionFromAverage(M)),M};var Q=a.fromValues(0,0);i.projectConvexOntoAxis=function(t,e,o,i,n){var r,s,c=null,l=null,p=Q;a.rotate(p,i,-o);for(var u=0;u<t.vertices.length;u++)r=t.vertices[u],s=h(r,p),(null===c||s>c)&&(c=s),(null===l||l>s)&&(l=s);if(l>c){var d=l;l=c,c=d}var f=h(e,i);a.set(n,l+f,c+f)};var $=a.fromValues(0,0),te=a.fromValues(0,0),ee=a.fromValues(0,0),oe=a.fromValues(0,0),ie=a.fromValues(0,0),ne=a.fromValues(0,0);i.findSeparatingAxis=function(t,e,o,n,r,c,h){var l=null,p=!1,u=!1,d=$,f=te,v=ee,y=oe,g=ie,A=ne;if(t instanceof m&&n instanceof m)for(var b=0;2!==b;b++){var E=t,B=o;1===b&&(E=n,B=c);for(var q=0;2!==q;q++){0===q?a.set(y,0,1):1===q&&a.set(y,1,0),0!==B&&a.rotate(y,y,B),i.projectConvexOntoAxis(t,e,o,y,g),i.projectConvexOntoAxis(n,r,c,y,A);var P=g,w=A,S=!1;g[0]>A[0]&&(w=g,P=A,S=!0);var C=w[0]-P[1];p=0>=C,(null===l||C>l)&&(a.copy(h,y),l=C,u=p)}}else for(var b=0;2!==b;b++){var E=t,B=o;1===b&&(E=n,B=c);for(var q=0;q!==E.vertices.length;q++){a.rotate(f,E.vertices[q],B),a.rotate(v,E.vertices[(q+1)%E.vertices.length],B),s(d,v,f),a.rotate90cw(y,d),a.normalize(y,y),i.projectConvexOntoAxis(t,e,o,y,g),i.projectConvexOntoAxis(n,r,c,y,A);var P=g,w=A,S=!1;g[0]>A[0]&&(w=g,P=A,S=!0);var C=w[0]-P[1];p=0>=C,(null===l||C>l)&&(a.copy(h,y),l=C,u=p)}}return u};var re=a.fromValues(0,0),ae=a.fromValues(0,0),se=a.fromValues(0,0);i.getClosestEdge=function(t,e,o,i){var n=re,r=ae,c=se;a.rotate(n,o,-e),i&&a.scale(n,n,-1);for(var l=-1,p=t.vertices.length,u=-1,d=0;d!==p;d++){s(r,t.vertices[(d+1)%p],t.vertices[d%p]),a.rotate90cw(c,r),a.normalize(c,c);var f=h(c,n);(-1===l||f>u)&&(l=d%p,u=f)}return l};var ce=a.create(),he=a.create(),le=a.create(),pe=a.create(),ue=a.create(),de=a.create(),fe=a.create();i.prototype[y.CIRCLE|y.HEIGHTFIELD]=i.prototype.circleHeightfield=function(t,e,o,i,n,r,h,l,p,u){var d=r.heights,u=u||e.radius,f=r.elementWidth,v=he,y=ce,m=ue,g=fe,A=de,b=le,E=pe,B=Math.floor((o[0]-u-h[0])/f),q=Math.ceil((o[0]+u-h[0])/f);0>B&&(B=0),q>=d.length&&(q=d.length-1);for(var P=d[B],w=d[q],S=B;q>S;S++)d[S]<w&&(w=d[S]),d[S]>P&&(P=d[S]);if(o[1]-u>P)return p?!1:0;for(var C=!1,S=B;q>S;S++){a.set(b,S*f,d[S]),a.set(E,(S+1)*f,d[S+1]),a.add(b,b,h),a.add(E,E,h),a.sub(A,E,b),a.rotate(A,A,Math.PI/2),a.normalize(A,A),a.scale(y,A,-u),a.add(y,y,o),a.sub(v,y,b);var L=a.dot(v,A);if(y[0]>=b[0]&&y[0]<E[0]&&0>=L){if(p)return!0;C=!0,a.scale(v,A,-L),a.add(m,y,v),a.copy(g,A);var x=this.createContactEquation(n,t,r,e);a.copy(x.normalA,g),a.scale(x.contactPointB,x.normalA,-u),c(x.contactPointB,x.contactPointB,o),s(x.contactPointB,x.contactPointB,t.position),a.copy(x.contactPointA,m),a.sub(x.contactPointA,x.contactPointA,n.position),this.contactEquations.push(x),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(x))}}if(C=!1,u>0)for(var S=B;q>=S;S++)if(a.set(b,S*f,d[S]),a.add(b,b,h),a.sub(v,o,b),a.squaredLength(v)<Math.pow(u,2)){if(p)return!0;
C=!0;var x=this.createContactEquation(n,t,r,e);a.copy(x.normalA,v),a.normalize(x.normalA,x.normalA),a.scale(x.contactPointB,x.normalA,-u),c(x.contactPointB,x.contactPointB,o),s(x.contactPointB,x.contactPointB,t.position),s(x.contactPointA,b,h),c(x.contactPointA,x.contactPointA,h),s(x.contactPointA,x.contactPointA,n.position),this.contactEquations.push(x),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(x))}return C?1:0};var ve=a.create(),ye=a.create(),me=a.create(),ge=new v({vertices:[a.create(),a.create(),a.create(),a.create()]});i.prototype[y.BOX|y.HEIGHTFIELD]=i.prototype[y.CONVEX|y.HEIGHTFIELD]=i.prototype.convexHeightfield=function(t,e,o,i,n,r,s,c,h){var l=r.heights,p=r.elementWidth,u=ve,d=ye,f=me,v=ge,y=Math.floor((t.aabb.lowerBound[0]-s[0])/p),m=Math.ceil((t.aabb.upperBound[0]-s[0])/p);0>y&&(y=0),m>=l.length&&(m=l.length-1);for(var g=l[y],A=l[m],b=y;m>b;b++)l[b]<A&&(A=l[b]),l[b]>g&&(g=l[b]);if(t.aabb.lowerBound[1]>g)return h?!1:0;for(var E=0,b=y;m>b;b++){a.set(u,b*p,l[b]),a.set(d,(b+1)*p,l[b+1]),a.add(u,u,s),a.add(d,d,s);var B=100;a.set(f,.5*(d[0]+u[0]),.5*(d[1]+u[1]-B)),a.sub(v.vertices[0],d,f),a.sub(v.vertices[1],u,f),a.copy(v.vertices[2],v.vertices[1]),a.copy(v.vertices[3],v.vertices[0]),v.vertices[2][1]-=B,v.vertices[3][1]-=B,E+=this.convexConvex(t,e,o,i,n,v,f,0,h)}return E}},{"../equations/ContactEquation":21,"../equations/Equation":22,"../equations/FrictionEquation":23,"../math/vec2":30,"../objects/Body":31,"../shapes/Box":37,"../shapes/Circle":39,"../shapes/Convex":40,"../shapes/Shape":45,"../utils/ContactEquationPool":48,"../utils/FrictionEquationPool":49,"../utils/TupleDictionary":56,"../utils/Utils":57}],11:[function(t,e,o){function i(t){t=t||{},this.from=t.from?r.fromValues(t.from[0],t.from[1]):r.create(),this.to=t.to?r.fromValues(t.to[0],t.to[1]):r.create(),this.checkCollisionResponse=void 0!==t.checkCollisionResponse?t.checkCollisionResponse:!0,this.skipBackfaces=!!t.skipBackfaces,this.collisionMask=void 0!==t.collisionMask?t.collisionMask:-1,this.collisionGroup=void 0!==t.collisionGroup?t.collisionGroup:-1,this.mode=void 0!==t.mode?t.mode:i.ANY,this.callback=t.callback||function(t){},this.direction=r.create(),this.length=1,this.update()}function n(t,e,o){r.sub(s,o,t);var i=r.dot(s,e);return r.scale(c,e,i),r.add(c,c,t),r.squaredDistance(o,c)}e.exports=i;var r=t("../math/vec2");t("../collision/RaycastResult"),t("../shapes/Shape"),t("../collision/AABB"),i.prototype.constructor=i,i.CLOSEST=1,i.ANY=2,i.ALL=4,i.prototype.update=function(){var t=this.direction;r.sub(t,this.to,this.from),this.length=r.length(t),r.normalize(t,t)},i.prototype.intersectBodies=function(t,e){for(var o=0,i=e.length;!t.shouldStop(this)&&i>o;o++){var n=e[o],r=n.getAABB();(r.overlapsRay(this)>=0||r.containsPoint(this.from))&&this.intersectBody(t,n)}};var a=r.create();i.prototype.intersectBody=function(t,e){var o=this.checkCollisionResponse;if(!o||e.collisionResponse)for(var i=a,n=0,s=e.shapes.length;s>n;n++){var c=e.shapes[n];if((!o||c.collisionResponse)&&0!==(this.collisionGroup&c.collisionMask)&&0!==(c.collisionGroup&this.collisionMask)){r.rotate(i,c.position,e.angle),r.add(i,i,e.position);var h=c.angle+e.angle;if(this.intersectShape(t,c,h,i,e),t.shouldStop(this))break}}},i.prototype.intersectShape=function(t,e,o,i,r){var a=this.from,s=n(a,this.direction,i);s>e.boundingRadius*e.boundingRadius||(this._currentBody=r,this._currentShape=e,e.raycast(t,this,i,o),this._currentBody=this._currentShape=null)},i.prototype.getAABB=function(t){var e=this.to,o=this.from;r.set(t.lowerBound,Math.min(e[0],o[0]),Math.min(e[1],o[1])),r.set(t.upperBound,Math.max(e[0],o[0]),Math.max(e[1],o[1]))},r.create(),i.prototype.reportIntersection=function(t,e,o,n){var a=(this.from,this.to,this._currentShape),s=this._currentBody;if(!(this.skipBackfaces&&r.dot(o,this.direction)>0))switch(this.mode){case i.ALL:t.set(o,a,s,e,n),this.callback(t);break;case i.CLOSEST:(e<t.fraction||!t.hasHit())&&t.set(o,a,s,e,n);break;case i.ANY:t.set(o,a,s,e,n)}};var s=r.create(),c=r.create()},{"../collision/AABB":7,"../collision/RaycastResult":12,"../math/vec2":30,"../shapes/Shape":45}],12:[function(t,e,o){function i(){this.normal=n.create(),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1}var n=t("../math/vec2"),r=t("../collision/Ray");e.exports=i,i.prototype.reset=function(){n.set(this.normal,0,0),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1},i.prototype.getHitDistance=function(t){return n.distance(t.from,t.to)*this.fraction},i.prototype.hasHit=function(){return-1!==this.fraction},i.prototype.getHitPoint=function(t,e){n.lerp(t,e.from,e.to,this.fraction)},i.prototype.stop=function(){this.isStopped=!0},i.prototype.shouldStop=function(t){return this.isStopped||-1!==this.fraction&&t.mode===r.ANY},i.prototype.set=function(t,e,o,i,r){n.copy(this.normal,t),this.shape=e,this.body=o,this.fraction=i,this.faceIndex=r}},{"../collision/Ray":11,"../math/vec2":30}],13:[function(t,e,o){function i(){r.call(this,r.SAP),this.axisList=[],this.axisIndex=0;var t=this;this._addBodyHandler=function(e){t.axisList.push(e.body)},this._removeBodyHandler=function(e){var o=t.axisList.indexOf(e.body);-1!==o&&t.axisList.splice(o,1)}}var n=t("../utils/Utils"),r=t("../collision/Broadphase");e.exports=i,i.prototype=new r,i.prototype.constructor=i,i.prototype.setWorld=function(t){this.axisList.length=0,n.appendArray(this.axisList,t.bodies),t.off("addBody",this._addBodyHandler).off("removeBody",this._removeBodyHandler),t.on("addBody",this._addBodyHandler).on("removeBody",this._removeBodyHandler),this.world=t},i.sortAxisList=function(t,e){e=0|e;for(var o=1,i=t.length;i>o;o++){for(var n=t[o],r=o-1;r>=0&&!(t[r].aabb.lowerBound[e]<=n.aabb.lowerBound[e]);r--)t[r+1]=t[r];t[r+1]=n}return t},i.prototype.sortList=function(){var t=this.axisList,e=this.axisIndex;i.sortAxisList(t,e)},i.prototype.getCollisionPairs=function(t){var e=this.axisList,o=this.result,i=this.axisIndex;o.length=0;for(var n=e.length;n--;){var a=e[n];a.aabbNeedsUpdate&&a.updateAABB()}this.sortList();for(var s=0,c=0|e.length;s!==c;s++)for(var h=e[s],l=s+1;c>l;l++){var p=e[l],u=p.aabb.lowerBound[i]<=h.aabb.upperBound[i];if(!u)break;r.canCollide(h,p)&&this.boundingVolumeCheck(h,p)&&o.push(h,p)}return o},i.prototype.aabbQuery=function(t,e,o){o=o||[],this.sortList();var i=this.axisIndex,n="x";1===i&&(n="y"),2===i&&(n="z");for(var r=this.axisList,a=(e.lowerBound[n],e.upperBound[n],0);a<r.length;a++){var s=r[a];s.aabbNeedsUpdate&&s.updateAABB(),s.aabb.overlaps(e)&&o.push(s)}return o}},{"../collision/Broadphase":8,"../utils/Utils":57}],14:[function(t,e,o){function i(t,e,o,i){this.type=o,i=n.defaults(i,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=t,this.bodyB=e,this.collideConnected=i.collideConnected,i.wakeUpBodies&&(t&&t.wakeUp(),e&&e.wakeUp())}e.exports=i;var n=t("../utils/Utils");i.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},i.DISTANCE=1,i.GEAR=2,i.LOCK=3,i.PRISMATIC=4,i.REVOLUTE=5,i.prototype.setStiffness=function(t){for(var e=this.equations,o=0;o!==e.length;o++){var i=e[o];i.stiffness=t,i.needsUpdate=!0}},i.prototype.setRelaxation=function(t){for(var e=this.equations,o=0;o!==e.length;o++){var i=e[o];i.relaxation=t,i.needsUpdate=!0}}},{"../utils/Utils":57}],15:[function(t,e,o){function i(t,e,o){o=s.defaults(o,{localAnchorA:[0,0],localAnchorB:[0,0]}),n.call(this,t,e,n.DISTANCE,o),this.localAnchorA=a.fromValues(o.localAnchorA[0],o.localAnchorA[1]),this.localAnchorB=a.fromValues(o.localAnchorB[0],o.localAnchorB[1]);var i=this.localAnchorA,c=this.localAnchorB;if(this.distance=0,"number"==typeof o.distance)this.distance=o.distance;else{var h=a.create(),l=a.create(),p=a.create();a.rotate(h,i,t.angle),a.rotate(l,c,e.angle),a.add(p,e.position,l),a.sub(p,p,h),a.sub(p,p,t.position),this.distance=a.length(p)}var u;u="undefined"==typeof o.maxForce?Number.MAX_VALUE:o.maxForce;var d=new r(t,e,-u,u);this.equations=[d],this.maxForce=u;var p=a.create(),f=a.create(),v=a.create(),y=this;d.computeGq=function(){var t=this.bodyA,e=this.bodyB,o=t.position,n=e.position;return a.rotate(f,i,t.angle),a.rotate(v,c,e.angle),a.add(p,n,v),a.sub(p,p,f),a.sub(p,p,o),a.length(p)-y.distance},this.setMaxForce(u),this.upperLimitEnabled=!1,this.upperLimit=1,this.lowerLimitEnabled=!1,this.lowerLimit=0,this.position=0}var n=t("./Constraint"),r=t("../equations/Equation"),a=t("../math/vec2"),s=t("../utils/Utils");e.exports=i,i.prototype=new n,i.prototype.constructor=i;var c=a.create(),h=a.create(),l=a.create();i.prototype.update=function(){var t=this.equations[0],e=this.bodyA,o=this.bodyB,i=(this.distance,e.position),n=o.position,r=this.equations[0],s=t.G;a.rotate(h,this.localAnchorA,e.angle),a.rotate(l,this.localAnchorB,o.angle),a.add(c,n,l),a.sub(c,c,h),a.sub(c,c,i),this.position=a.length(c);var p=!1;if(this.upperLimitEnabled&&this.position>this.upperLimit&&(r.maxForce=0,r.minForce=-this.maxForce,this.distance=this.upperLimit,p=!0),this.lowerLimitEnabled&&this.position<this.lowerLimit&&(r.maxForce=this.maxForce,r.minForce=0,this.distance=this.lowerLimit,p=!0),(this.lowerLimitEnabled||this.upperLimitEnabled)&&!p)return void(r.enabled=!1);r.enabled=!0,a.normalize(c,c);var u=a.crossLength(h,c),d=a.crossLength(l,c);s[0]=-c[0],s[1]=-c[1],s[2]=-u,s[3]=c[0],s[4]=c[1],s[5]=d},i.prototype.setMaxForce=function(t){var e=this.equations[0];e.minForce=-t,e.maxForce=t},i.prototype.getMaxForce=function(){var t=this.equations[0];return t.maxForce}},{"../equations/Equation":22,"../math/vec2":30,"../utils/Utils":57,"./Constraint":14}],16:[function(t,e,o){function i(t,e,o){o=o||{},n.call(this,t,e,n.GEAR,o),this.ratio=void 0!==o.ratio?o.ratio:1,this.angle=void 0!==o.angle?o.angle:e.angle-this.ratio*t.angle,o.angle=this.angle,o.ratio=this.ratio,this.equations=[new r(t,e,o)],void 0!==o.maxTorque&&this.setMaxTorque(o.maxTorque)}var n=t("./Constraint"),r=(t("../equations/Equation"),t("../equations/AngleLockEquation"));t("../math/vec2"),e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.update=function(){var t=this.equations[0];t.ratio!==this.ratio&&t.setRatio(this.ratio),t.angle=this.angle},i.prototype.setMaxTorque=function(t){this.equations[0].setMaxTorque(t)},i.prototype.getMaxTorque=function(t){return this.equations[0].maxForce}},{"../equations/AngleLockEquation":20,"../equations/Equation":22,"../math/vec2":30,"./Constraint":14}],17:[function(t,e,o){function i(t,e,o){o=o||{},n.call(this,t,e,n.LOCK,o);var i="undefined"==typeof o.maxForce?Number.MAX_VALUE:o.maxForce,s=(o.localAngleB||0,new a(t,e,-i,i)),c=new a(t,e,-i,i),h=new a(t,e,-i,i),l=r.create(),p=r.create(),u=this;s.computeGq=function(){return r.rotate(l,u.localOffsetB,t.angle),r.sub(p,e.position,t.position),r.sub(p,p,l),p[0]},c.computeGq=function(){return r.rotate(l,u.localOffsetB,t.angle),r.sub(p,e.position,t.position),r.sub(p,p,l),p[1]};var d=r.create(),f=r.create();h.computeGq=function(){return r.rotate(d,u.localOffsetB,e.angle-u.localAngleB),r.scale(d,d,-1),r.sub(p,t.position,e.position),r.add(p,p,d),r.rotate(f,d,-Math.PI/2),r.normalize(f,f),r.dot(p,f)},this.localOffsetB=r.create(),o.localOffsetB?r.copy(this.localOffsetB,o.localOffsetB):(r.sub(this.localOffsetB,e.position,t.position),r.rotate(this.localOffsetB,this.localOffsetB,-t.angle)),this.localAngleB=0,"number"==typeof o.localAngleB?this.localAngleB=o.localAngleB:this.localAngleB=e.angle-t.angle,this.equations.push(s,c,h),this.setMaxForce(i)}var n=t("./Constraint"),r=t("../math/vec2"),a=t("../equations/Equation");e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.setMaxForce=function(t){for(var e=this.equations,o=0;o<this.equations.length;o++)e[o].maxForce=t,e[o].minForce=-t},i.prototype.getMaxForce=function(){return this.equations[0].maxForce};var s=r.create(),c=r.create(),h=r.create(),l=r.fromValues(1,0),p=r.fromValues(0,1);i.prototype.update=function(){var t=this.equations[0],e=this.equations[1],o=this.equations[2],i=this.bodyA,n=this.bodyB;r.rotate(s,this.localOffsetB,i.angle),r.rotate(c,this.localOffsetB,n.angle-this.localAngleB),r.scale(c,c,-1),r.rotate(h,c,Math.PI/2),r.normalize(h,h),t.G[0]=-1,t.G[1]=0,t.G[2]=-r.crossLength(s,l),t.G[3]=1,e.G[0]=0,e.G[1]=-1,e.G[2]=-r.crossLength(s,p),e.G[4]=1,o.G[0]=-h[0],o.G[1]=-h[1],o.G[3]=h[0],o.G[4]=h[1],o.G[5]=r.crossLength(c,h)}},{"../equations/Equation":22,"../math/vec2":30,"./Constraint":14}],18:[function(t,e,o){function i(t,e,o){o=o||{},n.call(this,t,e,n.PRISMATIC,o);var i=s.fromValues(0,0),h=s.fromValues(1,0),l=s.fromValues(0,0);o.localAnchorA&&s.copy(i,o.localAnchorA),o.localAxisA&&s.copy(h,o.localAxisA),o.localAnchorB&&s.copy(l,o.localAnchorB),this.localAnchorA=i,this.localAnchorB=l,this.localAxisA=h;var p=this.maxForce="undefined"!=typeof o.maxForce?o.maxForce:Number.MAX_VALUE,u=new a(t,e,-p,p),d=new s.create,f=new s.create,v=new s.create,y=new s.create;if(u.computeGq=function(){return s.dot(v,y)},u.updateJacobian=function(){var o=this.G,n=t.position,r=e.position;s.rotate(d,i,t.angle),s.rotate(f,l,e.angle),s.add(v,r,f),s.sub(v,v,n),s.sub(v,v,d),s.rotate(y,h,t.angle+Math.PI/2),o[0]=-y[0],o[1]=-y[1],o[2]=-s.crossLength(d,y)+s.crossLength(y,v),o[3]=y[0],o[4]=y[1],o[5]=s.crossLength(f,y)},this.equations.push(u),!o.disableRotationalLock){var m=new c(t,e,-p,p);this.equations.push(m)}this.position=0,this.velocity=0,this.lowerLimitEnabled="undefined"!=typeof o.lowerLimit?!0:!1,this.upperLimitEnabled="undefined"!=typeof o.upperLimit?!0:!1,this.lowerLimit="undefined"!=typeof o.lowerLimit?o.lowerLimit:0,this.upperLimit="undefined"!=typeof o.upperLimit?o.upperLimit:1,this.upperLimitEquation=new r(t,e),this.lowerLimitEquation=new r(t,e),this.upperLimitEquation.minForce=this.lowerLimitEquation.minForce=0,this.upperLimitEquation.maxForce=this.lowerLimitEquation.maxForce=p,this.motorEquation=new a(t,e),this.motorEnabled=!1,this.motorSpeed=0;var g=this,A=this.motorEquation;A.computeGW,A.computeGq=function(){return 0},A.computeGW=function(){var t=this.G,e=this.bodyA,o=this.bodyB,i=e.velocity,n=o.velocity,r=e.angularVelocity,a=o.angularVelocity;return this.gmult(t,i,r,n,a)+g.motorSpeed}}var n=t("./Constraint"),r=t("../equations/ContactEquation"),a=t("../equations/Equation"),s=t("../math/vec2"),c=t("../equations/RotationalLockEquation");e.exports=i,i.prototype=new n,i.prototype.constructor=i;var h=s.create(),l=s.create(),p=s.create(),u=s.create(),d=s.create(),f=s.create();i.prototype.update=function(){var t=this.equations,e=t[0],o=this.upperLimit,i=this.lowerLimit,n=this.upperLimitEquation,r=this.lowerLimitEquation,a=this.bodyA,c=this.bodyB,v=this.localAxisA,y=this.localAnchorA,m=this.localAnchorB;e.updateJacobian(),s.rotate(h,v,a.angle),s.rotate(u,y,a.angle),s.add(l,u,a.position),s.rotate(d,m,c.angle),s.add(p,d,c.position);var g=this.position=s.dot(p,h)-s.dot(l,h);if(this.motorEnabled){var A=this.motorEquation.G;A[0]=h[0],A[1]=h[1],A[2]=s.crossLength(h,d),A[3]=-h[0],A[4]=-h[1],A[5]=-s.crossLength(h,u)}if(this.upperLimitEnabled&&g>o)s.scale(n.normalA,h,-1),s.sub(n.contactPointA,l,a.position),s.sub(n.contactPointB,p,c.position),s.scale(f,h,o),s.add(n.contactPointA,n.contactPointA,f),-1===t.indexOf(n)&&t.push(n);else{var b=t.indexOf(n);-1!==b&&t.splice(b,1)}if(this.lowerLimitEnabled&&i>g)s.scale(r.normalA,h,1),s.sub(r.contactPointA,l,a.position),s.sub(r.contactPointB,p,c.position),s.scale(f,h,i),s.sub(r.contactPointB,r.contactPointB,f),-1===t.indexOf(r)&&t.push(r);else{var b=t.indexOf(r);-1!==b&&t.splice(b,1)}},i.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},i.prototype.disableMotor=function(){if(this.motorEnabled){var t=this.equations.indexOf(this.motorEquation);this.equations.splice(t,1),this.motorEnabled=!1}},i.prototype.setLimits=function(t,e){"number"==typeof t?(this.lowerLimit=t,this.lowerLimitEnabled=!0):(this.lowerLimit=t,this.lowerLimitEnabled=!1),"number"==typeof e?(this.upperLimit=e,this.upperLimitEnabled=!0):(this.upperLimit=e,this.upperLimitEnabled=!1)}},{"../equations/ContactEquation":21,"../equations/Equation":22,"../equations/RotationalLockEquation":24,"../math/vec2":30,"./Constraint":14}],19:[function(t,e,o){function i(t,e,o){o=o||{},n.call(this,t,e,n.REVOLUTE,o);var i=this.maxForce="undefined"!=typeof o.maxForce?o.maxForce:Number.MAX_VALUE;this.pivotA=c.create(),this.pivotB=c.create(),o.worldPivot?(c.sub(this.pivotA,o.worldPivot,t.position),c.sub(this.pivotB,o.worldPivot,e.position),c.rotate(this.pivotA,this.pivotA,-t.angle),c.rotate(this.pivotB,this.pivotB,-e.angle)):(c.copy(this.pivotA,o.localPivotA),c.copy(this.pivotB,o.localPivotB));var f=this.equations=[new r(t,e,-i,i),new r(t,e,-i,i)],v=f[0],y=f[1],m=this;v.computeGq=function(){return c.rotate(h,m.pivotA,t.angle),c.rotate(l,m.pivotB,e.angle),c.add(d,e.position,l),c.sub(d,d,t.position),c.sub(d,d,h),c.dot(d,p)},y.computeGq=function(){return c.rotate(h,m.pivotA,t.angle),c.rotate(l,m.pivotB,e.angle),c.add(d,e.position,l),c.sub(d,d,t.position),c.sub(d,d,h),c.dot(d,u)},y.minForce=v.minForce=-i,y.maxForce=v.maxForce=i,this.motorEquation=new a(t,e),this.motorEnabled=!1,this.angle=0,this.lowerLimitEnabled=!1,this.upperLimitEnabled=!1,this.lowerLimit=0,this.upperLimit=0,this.upperLimitEquation=new s(t,e),this.lowerLimitEquation=new s(t,e),this.upperLimitEquation.minForce=0,this.lowerLimitEquation.maxForce=0}var n=t("./Constraint"),r=t("../equations/Equation"),a=t("../equations/RotationalVelocityEquation"),s=t("../equations/RotationalLockEquation"),c=t("../math/vec2");e.exports=i;var h=c.create(),l=c.create(),p=c.fromValues(1,0),u=c.fromValues(0,1),d=c.create();i.prototype=new n,i.prototype.constructor=i,i.prototype.setLimits=function(t,e){"number"==typeof t?(this.lowerLimit=t,this.lowerLimitEnabled=!0):(this.lowerLimit=t,this.lowerLimitEnabled=!1),"number"==typeof e?(this.upperLimit=e,this.upperLimitEnabled=!0):(this.upperLimit=e,this.upperLimitEnabled=!1)},i.prototype.update=function(){var t=this.bodyA,e=this.bodyB,o=this.pivotA,i=this.pivotB,n=this.equations,r=(n[0],n[1],n[0]),a=n[1],s=this.upperLimit,d=this.lowerLimit,f=this.upperLimitEquation,v=this.lowerLimitEquation,y=this.angle=e.angle-t.angle;if(this.upperLimitEnabled&&y>s)f.angle=s,-1===n.indexOf(f)&&n.push(f);else{var m=n.indexOf(f);-1!==m&&n.splice(m,1)}if(this.lowerLimitEnabled&&d>y)v.angle=d,-1===n.indexOf(v)&&n.push(v);else{var m=n.indexOf(v);-1!==m&&n.splice(m,1)}c.rotate(h,o,t.angle),c.rotate(l,i,e.angle),r.G[0]=-1,r.G[1]=0,r.G[2]=-c.crossLength(h,p),r.G[3]=1,r.G[4]=0,r.G[5]=c.crossLength(l,p),a.G[0]=0,a.G[1]=-1,a.G[2]=-c.crossLength(h,u),a.G[3]=0,a.G[4]=1,a.G[5]=c.crossLength(l,u)},i.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},i.prototype.disableMotor=function(){if(this.motorEnabled){var t=this.equations.indexOf(this.motorEquation);this.equations.splice(t,1),this.motorEnabled=!1}},i.prototype.motorIsEnabled=function(){return!!this.motorEnabled},i.prototype.setMotorSpeed=function(t){if(this.motorEnabled){var e=this.equations.indexOf(this.motorEquation);this.equations[e].relativeVelocity=t}},i.prototype.getMotorSpeed=function(){return this.motorEnabled?this.motorEquation.relativeVelocity:!1}},{"../equations/Equation":22,"../equations/RotationalLockEquation":24,"../equations/RotationalVelocityEquation":25,"../math/vec2":30,"./Constraint":14}],20:[function(t,e,o){function i(t,e,o){o=o||{},n.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=o.angle||0,this.ratio="number"==typeof o.ratio?o.ratio:1,this.setRatio(this.ratio)}var n=t("./Equation");t("../math/vec2"),e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.computeGq=function(){return this.ratio*this.bodyA.angle-this.bodyB.angle+this.angle},i.prototype.setRatio=function(t){var e=this.G;e[2]=t,e[5]=-1,this.ratio=t},i.prototype.setMaxTorque=function(t){this.maxForce=t,this.minForce=-t}},{"../math/vec2":30,"./Equation":22}],21:[function(t,e,o){function i(t,e){n.call(this,t,e,0,Number.MAX_VALUE),this.contactPointA=r.create(),this.penetrationVec=r.create(),this.contactPointB=r.create(),this.normalA=r.create(),this.restitution=0,this.firstImpact=!1,this.shapeA=null,this.shapeB=null}var n=t("./Equation"),r=t("../math/vec2");e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.computeB=function(t,e,o){var i=this.bodyA,n=this.bodyB,a=this.contactPointA,s=this.contactPointB,c=i.position,h=n.position,l=this.penetrationVec,p=this.normalA,u=this.G,d=r.crossLength(a,p),f=r.crossLength(s,p);u[0]=-p[0],u[1]=-p[1],u[2]=-d,u[3]=p[0],u[4]=p[1],u[5]=f,r.add(l,h,s),r.sub(l,l,c),r.sub(l,l,a);var v,y;this.firstImpact&&0!==this.restitution?(y=0,v=1/e*(1+this.restitution)*this.computeGW()):(y=r.dot(p,l)+this.offset,v=this.computeGW());var m=this.computeGiMf(),g=-y*t-v*e-o*m;return g}},{"../math/vec2":30,"./Equation":22}],22:[function(t,e,o){function i(t,e,o,n){this.minForce="undefined"==typeof o?-Number.MAX_VALUE:o,this.maxForce="undefined"==typeof n?Number.MAX_VALUE:n,this.bodyA=t,this.bodyB=e,this.stiffness=i.DEFAULT_STIFFNESS,this.relaxation=i.DEFAULT_RELAXATION,this.G=new r.ARRAY_TYPE(6);for(var a=0;6>a;a++)this.G[a]=0;this.offset=0,this.a=0,this.b=0,this.epsilon=0,this.timeStep=1/60,this.needsUpdate=!0,this.multiplier=0,this.relativeVelocity=0,this.enabled=!0}e.exports=i;var n=t("../math/vec2"),r=t("../utils/Utils");t("../objects/Body"),i.prototype.constructor=i,i.DEFAULT_STIFFNESS=1e6,i.DEFAULT_RELAXATION=4,i.prototype.update=function(){var t=this.stiffness,e=this.relaxation,o=this.timeStep;this.a=4/(o*(1+4*e)),this.b=4*e/(1+4*e),this.epsilon=4/(o*o*t*(1+4*e)),this.needsUpdate=!1},i.prototype.gmult=function(t,e,o,i,n){return t[0]*e[0]+t[1]*e[1]+t[2]*o+t[3]*i[0]+t[4]*i[1]+t[5]*n},i.prototype.computeB=function(t,e,o){var i=this.computeGW(),n=this.computeGq(),r=this.computeGiMf();return-n*t-i*e-r*o};var a=n.create(),s=n.create();i.prototype.computeGq=function(){var t=this.G,e=this.bodyA,o=this.bodyB,i=(e.position,o.position,e.angle),n=o.angle;return this.gmult(t,a,i,s,n)+this.offset},i.prototype.computeGW=function(){var t=this.G,e=this.bodyA,o=this.bodyB,i=e.velocity,n=o.velocity,r=e.angularVelocity,a=o.angularVelocity;return this.gmult(t,i,r,n,a)+this.relativeVelocity},i.prototype.computeGWlambda=function(){var t=this.G,e=this.bodyA,o=this.bodyB,i=e.vlambda,n=o.vlambda,r=e.wlambda,a=o.wlambda;return this.gmult(t,i,r,n,a)};var c=n.create(),h=n.create();i.prototype.computeGiMf=function(){var t=this.bodyA,e=this.bodyB,o=t.force,i=t.angularForce,r=e.force,a=e.angularForce,s=t.invMassSolve,l=e.invMassSolve,p=t.invInertiaSolve,u=e.invInertiaSolve,d=this.G;return n.scale(c,o,s),n.multiply(c,t.massMultiplier,c),n.scale(h,r,l),n.multiply(h,e.massMultiplier,h),this.gmult(d,c,i*p,h,a*u)},i.prototype.computeGiMGt=function(){var t=this.bodyA,e=this.bodyB,o=t.invMassSolve,i=e.invMassSolve,n=t.invInertiaSolve,r=e.invInertiaSolve,a=this.G;return a[0]*a[0]*o*t.massMultiplier[0]+a[1]*a[1]*o*t.massMultiplier[1]+a[2]*a[2]*n+a[3]*a[3]*i*e.massMultiplier[0]+a[4]*a[4]*i*e.massMultiplier[1]+a[5]*a[5]*r};var l=n.create(),p=n.create(),u=n.create();n.create(),n.create(),n.create(),i.prototype.addToWlambda=function(t){var e=this.bodyA,o=this.bodyB,i=l,r=p,a=u,s=e.invMassSolve,c=o.invMassSolve,h=e.invInertiaSolve,d=o.invInertiaSolve,f=this.G;r[0]=f[0],r[1]=f[1],a[0]=f[3],a[1]=f[4],n.scale(i,r,s*t),n.multiply(i,i,e.massMultiplier),n.add(e.vlambda,e.vlambda,i),e.wlambda+=h*f[2]*t,n.scale(i,a,c*t),n.multiply(i,i,o.massMultiplier),n.add(o.vlambda,o.vlambda,i),o.wlambda+=d*f[5]*t},i.prototype.computeInvC=function(t){return 1/(this.computeGiMGt()+t)}},{"../math/vec2":30,"../objects/Body":31,"../utils/Utils":57}],23:[function(t,e,o){function i(t,e,o){r.call(this,t,e,-o,o),this.contactPointA=n.create(),this.contactPointB=n.create(),this.t=n.create(),this.contactEquations=[],this.shapeA=null,this.shapeB=null,this.frictionCoefficient=.3}var n=t("../math/vec2"),r=t("./Equation");t("../utils/Utils"),e.exports=i,i.prototype=new r,i.prototype.constructor=i,i.prototype.setSlipForce=function(t){this.maxForce=t,this.minForce=-t},i.prototype.getSlipForce=function(){return this.maxForce},i.prototype.computeB=function(t,e,o){var i=(this.bodyA,this.bodyB,this.contactPointA),r=this.contactPointB,a=this.t,s=this.G;s[0]=-a[0],s[1]=-a[1],s[2]=-n.crossLength(i,a),s[3]=a[0],s[4]=a[1],s[5]=n.crossLength(r,a);var c=this.computeGW(),h=this.computeGiMf(),l=-c*e-o*h;return l}},{"../math/vec2":30,"../utils/Utils":57,"./Equation":22}],24:[function(t,e,o){function i(t,e,o){o=o||{},n.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=o.angle||0;var i=this.G;i[2]=1,i[5]=-1}var n=t("./Equation"),r=t("../math/vec2");e.exports=i,i.prototype=new n,i.prototype.constructor=i;var a=r.create(),s=r.create(),c=r.fromValues(1,0),h=r.fromValues(0,1);i.prototype.computeGq=function(){return r.rotate(a,c,this.bodyA.angle+this.angle),r.rotate(s,h,this.bodyB.angle),r.dot(a,s)}},{"../math/vec2":30,"./Equation":22}],25:[function(t,e,o){function i(t,e){n.call(this,t,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.relativeVelocity=1,this.ratio=1}var n=t("./Equation");t("../math/vec2"),e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.computeB=function(t,e,o){var i=this.G;i[2]=-1,i[5]=this.ratio;var n=this.computeGiMf(),r=this.computeGW(),a=-r*e-o*n;return a}},{"../math/vec2":30,"./Equation":22}],26:[function(t,e,o){var i=function(){};e.exports=i,i.prototype={constructor:i,on:function(t,e,o){e.context=o||this,void 0===this._listeners&&(this._listeners={});var i=this._listeners;return void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e),this},has:function(t,e){if(void 0===this._listeners)return!1;var o=this._listeners;if(e){if(void 0!==o[t]&&-1!==o[t].indexOf(e))return!0}else if(void 0!==o[t])return!0;return!1},off:function(t,e){if(void 0===this._listeners)return this;var o=this._listeners,i=o[t].indexOf(e);return-1!==i&&o[t].splice(i,1),this},emit:function(t){if(void 0===this._listeners)return this;var e=this._listeners,o=e[t.type];if(void 0!==o){t.target=this;for(var i=0,n=o.length;n>i;i++){var r=o[i];r.call(r.context,t)}}return this}}},{}],27:[function(t,e,o){function i(t,e,o){if(o=o||{},!(t instanceof n&&e instanceof n))throw new Error("First two arguments must be Material instances.");this.id=i.idCounter++,this.materialA=t,this.materialB=e,this.friction="undefined"!=typeof o.friction?Number(o.friction):.3,this.restitution="undefined"!=typeof o.restitution?Number(o.restitution):0,this.stiffness="undefined"!=typeof o.stiffness?Number(o.stiffness):r.DEFAULT_STIFFNESS,this.relaxation="undefined"!=typeof o.relaxation?Number(o.relaxation):r.DEFAULT_RELAXATION,this.frictionStiffness="undefined"!=typeof o.frictionStiffness?Number(o.frictionStiffness):r.DEFAULT_STIFFNESS,this.frictionRelaxation="undefined"!=typeof o.frictionRelaxation?Number(o.frictionRelaxation):r.DEFAULT_RELAXATION,this.surfaceVelocity="undefined"!=typeof o.surfaceVelocity?Number(o.surfaceVelocity):0,this.contactSkinSize=.005}var n=t("./Material"),r=t("../equations/Equation");e.exports=i,i.idCounter=0},{"../equations/Equation":22,"./Material":28}],28:[function(t,e,o){function i(t){this.id=t||i.idCounter++}e.exports=i,i.idCounter=0},{}],29:[function(t,e,o){var i={};i.GetArea=function(t){if(t.length<6)return 0;for(var e=t.length-2,o=0,i=0;e>i;i+=2)o+=(t[i+2]-t[i])*(t[i+1]+t[i+3]);return o+=(t[0]-t[e])*(t[e+1]+t[1]),.5*-o},i.Triangulate=function(t){var e=t.length>>1;if(3>e)return[];for(var o=[],n=[],r=0;e>r;r++)n.push(r);for(var r=0,a=e;a>3;){var s=n[(r+0)%a],c=n[(r+1)%a],h=n[(r+2)%a],l=t[2*s],p=t[2*s+1],u=t[2*c],d=t[2*c+1],f=t[2*h],v=t[2*h+1],y=!1;if(i._convex(l,p,u,d,f,v)){y=!0;for(var m=0;a>m;m++){var g=n[m];if(g!=s&&g!=c&&g!=h&&i._PointInTriangle(t[2*g],t[2*g+1],l,p,u,d,f,v)){y=!1;break}}}if(y)o.push(s,c,h),n.splice((r+1)%a,1),a--,r=0;else if(r++>3*a)break}return o.push(n[0],n[1],n[2]),o},i._PointInTriangle=function(t,e,o,i,n,r,a,s){var c=a-o,h=s-i,l=n-o,p=r-i,u=t-o,d=e-i,f=c*c+h*h,v=c*l+h*p,y=c*u+h*d,m=l*l+p*p,g=l*u+p*d,A=1/(f*m-v*v),b=(m*y-v*g)*A,E=(f*g-v*y)*A;return b>=0&&E>=0&&1>b+E},i._convex=function(t,e,o,i,n,r){return(e-i)*(n-o)+(o-t)*(r-i)>=0},e.exports=i},{}],30:[function(t,e,o){var i=e.exports={},n=t("../utils/Utils");i.crossLength=function(t,e){return t[0]*e[1]-t[1]*e[0]},i.crossVZ=function(t,e,o){return i.rotate(t,e,-Math.PI/2),i.scale(t,t,o),t},i.crossZV=function(t,e,o){return i.rotate(t,o,Math.PI/2),i.scale(t,t,e),t},i.rotate=function(t,e,o){if(0!==o){var i=Math.cos(o),n=Math.sin(o),r=e[0],a=e[1];t[0]=i*r-n*a,t[1]=n*r+i*a}else t[0]=e[0],t[1]=e[1]},i.rotate90cw=function(t,e){var o=e[0],i=e[1];t[0]=i,t[1]=-o},i.toLocalFrame=function(t,e,o,n){i.copy(t,e),i.sub(t,t,o),i.rotate(t,t,-n)},i.toGlobalFrame=function(t,e,o,n){i.copy(t,e),i.rotate(t,t,n),i.add(t,t,o)},i.vectorToLocalFrame=function(t,e,o){i.rotate(t,e,-o)},i.vectorToGlobalFrame=function(t,e,o){i.rotate(t,e,o)},i.centroid=function(t,e,o,n){return i.add(t,e,o),i.add(t,t,n),i.scale(t,t,1/3),t},i.create=function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},i.clone=function(t){var e=new n.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},i.fromValues=function(t,e){var o=new n.ARRAY_TYPE(2);return o[0]=t,o[1]=e,o},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},i.set=function(t,e,o){return t[0]=e,t[1]=o,t},i.add=function(t,e,o){return t[0]=e[0]+o[0],t[1]=e[1]+o[1],t},i.subtract=function(t,e,o){return t[0]=e[0]-o[0],t[1]=e[1]-o[1],t},i.sub=i.subtract,i.multiply=function(t,e,o){return t[0]=e[0]*o[0],t[1]=e[1]*o[1],t},i.mul=i.multiply,i.divide=function(t,e,o){return t[0]=e[0]/o[0],t[1]=e[1]/o[1],t},i.div=i.divide,i.scale=function(t,e,o){return t[0]=e[0]*o,t[1]=e[1]*o,t},i.distance=function(t,e){var o=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(o*o+i*i)},i.dist=i.distance,i.squaredDistance=function(t,e){var o=e[0]-t[0],i=e[1]-t[1];return o*o+i*i},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],o=t[1];return Math.sqrt(e*e+o*o)},i.len=i.length,i.squaredLength=function(t){var e=t[0],o=t[1];return e*e+o*o},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},i.normalize=function(t,e){var o=e[0],i=e[1],n=o*o+i*i;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},i.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},i.lerp=function(t,e,o,i){var n=e[0],r=e[1];return t[0]=n+i*(o[0]-n),t[1]=r+i*(o[1]-r),t},i.reflect=function(t,e,o){var i=e[0]*o[0]+e[1]*o[1];t[0]=e[0]-2*o[0]*i,t[1]=e[1]-2*o[1]*i},i.getLineSegmentsIntersection=function(t,e,o,n,r){var a=i.getLineSegmentsIntersectionFraction(e,o,n,r);return 0>a?!1:(t[0]=e[0]+a*(o[0]-e[0]),t[1]=e[1]+a*(o[1]-e[1]),!0)},i.getLineSegmentsIntersectionFraction=function(t,e,o,i){var n,r,a=e[0]-t[0],s=e[1]-t[1],c=i[0]-o[0],h=i[1]-o[1];return n=(-s*(t[0]-o[0])+a*(t[1]-o[1]))/(-c*s+a*h),r=(c*(t[1]-o[1])-h*(t[0]-o[0]))/(-c*s+a*h),n>=0&&1>=n&&r>=0&&1>=r?r:-1}},{"../utils/Utils":57}],31:[function(t,e,o){function i(t){t=t||{},l.call(this),this.id=t.id||++i._idCounter,this.world=null,this.shapes=[],this.mass=t.mass||0,this.invMass=0,this.inertia=0,this.invInertia=0,this.invMassSolve=0,this.invInertiaSolve=0,this.fixedRotation=!!t.fixedRotation,this.fixedX=!!t.fixedX,this.fixedY=!!t.fixedY,this.massMultiplier=n.create(),this.position=n.fromValues(0,0),t.position&&n.copy(this.position,t.position),this.interpolatedPosition=n.fromValues(0,0),this.interpolatedAngle=0,this.previousPosition=n.fromValues(0,0),this.previousAngle=0,this.velocity=n.fromValues(0,0),t.velocity&&n.copy(this.velocity,t.velocity),this.vlambda=n.fromValues(0,0),this.wlambda=0,this.angle=t.angle||0,this.angularVelocity=t.angularVelocity||0,this.force=n.create(),t.force&&n.copy(this.force,t.force),this.angularForce=t.angularForce||0,this.damping="number"==typeof t.damping?t.damping:.1,this.angularDamping="number"==typeof t.angularDamping?t.angularDamping:.1,this.type=i.STATIC,"undefined"!=typeof t.type?this.type=t.type:t.mass?this.type=i.DYNAMIC:this.type=i.STATIC,this.boundingRadius=0,this.aabb=new h,this.aabbNeedsUpdate=!0,this.allowSleep=void 0!==t.allowSleep?t.allowSleep:!0,this.wantsToSleep=!1,this.sleepState=i.AWAKE,this.sleepSpeedLimit=void 0!==t.sleepSpeedLimit?t.sleepSpeedLimit:.2,this.sleepTimeLimit=void 0!==t.sleepTimeLimit?t.sleepTimeLimit:1,this.gravityScale=void 0!==t.gravityScale?t.gravityScale:1,this.collisionResponse=void 0!==t.collisionResponse?t.collisionResponse:!0,this.idleTime=0,this.timeLastSleepy=0,this.ccdSpeedThreshold=void 0!==t.ccdSpeedThreshold?t.ccdSpeedThreshold:-1,this.ccdIterations=void 0!==t.ccdIterations?t.ccdIterations:10,this.concavePath=null,this._wakeUpAfterNarrowphase=!1,this.updateMassProperties()
}var n=t("../math/vec2"),r=t("poly-decomp"),a=t("../shapes/Convex"),s=t("../collision/RaycastResult"),c=t("../collision/Ray"),h=t("../collision/AABB"),l=t("../events/EventEmitter");e.exports=i,i.prototype=new l,i.prototype.constructor=i,i._idCounter=0,i.prototype.updateSolveMassProperties=function(){this.sleepState===i.SLEEPING||this.type===i.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve=0):(this.invMassSolve=this.invMass,this.invInertiaSolve=this.invInertia)},i.prototype.setDensity=function(t){var e=this.getArea();this.mass=e*t,this.updateMassProperties()},i.prototype.getArea=function(){for(var t=0,e=0;e<this.shapes.length;e++)t+=this.shapes[e].area;return t},i.prototype.getAABB=function(){return this.aabbNeedsUpdate&&this.updateAABB(),this.aabb};var p=new h,u=n.create();i.prototype.updateAABB=function(){for(var t=this.shapes,e=t.length,o=u,i=this.angle,r=0;r!==e;r++){var a=t[r],s=a.angle+i;n.rotate(o,a.position,i),n.add(o,o,this.position),a.computeAABB(p,o,s),0===r?this.aabb.copy(p):this.aabb.extend(p)}this.aabbNeedsUpdate=!1},i.prototype.updateBoundingRadius=function(){for(var t=this.shapes,e=t.length,o=0,i=0;i!==e;i++){var r=t[i],a=n.length(r.position),s=r.boundingRadius;a+s>o&&(o=a+s)}this.boundingRadius=o},i.prototype.addShape=function(t,e,o){if(t.body)throw new Error("A shape can only be added to one body.");t.body=this,e?n.copy(t.position,e):n.set(t.position,0,0),t.angle=o||0,this.shapes.push(t),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0},i.prototype.removeShape=function(t){var e=this.shapes.indexOf(t);return-1!==e?(this.shapes.splice(e,1),this.aabbNeedsUpdate=!0,t.body=null,!0):!1},i.prototype.updateMassProperties=function(){if(this.type===i.STATIC||this.type===i.KINEMATIC)this.mass=Number.MAX_VALUE,this.invMass=0,this.inertia=Number.MAX_VALUE,this.invInertia=0;else{var t=this.shapes,e=t.length,o=this.mass/e,r=0;if(this.fixedRotation)this.inertia=Number.MAX_VALUE,this.invInertia=0;else{for(var a=0;e>a;a++){var s=t[a],c=n.squaredLength(s.position),h=s.computeMomentOfInertia(o);r+=h+o*c}this.inertia=r,this.invInertia=r>0?1/r:0}this.invMass=1/this.mass,n.set(this.massMultiplier,this.fixedX?0:1,this.fixedY?0:1)}},n.create(),i.prototype.applyForce=function(t,e){if(n.add(this.force,this.force,t),e){var o=n.crossLength(e,t);this.angularForce+=o}};var d=n.create(),f=n.create(),v=n.create();i.prototype.applyForceLocal=function(t,e){e=e||v;var o=d,i=f;this.vectorToWorldFrame(o,t),this.vectorToWorldFrame(i,e),this.applyForce(o,i)};var y=n.create();i.prototype.applyImpulse=function(t,e){if(this.type===i.DYNAMIC){var o=y;if(n.scale(o,t,this.invMass),n.multiply(o,this.massMultiplier,o),n.add(this.velocity,o,this.velocity),e){var r=n.crossLength(e,t);r*=this.invInertia,this.angularVelocity+=r}}};var m=n.create(),g=n.create(),A=n.create();i.prototype.applyImpulseLocal=function(t,e){e=e||A;var o=m,i=g;this.vectorToWorldFrame(o,t),this.vectorToWorldFrame(i,e),this.applyImpulse(o,i)},i.prototype.toLocalFrame=function(t,e){n.toLocalFrame(t,e,this.position,this.angle)},i.prototype.toWorldFrame=function(t,e){n.toGlobalFrame(t,e,this.position,this.angle)},i.prototype.vectorToLocalFrame=function(t,e){n.vectorToLocalFrame(t,e,this.angle)},i.prototype.vectorToWorldFrame=function(t,e){n.vectorToGlobalFrame(t,e,this.angle)},i.prototype.fromPolygon=function(t,e){e=e||{};for(var o=this.shapes.length;o>=0;--o)this.removeShape(this.shapes[o]);var i=new r.Polygon;if(i.vertices=t,i.makeCCW(),"number"==typeof e.removeCollinearPoints&&i.removeCollinearPoints(e.removeCollinearPoints),"undefined"==typeof e.skipSimpleCheck&&!i.isSimple())return!1;this.concavePath=i.vertices.slice(0);for(var o=0;o<this.concavePath.length;o++){var s=[0,0];n.copy(s,this.concavePath[o]),this.concavePath[o]=s}var c;c=e.optimalDecomp?i.decomp():i.quickDecomp();for(var h=n.create(),o=0;o!==c.length;o++){for(var l=new a({vertices:c[o].vertices}),p=0;p!==l.vertices.length;p++){var s=l.vertices[p];n.sub(s,s,l.centerOfMass)}n.scale(h,l.centerOfMass,1),l.updateTriangles(),l.updateCenterOfMass(),l.updateBoundingRadius(),this.addShape(l,h)}return this.adjustCenterOfMass(),this.aabbNeedsUpdate=!0,!0};var b=(n.fromValues(0,0),n.fromValues(0,0)),E=n.fromValues(0,0),B=n.fromValues(0,0);i.prototype.adjustCenterOfMass=function(){var t=b,e=E,o=B,i=0;n.set(e,0,0);for(var r=0;r!==this.shapes.length;r++){var a=this.shapes[r];n.scale(t,a.position,a.area),n.add(e,e,t),i+=a.area}n.scale(o,e,1/i);for(var r=0;r!==this.shapes.length;r++){var a=this.shapes[r];n.sub(a.position,a.position,o)}n.add(this.position,this.position,o);for(var r=0;this.concavePath&&r<this.concavePath.length;r++)n.sub(this.concavePath[r],this.concavePath[r],o);this.updateMassProperties(),this.updateBoundingRadius()},i.prototype.setZeroForce=function(){n.set(this.force,0,0),this.angularForce=0},i.prototype.resetConstraintVelocity=function(){var t=this,e=t.vlambda;n.set(e,0,0),t.wlambda=0},i.prototype.addConstraintVelocity=function(){var t=this,e=t.velocity;n.add(e,e,t.vlambda),t.angularVelocity+=t.wlambda},i.prototype.applyDamping=function(t){if(this.type===i.DYNAMIC){var e=this.velocity;n.scale(e,e,Math.pow(1-this.damping,t)),this.angularVelocity*=Math.pow(1-this.angularDamping,t)}},i.prototype.wakeUp=function(){var t=this.sleepState;this.sleepState=i.AWAKE,this.idleTime=0,t!==i.AWAKE&&this.emit(i.wakeUpEvent)},i.prototype.sleep=function(){this.sleepState=i.SLEEPING,this.angularVelocity=0,this.angularForce=0,n.set(this.velocity,0,0),n.set(this.force,0,0),this.emit(i.sleepEvent)},i.prototype.sleepTick=function(t,e,o){if(this.allowSleep&&this.type!==i.SLEEPING){this.wantsToSleep=!1;var r=(this.sleepState,n.squaredLength(this.velocity)+Math.pow(this.angularVelocity,2)),a=Math.pow(this.sleepSpeedLimit,2);r>=a?(this.idleTime=0,this.sleepState=i.AWAKE):(this.idleTime+=o,this.sleepState=i.SLEEPY),this.idleTime>this.sleepTimeLimit&&(e?this.wantsToSleep=!0:this.sleep())}},i.prototype.overlaps=function(t){return this.world.overlapKeeper.bodiesAreOverlapping(this,t)};var q=n.create(),P=n.create();i.prototype.integrate=function(t){var e=this.invMass,o=this.force,i=this.position,r=this.velocity;n.copy(this.previousPosition,this.position),this.previousAngle=this.angle,this.fixedRotation||(this.angularVelocity+=this.angularForce*this.invInertia*t),n.scale(q,o,t*e),n.multiply(q,this.massMultiplier,q),n.add(r,q,r),this.integrateToTimeOfImpact(t)||(n.scale(P,r,t),n.add(i,i,P),this.fixedRotation||(this.angle+=this.angularVelocity*t)),this.aabbNeedsUpdate=!0};var w=new s,S=new c({mode:c.ALL}),C=n.create(),L=n.create(),x=n.create(),F=n.create();i.prototype.integrateToTimeOfImpact=function(t){if(this.ccdSpeedThreshold<0||n.squaredLength(this.velocity)<Math.pow(this.ccdSpeedThreshold,2))return!1;n.normalize(C,this.velocity),n.scale(L,this.velocity,t),n.add(L,L,this.position),n.sub(x,L,this.position);var e,o=this.angularVelocity*t,i=n.length(x),r=1,a=this;if(w.reset(),S.callback=function(t){t.body!==a&&(e=t.body,t.getHitPoint(L,S),n.sub(x,L,a.position),r=n.length(x)/i,t.stop())},n.copy(S.from,this.position),n.copy(S.to,L),S.update(),this.world.raycast(w,S),!e)return!1;var s=this.angle;n.copy(F,this.position);for(var c=0,h=0,l=0,p=r;p>=h&&c<this.ccdIterations;){c++,l=(p-h)/2,n.scale(P,x,r),n.add(this.position,F,P),this.angle=s+o*r,this.updateAABB();var u=this.aabb.overlaps(e.aabb)&&this.world.narrowphase.bodiesOverlap(this,e);u?h=l:p=l}return r=l,n.copy(this.position,F),this.angle=s,n.scale(P,x,r),n.add(this.position,this.position,P),this.fixedRotation||(this.angle+=o*r),!0},i.prototype.getVelocityAtPoint=function(t,e){return n.crossVZ(t,e,this.angularVelocity),n.subtract(t,this.velocity,t),t},i.sleepyEvent={type:"sleepy"},i.sleepEvent={type:"sleep"},i.wakeUpEvent={type:"wakeup"},i.DYNAMIC=1,i.STATIC=2,i.KINEMATIC=4,i.AWAKE=0,i.SLEEPY=1,i.SLEEPING=2},{"../collision/AABB":7,"../collision/Ray":11,"../collision/RaycastResult":12,"../events/EventEmitter":26,"../math/vec2":30,"../shapes/Convex":40,"poly-decomp":5}],32:[function(t,e,o){function i(t,e,o){o=o||{},r.call(this,t,e,o),this.localAnchorA=n.fromValues(0,0),this.localAnchorB=n.fromValues(0,0),o.localAnchorA&&n.copy(this.localAnchorA,o.localAnchorA),o.localAnchorB&&n.copy(this.localAnchorB,o.localAnchorB),o.worldAnchorA&&this.setWorldAnchorA(o.worldAnchorA),o.worldAnchorB&&this.setWorldAnchorB(o.worldAnchorB);var i=n.create(),a=n.create();this.getWorldAnchorA(i),this.getWorldAnchorB(a);var s=n.distance(i,a);this.restLength="number"==typeof o.restLength?o.restLength:s}var n=t("../math/vec2"),r=t("./Spring");t("../utils/Utils"),e.exports=i,i.prototype=new r,i.prototype.constructor=i,i.prototype.setWorldAnchorA=function(t){this.bodyA.toLocalFrame(this.localAnchorA,t)},i.prototype.setWorldAnchorB=function(t){this.bodyB.toLocalFrame(this.localAnchorB,t)},i.prototype.getWorldAnchorA=function(t){this.bodyA.toWorldFrame(t,this.localAnchorA)},i.prototype.getWorldAnchorB=function(t){this.bodyB.toWorldFrame(t,this.localAnchorB)};var a=n.create(),s=n.create(),c=n.create(),h=n.create(),l=n.create(),p=n.create(),u=n.create(),d=n.create(),f=n.create();i.prototype.applyForce=function(){var t=this.stiffness,e=this.damping,o=this.restLength,i=this.bodyA,r=this.bodyB,v=a,y=s,m=c,g=h,A=f,b=l,E=p,B=u,q=d;this.getWorldAnchorA(b),this.getWorldAnchorB(E),n.sub(B,b,i.position),n.sub(q,E,r.position),n.sub(v,E,b);var P=n.len(v);n.normalize(y,v),n.sub(m,r.velocity,i.velocity),n.crossZV(A,r.angularVelocity,q),n.add(m,m,A),n.crossZV(A,i.angularVelocity,B),n.sub(m,m,A),n.scale(g,y,-t*(P-o)-e*n.dot(m,y)),n.sub(i.force,i.force,g),n.add(r.force,r.force,g);var w=n.crossLength(B,g),S=n.crossLength(q,g);i.angularForce-=w,r.angularForce+=S}},{"../math/vec2":30,"../utils/Utils":57,"./Spring":34}],33:[function(t,e,o){function i(t,e,o){o=o||{},n.call(this,t,e,o),this.restAngle="number"==typeof o.restAngle?o.restAngle:e.angle-t.angle}var n=(t("../math/vec2"),t("./Spring"));e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.applyForce=function(){var t=this.stiffness,e=this.damping,o=this.restAngle,i=this.bodyA,n=this.bodyB,r=n.angle-i.angle,a=n.angularVelocity-i.angularVelocity,s=-t*(r-o)-e*a*0;i.angularForce-=s,n.angularForce+=s}},{"../math/vec2":30,"./Spring":34}],34:[function(t,e,o){function i(t,e,o){o=n.defaults(o,{stiffness:100,damping:1}),this.stiffness=o.stiffness,this.damping=o.damping,this.bodyA=t,this.bodyB=e}var n=(t("../math/vec2"),t("../utils/Utils"));e.exports=i,i.prototype.applyForce=function(){}},{"../math/vec2":30,"../utils/Utils":57}],35:[function(t,e,o){function i(t,e){e=e||{},this.chassisBody=t,this.wheels=[],this.groundBody=new c({mass:0}),this.world=null;var o=this;this.preStepCallback=function(){o.update()}}function n(t,e){e=e||{},this.vehicle=t,this.forwardEquation=new s(t.chassisBody,t.groundBody),this.sideEquation=new s(t.chassisBody,t.groundBody),this.steerValue=0,this.engineForce=0,this.setSideFriction(void 0!==e.sideFriction?e.sideFriction:5),this.localForwardVector=r.fromValues(0,1),e.localForwardVector&&r.copy(this.localForwardVector,e.localForwardVector),this.localPosition=r.fromValues(0,0),e.localPosition&&r.copy(this.localPosition,e.localPosition),a.apply(this,t.chassisBody,t.groundBody),this.equations.push(this.forwardEquation,this.sideEquation),this.setBrakeForce(0)}var r=t("../math/vec2"),a=(t("../utils/Utils"),t("../constraints/Constraint")),s=t("../equations/FrictionEquation"),c=t("../objects/Body");e.exports=i,i.prototype.addToWorld=function(t){this.world=t,t.addBody(this.groundBody),t.on("preStep",this.preStepCallback);for(var e=0;e<this.wheels.length;e++){var o=this.wheels[e];t.addConstraint(o)}},i.prototype.removeFromWorld=function(){var t=this.world;t.removeBody(this.groundBody),t.off("preStep",this.preStepCallback);for(var e=0;e<this.wheels.length;e++){var o=this.wheels[e];t.removeConstraint(o)}this.world=null},i.prototype.addWheel=function(t){var e=new n(this,t);return this.wheels.push(e),e},i.prototype.update=function(){for(var t=0;t<this.wheels.length;t++)this.wheels[t].update()},n.prototype=new a,n.prototype.setBrakeForce=function(t){this.forwardEquation.setSlipForce(t)},n.prototype.setSideFriction=function(t){this.sideEquation.setSlipForce(t)};var h=r.create(),l=r.create();n.prototype.getSpeed=function(){return this.vehicle.chassisBody.vectorToWorldFrame(l,this.localForwardVector),this.vehicle.chassisBody.getVelocityAtPoint(h,l),r.dot(h,l)};var p=r.create();n.prototype.update=function(){this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.t,this.localForwardVector),r.rotate(this.sideEquation.t,this.localForwardVector,Math.PI/2),this.vehicle.chassisBody.vectorToWorldFrame(this.sideEquation.t,this.sideEquation.t),r.rotate(this.forwardEquation.t,this.forwardEquation.t,this.steerValue),r.rotate(this.sideEquation.t,this.sideEquation.t,this.steerValue),this.vehicle.chassisBody.toWorldFrame(this.forwardEquation.contactPointB,this.localPosition),r.copy(this.sideEquation.contactPointB,this.forwardEquation.contactPointB),this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.contactPointA,this.localPosition),r.copy(this.sideEquation.contactPointA,this.forwardEquation.contactPointA),r.normalize(p,this.forwardEquation.t),r.scale(p,p,this.engineForce),this.vehicle.chassisBody.applyForce(p,this.forwardEquation.contactPointA)}},{"../constraints/Constraint":14,"../equations/FrictionEquation":23,"../math/vec2":30,"../objects/Body":31,"../utils/Utils":57}],36:[function(t,e,o){var i=e.exports={AABB:t("./collision/AABB"),AngleLockEquation:t("./equations/AngleLockEquation"),Body:t("./objects/Body"),Broadphase:t("./collision/Broadphase"),Capsule:t("./shapes/Capsule"),Circle:t("./shapes/Circle"),Constraint:t("./constraints/Constraint"),ContactEquation:t("./equations/ContactEquation"),ContactEquationPool:t("./utils/ContactEquationPool"),ContactMaterial:t("./material/ContactMaterial"),Convex:t("./shapes/Convex"),DistanceConstraint:t("./constraints/DistanceConstraint"),Equation:t("./equations/Equation"),EventEmitter:t("./events/EventEmitter"),FrictionEquation:t("./equations/FrictionEquation"),FrictionEquationPool:t("./utils/FrictionEquationPool"),GearConstraint:t("./constraints/GearConstraint"),GSSolver:t("./solver/GSSolver"),Heightfield:t("./shapes/Heightfield"),Line:t("./shapes/Line"),LockConstraint:t("./constraints/LockConstraint"),Material:t("./material/Material"),Narrowphase:t("./collision/Narrowphase"),NaiveBroadphase:t("./collision/NaiveBroadphase"),Particle:t("./shapes/Particle"),Plane:t("./shapes/Plane"),Pool:t("./utils/Pool"),RevoluteConstraint:t("./constraints/RevoluteConstraint"),PrismaticConstraint:t("./constraints/PrismaticConstraint"),Ray:t("./collision/Ray"),RaycastResult:t("./collision/RaycastResult"),Box:t("./shapes/Box"),RotationalVelocityEquation:t("./equations/RotationalVelocityEquation"),SAPBroadphase:t("./collision/SAPBroadphase"),Shape:t("./shapes/Shape"),Solver:t("./solver/Solver"),Spring:t("./objects/Spring"),TopDownVehicle:t("./objects/TopDownVehicle"),LinearSpring:t("./objects/LinearSpring"),RotationalSpring:t("./objects/RotationalSpring"),Utils:t("./utils/Utils"),World:t("./world/World"),vec2:t("./math/vec2"),version:t("../package.json").version};Object.defineProperty(i,"Rectangle",{get:function(){return console.warn("The Rectangle class has been renamed to Box."),this.Box}})},{"../package.json":6,"./collision/AABB":7,"./collision/Broadphase":8,"./collision/NaiveBroadphase":9,"./collision/Narrowphase":10,"./collision/Ray":11,"./collision/RaycastResult":12,"./collision/SAPBroadphase":13,"./constraints/Constraint":14,"./constraints/DistanceConstraint":15,"./constraints/GearConstraint":16,"./constraints/LockConstraint":17,"./constraints/PrismaticConstraint":18,"./constraints/RevoluteConstraint":19,"./equations/AngleLockEquation":20,"./equations/ContactEquation":21,"./equations/Equation":22,"./equations/FrictionEquation":23,"./equations/RotationalVelocityEquation":25,"./events/EventEmitter":26,"./material/ContactMaterial":27,"./material/Material":28,"./math/vec2":30,"./objects/Body":31,"./objects/LinearSpring":32,"./objects/RotationalSpring":33,"./objects/Spring":34,"./objects/TopDownVehicle":35,"./shapes/Box":37,"./shapes/Capsule":38,"./shapes/Circle":39,"./shapes/Convex":40,"./shapes/Heightfield":41,"./shapes/Line":42,"./shapes/Particle":43,"./shapes/Plane":44,"./shapes/Shape":45,"./solver/GSSolver":46,"./solver/Solver":47,"./utils/ContactEquationPool":48,"./utils/FrictionEquationPool":49,"./utils/Pool":55,"./utils/Utils":57,"./world/World":61}],37:[function(t,e,o){function i(t){"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&(t={width:arguments[0],height:arguments[1]},console.warn("The Rectangle has been renamed to Box and its constructor signature has changed. Please use the following format: new Box({ width: 1, height: 1, ... })")),t=t||{};var e=this.width=t.width||1,o=this.height=t.height||1,i=[n.fromValues(-e/2,-o/2),n.fromValues(e/2,-o/2),n.fromValues(e/2,o/2),n.fromValues(-e/2,o/2)],s=[n.fromValues(1,0),n.fromValues(0,1)];t.vertices=i,t.axes=s,t.type=r.BOX,a.call(this,t)}var n=t("../math/vec2"),r=t("./Shape"),a=t("./Convex");e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.computeMomentOfInertia=function(t){var e=this.width,o=this.height;return t*(o*o+e*e)/12},i.prototype.updateBoundingRadius=function(){var t=this.width,e=this.height;this.boundingRadius=Math.sqrt(t*t+e*e)/2},n.create(),n.create(),n.create(),n.create(),i.prototype.computeAABB=function(t,e,o){t.setFromPoints(this.vertices,e,o,0)},i.prototype.updateArea=function(){this.area=this.width*this.height}},{"../math/vec2":30,"./Convex":40,"./Shape":45}],38:[function(t,e,o){function i(t){"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&(t={length:arguments[0],radius:arguments[1]},console.warn("The Capsule constructor signature has changed. Please use the following format: new Capsule({ radius: 1, length: 1 })")),t=t||{},this.length=t.length||1,this.radius=t.radius||1,t.type=n.CAPSULE,n.call(this,t)}var n=t("./Shape"),r=t("../math/vec2");e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.computeMomentOfInertia=function(t){var e=this.radius,o=this.length+e,i=2*e;return t*(i*i+o*o)/12},i.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius+this.length/2},i.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius+2*this.radius*this.length};var a=r.create();i.prototype.computeAABB=function(t,e,o){var i=this.radius;r.set(a,this.length/2,0),0!==o&&r.rotate(a,a,o),r.set(t.upperBound,Math.max(a[0]+i,-a[0]+i),Math.max(a[1]+i,-a[1]+i)),r.set(t.lowerBound,Math.min(a[0]-i,-a[0]-i),Math.min(a[1]-i,-a[1]-i)),r.add(t.lowerBound,t.lowerBound,e),r.add(t.upperBound,t.upperBound,e)};var s=r.create(),c=r.create(),h=r.create(),l=r.create(),p=r.fromValues(0,1);i.prototype.raycast=function(t,e,o,i){for(var n=e.from,a=e.to,u=(e.direction,s),d=c,f=h,v=l,y=this.length/2,m=0;2>m;m++){var g=this.radius*(2*m-1);r.set(f,-y,g),r.set(v,y,g),r.toGlobalFrame(f,f,o,i),r.toGlobalFrame(v,v,o,i);var A=r.getLineSegmentsIntersectionFraction(n,a,f,v);if(A>=0&&(r.rotate(d,p,i),r.scale(d,d,2*m-1),e.reportIntersection(t,A,d,-1),t.shouldStop(e)))return}for(var b=Math.pow(this.radius,2)+Math.pow(y,2),m=0;2>m;m++){r.set(f,y*(2*m-1),0),r.toGlobalFrame(f,f,o,i);var E=Math.pow(a[0]-n[0],2)+Math.pow(a[1]-n[1],2),B=2*((a[0]-n[0])*(n[0]-f[0])+(a[1]-n[1])*(n[1]-f[1])),q=Math.pow(n[0]-f[0],2)+Math.pow(n[1]-f[1],2)-Math.pow(this.radius,2),A=Math.pow(B,2)-4*E*q;if(!(0>A))if(0===A){if(r.lerp(u,n,a,A),r.squaredDistance(u,o)>b&&(r.sub(d,u,f),r.normalize(d,d),e.reportIntersection(t,A,d,-1),t.shouldStop(e)))return}else{var P=Math.sqrt(A),w=1/(2*E),S=(-B-P)*w,C=(-B+P)*w;if(S>=0&&1>=S&&(r.lerp(u,n,a,S),r.squaredDistance(u,o)>b&&(r.sub(d,u,f),r.normalize(d,d),e.reportIntersection(t,S,d,-1),t.shouldStop(e))))return;if(C>=0&&1>=C&&(r.lerp(u,n,a,C),r.squaredDistance(u,o)>b&&(r.sub(d,u,f),r.normalize(d,d),e.reportIntersection(t,C,d,-1),t.shouldStop(e))))return}}}},{"../math/vec2":30,"./Shape":45}],39:[function(t,e,o){function i(t){"number"==typeof arguments[0]&&(t={radius:arguments[0]},console.warn("The Circle constructor signature has changed. Please use the following format: new Circle({ radius: 1 })")),t=t||{},this.radius=t.radius||1,t.type=n.CIRCLE,n.call(this,t)}var n=t("./Shape"),r=t("../math/vec2");e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.computeMomentOfInertia=function(t){var e=this.radius;return t*e*e/2},i.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius},i.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius},i.prototype.computeAABB=function(t,e,o){var i=this.radius;r.set(t.upperBound,i,i),r.set(t.lowerBound,-i,-i),e&&(r.add(t.lowerBound,t.lowerBound,e),r.add(t.upperBound,t.upperBound,e))};var a=r.create(),s=r.create();i.prototype.raycast=function(t,e,o,i){var n=e.from,c=e.to,h=this.radius,l=Math.pow(c[0]-n[0],2)+Math.pow(c[1]-n[1],2),p=2*((c[0]-n[0])*(n[0]-o[0])+(c[1]-n[1])*(n[1]-o[1])),u=Math.pow(n[0]-o[0],2)+Math.pow(n[1]-o[1],2)-Math.pow(h,2),d=Math.pow(p,2)-4*l*u,f=a,v=s;if(!(0>d))if(0===d)r.lerp(f,n,c,d),r.sub(v,f,o),r.normalize(v,v),e.reportIntersection(t,d,v,-1);else{var y=Math.sqrt(d),m=1/(2*l),g=(-p-y)*m,A=(-p+y)*m;if(g>=0&&1>=g&&(r.lerp(f,n,c,g),r.sub(v,f,o),r.normalize(v,v),e.reportIntersection(t,g,v,-1),t.shouldStop(e)))return;A>=0&&1>=A&&(r.lerp(f,n,c,A),r.sub(v,f,o),r.normalize(v,v),e.reportIntersection(t,A,v,-1))}}},{"../math/vec2":30,"./Shape":45}],40:[function(t,e,o){function i(t){Array.isArray(arguments[0])&&(t={vertices:arguments[0],axes:arguments[1]},console.warn("The Convex constructor signature has changed. Please use the following format: new Convex({ vertices: [...], ... })")),t=t||{},this.vertices=[];for(var e=void 0!==t.vertices?t.vertices:[],o=0;o<e.length;o++){var i=r.create();r.copy(i,e[o]),this.vertices.push(i)}if(this.axes=[],t.axes)for(var o=0;o<t.axes.length;o++){var a=r.create();r.copy(a,t.axes[o]),this.axes.push(a)}else for(var o=0;o<this.vertices.length;o++){var s=this.vertices[o],c=this.vertices[(o+1)%this.vertices.length],h=r.create();r.sub(h,c,s),r.rotate90cw(h,h),r.normalize(h,h),this.axes.push(h)}if(this.centerOfMass=r.fromValues(0,0),this.triangles=[],this.vertices.length&&(this.updateTriangles(),this.updateCenterOfMass()),this.boundingRadius=0,t.type=n.CONVEX,n.call(this,t),this.updateBoundingRadius(),this.updateArea(),this.area<0)throw new Error("Convex vertices must be given in conter-clockwise winding.")}var n=t("./Shape"),r=t("../math/vec2"),a=t("../math/polyk");t("poly-decomp"),e.exports=i,i.prototype=new n,i.prototype.constructor=i;var s=r.create(),c=r.create();i.prototype.projectOntoLocalAxis=function(t,e){for(var o,i,n=null,a=null,t=s,c=0;c<this.vertices.length;c++)o=this.vertices[c],i=r.dot(o,t),(null===n||i>n)&&(n=i),(null===a||a>i)&&(a=i);if(a>n){var h=a;a=n,n=h}r.set(e,a,n)},i.prototype.projectOntoWorldAxis=function(t,e,o,i){var n=c;this.projectOntoLocalAxis(t,i),0!==o?r.rotate(n,t,o):n=t;var a=r.dot(e,n);r.set(i,i[0]+a,i[1]+a)},i.prototype.updateTriangles=function(){this.triangles.length=0;for(var t=[],e=0;e<this.vertices.length;e++){var o=this.vertices[e];t.push(o[0],o[1])}for(var i=a.Triangulate(t),e=0;e<i.length;e+=3){var n=i[e],r=i[e+1],s=i[e+2];this.triangles.push([n,r,s])}};var h=r.create(),l=r.create(),p=r.create(),u=r.create(),d=r.create();r.create(),r.create(),r.create(),r.create(),i.prototype.updateCenterOfMass=function(){var t=this.triangles,e=this.vertices,o=this.centerOfMass,n=h,a=p,s=u,c=d,f=l;r.set(o,0,0);for(var v=0,y=0;y!==t.length;y++){var m=t[y],a=e[m[0]],s=e[m[1]],c=e[m[2]];r.centroid(n,a,s,c);var g=i.triangleArea(a,s,c);v+=g,r.scale(f,n,g),r.add(o,o,f)}r.scale(o,o,1/v)},i.prototype.computeMomentOfInertia=function(t){for(var e=0,o=0,i=this.vertices.length,n=i-1,a=0;i>a;n=a,a++){var s=this.vertices[n],c=this.vertices[a],h=Math.abs(r.crossLength(s,c)),l=r.dot(c,c)+r.dot(c,s)+r.dot(s,s);e+=h*l,o+=h}return t/6*(e/o)},i.prototype.updateBoundingRadius=function(){for(var t=this.vertices,e=0,o=0;o!==t.length;o++){var i=r.squaredLength(t[o]);i>e&&(e=i)}this.boundingRadius=Math.sqrt(e)},i.triangleArea=function(t,e,o){return.5*((e[0]-t[0])*(o[1]-t[1])-(o[0]-t[0])*(e[1]-t[1]))},i.prototype.updateArea=function(){this.updateTriangles(),this.area=0;for(var t=this.triangles,e=this.vertices,o=0;o!==t.length;o++){var n=t[o],r=e[n[0]],a=e[n[1]],s=e[n[2]],c=i.triangleArea(r,a,s);this.area+=c}},i.prototype.computeAABB=function(t,e,o){t.setFromPoints(this.vertices,e,o,0)};var f=r.create(),v=r.create(),y=r.create();i.prototype.raycast=function(t,e,o,i){var n=f,a=v,s=y,c=this.vertices;r.toLocalFrame(n,e.from,o,i),r.toLocalFrame(a,e.to,o,i);for(var h=c.length,l=0;h>l&&!t.shouldStop(e);l++){var p=c[l],u=c[(l+1)%h],d=r.getLineSegmentsIntersectionFraction(n,a,p,u);d>=0&&(r.sub(s,u,p),r.rotate(s,s,-Math.PI/2+i),r.normalize(s,s),e.reportIntersection(t,d,s,l))}}},{"../math/polyk":29,"../math/vec2":30,"./Shape":45,"poly-decomp":5}],41:[function(t,e,o){function i(t){if(Array.isArray(arguments[0])){if(t={heights:arguments[0]},"object"==typeof arguments[1])for(var e in arguments[1])t[e]=arguments[1][e];console.warn("The Heightfield constructor signature has changed. Please use the following format: new Heightfield({ heights: [...], ... })")}t=t||{},this.heights=t.heights?t.heights.slice(0):[],this.maxValue=t.maxValue||null,this.minValue=t.minValue||null,this.elementWidth=t.elementWidth||.1,(void 0===t.maxValue||void 0===t.minValue)&&this.updateMaxMinValues(),t.type=n.HEIGHTFIELD,n.call(this,t)}var n=t("./Shape"),r=t("../math/vec2");t("../utils/Utils"),e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.updateMaxMinValues=function(){for(var t=this.heights,e=t[0],o=t[0],i=0;i!==t.length;i++){var n=t[i];n>e&&(e=n),o>n&&(o=n)}this.maxValue=e,this.minValue=o},i.prototype.computeMomentOfInertia=function(t){return Number.MAX_VALUE},i.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},i.prototype.updateArea=function(){for(var t=this.heights,e=0,o=0;o<t.length-1;o++)e+=(t[o]+t[o+1])/2*this.elementWidth;this.area=e};var a=[r.create(),r.create(),r.create(),r.create()];i.prototype.computeAABB=function(t,e,o){r.set(a[0],0,this.maxValue),r.set(a[1],this.elementWidth*this.heights.length,this.maxValue),r.set(a[2],this.elementWidth*this.heights.length,this.minValue),r.set(a[3],0,this.minValue),t.setFromPoints(a,e,o)},i.prototype.getLineSegment=function(t,e,o){var i=this.heights,n=this.elementWidth;r.set(t,o*n,i[o]),r.set(e,(o+1)*n,i[o+1])},i.prototype.getSegmentIndex=function(t){return Math.floor(t[0]/this.elementWidth)},i.prototype.getClampedSegmentIndex=function(t){var e=this.getSegmentIndex(t);return e=Math.min(this.heights.length,Math.max(e,0))};var s=(r.create(),r.create()),c=r.create(),h=r.create(),l=r.create(),p=r.create();r.fromValues(0,1),i.prototype.raycast=function(t,e,o,i){var n=e.from,a=e.to,u=(e.direction,s),d=c,f=h,v=l,y=p;r.toLocalFrame(v,n,o,i),r.toLocalFrame(y,a,o,i);var m=this.getClampedSegmentIndex(v),g=this.getClampedSegmentIndex(y);if(m>g){var A=m;m=g,g=A}for(var b=0;b<this.heights.length-1;b++){this.getLineSegment(d,f,b);var E=r.getLineSegmentsIntersectionFraction(v,y,d,f);if(E>=0&&(r.sub(u,f,d),r.rotate(u,u,i+Math.PI/2),r.normalize(u,u),e.reportIntersection(t,E,u,-1),t.shouldStop(e)))return}}},{"../math/vec2":30,"../utils/Utils":57,"./Shape":45}],42:[function(t,e,o){function i(t){"number"==typeof arguments[0]&&(t={length:arguments[0]},console.warn("The Line constructor signature has changed. Please use the following format: new Line({ length: 1, ... })")),t=t||{},this.length=t.length||1,t.type=n.LINE,n.call(this,t)}var n=t("./Shape"),r=t("../math/vec2");e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.computeMomentOfInertia=function(t){return t*Math.pow(this.length,2)/12},i.prototype.updateBoundingRadius=function(){this.boundingRadius=this.length/2};var a=[r.create(),r.create()];i.prototype.computeAABB=function(t,e,o){var i=this.length/2;r.set(a[0],-i,0),r.set(a[1],i,0),t.setFromPoints(a,e,o,0)};var s=(r.create(),r.create()),c=r.create(),h=r.create(),l=r.fromValues(0,1);i.prototype.raycast=function(t,e,o,i){var n=e.from,a=e.to,p=c,u=h,d=this.length/2;r.set(p,-d,0),r.set(u,d,0),r.toGlobalFrame(p,p,o,i),r.toGlobalFrame(u,u,o,i);var f=r.getLineSegmentsIntersectionFraction(p,u,n,a);if(f>=0){var v=s;r.rotate(v,l,i),e.reportIntersection(t,f,v,-1)}}},{"../math/vec2":30,"./Shape":45}],43:[function(t,e,o){function i(t){t=t||{},t.type=n.PARTICLE,n.call(this,t)}var n=t("./Shape"),r=t("../math/vec2");e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.computeMomentOfInertia=function(t){return 0},i.prototype.updateBoundingRadius=function(){this.boundingRadius=0},i.prototype.computeAABB=function(t,e,o){r.copy(t.lowerBound,e),r.copy(t.upperBound,e)}},{"../math/vec2":30,"./Shape":45}],44:[function(t,e,o){function i(t){t=t||{},t.type=n.PLANE,n.call(this,t)}var n=t("./Shape"),r=t("../math/vec2");t("../utils/Utils"),e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.computeMomentOfInertia=function(t){return 0},i.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},i.prototype.computeAABB=function(t,e,o){var i=o%(2*Math.PI),n=r.set,a=Number.MAX_VALUE,s=t.lowerBound,c=t.upperBound;0===i?(n(s,-a,-a),n(c,a,0)):i===Math.PI/2?(n(s,0,-a),n(c,a,a)):i===Math.PI?(n(s,-a,0),n(c,a,a)):i===3*Math.PI/2?(n(s,-a,-a),n(c,0,a)):(n(s,-a,-a),n(c,a,a)),r.add(s,s,e),r.add(c,c,e)},i.prototype.updateArea=function(){this.area=Number.MAX_VALUE};var a=r.create(),s=(r.create(),r.create(),r.create()),c=r.create();i.prototype.raycast=function(t,e,o,i){var n=e.from,h=e.to,l=e.direction,p=a,u=s,d=c;r.set(u,0,1),r.rotate(u,u,i),r.sub(d,n,o);var f=r.dot(d,u);r.sub(d,h,o);var v=r.dot(d,u);if(!(f*v>0||r.squaredDistance(n,h)<f*f)){var y=r.dot(u,l);r.sub(p,n,o);var m=-r.dot(u,p)/y/e.length;e.reportIntersection(t,m,u,-1)}}},{"../math/vec2":30,"../utils/Utils":57,"./Shape":45}],45:[function(t,e,o){function i(t){t=t||{},this.body=null,this.position=n.fromValues(0,0),t.position&&n.copy(this.position,t.position),this.angle=t.angle||0,this.type=t.type||0,this.id=i.idCounter++,this.boundingRadius=0,this.collisionGroup=void 0!==t.collisionGroup?t.collisionGroup:1,this.collisionResponse=void 0!==t.collisionResponse?t.collisionResponse:!0,this.collisionMask=void 0!==t.collisionMask?t.collisionMask:1,this.material=t.material||null,this.area=0,this.sensor=void 0!==t.sensor?t.sensor:!1,this.type&&this.updateBoundingRadius(),this.updateArea()}e.exports=i;var n=t("../math/vec2");i.idCounter=0,i.CIRCLE=1,i.PARTICLE=2,i.PLANE=4,i.CONVEX=8,i.LINE=16,i.BOX=32,Object.defineProperty(i,"RECTANGLE",{get:function(){return console.warn("Shape.RECTANGLE is deprecated, use Shape.BOX instead."),i.BOX}}),i.CAPSULE=64,i.HEIGHTFIELD=128,i.prototype.computeMomentOfInertia=function(t){},i.prototype.updateBoundingRadius=function(){},i.prototype.updateArea=function(){},i.prototype.computeAABB=function(t,e,o){},i.prototype.raycast=function(t,e,o,i){}},{"../math/vec2":30}],46:[function(t,e,o){function i(t){a.call(this,t,a.GS),t=t||{},this.iterations=t.iterations||10,this.tolerance=t.tolerance||1e-7,this.arrayStep=30,this.lambda=new s.ARRAY_TYPE(this.arrayStep),this.Bs=new s.ARRAY_TYPE(this.arrayStep),this.invCs=new s.ARRAY_TYPE(this.arrayStep),this.useZeroRHS=!1,this.frictionIterations=0,this.usedIterations=0}function n(t){for(var e=t.length;e--;)t[e]=0}var r=t("../math/vec2"),a=t("./Solver"),s=t("../utils/Utils"),c=t("../equations/FrictionEquation");e.exports=i,i.prototype=new a,i.prototype.constructor=i,i.prototype.solve=function(t,e){this.sortEquations();var o=0,a=this.iterations,h=this.frictionIterations,l=this.equations,p=l.length,u=Math.pow(this.tolerance*p,2),d=e.bodies,f=e.bodies.length,v=(r.add,r.set,this.useZeroRHS),y=this.lambda;if(this.usedIterations=0,p)for(var m=0;m!==f;m++){var g=d[m];g.updateSolveMassProperties()}y.length<p&&(y=this.lambda=new s.ARRAY_TYPE(p+this.arrayStep),this.Bs=new s.ARRAY_TYPE(p+this.arrayStep),this.invCs=new s.ARRAY_TYPE(p+this.arrayStep)),n(y);
for(var A=this.invCs,b=this.Bs,y=this.lambda,m=0;m!==l.length;m++){var E=l[m];(E.timeStep!==t||E.needsUpdate)&&(E.timeStep=t,E.update()),b[m]=E.computeB(E.a,E.b,t),A[m]=E.computeInvC(E.epsilon)}var E,B,m,q;if(0!==p){for(m=0;m!==f;m++){var g=d[m];g.resetConstraintVelocity()}if(h){for(o=0;o!==h;o++){for(B=0,q=0;q!==p;q++){E=l[q];var P=i.iterateEquation(q,E,E.epsilon,b,A,y,v,t,o);B+=Math.abs(P)}if(this.usedIterations++,u>=B*B)break}for(i.updateMultipliers(l,y,1/t),q=0;q!==p;q++){var w=l[q];if(w instanceof c){for(var S=0,C=0;C!==w.contactEquations.length;C++)S+=w.contactEquations[C].multiplier;S*=w.frictionCoefficient/w.contactEquations.length,w.maxForce=S,w.minForce=-S}}}for(o=0;o!==a;o++){for(B=0,q=0;q!==p;q++){E=l[q];var P=i.iterateEquation(q,E,E.epsilon,b,A,y,v,t,o);B+=Math.abs(P)}if(this.usedIterations++,u>=B*B)break}for(m=0;m!==f;m++)d[m].addConstraintVelocity();i.updateMultipliers(l,y,1/t)}},i.updateMultipliers=function(t,e,o){for(var i=t.length;i--;)t[i].multiplier=e[i]*o},i.iterateEquation=function(t,e,o,i,n,r,a,s,c){var h=i[t],l=n[t],p=r[t],u=e.computeGWlambda(),d=e.maxForce,f=e.minForce;a&&(h=0);var v=l*(h-u-o*p),y=p+v;return f*s>y?v=f*s-p:y>d*s&&(v=d*s-p),r[t]+=v,e.addToWlambda(v),v}},{"../equations/FrictionEquation":23,"../math/vec2":30,"../utils/Utils":57,"./Solver":47}],47:[function(t,e,o){function i(t,e){t=t||{},n.call(this),this.type=e,this.equations=[],this.equationSortFunction=t.equationSortFunction||!1}var n=(t("../utils/Utils"),t("../events/EventEmitter"));e.exports=i,i.prototype=new n,i.prototype.constructor=i,i.prototype.solve=function(t,e){throw new Error("Solver.solve should be implemented by subclasses!")};var r={bodies:[]};i.prototype.solveIsland=function(t,e){this.removeAllEquations(),e.equations.length&&(this.addEquations(e.equations),r.bodies.length=0,e.getBodies(r.bodies),r.bodies.length&&this.solve(t,r))},i.prototype.sortEquations=function(){this.equationSortFunction&&this.equations.sort(this.equationSortFunction)},i.prototype.addEquation=function(t){t.enabled&&this.equations.push(t)},i.prototype.addEquations=function(t){for(var e=0,o=t.length;e!==o;e++){var i=t[e];i.enabled&&this.equations.push(i)}},i.prototype.removeEquation=function(t){var e=this.equations.indexOf(t);-1!==e&&this.equations.splice(e,1)},i.prototype.removeAllEquations=function(){this.equations.length=0},i.GS=1,i.ISLAND=2},{"../events/EventEmitter":26,"../utils/Utils":57}],48:[function(t,e,o){function i(){r.apply(this,arguments)}var n=t("../equations/ContactEquation"),r=t("./Pool");e.exports=i,i.prototype=new r,i.prototype.constructor=i,i.prototype.create=function(){return new n},i.prototype.destroy=function(t){return t.bodyA=t.bodyB=null,this}},{"../equations/ContactEquation":21,"./Pool":55}],49:[function(t,e,o){function i(){r.apply(this,arguments)}var n=t("../equations/FrictionEquation"),r=t("./Pool");e.exports=i,i.prototype=new r,i.prototype.constructor=i,i.prototype.create=function(){return new n},i.prototype.destroy=function(t){return t.bodyA=t.bodyB=null,this}},{"../equations/FrictionEquation":23,"./Pool":55}],50:[function(t,e,o){function i(){r.apply(this,arguments)}var n=t("../world/IslandNode"),r=t("./Pool");e.exports=i,i.prototype=new r,i.prototype.constructor=i,i.prototype.create=function(){return new n},i.prototype.destroy=function(t){return t.reset(),this}},{"../world/IslandNode":60,"./Pool":55}],51:[function(t,e,o){function i(){r.apply(this,arguments)}var n=t("../world/Island"),r=t("./Pool");e.exports=i,i.prototype=new r,i.prototype.constructor=i,i.prototype.create=function(){return new n},i.prototype.destroy=function(t){return t.reset(),this}},{"../world/Island":58,"./Pool":55}],52:[function(t,e,o){function i(){this.overlappingShapesLastState=new n,this.overlappingShapesCurrentState=new n,this.recordPool=new r({size:16}),this.tmpDict=new n,this.tmpArray1=[]}var n=t("./TupleDictionary"),r=(t("./OverlapKeeperRecord"),t("./OverlapKeeperRecordPool"));t("./Utils"),e.exports=i,i.prototype.tick=function(){for(var t=this.overlappingShapesLastState,e=this.overlappingShapesCurrentState,o=t.keys.length;o--;){var i=t.keys[o],n=t.getByKey(i);e.getByKey(i),n&&this.recordPool.release(n)}t.reset(),t.copy(e),e.reset()},i.prototype.setOverlapping=function(t,e,o,i){var n=(this.overlappingShapesLastState,this.overlappingShapesCurrentState);if(!n.get(e.id,i.id)){var r=this.recordPool.get();r.set(t,e,o,i),n.set(e.id,i.id,r)}},i.prototype.getNewOverlaps=function(t){return this.getDiff(this.overlappingShapesLastState,this.overlappingShapesCurrentState,t)},i.prototype.getEndOverlaps=function(t){return this.getDiff(this.overlappingShapesCurrentState,this.overlappingShapesLastState,t)},i.prototype.bodiesAreOverlapping=function(t,e){for(var o=this.overlappingShapesCurrentState,i=o.keys.length;i--;){var n=o.keys[i],r=o.data[n];if(r.bodyA===t&&r.bodyB===e||r.bodyA===e&&r.bodyB===t)return!0}return!1},i.prototype.getDiff=function(t,e,o){var o=o||[],i=t,n=e;o.length=0;for(var r=n.keys.length;r--;){var a=n.keys[r],s=n.data[a];if(!s)throw new Error("Key "+a+" had no data!");var c=i.data[a];c||o.push(s)}return o},i.prototype.isNewOverlap=function(t,e){var o=0|t.id,i=0|e.id,n=this.overlappingShapesLastState,r=this.overlappingShapesCurrentState;return!n.get(o,i)&&!!r.get(o,i)},i.prototype.getNewBodyOverlaps=function(t){this.tmpArray1.length=0;var e=this.getNewOverlaps(this.tmpArray1);return this.getBodyDiff(e,t)},i.prototype.getEndBodyOverlaps=function(t){this.tmpArray1.length=0;var e=this.getEndOverlaps(this.tmpArray1);return this.getBodyDiff(e,t)},i.prototype.getBodyDiff=function(t,e){e=e||[];for(var o=this.tmpDict,i=t.length;i--;){var n=t[i];o.set(0|n.bodyA.id,0|n.bodyB.id,n)}for(i=o.keys.length;i--;){var n=o.getByKey(o.keys[i]);n&&e.push(n.bodyA,n.bodyB)}return o.reset(),e}},{"./OverlapKeeperRecord":53,"./OverlapKeeperRecordPool":54,"./TupleDictionary":56,"./Utils":57}],53:[function(t,e,o){function i(t,e,o,i){this.shapeA=e,this.shapeB=i,this.bodyA=t,this.bodyB=o}e.exports=i,i.prototype.set=function(t,e,o,n){i.call(this,t,e,o,n)}},{}],54:[function(t,e,o){function i(){r.apply(this,arguments)}var n=t("./OverlapKeeperRecord"),r=t("./Pool");e.exports=i,i.prototype=new r,i.prototype.constructor=i,i.prototype.create=function(){return new n},i.prototype.destroy=function(t){return t.bodyA=t.bodyB=t.shapeA=t.shapeB=null,this}},{"./OverlapKeeperRecord":53,"./Pool":55}],55:[function(t,e,o){function i(t){t=t||{},this.objects=[],void 0!==t.size&&this.resize(t.size)}e.exports=i,i.prototype.resize=function(t){for(var e=this.objects;e.length>t;)e.pop();for(;e.length<t;)e.push(this.create());return this},i.prototype.get=function(){var t=this.objects;return t.length?t.pop():this.create()},i.prototype.release=function(t){return this.destroy(t),this.objects.push(t),this}},{}],56:[function(t,e,o){function i(){this.data={},this.keys=[]}var n=t("./Utils");e.exports=i,i.prototype.getKey=function(t,e){return t=0|t,e=0|e,(0|t)===(0|e)?-1:0|((0|t)>(0|e)?t<<16|65535&e:e<<16|65535&t)},i.prototype.getByKey=function(t){return t=0|t,this.data[t]},i.prototype.get=function(t,e){return this.data[this.getKey(t,e)]},i.prototype.set=function(t,e,o){if(!o)throw new Error("No data!");var i=this.getKey(t,e);return this.data[i]||this.keys.push(i),this.data[i]=o,i},i.prototype.reset=function(){for(var t=this.data,e=this.keys,o=e.length;o--;)delete t[e[o]];e.length=0},i.prototype.copy=function(t){this.reset(),n.appendArray(this.keys,t.keys);for(var e=t.keys.length;e--;){var o=t.keys[e];this.data[o]=t.data[o]}}},{"./Utils":57}],57:[function(t,e,o){function i(){}e.exports=i,i.appendArray=function(t,e){if(e.length<15e4)t.push.apply(t,e);else for(var o=0,i=e.length;o!==i;++o)t.push(e[o])},i.splice=function(t,e,o){o=o||1;for(var i=e,n=t.length-o;n>i;i++)t[i]=t[i+o];t.length=n},"undefined"!=typeof P2_ARRAY_TYPE?i.ARRAY_TYPE=P2_ARRAY_TYPE:"undefined"!=typeof Float32Array?i.ARRAY_TYPE=Float32Array:i.ARRAY_TYPE=Array,i.extend=function(t,e){for(var o in e)t[o]=e[o]},i.defaults=function(t,e){t=t||{};for(var o in e)o in t||(t[o]=e[o]);return t}},{}],58:[function(t,e,o){function i(){this.equations=[],this.bodies=[]}var n=t("../objects/Body");e.exports=i,i.prototype.reset=function(){this.equations.length=this.bodies.length=0};var r=[];i.prototype.getBodies=function(t){var e=t||[],o=this.equations;r.length=0;for(var i=0;i!==o.length;i++){var n=o[i];-1===r.indexOf(n.bodyA.id)&&(e.push(n.bodyA),r.push(n.bodyA.id)),-1===r.indexOf(n.bodyB.id)&&(e.push(n.bodyB),r.push(n.bodyB.id))}return e},i.prototype.wantsToSleep=function(){for(var t=0;t<this.bodies.length;t++){var e=this.bodies[t];if(e.type===n.DYNAMIC&&!e.wantsToSleep)return!1}return!0},i.prototype.sleep=function(){for(var t=0;t<this.bodies.length;t++){var e=this.bodies[t];e.sleep()}return!0}},{"../objects/Body":31}],59:[function(t,e,o){function i(t){this.nodePool=new n({size:16}),this.islandPool=new r({size:8}),this.equations=[],this.islands=[],this.nodes=[],this.queue=[]}var n=(t("../math/vec2"),t("./Island"),t("./IslandNode"),t("./../utils/IslandNodePool")),r=t("./../utils/IslandPool"),a=t("../objects/Body");e.exports=i,i.getUnvisitedNode=function(t){for(var e=t.length,o=0;o!==e;o++){var i=t[o];if(!i.visited&&i.body.type===a.DYNAMIC)return i}return!1},i.prototype.visit=function(t,e,o){e.push(t.body);for(var i=t.equations.length,n=0;n!==i;n++){var r=t.equations[n];-1===o.indexOf(r)&&o.push(r)}},i.prototype.bfs=function(t,e,o){var n=this.queue;for(n.length=0,n.push(t),t.visited=!0,this.visit(t,e,o);n.length;)for(var r,s=n.pop();r=i.getUnvisitedNode(s.neighbors);)r.visited=!0,this.visit(r,e,o),r.body.type===a.DYNAMIC&&n.push(r)},i.prototype.split=function(t){for(var e=t.bodies,o=this.nodes,n=this.equations;o.length;)this.nodePool.release(o.pop());for(var r=0;r!==e.length;r++){var a=this.nodePool.get();a.body=e[r],o.push(a)}for(var s=0;s!==n.length;s++){var c=n[s],r=e.indexOf(c.bodyA),h=e.indexOf(c.bodyB),l=o[r],p=o[h];l.neighbors.push(p),p.neighbors.push(l),l.equations.push(c),p.equations.push(c)}for(var u=this.islands,r=0;r<u.length;r++)this.islandPool.release(u[r]);u.length=0;for(var d;d=i.getUnvisitedNode(o);){var f=this.islandPool.get();this.bfs(d,f.bodies,f.equations),u.push(f)}return u}},{"../math/vec2":30,"../objects/Body":31,"./../utils/IslandNodePool":50,"./../utils/IslandPool":51,"./Island":58,"./IslandNode":60}],60:[function(t,e,o){function i(t){this.body=t,this.neighbors=[],this.equations=[],this.visited=!1}e.exports=i,i.prototype.reset=function(){this.equations.length=0,this.neighbors.length=0,this.visited=!1,this.body=null}},{}],61:[function(t,e,o){function i(t){p.apply(this),t=t||{},this.springs=[],this.bodies=[],this.disabledBodyCollisionPairs=[],this.solver=t.solver||new n,this.narrowphase=new m(this),this.islandManager=new b,this.gravity=r.fromValues(0,-9.78),t.gravity&&r.copy(this.gravity,t.gravity),this.frictionGravity=r.length(this.gravity)||10,this.useWorldGravityAsFrictionGravity=!0,this.useFrictionGravityOnZeroGravity=!0,this.broadphase=t.broadphase||new y,this.broadphase.setWorld(this),this.constraints=[],this.defaultMaterial=new d,this.defaultContactMaterial=new f(this.defaultMaterial,this.defaultMaterial),this.lastTimeStep=1/60,this.applySpringForces=!0,this.applyDamping=!0,this.applyGravity=!0,this.solveConstraints=!0,this.contactMaterials=[],this.time=0,this.accumulator=0,this.stepping=!1,this.bodiesToBeRemoved=[],this.islandSplit="undefined"!=typeof t.islandSplit?!!t.islandSplit:!0,this.emitImpactEvent=!0,this._constraintIdCounter=0,this._bodyIdCounter=0,this.postStepEvent={type:"postStep"},this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.addSpringEvent={type:"addSpring",spring:null},this.impactEvent={type:"impact",bodyA:null,bodyB:null,shapeA:null,shapeB:null,contactEquation:null},this.postBroadphaseEvent={type:"postBroadphase",pairs:null},this.sleepMode=i.NO_SLEEPING,this.beginContactEvent={type:"beginContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null,contactEquations:[]},this.endContactEvent={type:"endContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null},this.preSolveEvent={type:"preSolve",contactEquations:null,frictionEquations:null},this.overlappingShapesLastState={keys:[]},this.overlappingShapesCurrentState={keys:[]},this.overlapKeeper=new A}var n=t("../solver/GSSolver"),r=(t("../solver/Solver"),t("../collision/Ray"),t("../math/vec2")),a=t("../shapes/Circle"),s=t("../shapes/Convex"),c=(t("../shapes/Line"),t("../shapes/Plane")),h=t("../shapes/Capsule"),l=t("../shapes/Particle"),p=t("../events/EventEmitter"),u=t("../objects/Body"),d=(t("../shapes/Shape"),t("../objects/LinearSpring"),t("../material/Material")),f=t("../material/ContactMaterial"),v=(t("../constraints/DistanceConstraint"),t("../constraints/Constraint"),t("../constraints/LockConstraint"),t("../constraints/RevoluteConstraint"),t("../constraints/PrismaticConstraint"),t("../constraints/GearConstraint"),t("../../package.json"),t("../collision/Broadphase"),t("../collision/AABB")),y=t("../collision/SAPBroadphase"),m=t("../collision/Narrowphase"),g=t("../utils/Utils"),A=t("../utils/OverlapKeeper"),b=t("./IslandManager");t("../objects/RotationalSpring"),e.exports=i,i.prototype=new Object(p.prototype),i.prototype.constructor=i,i.NO_SLEEPING=1,i.BODY_SLEEPING=2,i.ISLAND_SLEEPING=4,i.prototype.addConstraint=function(t){this.constraints.push(t)},i.prototype.addContactMaterial=function(t){this.contactMaterials.push(t)},i.prototype.removeContactMaterial=function(t){var e=this.contactMaterials.indexOf(t);-1!==e&&g.splice(this.contactMaterials,e,1)},i.prototype.getContactMaterial=function(t,e){for(var o=this.contactMaterials,i=0,n=o.length;i!==n;i++){var r=o[i];if(r.materialA.id===t.id&&r.materialB.id===e.id||r.materialA.id===e.id&&r.materialB.id===t.id)return r}return!1},i.prototype.removeConstraint=function(t){var e=this.constraints.indexOf(t);-1!==e&&g.splice(this.constraints,e,1)};var E=(r.create(),r.create(),r.create(),r.create(),r.create(),r.create(),r.create()),B=r.fromValues(0,0),q=r.fromValues(0,0);r.fromValues(0,0),r.fromValues(0,0),i.prototype.step=function(t,e,o){if(o=o||10,e=e||0,0===e)this.internalStep(t),this.time+=t;else{this.accumulator+=e;for(var i=0;this.accumulator>=t&&o>i;)this.internalStep(t),this.time+=t,this.accumulator-=t,i++;for(var n=this.accumulator%t/t,a=0;a!==this.bodies.length;a++){var s=this.bodies[a];r.lerp(s.interpolatedPosition,s.previousPosition,s.position,n),s.interpolatedAngle=s.previousAngle+n*(s.angle-s.previousAngle)}}};var P=[];i.prototype.internalStep=function(t){this.stepping=!0;var e=this.springs.length,o=this.springs,n=this.bodies,a=this.gravity,s=this.solver,c=this.bodies.length,h=this.broadphase,l=this.narrowphase,p=this.constraints,d=E,f=(r.scale,r.add),v=(r.rotate,this.islandManager);if(this.overlapKeeper.tick(),this.lastTimeStep=t,this.useWorldGravityAsFrictionGravity){var y=r.length(this.gravity);0===y&&this.useFrictionGravityOnZeroGravity||(this.frictionGravity=y)}if(this.applyGravity)for(var m=0;m!==c;m++){var A=n[m],b=A.force;A.type===u.DYNAMIC&&A.sleepState!==u.SLEEPING&&(r.scale(d,a,A.mass*A.gravityScale),f(b,b,d))}if(this.applySpringForces)for(var m=0;m!==e;m++){var B=o[m];B.applyForce()}if(this.applyDamping)for(var m=0;m!==c;m++){var A=n[m];A.type===u.DYNAMIC&&A.applyDamping(t)}for(var q=h.getCollisionPairs(this),w=this.disabledBodyCollisionPairs,m=w.length-2;m>=0;m-=2)for(var S=q.length-2;S>=0;S-=2)(w[m]===q[S]&&w[m+1]===q[S+1]||w[m+1]===q[S]&&w[m]===q[S+1])&&q.splice(S,2);var C=p.length;for(m=0;m!==C;m++){var L=p[m];if(!L.collideConnected)for(var S=q.length-2;S>=0;S-=2)(L.bodyA===q[S]&&L.bodyB===q[S+1]||L.bodyB===q[S]&&L.bodyA===q[S+1])&&q.splice(S,2)}this.postBroadphaseEvent.pairs=q,this.emit(this.postBroadphaseEvent),this.postBroadphaseEvent.pairs=null,l.reset(this);for(var m=0,x=q.length;m!==x;m+=2)for(var F=q[m],M=q[m+1],I=0,R=F.shapes.length;I!==R;I++)for(var V=F.shapes[I],T=V.position,N=V.angle,G=0,O=M.shapes.length;G!==O;G++){var U=M.shapes[G],k=U.position,_=U.angle,D=this.defaultContactMaterial;if(V.material&&U.material){var W=this.getContactMaterial(V.material,U.material);W&&(D=W)}this.runNarrowphase(l,F,V,T,N,M,U,k,_,D,this.frictionGravity)}for(var m=0;m!==c;m++){var X=n[m];X._wakeUpAfterNarrowphase&&(X.wakeUp(),X._wakeUpAfterNarrowphase=!1)}if(this.has("endContact")){this.overlapKeeper.getEndOverlaps(P);for(var j=this.endContactEvent,G=P.length;G--;){var z=P[G];j.shapeA=z.shapeA,j.shapeB=z.shapeB,j.bodyA=z.bodyA,j.bodyB=z.bodyB,this.emit(j)}P.length=0}var Y=this.preSolveEvent;Y.contactEquations=l.contactEquations,Y.frictionEquations=l.frictionEquations,this.emit(Y),Y.contactEquations=Y.frictionEquations=null;var C=p.length;for(m=0;m!==C;m++)p[m].update();if(l.contactEquations.length||l.frictionEquations.length||C)if(this.islandSplit){for(v.equations.length=0,g.appendArray(v.equations,l.contactEquations),g.appendArray(v.equations,l.frictionEquations),m=0;m!==C;m++)g.appendArray(v.equations,p[m].equations);v.split(this);for(var m=0;m!==v.islands.length;m++){var K=v.islands[m];K.equations.length&&s.solveIsland(t,K)}}else{for(s.addEquations(l.contactEquations),s.addEquations(l.frictionEquations),m=0;m!==C;m++)s.addEquations(p[m].equations);this.solveConstraints&&s.solve(t,this),s.removeAllEquations()}for(var m=0;m!==c;m++){var X=n[m];X.integrate(t)}for(var m=0;m!==c;m++)n[m].setZeroForce();if(this.emitImpactEvent&&this.has("impact"))for(var H=this.impactEvent,m=0;m!==l.contactEquations.length;m++){var Z=l.contactEquations[m];Z.firstImpact&&(H.bodyA=Z.bodyA,H.bodyB=Z.bodyB,H.shapeA=Z.shapeA,H.shapeB=Z.shapeB,H.contactEquation=Z,this.emit(H))}if(this.sleepMode===i.BODY_SLEEPING)for(m=0;m!==c;m++)n[m].sleepTick(this.time,!1,t);else if(this.sleepMode===i.ISLAND_SLEEPING&&this.islandSplit){for(m=0;m!==c;m++)n[m].sleepTick(this.time,!0,t);for(var m=0;m<this.islandManager.islands.length;m++){var K=this.islandManager.islands[m];K.wantsToSleep()&&K.sleep()}}this.stepping=!1;for(var J=this.bodiesToBeRemoved,m=0;m!==J.length;m++)this.removeBody(J[m]);J.length=0,this.emit(this.postStepEvent)},i.prototype.runNarrowphase=function(t,e,o,i,n,a,s,c,h,l,p){if(0!==(o.collisionGroup&s.collisionMask)&&0!==(s.collisionGroup&o.collisionMask)){r.rotate(B,i,e.angle),r.rotate(q,c,a.angle),r.add(B,B,e.position),r.add(q,q,a.position);var d=n+e.angle,f=h+a.angle;t.enableFriction=l.friction>0,t.frictionCoefficient=l.friction;var v;v=e.type===u.STATIC||e.type===u.KINEMATIC?a.mass:a.type===u.STATIC||a.type===u.KINEMATIC?e.mass:e.mass*a.mass/(e.mass+a.mass),t.slipForce=l.friction*p*v,t.restitution=l.restitution,t.surfaceVelocity=l.surfaceVelocity,t.frictionStiffness=l.frictionStiffness,t.frictionRelaxation=l.frictionRelaxation,t.stiffness=l.stiffness,t.relaxation=l.relaxation,t.contactSkinSize=l.contactSkinSize,t.enabledEquations=e.collisionResponse&&a.collisionResponse&&o.collisionResponse&&s.collisionResponse;var y=t[o.type|s.type],m=0;if(y){var g=o.sensor||s.sensor,A=t.frictionEquations.length;m=o.type<s.type?y.call(t,e,o,B,d,a,s,q,f,g):y.call(t,a,s,q,f,e,o,B,d,g);var b=t.frictionEquations.length-A;if(m){if(e.allowSleep&&e.type===u.DYNAMIC&&e.sleepState===u.SLEEPING&&a.sleepState===u.AWAKE&&a.type!==u.STATIC){var E=r.squaredLength(a.velocity)+Math.pow(a.angularVelocity,2),P=Math.pow(a.sleepSpeedLimit,2);E>=2*P&&(e._wakeUpAfterNarrowphase=!0)}if(a.allowSleep&&a.type===u.DYNAMIC&&a.sleepState===u.SLEEPING&&e.sleepState===u.AWAKE&&e.type!==u.STATIC){var w=r.squaredLength(e.velocity)+Math.pow(e.angularVelocity,2),S=Math.pow(e.sleepSpeedLimit,2);w>=2*S&&(a._wakeUpAfterNarrowphase=!0)}if(this.overlapKeeper.setOverlapping(e,o,a,s),this.has("beginContact")&&this.overlapKeeper.isNewOverlap(o,s)){var C=this.beginContactEvent;if(C.shapeA=o,C.shapeB=s,C.bodyA=e,C.bodyB=a,C.contactEquations.length=0,"number"==typeof m)for(var L=t.contactEquations.length-m;L<t.contactEquations.length;L++)C.contactEquations.push(t.contactEquations[L]);this.emit(C)}if("number"==typeof m&&b>1)for(var L=t.frictionEquations.length-b;L<t.frictionEquations.length;L++){var x=t.frictionEquations[L];x.setSlipForce(x.getSlipForce()/b)}}}}},i.prototype.addSpring=function(t){this.springs.push(t);var e=this.addSpringEvent;e.spring=t,this.emit(e),e.spring=null},i.prototype.removeSpring=function(t){var e=this.springs.indexOf(t);-1!==e&&g.splice(this.springs,e,1)},i.prototype.addBody=function(t){if(-1===this.bodies.indexOf(t)){this.bodies.push(t),t.world=this;var e=this.addBodyEvent;e.body=t,this.emit(e),e.body=null}},i.prototype.removeBody=function(t){if(this.stepping)this.bodiesToBeRemoved.push(t);else{t.world=null;var e=this.bodies.indexOf(t);-1!==e&&(g.splice(this.bodies,e,1),this.removeBodyEvent.body=t,t.resetConstraintVelocity(),this.emit(this.removeBodyEvent),this.removeBodyEvent.body=null)}},i.prototype.getBodyById=function(t){for(var e=this.bodies,o=0;o<e.length;o++){var i=e[o];if(i.id===t)return i}return!1},i.prototype.disableBodyCollision=function(t,e){this.disabledBodyCollisionPairs.push(t,e)},i.prototype.enableBodyCollision=function(t,e){for(var o=this.disabledBodyCollisionPairs,i=0;i<o.length;i+=2)if(o[i]===t&&o[i+1]===e||o[i+1]===t&&o[i]===e)return void o.splice(i,2)},i.prototype.clear=function(){this.time=0,this.solver&&this.solver.equations.length&&this.solver.removeAllEquations();for(var t=this.constraints,e=t.length-1;e>=0;e--)this.removeConstraint(t[e]);for(var o=this.bodies,e=o.length-1;e>=0;e--)this.removeBody(o[e]);for(var n=this.springs,e=n.length-1;e>=0;e--)this.removeSpring(n[e]);for(var r=this.contactMaterials,e=r.length-1;e>=0;e--)this.removeContactMaterial(r[e]);i.apply(this)};var w=r.create(),S=(r.fromValues(0,0),r.fromValues(0,0));i.prototype.hitTest=function(t,e,o){o=o||0;var i=new u({position:t}),n=new l,p=t,d=0,f=w,v=S;i.addShape(n);for(var y=this.narrowphase,m=[],g=0,A=e.length;g!==A;g++)for(var b=e[g],E=0,B=b.shapes.length;E!==B;E++){var q=b.shapes[E];r.rotate(f,q.position,b.angle),r.add(f,f,b.position);var P=q.angle+b.angle;(q instanceof a&&y.circleParticle(b,q,f,P,i,n,p,d,!0)||q instanceof s&&y.particleConvex(i,n,p,d,b,q,f,P,!0)||q instanceof c&&y.particlePlane(i,n,p,d,b,q,f,P,!0)||q instanceof h&&y.particleCapsule(i,n,p,d,b,q,f,P,!0)||q instanceof l&&r.squaredLength(r.sub(v,f,t))<o*o)&&m.push(b)}return m},i.prototype.setGlobalStiffness=function(t){for(var e=this.constraints,o=0;o!==e.length;o++)for(var i=e[o],n=0;n!==i.equations.length;n++){var r=i.equations[n];r.stiffness=t,r.needsUpdate=!0}for(var a=this.contactMaterials,o=0;o!==a.length;o++){var i=a[o];i.stiffness=i.frictionStiffness=t}var i=this.defaultContactMaterial;i.stiffness=i.frictionStiffness=t},i.prototype.setGlobalRelaxation=function(t){for(var e=0;e!==this.constraints.length;e++)for(var o=this.constraints[e],i=0;i!==o.equations.length;i++){var n=o.equations[i];n.relaxation=t,n.needsUpdate=!0}for(var e=0;e!==this.contactMaterials.length;e++){var o=this.contactMaterials[e];o.relaxation=o.frictionRelaxation=t}var o=this.defaultContactMaterial;o.relaxation=o.frictionRelaxation=t};var C=new v,L=[];i.prototype.raycast=function(t,e){return e.getAABB(C),this.broadphase.aabbQuery(this,C,L),e.intersectBodies(t,L),L.length=0,t.hasHit()}},{"../../package.json":6,"../collision/AABB":7,"../collision/Broadphase":8,"../collision/Narrowphase":10,"../collision/Ray":11,"../collision/SAPBroadphase":13,"../constraints/Constraint":14,"../constraints/DistanceConstraint":15,"../constraints/GearConstraint":16,"../constraints/LockConstraint":17,"../constraints/PrismaticConstraint":18,"../constraints/RevoluteConstraint":19,"../events/EventEmitter":26,"../material/ContactMaterial":27,"../material/Material":28,"../math/vec2":30,"../objects/Body":31,"../objects/LinearSpring":32,"../objects/RotationalSpring":33,"../shapes/Capsule":38,"../shapes/Circle":39,"../shapes/Convex":40,"../shapes/Line":42,"../shapes/Particle":43,"../shapes/Plane":44,"../shapes/Shape":45,"../solver/GSSolver":46,"../solver/Solver":47,"../utils/OverlapKeeper":52,"../utils/Utils":57,"./IslandManager":59}]},{},[36])(36)});

 //js/mouse.min_c3ba2ccd.js
var __reflect=(this&&this.__reflect)||function(p,c,t){p.__class__=c,t?t.push(c):t=[c],p.__types__=p.__types__?t.concat(p.__types__):t};var mouse;(function(mouse){var MouseEvent=(function(){function MouseEvent(){}MouseEvent.MOUSE_MOVE="mouseMove";MouseEvent.MOUSE_OVER="rollOver";MouseEvent.MOUSE_OUT="rollOut";MouseEvent.ROLL_OVER="rollOver";MouseEvent.ROLL_OUT="rollOut";MouseEvent.MOUSE_WHEEL="mouseWheel";return MouseEvent}());mouse.MouseEvent=MouseEvent;__reflect(MouseEvent.prototype,"mouse.MouseEvent")})(mouse||(mouse={}));egret.DisplayObject.prototype["$getConcatenatedVisible"]=function(){if(this.$parent){var parentVisible=this.$parent.$getConcatenatedVisible();return parentVisible&&this.$visible}else{return this.$visible}};var mouse;(function(mouse){var currentTarget;var stageObj;var isPC;var dispatch=function(type,bubbles,x,y){if(type==mouse.MouseEvent.ROLL_OVER&&currentTarget.isRollOver){return}if(type==mouse.MouseEvent.ROLL_OVER){currentTarget.isRollOver=true}else{if(type==mouse.MouseEvent.ROLL_OUT){delete currentTarget.isRollOver}}if(isPC&&currentTarget["buttonModeForMouse"]){try{var canvas=stageObj.$displayList.renderBuffer.surface;if(type==mouse.MouseEvent.ROLL_OVER){canvas.style.cursor="pointer"}else{if(type==mouse.MouseEvent.ROLL_OUT){canvas.style.cursor="auto"}}}catch(e){}}egret.TouchEvent.dispatchTouchEvent(currentTarget,type,bubbles,false,x,y,null)};mouse.enable=function(stage){stageObj=stage;var onTouchMove=egret.sys.TouchHandler.prototype.onTouchMove;egret.sys.TouchHandler.prototype.onTouchMove=function(x,y,touchPointID){if(GYLite.GYSprite.stageX!=x&&GYLite.GYSprite.stageY!=y){if(mouseMoveEnabled){var target=this.findTarget(x,y);egret.TouchEvent.dispatchTouchEvent(target,mouse.MouseEvent.MOUSE_MOVE,true,true,x,y,touchPointID,true);GYLite.ProtoUtil.moveDispatched=true}}onTouchMove.call(this,x,y,touchPointID)};var onTouchEnd=egret.sys.TouchHandler.prototype.onTouchEnd;egret.sys.TouchHandler.prototype.onTouchEnd=function(x,y,touchPointID){if(GYLite.GYSprite.stageX!=x&&GYLite.GYSprite.stageY!=y){if(mouseMoveEnabled){var target=this.findTarget(x,y);egret.TouchEvent.dispatchTouchEvent(target,mouse.MouseEvent.MOUSE_MOVE,true,true,x,y,touchPointID,true);GYLite.ProtoUtil.moveDispatched=true}}onTouchEnd.call(this,x,y,touchPointID)}};mouse.setButtonMode=function(displayObjcet,buttonMode){displayObjcet["buttonModeForMouse"]=buttonMode};var mouseMoveEnabled=false;mouse.setMouseMoveEnabled=function(enabled){mouseMoveEnabled=enabled;if(window.GYLite.setMouseMoveEnabled!=null){window.GYLite.setMouseMoveEnabled(enabled)}};var addMouseWheelEvent=function(){}})(mouse||(mouse={}));

 //js/promise.min_83a6a5d.js
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.ES6Promise=e()}(this,function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function e(t){return"function"==typeof t}function n(t){I=t}function r(t){J=t}function o(){return function(){return process.nextTick(a)}}function i(){return"undefined"!=typeof H?function(){H(a)}:c()}function s(){var t=0,e=new V(a),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function u(){var t=new MessageChannel;return t.port1.onmessage=a,function(){return t.port2.postMessage(0)}}function c(){var t=setTimeout;return function(){return t(a,1)}}function a(){for(var t=0;G>t;t+=2){var e=$[t],n=$[t+1];e(n),$[t]=void 0,$[t+1]=void 0}G=0}function f(){try{var t=require,e=t("vertx");return H=e.runOnLoop||e.runOnContext,i()}catch(n){return c()}}function l(t,e){var n=arguments,r=this,o=new this.constructor(p);void 0===o[ee]&&k(o);var i=r._state;return i?!function(){var t=n[i-1];J(function(){return x(i,o,t,r._result)})}():E(r,o,t,e),o}function h(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(p);return w(n,t),n}function p(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function d(){return new TypeError("A promises callback cannot return that same promise.")}function _(t){try{return t.then}catch(e){return ie.error=e,ie}}function y(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function m(t,e,n){J(function(t){var r=!1,o=y(n,e,function(n){r||(r=!0,e!==n?w(t,n):S(t,n))},function(e){r||(r=!0,j(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,j(t,o))},t)}function b(t,e){e._state===re?S(t,e._result):e._state===oe?j(t,e._result):E(e,void 0,function(e){return w(t,e)},function(e){return j(t,e)})}function g(t,n,r){n.constructor===t.constructor&&r===l&&n.constructor.resolve===h?b(t,n):r===ie?j(t,ie.error):void 0===r?S(t,n):e(r)?m(t,n,r):S(t,n)}function w(e,n){e===n?j(e,v()):t(n)?g(e,n,_(n)):S(e,n)}function A(t){t._onerror&&t._onerror(t._result),P(t)}function S(t,e){t._state===ne&&(t._result=e,t._state=re,0!==t._subscribers.length&&J(P,t))}function j(t,e){t._state===ne&&(t._state=oe,t._result=e,J(A,t))}function E(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+re]=n,o[i+oe]=r,0===i&&t._state&&J(P,t)}function P(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?x(n,r,o,i):o(i);t._subscribers.length=0}}function T(){this.error=null}function M(t,e){try{return t(e)}catch(n){return se.error=n,se}}function x(t,n,r,o){var i=e(r),s=void 0,u=void 0,c=void 0,a=void 0;if(i){if(s=M(r,o),s===se?(a=!0,u=s.error,s=null):c=!0,n===s)return void j(n,d())}else s=o,c=!0;n._state!==ne||(i&&c?w(n,s):a?j(n,u):t===re?S(n,s):t===oe&&j(n,s))}function C(t,e){try{e(function(e){w(t,e)},function(e){j(t,e)})}catch(n){j(t,n)}}function O(){return ue++}function k(t){t[ee]=ue++,t._state=void 0,t._result=void 0,t._subscribers=[]}function Y(t,e){this._instanceConstructor=t,this.promise=new t(p),this.promise[ee]||k(this.promise),B(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?S(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&S(this.promise,this._result))):j(this.promise,q())}function q(){return new Error("Array Methods must be provided an Array")}function F(t){return new Y(this,t).promise}function D(t){var e=this;return new e(B(t)?function(n,r){for(var o=t.length,i=0;o>i;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function K(t){var e=this,n=new e(p);return j(n,t),n}function L(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function N(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function U(t){this[ee]=O(),this._result=this._state=void 0,this._subscribers=[],p!==t&&("function"!=typeof t&&L(),this instanceof U?C(this,t):N())}function W(){var t=void 0;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;if("undefined"!=typeof egret_native&&egret_native.capability&&!egret_native.capability("Promise")&&(n=void 0),n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(e){}if("[object Promise]"===r&&!n.cast)return}t.Promise=U}var z=void 0;z=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var B=z,G=0,H=void 0,I=void 0,J=function(t,e){$[G]=t,$[G+1]=e,G+=2,2===G&&(I?I(a):te())},Q="undefined"!=typeof window?window:void 0,R=Q||{},V=R.MutationObserver||R.WebKitMutationObserver,X="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),Z="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,$=new Array(1e3),te=void 0;te=X?o():V?s():Z?u():void 0===Q&&"function"==typeof require?f():c();var ee=Math.random().toString(36).substring(16),ne=void 0,re=1,oe=2,ie=new T,se=new T,ue=0;return Y.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===ne&&t>n;n++)this._eachEntry(e[n],n)},Y.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===h){var o=_(t);if(o===l&&t._state!==ne)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===U){var i=new n(p);g(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},Y.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===ne&&(this._remaining--,t===oe?j(r,n):this._result[e]=n),0===this._remaining&&S(r,this._result)},Y.prototype._willSettleAt=function(t,e){var n=this;E(t,void 0,function(t){return n._settledAt(re,e,t)},function(t){return n._settledAt(oe,e,t)})},U.all=F,U.race=D,U.resolve=h,U.reject=K,U._setScheduler=n,U._setAsap=r,U._asap=J,U.prototype={constructor:U,then:l,"catch":function(t){return this.then(null,t)}},U.polyfill=W,U.Promise=U,U}),ES6Promise.polyfill();

 //js/main.min_937fd6f9.js
var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},__extends=function(e,t){function i(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},__assign=Object.assign||function(e){for(var t,i=1,n=arguments.length;n>i;i++){t=arguments[i];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},__rest=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]]);return i},__decorate=function(e,t,i,n){var o,r=arguments.length,a=3>r?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(3>r?o(a):r>3?o(t,i,a):o(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a},__param=function(e,t){return function(i,n){t(i,n,e)}},__metadata=function(e,t){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(e,t):void 0},__awaiter=function(e,t,i,n){function o(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,r){function a(e){try{l(n.next(e))}catch(t){r(t)}}function s(e){try{l(n["throw"](e))}catch(t){r(t)}}function l(e){e.done?i(e.value):o(e.value).then(a,s)}l((n=n.apply(e,t||[])).next())})},__generator=function(e,t){function i(e){return function(t){return n([e,t])}}function n(i){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,r&&(a=2&i[0]?r["return"]:i[0]?r["throw"]||((a=r["return"])&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,r=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){l.label=i[1];break}if(6===i[0]&&l.label<a[1]){l.label=a[1],a=i;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(i);break}a[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(n){i=[6,n],r=0}finally{o=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var o,r,a,s,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},__exportStar=function(e,t){for(var i in e)"default"===i||t.hasOwnProperty(i)||__createBinding(t,e,i)},__createBinding=Object.create?function(e,t,i,n){void 0===n&&(n=i),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,n){void 0===n&&(n=i),e[n]=t[i]},__values=function(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=function(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,o,r=i.call(e),a=[];try{for(;(void 0===t||t-->0)&&!(n=r.next()).done;)a.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(i=r["return"])&&i.call(r)}finally{if(o)throw o.error}}return a},__spread=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e},__spreadArrays=function(){for(var e=0,t=0,i=arguments.length;i>t;t++)e+=arguments[t].length;for(var n=Array(e),o=0,t=0;i>t;t++)for(var r=arguments[t],a=0,s=r.length;s>a;a++,o++)n[o]=r[a];return n},__await=function(e){return this instanceof __await?(this.v=e,this):new __await(e)},__asyncGenerator=function(e,t,i){function n(e){c[e]&&(h[e]=function(t){return new Promise(function(i,n){d.push([e,t,i,n])>1||o(e,t)})})}function o(e,t){try{r(c[e](t))}catch(i){l(d[0][3],i)}}function r(e){e.value instanceof __await?Promise.resolve(e.value.v).then(a,s):l(d[0][2],e)}function a(e){o("next",e)}function s(e){o("throw",e)}function l(e,t){e(t),d.shift(),d.length&&o(d[0][0],d[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var h,c=i.apply(e,t||[]),d=[];return h={},n("next"),n("throw"),n("return"),h[Symbol.asyncIterator]=function(){return this},h},__asyncDelegator=function(e){function t(t,o){i[t]=e[t]?function(i){return(n=!n)?{value:__await(e[t](i)),done:"return"===t}:o?o(i):i}:o}var i,n;return i={},t("next"),t("throw",function(e){throw e}),t("return"),i[Symbol.iterator]=function(){return this},i},__asyncValues=function(e){function t(t){n[t]=e[t]&&function(n){return new Promise(function(o,r){n=e[t](n),i(o,r,n.done,n.value)})}}function i(e,t,i,n){Promise.resolve(n).then(function(t){e({value:t,done:i})},t)}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=e[Symbol.asyncIterator];return o?o.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),n={},t("next"),t("throw"),t("return"),n[Symbol.asyncIterator]=function(){return this},n)},__makeTemplateObject=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__setModuleDefault=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t},__importStar=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&__createBinding(t,e,i);return __setModuleDefault(t,e),t},__importDefault=function(e){return e&&e.__esModule?e:{"default":e}},__classPrivateFieldGet=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},__classPrivateFieldSet=function(e,t,i){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,i),i},__reflect=function(e,t,i){e.__class__=t,i?i.push(t):i=[t],e.__types__=e.__types__?i.concat(e.__types__):i};!function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var i={};return t.m=e,t.c=i,t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(1&i&&(e=t(e)),8&i)return e;if(4&i&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&i&&"string"!=typeof e)for(var o in e)t.d(n,o,function(t){return e[t]}.bind(null,o));return n},t.n=function(e){var i=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,i){i(1),i(2),i(3),i(4),i(5),i(6),i(0),i(7),i(8),i(9),i(10),i(11),i(12),i(13),i(14),i(15),i(16),i(17),i(18),i(19),i(20),i(21),i(22),i(23),i(24),i(25),i(26),i(27),i(28),i(29),i(30),i(31),i(32),i(33),i(34),i(35),i(36),i(37),i(38),i(39),i(40),i(41),i(42),i(43),i(44),i(45),i(46),i(47),i(48),i(49),i(50),i(51),i(52),i(53),i(54),i(55),i(56),i(57),i(58),i(59),i(60),i(61),i(62),i(63),i(64),i(65),i(66),i(67),i(68),i(69),i(70),i(71),i(72),i(73),i(74),i(75),i(76),i(77),i(78),i(79),i(80),i(81),i(82),i(83),i(84),i(85),i(86),i(87),i(88),i(89),i(90),i(91);var n=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){this.runGame()},t.prototype.runGame=function(){var e=this;codeBase.SceneManager.instance.Init(),codeBase.GlobalSetting.initData(),codeBase.HeartBeat.init(),this.loadingView=new codeBase.LoadingUI,codeBase.SceneManager.instance.showScene(this.loadingView),codeBase.EventManager.addEventListener(codeBase.EventType.LOADINGUI_FINISH,function(){e.loadResource(),e.createGameScene()},this)},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return t.sent(),[4,RES.loadGroup("preload",0,this.loadingView)];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),console.error(e),[3,4];case 4:return[2]}})})},t.prototype.createGameScene=function(){egret.setTimeout(function(){codeBase.SceneManager.instance.showScene(new codeBase.MainScene)},this,1e3)},t}(egret.DisplayObjectContainer);window.Main=n,__reflect(n.prototype,"Main",[])},function(e,t){var i,i=window.codeBase;!function(e){var t=function(e){function t(){var t=e.call(this)||this;t._isAddedToStage=!1,t._top=0/0,t._left=0/0,t._bottom=0/0,t._right=0/0,t._horizontalCenter=0/0,t._verticalCenter=0/0,t._hasInvalidatePosition=!1,t._drawDelay=!1,t._hasInvalidate=!1,t._data=null,t._enabled=!0;var i=t;return i._drawDelay=!1,i.addEventListener(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),t}return __extends(t,e),t.prototype.onAddToStage=function(e){var t=this;t._isAddedToStage=!0,t.removeEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t.createChildren(),t.initData(),t.onInvalidatePosition(),t.invalidate()},t.prototype.initData=function(){},t.prototype.createChildren=function(){var e=this;e.touchEnabled=!1},Object.defineProperty(t.prototype,"width",{get:function(){return this.$getWidth()},set:function(t){t>=0&&(e.prototype.$setWidth.call(this,t),this.onInvalidatePosition(),this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.$getHeight()},set:function(t){t>=0&&(e.prototype.$setHeight.call(this,t),this.onInvalidatePosition(),this.invalidate())},enumerable:!1,configurable:!0}),t.prototype.setSize=function(e,t){var i=this;(i.width!=e||i.height!=t)&&(i.width=e,i.height=t,i.onInvalidatePosition(),i.invalidate())},Object.defineProperty(t.prototype,"top",{get:function(){return this._top},set:function(e){var t=this;t._top!=e&&(t._top=e,t.onInvalidatePosition())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this._left},set:function(e){var t=this;t._left!=e&&(t._left=e,t.onInvalidatePosition())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this._bottom},set:function(e){var t=this;t._bottom!=e&&(t._bottom=e,t.onInvalidatePosition())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this._right},set:function(e){var t=this;t._right!=e&&(t._right=e,t.onInvalidatePosition())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalCenter",{get:function(){return this._horizontalCenter},set:function(e){var t=this;t._horizontalCenter!=e&&(t._horizontalCenter=e,t.onInvalidatePosition())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalCenter",{get:function(){return this._verticalCenter},set:function(e){var t=this;t._verticalCenter!=e&&(t._verticalCenter=e,t.onInvalidatePosition())},enumerable:!1,configurable:!0}),t.prototype.onInvalidatePosition=function(){var e=this;if(!e._hasInvalidatePosition){e._hasInvalidatePosition=!0,e.addEventListener(egret.Event.ENTER_FRAME,e.resetPosition,e);for(var i=void 0,n=0;n<e.numChildren;n++)i=e.getChildAt(n),i instanceof t&&i.onInvalidatePosition()}},t.prototype.resetPosition=function(){var e=this,i=e.parent;if(null!=i){var n=i.width,o=i.height,r=e.width,a=e.height;(isNaN(n)||void 0==o)&&(n=0),(isNaN(o)||void 0==o)&&(o=0),(isNaN(r)||void 0==r)&&(r=0),(isNaN(a)||void 0==a)&&(r=0);var s=!1,l=!1;if(!isNaN(e._top)&&isNaN(e._bottom)?e.y=e._top:!isNaN(e._bottom)&&isNaN(e._top)?e.y=o-e._bottom-a:isNaN(e._top)||isNaN(e._bottom)||(e.y=e._top,a=o-e._top-e._bottom,e.height!=a&&(e.height=a,l=!0)),!isNaN(e._left)&&isNaN(e._right)?e.x=e._left:!isNaN(e._right)&&isNaN(e.left)?e.x=n-e._right-r:isNaN(e.left)||isNaN(e._right)||(e.x=e._left,r=n-e._left-e._right,e.width!=r&&(e.width=r,s=!0)),isNaN(e._horizontalCenter)||s||(e.x=(n-r)/2+e._horizontalCenter),isNaN(e._verticalCenter)||l||(e.y=(o-a)/2+e._verticalCenter),s||l)for(var h=void 0,c=0;c<e.numChildren;c++)h=e.getChildAt(c),h instanceof t&&h.onInvalidatePosition()}e.removeEventListener(egret.Event.ENTER_FRAME,e.resetPosition,e),e._hasInvalidatePosition=!1},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e},enumerable:!1,configurable:!0}),t.prototype.clean=function(){},Object.defineProperty(t.prototype,"enabled",{get:function(){return this._enabled},set:function(e){this._enabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cx",{get:function(){return this.width/2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cy",{get:function(){return this.height/2},enumerable:!1,configurable:!0}),t.prototype.removeFromParent=function(){this.parent&&this.parent.removeChild(this)},t.prototype.getGlobalXY=function(){var e=new egret.Point(0,0);return this.localToGlobal(e.x,e.y,e),e},Object.defineProperty(t.prototype,"actualWidth",{get:function(){return this.width*this.scaleX},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"actualHeight",{get:function(){return this.height*this.scaleX},enumerable:!1,configurable:!0}),t.prototype.getRegPoint=function(){var e=new egret.Point(0,0);return 0!=this.anchorOffsetX&&(e.x=this.anchorOffsetX),0!=this.anchorOffsetY&&(e.y=this.anchorOffsetY),e},t.prototype.invalidate=function(){var e=this;e._hasInvalidate||e._drawDelay||(e.addEventListener(egret.Event.ENTER_FRAME,e.onInvalidate,e),e._hasInvalidate=!0)},t.prototype.onInvalidate=function(e){var t=this;t.draw(),t.removeEventListener(egret.Event.ENTER_FRAME,t.onInvalidate,t),t._hasInvalidate=!1},t.prototype.draw=function(){},Object.defineProperty(t.prototype,"drawDelay",{get:function(){return this._drawDelay},set:function(e){var t=this;t._drawDelay=e,t._drawDelay?(t.removeEventListener(egret.Event.ENTER_FRAME,t.onInvalidate,t),t._hasInvalidate=!1):t.invalidate()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAddedToStage",{get:function(){return this._isAddedToStage},enumerable:!1,configurable:!0}),t}(egret.DisplayObjectContainer);e.BaseGroup=t,__reflect(t.prototype,"codeBase.BaseGroup",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e._showBg=!1,e._bgColor=13421772,e._bgImage=null,e._bgTexture=null,e._scale9GridRect=null,e.scale9RectData=[],e._fillMode="scale",e._border=!1,e._clip=!0,e._touchNonePixel=!1,e}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this)},Object.defineProperty(i.prototype,"bgColor",{get:function(){return this._bgColor},set:function(e){this._bgColor!=e&&this._showBg&&(this._bgColor=e,this._bgTexture=null,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillMode",{get:function(){return this._fillMode},set:function(e){this._fillMode!=e&&(this._fillMode=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"showBg",{get:function(){return this._showBg},set:function(e){this._showBg!=e&&(this._showBg=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"clip",{get:function(){return this._clip},set:function(e){e!=this._clip&&(this._clip=e,this.invalidate())},enumerable:!1,configurable:!0}),i.prototype.draw=function(){if(0!=this.width&&0!=this.height){if(t.prototype.draw.call(this),this._clip){var i=e.ObjectPool.getByClass(egret.Rectangle);this.scrollRect&&(e.ObjectPool.recycleClass(this.scrollRect),this.scrollRect=null),i.width=this.width,i.height=this.height,i.x=0,i.y=0,this.scrollRect=i}else this.scrollRect=null;this._showBg||this._touchNonePixel&&this.touchEnabled?(this.addDefaultSkin(),this._bgImage&&(this._bgImage.visible=!0,this._touchNonePixel&&!this._showBg?this._bgImage.alpha=0:this._bgImage.alpha=1)):this._bgImage&&(this._bgImage.visible=!1,this._bgImage.parent&&this._bgImage.parent.removeChild(this._bgImage))}},i.prototype.addDefaultSkin=function(){if(this.width>0&&this.height>0)if(null==this._bgImage&&(this._bgImage=new egret.Bitmap),null==this._bgTexture){this._bgImage.fillMode=egret.BitmapFillMode.SCALE;var e=new egret.Shape;e.width=this.width,e.height=this.height,e.graphics.beginFill(this._bgColor,1),e.graphics.drawRect(0,0,this.width,this.height),e.graphics.endFill(),this._border&&(e.graphics.lineStyle(1,65280,1),e.graphics.drawRect(0,0,this.width,this.height));var t=new egret.RenderTexture;t.drawToTexture(e),this._bgTexture=t,this._bgImage.texture=this._bgTexture}else this._bgImage.texture=this._bgTexture;this._bgImage&&(this._showBg||this._touchNonePixel&&this.touchEnabled)&&(this._bgImage.parent||this.addChildAt(this._bgImage,0),4==this.scale9RectData.length?(null==this._scale9GridRect&&(this._scale9GridRect=this.scale9Rect()),this._scale9GridRect.x=this.scale9RectData[0],this._scale9GridRect.y=this.scale9RectData[2],this._scale9GridRect.width=this._bgImage.texture.$getTextureWidth()-(this.scale9RectData[0]+this.scale9RectData[1]),this._scale9GridRect.height=this._bgImage.texture.$getTextureHeight()-(this.scale9RectData[2]+this.scale9RectData[3]),this._bgImage.scale9Grid=this._scale9GridRect):this._bgImage.scale9Grid=null,this._bgImage.width=this.width,this._bgImage.height=this.height,this._bgImage.fillMode=this._fillMode)},Object.defineProperty(i.prototype,"border",{get:function(){return this._border},set:function(e){this._border!=e&&(this._border=e,this.invalidate())},enumerable:!1,configurable:!0}),i.prototype.getDefaultSkin=function(){return this._bgImage},Object.defineProperty(i.prototype,"bgTexture",{get:function(){return this._bgTexture},set:function(e){this._bgTexture!=e&&(this._bgTexture=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"touchNonePixel",{get:function(){return this._touchNonePixel},set:function(e){e!=this._touchNonePixel&&(this._touchNonePixel=e,this.invalidate())},enumerable:!1,configurable:!0}),i.prototype.scale9Grid=function(e){void 0===e&&(e=[]);4==e.length?this.scale9RectData=e.concat():this.scale9RectData.length=0,this.invalidate()},i.prototype.scale9Rect=function(){var e=new egret.Rectangle;return e.x=1,e.y=1,e.width=1,e.height=1,e},i}(e.BaseGroup);e.Group=t,__reflect(t.prototype,"codeBase.Group",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.list=null,t}return __extends(t,e),t.prototype.initData=function(){},t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.draw=function(){e.prototype.draw.call(this)},Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e,this.invalidate()},enumerable:!1,configurable:!0}),t.prototype.refresh=function(){this.data=this._data},Object.defineProperty(t.prototype,"selected",{get:function(){return this._selected},set:function(e){this.setSelected(e)},enumerable:!1,configurable:!0}),t.prototype.setSelected=function(e){this._selected!=e&&(this._selected=e,this.invalidate())},t.prototype.destroy=function(){},t.prototype.validateNow=function(){},t}(e.Group);e.DefaultRenderer=t,__reflect(t.prototype,"codeBase.DefaultRenderer",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.initData=function(){},i.prototype.draw=function(){this.itemImage&&(this.width=this.itemImage.texture.textureWidth,this.height=this.itemImage.texture.textureHeight)},i.prototype.destroy=function(){var e=this;e.itemImage&&(e.itemImage.parent&&e.itemImage.parent.removeChild(e.itemImage),e.itemImage=null)},i.prototype.validateNow=function(){var t=this;t.data&&(t.itemImage||(t.itemImage=new e.Image,t.addChild(t.itemImage)),t.itemImage.texture=RES.getRes(t.data.res),t.onInvalidate(null))},i}(e.DefaultRenderer);e.ListItemRenderer=t,__reflect(t.prototype,"codeBase.ListItemRenderer",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.isClear=!1,e}return __extends(i,t),i.prototype.initData=function(){t.prototype.initData.call(this);var i=this;i.stage=e.curStage(),i.modulePath="",i.skeletonPath=i.modulePath+"/skeleton/",i.videopath="video/"+i.modulePath+"/"},i.prototype.hide=function(){console.log("remove"+egret.getQualifiedClassName(this))},i}(e.BaseGroup);e.BaseScene=t,__reflect(t.prototype,"codeBase.BaseScene",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.prototype.initData=function(){t.prototype.initData.call(this),this.createView()},i.prototype.createView=function(){this.textField=new e.Label,this.addChild(this.textField),this.textField.horizontalCenter=0,this.textField.verticalCenter=0,this.textField.width=1920,this.textField.height=100,this.textField.hAlign=egret.HorizontalAlign.CENTER,this.textField.autoSize=!1,this.textField.showBg=!0,this.textField.bgColor=e.TextColors.blue,this.textField.fontSize=36,this.textField.text="Loading...",e.MyEvent.sendEvent(e.EventType.LOADINGUI_FINISH)},i.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},i}(e.BaseScene);e.LoadingUI=t,__reflect(t.prototype,"codeBase.LoadingUI",["RES.PromiseTaskReporter"])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(e,t){this.framekey="",this.frameNames=[],this.frameTextures=[];var i=this;i.framekey=e,i.frameNames=__spreadArrays(t),i.init()}return e.prototype.init=function(){for(var e=this,t=e.frameNames.length,i=0;t>i;++i)e.frameTextures[i]=RES.getRes(e.frameNames[i])},e.prototype.setFrameData=function(e,t){var i=this;i.framekey=e,i.frameNames=__spreadArrays(t)},e}();e.ImageData=t,__reflect(t.prototype,"codeBase.ImageData",[]);var i=function(){function e(){this.frameListener=[],this.frameListenerObj=[],this.frameIndex=[]}return e}();e.AnimationData=i,__reflect(i.prototype,"codeBase.AnimationData",[]);var n=function(e){function n(t,i,n,o,r){void 0===r&&(r=0);var a=e.call(this)||this;a.mCurFrame=0,a.mDelta=0,a.mFrameDelta=0,a.FPS=5,a.SpriteFrames=new Array,a.IsPlaying=!1,a.Foward=!0,a.AutoPlay=!1,a.Loop=1,a.loopCounter=0,a.currentAnimationData=null,a.FrameCount=0,a.defaultAnimationKey="",a.ax=.5,a.ay=.5,a.color=-1;var s=a;return s.AddAnimation(t,i,n,o,r),s.defaultAnimationKey=t,s.currentAnimationData=s.SpriteFrames[0],s.initImage(),s.addEventListener(egret.Event.ADDED_TO_STAGE,s.AddToStage,s),a}return __extends(n,e),n.prototype.AddToStage=function(e){var t=this;n._init||(n._init=!0,n.mLastTime=egret.getTimer(),n._stage=t.stage,n._stage.addEventListener(egret.Event.ENTER_FRAME,n.frameUpdate,t)),t.removeEventListener(egret.Event.ADDED_TO_STAGE,t.AddToStage,t),t.animationRun=new i,t.animationRun.fun=t.animationUpdate,t.animationRun.funObj=t,n.animationRunData.push(t.animationRun)},n.prototype.removeFromStage=function(e){var t=this,i=n.animationRunData.indexOf(t.animationRun);-1!=i&&n.animationRunData.splice(i,1),t.removeEventListener(egret.Event.REMOVED_FROM_STAGE,t.removeFromStage,t)},n.prototype.Init=function(){var e=this;e.mDelta=0,e.mCurFrame=0,e.IsPlaying=!0,e.mFrameDelta=1/e.FPS,e.Foward||(e.mCurFrame=e.FrameCount-1),e.ImageSource.texture=e.currentAnimationData.frameTextures[e.mCurFrame],e.initImage()},n.prototype.initImage=function(){var e=this;e.ImageSource||(e.ImageSource=new egret.Bitmap,e.addChild(e.ImageSource),e.setSprite(0)),e.ImageSource.anchorOffsetX=e.ImageSource.width*e.ax,e.ImageSource.anchorOffsetY=e.ImageSource.height*e.ay,e.width=e.ImageSource.width,e.height=e.ImageSource.height},n.prototype.animationUpdate=function(e){var t=this;if(t.IsPlaying&&t.currentAnimationData&&0!=t.FrameCount&&(e>1&&(e=0),t.mDelta+=e,t.mDelta>t.mFrameDelta)){if(t.mDelta-=t.mFrameDelta,t.frameListener(t.mCurFrame),t.Foward?t.mCurFrame++:t.mCurFrame--,t.mCurFrame>=t.FrameCount){if(t.Loop-=1,0==t.Loop)return t.IsPlaying=!1,void t.completeListener();t.mCurFrame=0}else if(t.mCurFrame<0){if(t.Loop-=1,0==t.Loop)return t.IsPlaying=!1,void t.completeListener();t.mCurFrame=t.FrameCount-1}t.setSprite(t.mCurFrame)}},n.frameUpdate=function(e){n.mCurrentTime=egret.getTimer(),n.mGapTime=(n.mCurrentTime-n.mLastTime)/1e3,n.mLastTime=n.mCurrentTime;for(var t=n.animationRunData.length,i=0;t>i;++i)n.animationRunData[i].fun.call(n.animationRunData[i].funObj,n.mGapTime)},n.prototype.AddAnimation=function(e,i,n,o,r){if(void 0===r&&(r=0),0==n)return void alert("");if(""==e)return void alert("");for(var a=this,s=!1,l=0;l<a.SpriteFrames.length;++l)if(a.SpriteFrames[l].framekey==e){s=!0;break}if(!s){for(var h=[],l=0;n>l;++l)h[l]=o+"."+i+(""+(r+l));var c=new t(e,h);a.SpriteFrames.push(c)}return a},n.prototype.show=function(e,t,i){var n=this;e.addChild(n),n.x=t,n.y=i},n.prototype.play=function(e,t,i){void 0===t&&(t=1),void 0===i&&(i=!0);var n=this;n.currentAnimationData=null,n.FrameCount=0,n.Loop=t,n.Foward=i;for(var o=0;o<n.SpriteFrames.length;++o)if(n.SpriteFrames[o].framekey==e){n.currentAnimationData=n.SpriteFrames[o],n.FrameCount=n.currentAnimationData.frameNames.length;break}0==n.FrameCount?alert("key"):n.Init()},n.prototype.stop=function(e){void 0===e&&(e=!1);var t=this;t.currentAnimationData&&(t.IsPlaying=!1,t.setSprite(0),e&&t.clear())},n.prototype.setFPS=function(e){this.FPS=e,this.mFrameDelta=1/this.FPS},n.prototype.setSprite=function(e){var t=this;t.ImageSource.texture=t.currentAnimationData.frameTextures[e]},n.prototype.clear=function(){var e=this,t=n.animationRunData.indexOf(e.animationRun);-1!=t&&n.animationRunData.splice(t,1)},n.dispose=function(){var e=this;n._init&&(n._init=!1,n._stage.removeEventListener(egret.Event.ENTER_FRAME,n.frameUpdate,e)),n.animationRunData.length=0},n.prototype.setAnchorPoint=function(e,t){var i=this;i.ax=e,i.ay=t;var n=i.ImageSource.x,o=i.ImageSource.y;i.ImageSource.anchorOffsetX=i.ImageSource.width*i.ax,i.ImageSource.anchorOffsetY=i.ImageSource.height*i.ay,i.ImageSource.x=n,i.ImageSource.y=o},n.prototype.setColor=function(e){this.color=e},n.prototype.frameListener=function(e){var t,i=this,n=i.animationRun.frameIndex.length;for(t=0;n>t;++t)i.animationRun.frameIndex[t]==e&&i.animationRun.frameListener[t].call(i.animationRun.frameListenerObj[t],i)},n.prototype.completeListener=function(){var e=this;if(e.animationRun.completeFun){var t=e.animationRun.completeFun,i=e.animationRun.completeFunObj;e.animationRun.completeFun=null,e.animationRun.completeFunObj=null,t.call(i,e)}},n.prototype.addCompleteListener=function(e,t){var i=this;i.animationRun.completeFun=e,i.animationRun.completeFunObj=t},n.prototype.addFrameListener=function(e,t,i){var n,o=this,r=o.animationRun.frameIndex.length;for(n=0;r>n&&o.animationRun.frameIndex[n]!=i;++n);n==r&&(o.animationRun.frameListener.push(e),o.animationRun.frameListenerObj.push(t),o.animationRun.frameIndex.push(i))},n.mLastTime=0,n.mCurrentTime=0,n.mGapTime=0,n._init=!1,n.animationRunData=[],n}(egret.Sprite);e.ImageAnimation=n,__reflect(n.prototype,"codeBase.ImageAnimation",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){}return e.showParticleEffect=function(e,t,i,n,o){var r=new particle.GravityParticleSystem(n,o);return r.start(),r.emitterX=t,r.emitterY=i,e.addChild(r),r},e}();e.ParticleUtil=t,__reflect(t.prototype,"codeBase.ParticleUtil",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){this.dragonBonesTime=0/0}return Object.defineProperty(e,"Instance",{get:function(){return e.inst||(e.inst=new e,e.inst.init()),e.inst},enumerable:!1,configurable:!0}),e.prototype.init=function(){var e=this;e.worldClock=new dragonBones.WorldClock},e.prototype.createMovieClipAnimation=function(e,t,i){var n=new egret.MovieClipDataFactory(e,t),o=new egret.MovieClip(n.generateMovieClipData(i));return o},e.prototype.initDragonBonesData=function(e,t){var i=e+t+"_ske.json",n=e+t+"_tex.json",o=e+t+"_tex.png",r=RES.getRes(i),a=RES.getRes(n),s=RES.getRes(o);dragonBones.EgretFactory.factory.parseDragonBonesData(r,t),dragonBones.EgretFactory.factory.parseTextureAtlasData(a,s,t)},e.prototype.createSkeletonDisplay=function(e,t,i,n){var o=this,r=dragonBones.EgretFactory.factory.getDragonBonesData(t),a=dragonBones.EgretFactory.factory.getTextureAtlasData(t);r&&a||o.initDragonBonesData(e,t);var s=dragonBones.EgretFactory.factory.buildArmatureDisplay(i,n);return s},e.prototype.createSkeletonArmature=function(e,t,i,n){var o=this,r=dragonBones.EgretFactory.factory.getDragonBonesData(t),a=dragonBones.EgretFactory.factory.getTextureAtlasData(t);r&&a||o.initDragonBonesData(e,t);var s=dragonBones.EgretFactory.factory.buildArmature(i,n);return o.worldClock.clock.add(s),o.dragonBonesTime!=o.dragonBonesTime&&(o.dragonBonesTime=egret.getTimer(),egret.startTick(o.onTicker,o)),s},e.prototype.onTicker=function(e){var t=this,i=e,n=i-t.dragonBonesTime;return t.dragonBonesTime=i,t.worldClock.clock.advanceTime(n/1e3),!1},e.prototype.dispose=function(){var e=this;e.dragonBonesTime==e.dragonBonesTime&&(egret.stopTick(e.onTicker,e),e.dragonBonesTime=0/0)},e}();e.SkeletonUtil=t,__reflect(t.prototype,"codeBase.SkeletonUtil",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(){this._straightCost=10,this._diagCost=14,this.avoidSideGrids=!1,this.nowVersion=1,this.openSet=new Array,this.closeSet=new Array,this.TwoOneTwoZero=2*Math.cos(Math.PI/3),this.heuristic=this.euclidian2}return Object.defineProperty(t.prototype,"grid",{get:function(){return this._grid},enumerable:!1,configurable:!0}),t.prototype.floydPath=function(t,i,n){var o=n.concat(),r=o.length,a=0;if(r>2){var s=new e.Node(0,0,1),l=new e.Node(0,0,1);for(this.floydVector(s,o[r-1],o[r-2]),a=r-3;a>=0;a--)this.floydVector(l,o[a+1],o[a]),s.row==l.row&&s.column==l.column?o.splice(a+1,1):(s.row=l.row,s.column=l.column)}if(r=o.length,r>2)for(a=r-3;a>=0;a--)this.hasBarrier(o[a+2],o[a])||o.splice(a+1,1);var h=new Array;for(h.push(t),a=1;a<o.length-1;a++)h.push(o[a].point);return h.push(i),o.length=0,h},t.prototype.hasBarrier=function(e,t){Math.abs(egret.Point.distance(e.point,t.point)),this.grid.cellSize/2;return!1},t.prototype.floydVector=function(e,t,i){e.row=t.row-i.row,e.column=t.column-i.column},t.prototype.justMin=function(e,t){return e.f<t.f},t.prototype.pushOpenSetNode=function(t){this.openSet.push(t),e.BinaryHeap.upAdjust(this.openSet)},t.prototype.popOpenSetNode=function(){if(this.openSet.length>0){var t=this.openSet[0];return this.openSet.length>1?(this.openSet[0]=this.openSet[this.openSet.length-1],e.BinaryHeap.downAdjust(this.openSet,0,this.openSet.length-1)):this.openSet.length=0,t}return null},t.prototype.findPath=function(t){for(this._grid=t,this._startNode=this._grid.startNode,this._endNode=this._grid.endNode,this._startNode.g=0,this.openSet.length=0,this.closeSet.length=0,e.BinaryHeap.setJudgeFunction(this.justMin),this.pushOpenSetNode(this._startNode);this.openSet.length>0;){var i=this.popOpenSetNode();if(this.closeSet.push(i),i==this._endNode)return this.buildPath(),!0;for(var n=t.getNeighbourNodes(i,0),o=void 0,r=0;r<n.length;++r)if(o=n[r],o.walkable&&!(this.closeSet.indexOf(o)>=0)){if(this.avoidSideGrids){if(o.row!=i.row&&o.column<i.column){var a=this.grid.getLeftNode(i),s=this.grid.getUpNode(i),l=this.grid.getDownNode(i);
if(o.row<i.row&&a&&!a.walkable||s&&!s.walkable)continue;if(o.row>i.row&&a&&!a.walkable||l&&!l.walkable)continue}if(o.row!=i.row&&o.column>i.column){var h=this.grid.getLeftNode(i),s=this.grid.getUpNode(i),l=this.grid.getDownNode(i);if(o.row<i.row&&(h&&!h.walkable||s&&!s.walkable))continue;if(o.row>i.row&&(h&&!h.walkable||l&&!l.walkable))continue}}var c=i.g+this.getDistanceNodes2(i,o),d=this.openSet.indexOf(o);(c<o.g||0>d)&&(o.g=c,o.h=this.manhattan2(o),o.f=o.g+o.h,o.parent=i,0>d&&this.pushOpenSetNode(o))}}return!1},t.prototype.getDistanceNodes=function(e,t){var i=Math.abs(e.point.x-t.point.x),n=Math.abs(e.point.y-t.point.y);return Math.sqrt(i*i+n*n)},t.prototype.getDistanceNodes2=function(e,t){var i=Math.abs(e.row-t.row),n=Math.abs(e.column-t.column);return i>n?this._diagCost*n+this._straightCost*(i-n):this._diagCost*i+this._straightCost*(n-i)},t.prototype.buildPath=function(){this.path=new Array;var e=this._endNode;for(this.path.push(e);e!=this._startNode;)e=e.parent,this.path.unshift(e)},t.prototype.manhattan=function(e){return Math.abs(e.point.x-this._endNode.point.x)+Math.abs(e.point.y-this._endNode.point.y)},t.prototype.manhattan2=function(e){var t=Math.abs(e.row-this._endNode.row),i=Math.abs(e.column-this._endNode.column);return(t+i)*this._straightCost},t.prototype.euclidian=function(e){var t=e.point.x-this._endNode.point.x,i=e.point.y-this._endNode.point.y;return Math.sqrt(t*t+i*i)},t.prototype.euclidian2=function(e){var t=e.row-this._endNode.row,i=e.column-this._endNode.column;return Math.sqrt(t*t+i*i)*this._straightCost},t.prototype.diagonal=function(e){var t=Math.abs(e.point.x-this._endNode.point.x),i=Math.abs(e.point.y-this._endNode.point.y),n=Math.min(t,i),o=t+i;return this._diagCost*n+this._straightCost*(o-2*n)},t.prototype.chineseCheckersEuclidian2=function(e){var t=e.column/this.TwoOneTwoZero,i=e.row+e.column/2,n=i-this._endNode.row-this._endNode.column/2,o=t-this._endNode.column/this.TwoOneTwoZero;return this.sqrt(n*n+o*o)},t.prototype.sqrt=function(e){return Math.sqrt(e)},t}();e.AStar=t,__reflect(t.prototype,"codeBase.AStar",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(e){void 0===e&&(e=null),this.a=new Array,this.justMinFun=function(e,t){return this.x<this.y},this.a.push(-1),null!=e&&(this.justMinFun=e)}return e.prototype.ins=function(e){var t=this.a.length;this.a[t]=e;for(var i=t>>1;t>1&&this.justMinFun(this.a[t],this.a[i]);){var n=this.a[t];this.a[t]=this.a[i],this.a[i]=n,t=i,i=t>>1}},e.prototype.pop=function(){var e=this.a[1];this.a[1]=this.a[this.a.length-1],this.a.pop();for(var t=1,i=this.a.length,n=t<<1,o=n+1;i>n;){if(i>o)var r=this.justMinFun(this.a[o],this.a[n])?o:n;else r=n;if(!this.justMinFun(this.a[r],this.a[t]))break;var a=this.a[t];this.a[t]=this.a[r],this.a[r]=a,t=r,n=t<<1,o=n+1}return e},e.setJudgeFunction=function(t){null!=t&&(e.judgeFun=t)},e.upAdjust=function(t){void 0===t&&(t=[]);for(var i=t.length-1,n=Math.floor((i-1)/2),o=t[i];i>0&&e.judgeFun(o,t[n]);)t[i]=t[n],i=n,n=Math.floor((i-1)/2);t[i]=o},e.downAdjust=function(t,i,n){for(var o=t[i],r=2*i+1;n>r&&(n>r+1&&e.judgeFun(t[r+1],t[r])&&r++,!e.judgeFun(o,t[r]));)t[i]=t[r],i=r,r=2*r+1;t[i]=o},e.buildHeap=function(e){void 0===e&&(e=[]);for(var t=this,i=Math.floor(e.length/2);i>=0;i--)t.downAdjust(e,i,e.length-1)},e}();e.BinaryHeap=t,__reflect(t.prototype,"codeBase.BinaryHeap",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(t,i){void 0===i&&(i=0),this._startNode=null,this._endNode=null,this._nodes=null,this._numRows=0,this._numCols=0,this._cellSize=20,this.type=0,this._numRows=t.length,this._numCols=t[0].length,this._cellSize=i,this._nodes=new Array;for(var n=0;n<this._numRows;n++){this._nodes[n]=new Array;for(var o=0;o<this._numCols;o++){var r=1==t[n][o].type?0:1;this._nodes[n][o]=new e.Node(n,o,r),this._nodes[n][o].point.x=o*this._cellSize+this._cellSize/2,this._nodes[n][o].point.y=n*this._cellSize+this._cellSize/2}}}return Object.defineProperty(t.prototype,"cellSize",{get:function(){return this._cellSize},enumerable:!1,configurable:!0}),t.prototype.getNeighbourNodes=function(e,t){void 0===t&&(t=0);var i,n,o=[];if(0==t)for(var r=-1;1>=r;++r)for(var a=-1;1>=a;++a)(0!=r||0!=a)&&(i=e.row+r,n=e.column+a,i>=0&&i<this._numRows&&n>=0&&n<this._numCols&&o.push(this._nodes[i][n]));else 1==t&&(i=e.row-1,n=e.column,i>=0&&i<this._numRows&&n>=0&&n<this._numCols&&o.push(this._nodes[i][n]),i=e.row+1,n=e.column,i>=0&&i<this._numRows&&n>=0&&n<this._numCols&&o.push(this._nodes[i][n]),i=e.row,n=e.column-1,i>=0&&i<this._numRows&&n>=0&&n<this._numCols&&o.push(this._nodes[i][n]),i=e.row,n=e.column+1,i>=0&&i<this._numRows&&n>=0&&n<this._numCols&&o.push(this._nodes[i][n]));return o},t.prototype.getType=function(){return this.type},t.prototype.getNodeByPoint=function(e){var t=Math.floor(e.y/this.cellSize),i=Math.floor(e.x/this.cellSize);return t=Math.min(t,this.numRows-1),t=Math.max(t,0),i=Math.min(i,this.numCols-1),i=Math.max(i,0),this.getNode(t,i)},t.prototype.getNode=function(e,t){return this._nodes[e][t]},t.prototype.getLeftNode=function(e){return e.column-1>=0?this._nodes[e.row][e.column-1]:null},t.prototype.getRightNode=function(e){return e.column+1<this._numCols?this._nodes[e.row][e.column+1]:null},t.prototype.getUpNode=function(e){return e.row-1>=0?this._nodes[e.row-1][e.column]:null},t.prototype.getDownNode=function(e){return e.row+1<this._numRows?this._nodes[e.row+1][e.column]:null},t.prototype.setEndNode=function(e,t){this._endNode=this._nodes[e][t]},t.prototype.setStartNode=function(e,t){this._startNode=this._nodes[e][t]},t.prototype.setWalkable=function(e,t,i){this._nodes[e][t].walkable=i},Object.defineProperty(t.prototype,"endNode",{get:function(){return this._endNode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"numCols",{get:function(){return this._numCols},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"numRows",{get:function(){return this._numRows},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"startNode",{get:function(){return this._startNode},enumerable:!1,configurable:!0}),t}();e.Grid=t,__reflect(t.prototype,"codeBase.Grid",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(e,t){this.node=null,this.cost=0,this.node=e,this.cost=t}return e}();e.Link=t,__reflect(t.prototype,"codeBase.Link",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(e,t,i){void 0===i&&(i=0),this.row=0,this.column=0,this.f=0,this.g=0,this.h=0,this.walkable=!0,this.alpha=1,this.data=0,this.parent=null,this.version=1,this.point=null,this.row=e,this.column=t,this.data=i,0==this.data?this.walkable=!1:this.walkable=!0,this.point=new egret.Point}return e}();e.Node=t,__reflect(t.prototype,"codeBase.Node",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){}return e.bezierMove=function(e,t,i,n,o,r,a,s){void 0===o&&(o=1e3),void 0===r&&(r=null),void 0===a&&(a=null),void 0===s&&(s=null),e.factor||(e.factor=0),e.factor=0,e.x=t.x,e.y=t.y,egret.Tween.get(e,{onChange:function(){var o=e.factor;e.x=(1-o)*(1-o)*t.x+2*o*(1-o)*i.x+o*o*n.x,e.y=(1-o)*(1-o)*t.y+2*o*(1-o)*i.y+o*o*n.y},onChangeObj:e}).to({factor:1},o,r).call(function(){a&&s&&a.call(s,[e])},this)},e}();e.BezierUtil=t,__reflect(t.prototype,"codeBase.BezierUtil",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(e){function t(t,i){var n=e.call(this)||this;n.animateTime=600,n._positive=!0;var o=n;o.texture=t,o.posSide=t,o.negSide=i,o.touchEnabled=!0,o.addEventListener(egret.TouchEvent.TOUCH_TAP,o.onTouch,o);var r="\n            attribute vec2 aVertexPosition;\n            attribute vec2 aTextureCoord;\n            attribute vec2 aColor;\n\n            uniform vec2 projectionVector;\n\n            varying vec2 vTextureCoord;\n            varying vec4 vColor;\n\n            const vec2 center = vec2(-1.0, 1.0);\n\n            void main(void) {\n                gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\n                vTextureCoord = aTextureCoord;\n                vColor = vec4(aColor.x, aColor.x, aColor.x, aColor.x);\n            }\n        ",a="\n            precision lowp float;\n            varying vec2 vTextureCoord;\n            varying vec4 vColor;\n            uniform sampler2D uSampler;\n\n            uniform float time;\n            uniform float duration;\n            uniform float max;\n\n            void main() {\n                vec2 uv = vTextureCoord.xy;\n                vec2 texCoord = uv;\n                float scale = max;\n                float angle = time / duration * 3.1416;\n                float scaletime = duration * 0.2;\n\n                if(time < scaletime) scale = time / scaletime * (max - 1.0) + 1.0;\n                if(time > duration - scaletime) scale = (duration - time) / scaletime * (max - 1.0) + 1.0;\n\n                if(time > duration / 2.0) angle = (duration - time) / duration * 3.1416;\n                float direct = 1.0;\n                if(time > duration / 2.0) direct = -1.0;\n                texCoord.y = uv.y + (uv.y - 0.5) * sin(angle) * 0.5 * (uv.x - 0.5) * direct;\n                \n                if(uv.x > 0.5) texCoord.x = (uv.x - 0.5) / cos(angle) + 0.5;\n                else texCoord.x = 0.5 - (0.5 - uv.x) / cos(angle);\n\n                texCoord.x = (texCoord.x - 0.5) / scale + 0.5;\n                texCoord.y = (texCoord.y - 0.5) / scale + 0.5;\n\n                gl_FragColor = texture2D(uSampler, texCoord);\n            }\n        ";return o.customFilter=new egret.CustomFilter(r,a,{time:0,duration:o.animateTime,max:1.1}),o.customFilter.padding=.3*o.width,o.filters=[],n}return __extends(t,e),Object.defineProperty(t.prototype,"positive",{set:function(e){var t=this;t._positive=e,t.texture=e?t.posSide:t.negSide},enumerable:!1,configurable:!0}),t.prototype.onTouch=function(e){var t=this;t.touchEnabled=!1,t.startTime=Date.now(),t.startFace=t._positive,t.addEventListener(egret.Event.ENTER_FRAME,t.update,t),t.filters=[t.customFilter]},t.prototype.update=function(){var e=this,t=Date.now()-e.startTime;return t>e.animateTime?(e.removeEventListener(egret.Event.ENTER_FRAME,e.update,e),e.filters=[],e.touchEnabled=!0,!1):(t>e.animateTime/2&&e._positive==e.startFace&&(e.positive=!e.startFace),void(e.customFilter.uniforms.time=t))},t}(egret.Bitmap);e.FlippingCard=t,__reflect(t.prototype,"codeBase.FlippingCard",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){this.targetIndexList=[],this.rabbitStatus=[]}return Object.defineProperty(e,"Instance",{get:function(){return null==e._instance&&(e._instance=new e),e._instance},enumerable:!1,configurable:!0}),e}();e.GameData=t,__reflect(t.prototype,"codeBase.GameData",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.prototype.addEventListener=function(t,i,n,o,r){void 0===o&&(o=!1),void 0===r&&(r=1),e.prototype.addEventListener.call(this,t,i,n,o,r)},t.prototype.removeEventListener=function(t,i,n,o){void 0===o&&(o=!1),e.prototype.removeEventListener.call(this,t,i,n,o)},t.prototype.hasEventListener=function(t){return e.prototype.hasEventListener.call(this,t)},t.prototype.once=function(t,i,n,o){void 0===o&&(o=!1),e.prototype.once.call(this,t,i,n,o)},t.prototype.dispatchEvent=function(t){var i=egret.getTimer(),n=e.prototype.dispatchEvent.call(this,t);egret.getTimer()-i;return n},t.prototype.willTrigger=function(t){return e.prototype.willTrigger.call(this,t)},t}(egret.EventDispatcher);e.GameDispatcher=t,__reflect(t.prototype,"codeBase.GameDispatcher",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(e){function t(t){void 0===t&&(t=!1);var i=e.call(this)||this;return i.size=100,i.rect=new egret.Rectangle,i.touchEnabled=t,i}return __extends(t,e),t.prototype.show=function(e,t,i,n){var o=this;o.eraseImageTexture=n,o.x=t,o.y=i,e.addChild(o),o.onAddedToStage(null)},t.prototype.onAddedToStage=function(e){var t=this;t.eraseImg=new egret.Bitmap(t.eraseImageTexture),t.addChild(t.eraseImg),t.width=t.eraseImg.width,t.height=t.eraseImg.height,t.eraserSp=new egret.Sprite,t.addChild(t.eraserSp),t.eraserSp.visible=!1,t.renderTexture=new egret.RenderTexture,t._bitmapMask=new egret.Bitmap,t._bitmapMask.blendMode=egret.BlendMode.ERASE,t._reverseMask=new egret.Sprite,t._reverseMask.graphics.beginFill(0,1),t._reverseMask.graphics.drawRect(0,0,t.width,t.height),t._reverseMask.graphics.endFill(),t._reverseMask.addChild(t._bitmapMask),t.renderTex=new egret.RenderTexture,t.reverseMask=new egret.Bitmap,t.addChild(t.reverseMask),t.touchEnabled&&(t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onTapBegin,t),t.addEventListener(egret.TouchEvent.TOUCH_END,t.onTapEnd,t))},t.prototype.controlStart=function(e,t){var i=this;i.startPoint=i.eraserSp.globalToLocal(e,t),i.clamErasePoint(),i.eraserSp.graphics.lineStyle(i.size,0),i.eraserSp.graphics.moveTo(i.startPoint.x,i.startPoint.y),i.eraserSp.graphics.lineTo(i.startPoint.x,i.startPoint.y),i.createReverseMask2()},t.prototype.controlMove=function(e,t){var i=this;return i.startPoint?(i.movePoint=i.eraserSp.globalToLocal(e,t),i.clamErasePoint(),void(i.movePoint.x>i.eraseImg.x+i.eraseImg.width||i.movePoint.x<i.eraseImg.x||i.movePoint.y>i.eraseImg.y+i.eraseImg.height||i.movePoint.y<i.eraseImg.y||(i.eraserSp.graphics.lineTo(i.movePoint.x,i.movePoint.y),i.createReverseMask2()))):void i.controlStart(e,t)},t.prototype.onTapBegin=function(e){var t=this;t.controlStart(e.stageX,e.stageY),t.hasEventListener(egret.TouchEvent.TOUCH_MOVE)||t.addEventListener(egret.TouchEvent.TOUCH_MOVE,t.mouseMove,t)},t.prototype.mouseMove=function(e){var t=this;t.controlMove(e.stageX,e.stageY)},t.prototype.onTapEnd=function(e){this.hasEventListener(egret.TouchEvent.TOUCH_MOVE)&&this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this)},t.prototype.clamErasePoint=function(){var e=this;e.startPoint&&(e.startPoint.x>e.width-e.size/2&&(e.startPoint.x=e.width-e.size/2),e.startPoint.x<e.size/2&&(e.startPoint.x=e.size/2),e.startPoint.y>e.height-e.size/2&&(e.startPoint.y=e.height-e.size/2),e.startPoint.y<e.size/2&&(e.startPoint.y=e.size/2)),e.movePoint&&(e.movePoint.x>e.width-e.size/2&&(e.movePoint.x=e.width-e.size/2),e.movePoint.x<e.size/2&&(e.movePoint.x=e.size/2),e.movePoint.y>e.height-e.size/2&&(e.movePoint.y=e.height-e.size/2),e.movePoint.y<e.size/2&&(e.movePoint.y=e.size/2))},t.prototype.createReverseMask2=function(){var e=this;e.rect.setTo(0,0,e.width,e.height),e.renderTexture.drawToTexture(e.eraserSp,e.rect),e._bitmapMask.texture=e.renderTexture,e.renderTex.drawToTexture(e._reverseMask),e.reverseMask.texture=e.renderTex,e.mask||(e.mask=e.reverseMask)},t}(egret.DisplayObjectContainer);e.MaskEraser=t,__reflect(t.prototype,"codeBase.MaskEraser",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){}return e.getByClass=function(t,i,n){void 0===i&&(i=""),void 0===n&&(n=!0);var o=egret.getQualifiedClassName(t);o=i+o;var r=e.getObject(o,n);return null==r&&(r=new t),n||e.recycleClass(r,i),r},e.recycleClass=function(t,i){if(void 0===i&&(i=""),t){var n=egret.getQualifiedClassName(t);n=i+n,e.recycleObject(n,t)}},e.hasClass=function(t,i){return void 0===i&&(i=""),e.getByClass(t,i,!1)},e.getObject=function(t,i){if(void 0===i&&(i=!0),e._dataPool.hasOwnProperty(t)&&e._dataPool[t].length>0){var n=null;return i?(n=e._dataPool[t].pop(),0==e._dataPool[t].length&&delete e._dataPool[t]):n=e._dataPool[t][0],n}return null},e.setObject=function(t,i){e.recycleObject(t,i)},e.recycleObject=function(t,i){i&&(e._dataPool.hasOwnProperty(t)||(e._dataPool[t]=[]),i.hasOwnProperty("destroy")&&i.destroy(),e._dataPool[t].indexOf(i)<0&&e._dataPool[t].push(i))},e.hasObject=function(t){return e.getObject(t,!1)},e.dispose=function(t){var i=egret.getQualifiedClassName(t);e.disposeObjects(i)},e.disposeObjects=function(t){e._dataPool.hasOwnProperty(t)&&(e._dataPool[t].length=0,delete e._dataPool[t])},e._dataPool={},e}();e.ObjectPool=t,__reflect(t.prototype,"codeBase.ObjectPool",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(e,t,i,n,o,r){void 0===t&&(t=1e3),this.curNumber=0,this.gridGroup=new egret.Sprite,this.switchTime=1e3;var a=this;a.switchType=e||5,a.txNumber=o||20,a.XNumber=r||5,a.callFun=i,a.funObj=n,a.switchTime=t,a.switchScreen()}return e.prototype.switchScreen=function(){var e=this,t=egret.MainContext.instance.stage,i=t.stageWidth,n=t.stageHeight;e.gridGroup.width=i,e.gridGroup.height=n,e.gridGroup.touchEnabled=!1,e.gridGroup.touchChildren=!1,t.addChild(e.gridGroup);for(var o=e.txNumber/e.XNumber,r=0;r<e.txNumber;r++){var a=i/e.XNumber,s=n/o,l=r%e.XNumber*a,h=Math.floor(r/e.XNumber)*s,c=new egret.RenderTexture,d=(c.drawToTexture(t,new egret.Rectangle(l,h,a,s)),new egret.Bitmap);d.texture=c,d.anchorOffsetX=a/2,d.anchorOffsetY=s/2,d.x=l+a/2,d.y=h+s/2,e.gridGroup.addChild(d),d.touchEnabled=!1,5==e.switchType&&(e.switchType=Math.ceil(4*Math.random()));var u=egret.Tween.get(d);switch(e.switchType){case 1:u.to({scaleX:0,scaleY:0,alpha:0,rotation:359},e.switchTime,egret.Ease.circIn).call(e.onComplete,e);break;case 2:var p=t.stageWidth,f=-p;r%2||(f=2*p),u.to({x:f,alpha:0},e.switchTime,egret.Ease.circIn).call(e.onComplete,e);break;case 3:var g=t.stageHeight,_=-g;r%2||(_=2*g),u.to({y:_,alpha:0},e.switchTime,egret.Ease.circIn).call(e.onComplete,e);break;case 4:u.to({scaleX:.2,scaleY:1,alpha:0,blurFliter:0},e.switchTime,egret.Ease.backInOut).call(e.onComplete,e);break;default:u.to({scaleX:1,scaleY:0,alpha:0},e.switchTime,egret.Ease.circIn).call(e.onComplete,e)}}},e.prototype.onComplete=function(){var e=this;e.curNumber+=1,e.curNumber==e.txNumber&&(egret.MainContext.instance.stage.removeChild(e.gridGroup),e.callFun&&e.funObj&&e.callFun.call(e.funObj))},e}();e.ScreenSwitch=t,__reflect(t.prototype,"codeBase.ScreenSwitch",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.dataEvent=new Object,e.init(),e}return __extends(i,t),i.prototype.init=function(){},i.prototype.initData=function(){},i.prototype.createChildren=function(){},i.prototype.dispEvent=function(t,i,n){if(void 0===i&&(i=null),void 0===n&&(n=null),this.dataEvent){var o=this.dataEvent[t];if(null!=o){var r=new e.LayoutEvent;r.currentTarget=this,r.data=i,r.type=t,r.dataType=n,o["this"]?o.apply(o["this"],[r]):o(r)}}},i.prototype.addEvent=function(e,t,i){void 0===i&&(i=null);var n=this;n.dataEvent&&null==n.dataEvent[e]&&(t["this"]=i,n.dataEvent[e]=t)},i.prototype.removeEvent=function(e,t){var i=this;i.dataEvent&&i.dataEvent[e]&&delete i.dataEvent[e]},i.prototype.removeFromParent=function(e){void 0===e&&(e=!1);var t=this,i=this.parent;e&&t.dispose(),i&&i.contains(t)&&i.removeChild(t),i=null},i.prototype.removeChildAll=function(e){for(void 0===e&&(e=!1);this.numChildren>0;)this.removeChildIndex(0,e)},i.prototype.removeChildIndex=function(e,t){var n=this;if(e>=0||e<n.numChildren){var o=n.getChildAt(e);if(o instanceof i)o.removeFromParent(t);else{var r=this.getChildAt(e);r.parent&&r.parent.removeChild(r)}}},i.prototype.dispose=function(){var e=this;e.removeChildAll(!0),e.dataEvent=null},i}(e.BaseGroup);e.BasicLayout=t,__reflect(t.prototype,"codeBase.BasicLayout",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(egret.TextField);e.TextField=t,__reflect(t.prototype,"codeBase.TextField",[]);var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(egret.Sprite);e.Sprite=i,__reflect(i.prototype,"codeBase.Sprite",[]);var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(egret.Shape);e.Shape=n,__reflect(n.prototype,"codeBase.Shape",[]);var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(egret.DisplayObject);e.DisplayObject=o,__reflect(o.prototype,"codeBase.DisplayObject",[]);var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(egret.DisplayObjectContainer);e.DisplayObjectContainer=r,__reflect(r.prototype,"codeBase.DisplayObjectContainer",[]);var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(egret.Point);e.Point=a,__reflect(a.prototype,"codeBase.Point",[]);var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(egret.Rectangle);e.Rectangle=s,__reflect(s.prototype,"codeBase.Rectangle",[]);var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(egret.Bitmap);e.Bitmap=l,__reflect(l.prototype,"codeBase.Bitmap",[]);var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(egret.BitmapData);e.BitmapData=h,__reflect(h.prototype,"codeBase.BitmapData",[]);var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(egret.Stage);e.Stage=c,__reflect(c.prototype,"codeBase.Stage",[]);var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(egret.Tween);e.Tween=d,__reflect(d.prototype,"codeBase.Tween",[]);var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(egret.Ease);e.Ease=u,__reflect(u.prototype,"codeBase.Ease",[]);var p=function(e){function t(t,i,n){void 0===t&&(t=""),void 0===i&&(i=null),void 0===n&&(n=null);var o=e.call(this)||this;return o.type=t,o.data=i,o.currentTarget=n,o}return __extends(t,e),t.MOUSE_OVER="event-over",t.MOUSE_OUT="event-out",t.MOUSE_DOWN="event-down",t.MOUSE_MOVE="event-move",t.MOUSE_UP="event-up",t.CLICK="event-click",t.CHANGE="change",t.COMPLETE="complete",t.ERROR="error",t.RENDER_COMPLETE="render complete",t.UPDATE="update",t.START="start",t.MOVE="move",t.OVER="over",t.PAUSE="pause",t.STOP="stop",t.PLAY="play",t.OPEN="open",t.CLOSE="close",t}(egret.EventDispatcher);e.LayoutEvent=p,__reflect(p.prototype,"codeBase.LayoutEvent",[]);var f=function(){function e(){}return e.fontName="",e}();e.FONT=f,__reflect(f.prototype,"codeBase.FONT",[]);var g=function(){function e(){}return e.SHAPE_RECT="shape rect",e.SHAPE_RECT_ROUND="shape rect round",e.SHAPE_CIRCLE="shape circle",e.VER_DEBUG="debug",e.VER_RELEASE="release",e}();e.LayoutConst=g,__reflect(g.prototype,"codeBase.LayoutConst",[]);var _=function(){function e(){}return Object.defineProperty(e,"random",{get:function(){return 16777215*Math.random()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"white",{get:function(){return 16777215},enumerable:!1,configurable:!0}),Object.defineProperty(e,"black",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e,"gray",{get:function(){return 6710886},enumerable:!1,configurable:!0}),Object.defineProperty(e,"red",{get:function(){return 16711680},enumerable:!1,configurable:!0}),Object.defineProperty(e,"green",{get:function(){return 65280},enumerable:!1,configurable:!0}),Object.defineProperty(e,"bule",{get:function(){return 255},enumerable:!1,configurable:!0}),Object.defineProperty(e,"skinNormal",{get:function(){return 1382684},enumerable:!1,configurable:!0}),Object.defineProperty(e,"skinDown",{get:function(){return 10066329},enumerable:!1,configurable:!0}),Object.defineProperty(e,"titleBackground",{get:function(){return 2106923},enumerable:!1,configurable:!0}),e.getRandomArray=function(e){for(var t=[],i=0;e>i;i++)t.push(16777215*Math.random());return t},e.lightenDarkenColor=function(e,t){var i=(e>>16)+t;i>255?i=255:0>i&&(i=0);var n=(e>>8&255)+t;n>255?n=255:0>n&&(n=0);var o=(255&e)+t;return o>255?o=255:0>o&&(o=0),o|n<<8|i<<16},e}();e.Color=_,__reflect(_.prototype,"codeBase.Color",[]);var v=function(){function e(){}return Object.defineProperty(e,"randomRect",{get:function(){return m.getRect(60,60,_.random)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"randomCircle",{get:function(){return m.getCircle(50,_.random)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"switchOff",{get:function(){return m.getSwitch(_.skinNormal,_.white)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"switchOn",{get:function(){return m.getSwitch(_.skinNormal,_.white,1)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"progressBackground",{get:function(){return m.getRect(300,20,_.skinNormal)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"progressValue",{get:function(){return m.getRect(300,20,_.skinDown)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"sliderBackground",{get:function(){return m.getRect(300,10,_.skinNormal)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"sliderValue",{get:function(){return m.getRect(300,10,_.skinDown)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"sliderBar",{get:function(){return m.getCircle(15,_.white)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"scrollBar",{get:function(){return m.getRect(10,10,_.skinNormal)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"pnBarPrevNormal",{get:function(){return m.getPolygon(3,20,_.skinNormal,180)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"pnBarPrevDown",{get:function(){return m.getPolygon(3,20,_.skinDown,180)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"pnBarNextNormal",{get:function(){return m.getPolygon(3,20,_.skinNormal)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"pnBarNextDown",{get:function(){return m.getPolygon(3,20,_.skinDown)},enumerable:!1,configurable:!0}),e}();e.Skin=v,__reflect(v.prototype,"codeBase.Skin",[]);var y=function(){function e(){}return e.displayRank=function(e,t,i,n,o,r,a){void 0===t&&(t=1),void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=0),void 0===a&&(a=1);for(var s,l=0;l<e.length;l++)s=e[l],s.x=o+Math.floor(l%t)*(s.width+i)*a,s.y=r+Math.floor(l/t)*(s.height+n)*a},e}();e.SimpleLayout=y,__reflect(y.prototype,"codeBase.SimpleLayout",[]);var m=function(){function e(){}return e.getLineRect=function(e,t,n,o,r,a){void 0===n&&(n=0),void 0===o&&(o=1),void 0===r&&(r=0),void 0===a&&(a=0);var s=new i;return s.graphics.lineStyle(o,n),s.graphics.drawRect(r,a,e,t),s.graphics.endFill(),s},e.getLineCircle=function(e,t,n,o,r){void 0===t&&(t=0),void 0===n&&(n=1),void 0===o&&(o=0),void 0===r&&(r=0);var a=new i;return a.graphics.lineStyle(n,t),a.graphics.drawCircle(o,r,e),a.graphics.endFill(),a},e.getMatrixRect=function(e,t,n,o,r){void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=0);var a=new i,s=new egret.Matrix;return s.createGradientBox(e,t,Math.PI*r,0,0),a.graphics.beginGradientFill(egret.GradientType.LINEAR,[n,o],[1,1],[0,255],s),a.graphics.drawRect(0,0,e,t),a.graphics.endFill(),a},e.getRect=function(e,t,n,o,r){void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=0);var a=new i;return a.graphics.beginFill(n),a.graphics.drawRect(o,r,e,t),a.graphics.endFill(),a},e.getRectAndX=function(e,t,i,n,o){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=0);var r=this.getRect(e,t,i,n,o);return r.addChild(this.getX(e,t,i,1,n,o)),r},e.getX=function(e,t,n,o,r,a){void 0===n&&(n=0),void 0===o&&(o=1),void 0===r&&(r=0),void 0===a&&(a=0);var s=new i,l=new i;l.graphics.lineStyle(o,n),l.graphics.moveTo(0,0),l.graphics.lineTo(e,t);var h=new i;return h.graphics.lineStyle(o,n),h.graphics.moveTo(e,0),h.graphics.lineTo(0,t),s.addChild(l),s.addChild(h),s},e.getRoundRect=function(e,t,n,o,r,a,s){void 0===n&&(n=0),void 0===o&&(o=5),void 0===r&&(r=5),void 0===a&&(a=0),void 0===s&&(s=0);var l=new i;return l.graphics.beginFill(n),l.graphics.drawRoundRect(a,s,e,t,o,r),l.graphics.endFill(),l},e.getCircle=function(e,t,n,o){void 0===t&&(t=0),void 0===n&&(n=0),void 0===o&&(o=0);var r=new i;return r.graphics.beginFill(t),r.graphics.drawCircle(n,o,e),r.graphics.endFill(),r},e.getPolygon=function(e,t,n,o){void 0===e&&(e=3),void 0===t&&(t=10),void 0===n&&(n=0),void 0===o&&(o=0);var r=new i;r.rotation=o,r.graphics.beginFill(n);for(var a=0;e>=a;a++){var s=Math.cos(a*(360/e)*Math.PI/180)*t,l=Math.sin(a*(360/e)*Math.PI/180)*t;0==a?r.graphics.moveTo(s,l):r.graphics.lineTo(s,l)}return r.graphics.endFill(),r},e.getArrowRoundRect=function(e,t,n,o,r){void 0===o&&(o=0),void 0===r&&(r=0);var a=new i;a.addChild(this.getRoundRect(e,t,n));var s=this.getPolygon(3,e/3,o,30+r);return s.x=a.width>>1,s.y=a.height>>1,a.addChild(s),a},e.getScrollLineBar=function(e,t,n){for(var o=new i,r=t/3,a=0;3>a;a++){var s=this.getRect(e,1,n,0,a*r);o.addChild(s)}return o},e.getAddRoundRect=function(e,t,n){var o=new i;o.addChild(this.getRoundRect(e,t,n));var r=this.getRect(e/2,2,0,e/4,t/2-1),a=this.getRect(2,t/2,0,e/2-1,t/4);return o.addChild(r),o.addChild(a),o},e.getRemoveRoundRect=function(e,t,n){var o=new i;o.addChild(this.getRoundRect(e,t,n));var r=this.getRect(e/2,2,0,e/4,t/2-1);return o.addChild(r),o},e.getRoundRectText=function(e,n,o,r){void 0===r&&(r="click");var a=new i;a.addChild(this.getRoundRect(e,n,o));var s=new t;return s.name="text",s.text=r,s.x=a.width-s.width>>1,s.y=a.height-s.height>>1,a.addChild(s),a},e.getSwitch=function(t,i,n){void 0===t&&(t=16777215),void 0===i&&(i=0),void 0===n&&(n=0);var o=e.getRoundRect(80,50,t,60,60);return o.addChild(e.getCircle(22,i,0==n?25:55,25)),o},e.getGridding=function(e,t){void 0===t&&(t=0);var n=new i;n.graphics.lineStyle(.1,t);for(var o=e.width/e.x,r=e.height/e.y,a=0;a<e.x;a++)n.graphics.moveTo(0,a*r),n.graphics.lineTo(e.width,a*r);for(a=0;a<e.y;a++)n.graphics.moveTo(a*o,0),n.graphics.lineTo(a*o,e.height);return n},e.getHeart=function(e,t){void 0===e&&(e=15),void 0===t&&(t=16711680);var n=new i;return n.graphics.beginFill(t),n.graphics.moveTo(0,0),n.graphics.lineTo(0,2*-e),n.graphics.cubicCurveTo(e,2.5*-e,2*e,1.5*-e,0,0),n.graphics.moveTo(0,0),n.graphics.lineTo(0,2*-e),n.graphics.cubicCurveTo(-e,2.5*-e,2*-e,1.5*-e,0,0),n.graphics.endFill(),n.anchorOffsetX=-n.width/2,n.anchorOffsetY=-n.height,n},e}();e.LayoutUI=m,__reflect(m.prototype,"codeBase.LayoutUI",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function i(i,n,o,r,a){void 0===o&&(o=e.Style.VERTICAL),void 0===r&&(r=10),void 0===a&&(a=[]);var s=t.call(this)||this;s.itemInterval=0,s.items=[];var l=s;return l.alignType=o,l.itemInterval=r,l.contentView=new e.BaseGroup,l.scrollBar=new e.Scroller(i,n,l.contentView,o),l.addChild(l.scrollBar),l.width=i,l.height=n,l.initItem(a),s}return __extends(i,t),i.prototype.initItem=function(e){var t=this;e.forEach(function(e){t.addItem(e)}),t.layout(t.alignType,t.itemInterval)},i.prototype.addItem=function(e){var t=this;t.contentView.addChild(e),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onTouch,t),e.addEventListener(egret.TouchEvent.TOUCH_END,t.onTouch,t),t.items.push(e)},i.prototype.removeItem=function(t){var i=this;i.contentView.contains(t)&&(i.contentView.removeChild(t),t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,i.onTouch,i),t.removeEventListener(egret.TouchEvent.TOUCH_END,i.onTouch,i),t instanceof e.BasicLayout&&t.dispose&&t.dispose instanceof Function&&t.dispose(),i.layout(i.alignType,i.itemInterval))},i.prototype.layout=function(t,i){var n=this;t==e.Style.VERTICAL?n.items.forEach(function(e,t){e.x=0,e.y=0+t*(e.height+i)}):t==e.Style.HORIZONTAL&&n.items.forEach(function(e,t){e.x=0+t*(e.width+i),e.y=0})},i.prototype.renderList=function(e,t,i){void 0===t&&(t=[]),void 0===i&&(i=!0);var n=this;if(e&&t){n.clear(),n.executeSelected=i,n.itemRenderer=e,n.dataProvider=t.concat();for(var o=0;o<t.length;++o){var r=new e;
r.data=t[o],r.dataIndex=o,r.list=n,r.validateNow(),n.addItem(r)}n.layout(n.alignType,n.itemInterval)}},i.prototype.setItemList=function(e){void 0===e&&(e=[]);var t=this;t.clear(),t.initItem(e)},i.prototype.clear=function(){var e=this;e.itemRenderer=null,e.dataProvider&&e.dataProvider instanceof Array&&(e.dataProvider.length=0,e.dataProvider=null),e.items.forEach(function(t){e.removeItem(t)}),e.items.length=0},i.prototype.setMouseWheelEnable=function(e){var t=this;t.scrollBar.setMouseWheelEnable(e)},i.prototype.twoDistance=function(e,t){var i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)},i.prototype.onTouch=function(t){var i=this;if(t.type==egret.TouchEvent.TOUCH_BEGIN)i.posStart=new e.Point(t.stageX,t.stageY);else{var n=new e.Point(t.stageX,t.stageY);i.posStart&&i.twoDistance(i.posStart,n)<20&&i.onClick(t.currentTarget),i.posStart=null}},i.prototype.onClick=function(t){var i=this;i.itemRenderer?(i.itemSelected&&i.executeSelected&&i.itemSelected.setSelected(!1),i.itemSelected=t,i.itemSelected.setSelected(!0)):i.itemSelected=t;var n={item:t,index:i.items.indexOf(t)};i.dispEvent(e.LayoutEvent.CLICK,n)},i}(e.BasicLayout);e.ListGroup=t,__reflect(t.prototype,"codeBase.ListGroup",["ILayout"])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function i(i,n){void 0===i&&(i=null),void 0===n&&(n=null);var o=t.call(this)||this;return o._value=0,o.setSkin(i,n),o.addChild(o.skinBg),o.addChild(o.skinValue),o.text=new e.Label,o.addChild(o.text),o}return __extends(i,t),i.prototype.setSkin=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null),this.skinBg=t||e.Skin.progressBackground,this.skinValue=i||e.Skin.progressValue},Object.defineProperty(i.prototype,"value",{get:function(){return this._value},set:function(e){e=0>e?0:e>1?1:e,this._value=e,this.skinValue.scaleX=e},enumerable:!1,configurable:!0}),i.prototype.showText=function(e,t,i){void 0===t&&(t=-1),void 0===i&&(i=-1),this.text.text=e,-1==t?this.text.x=this.skinBg.width-this.text.width>>1:this.text.x=t,-1==i?this.text.y=this.skinBg.height+5:this.text.y=i},i}(e.BasicLayout);e.Progress=t,__reflect(t.prototype,"codeBase.Progress",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function i(i,n,o,r,a,s){void 0===r&&(r=e.Style.VERTICAL),void 0===a&&(a=null),void 0===s&&(s=!0);var l=t.call(this)||this;l.mouseEnable=!1,l.mouseOver=!1,l.mouseWheelMoveStep=5;var h=l;return h.width=i,h.height=n,h.touchEnabled=!0,h.addEventListener(egret.TouchEvent.TOUCH_BEGIN,h.onTouch,h),h.startPos=new e.Point,h.stPos=new e.Point,h._contentPos=new egret.Point,h.content=o,h.alignType=r,h.sliderBarV=a||e.Skin.scrollBar,h.sliderBarV.alpha=0,h.barVisible=s,h.addChild(h.sliderBarV),h.sliderBarV.visible=s,h.viewPort=e.LayoutUI.getRect(i,n,e.Color.white),h.addChildAt(h.viewPort,0),h.viewPort.visible=!1,h.layout(r),l}return __extends(i,t),i.prototype.onTouch=function(e){var t=this;switch(e.type){case egret.TouchEvent.TOUCH_BEGIN:t.stage.addEventListener(egret.TouchEvent.TOUCH_END,t.onTouch,t),t.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,t.onTouch,t),t.stPos.x=e.stageX,t.stPos.y=e.stageY,t.startPos.x=e.stageX-t._contentPos.x,t.startPos.y=e.stageY-t._contentPos.y,t.hideShow(1),t.startTime=egret.getTimer();break;case egret.TouchEvent.TOUCH_MOVE:t.moveDo(e.stageX,e.stageY);break;case egret.TouchEvent.TOUCH_END:t.stage.removeEventListener(egret.TouchEvent.TOUCH_END,t.onTouch,t),t.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,t.onTouch,t),t.hideShow(0,100),t.timeMove(e.stageX,e.stageY)}},i.prototype.setMouseWheelEnable=function(t){var i=this;if(i.alignType==e.Style.VERTICAL){if(i.mouseEnable==t)return;i.mouseEnable=t,i.mouseEnable?i.addMouseEvent():i.removeMouseEvent()}},i.prototype.addMouseEvent=function(){var e=this;e.addCanvasEventListener("mousewheel",e.onMouseWheel,e)},i.prototype.removeMouseEvent=function(){var e=this;e.canvas&&e.mouseWheelFun&&e.canvas.removeEventListener("mousewheel",e.mouseWheelFun)},i.prototype.addCanvasEventListener=function(e,t,i){var n=this;n.canvas||(n.canvas=document.getElementsByTagName("CANVAS")[0]),n.mouseWheelFun=t.bind(i),n.canvas.addEventListener(e,n.mouseWheelFun)},i.prototype.onMouseMoveEvent=function(e){var t=this;"mouseOver"==e.type?t.mouseOver=!0:"mouseOut"==e.type&&(t.mouseOver=!1)},i.prototype.onMouseWheel=function(e){var t=this,i=t.globalToLocal(e.x,e.y);i.x>=t.viewPort.x&&i.x<=t.viewPort.x+t.viewPort.width&&i.y>=t.viewPort.y&&i.y<=t.viewPort.y+t.viewPort.height?(t.mouseWheelMoveY(e.deltaY),t.hideShow(1)):t.hideShow(0)},i.prototype.timeMove=function(t,i){var n=this,o=egret.getTimer()-n.startTime;if(500>o){var r=n._contentPos,a=n.viewPort;e.Tween.removeTweens(r);var s=t-n.stPos.x,l=i-n.stPos.y,h=Math.sqrt(s*s+l*l),c=h/o*100,d=e.Tween.get(r,{loop:!1,onChange:function(){var e=n._content.scrollRect;e.x=-n._contentPos.x,e.y=-n._contentPos.y,n._content.scrollRect=e},onChangeObj:n});if(this.alignType==e.Style.VERTICAL){var u=l>0?1:-1;c*=u;var p=r.y+c;p>0&&r.y+c>0&&(p=0),0>p&&r.y+c<a.height-n._content.height&&(p=a.height-n._content.height),d.to({y:p},400,e.Ease.sineOut).call(n.setBarPos,n)}else{var u=s>0?1:-1;c*=u;var f=r.x+c;f>0&&r.x+c>0&&(f=0),0>f&&r.x+c<a.width-n._content.width&&(f=a.width-n._content.width),d.to({x:f},400,e.Ease.sineOut).call(n.setBarPos,n)}}},Object.defineProperty(i.prototype,"isBarVisible",{set:function(e){this.barVisible=e},enumerable:!1,configurable:!0}),i.prototype.setBarPos=function(){var t=this;t.barVisible&&(t.alignType==e.Style.VERTICAL?t.sliderBarV.y=-t._content.y/(t._content.height-t.viewPort.height)*(t.viewPort.height-t.sliderBarV.height):t.sliderBarV.x=-t._content.x/(t._content.width-t.viewPort.width)*(t.viewPort.width-t.sliderBarV.width))},i.prototype.hideShow=function(t,i){void 0===i&&(i=1e3);var n=this;if(n.barVisible&&n.sliderBarV.alpha!=t)if(e.Tween.removeTweens(n.sliderBarV),1==t)n.sliderBarV.alpha=1;else{var o=e.Tween.get(n.sliderBarV);o.to({alpha:t},i)}},i.prototype.moveDo=function(t,i){var n=this;n.alignType==e.Style.VERTICAL?n.canMoveY(i):n.alignType==e.Style.HORIZONTAL&&n.canMoveX(t)},i.prototype.canMoveX=function(e){var t=this,i=t.viewPort.width-t._content.width,n=e-t.startPos.x;if(n>i&&0>n){t._contentPos.x=n;var o=t._content.scrollRect;o.x=-n,t._content.scrollRect=o,t.sliderBarV.x=-n/(t._content.width-t.viewPort.width)*(t.viewPort.width-t.sliderBarV.width)}},i.prototype.canMoveY=function(e){var t=this,i=t.viewPort.height-t._content.height,n=e-t.startPos.y;if(n>i&&0>n){t._contentPos.y=n;var o=t._content.scrollRect;o.y=-n,t._content.scrollRect=o,t.sliderBarV.y=-n/(t._content.height-t.viewPort.height)*(t.viewPort.height-t.sliderBarV.height)}},i.prototype.mouseWheelMoveY=function(e){var t=this,i=t.viewPort.height-t._content.height;if(0>i){var n=t._contentPos.y;n-=e,i>n?n=i:n>0&&(n=0),t._contentPos.y=n;var o=t._content.scrollRect;o.y=-n,t._content.scrollRect=o,t.sliderBarV.y=-n/(t._content.height-t.viewPort.height)*(t.viewPort.height-t.sliderBarV.height)}},i.prototype.setScrollRect=function(){var e=this;e._content&&(e._content.scrollRect=new egret.Rectangle(0,0,e.width,e.height))},i.prototype.setSliderBarPos=function(){var t=this;t.sliderBarV.x=t.sliderBarV.y=0,t.alignType==e.Style.VERTICAL?t.sliderBarV.x=t.viewPort.width:t.alignType==e.Style.HORIZONTAL&&(t.sliderBarV.y=t.viewPort.height)},i.prototype.layout=function(t,i){void 0===t&&(t=e.Style.VERTICAL),void 0===i&&(i=0);var n=this;n.alignType=t,n.alignType==e.Style.HORIZONTAL&&n.setMouseWheelEnable(!1),n.setSliderBarPos(),n.content&&(n.content.x=n.content.y=0)},i.prototype.reset=function(){var e=this;e.layout(e.alignType)},Object.defineProperty(i.prototype,"content",{set:function(t){var i=this;i._content!=t&&(i._content&&i._content.parent&&(i._content instanceof e.BasicLayout?i._content.removeFromParent(!0):i._content.parent.removeChild(i._content)),i._content=t,i.addChild(i._content),i.setScrollRect())},enumerable:!1,configurable:!0}),i.prototype.sliderBarSkins=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null);var n=this;n.alignType==e.Style.VERTICAL?(n.sliderBarV&&n.sliderBarV!=t&&n.contains(n.sliderBarV)&&n.removeChild(n.sliderBarV),n.sliderBarV=t,n.sliderBarV&&n.addChild(n.sliderBarV)):n.alignType==e.Style.HORIZONTAL&&(n.sliderBarH&&n.sliderBarH!=i&&n.contains(n.sliderBarV)&&n.removeChild(n.sliderBarH),n.sliderBarH=i,n.sliderBarH&&n.addChild(n.sliderBarH)),n.setSliderBarPos()},i}(e.BasicLayout);e.Scroller=t,__reflect(t.prototype,"codeBase.Scroller",["ILayout"])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function i(i,n,o){void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null);var r=t.call(this,i,n)||this;return r.skinBar=o||e.Skin.sliderBar,r.addChild(r.skinBar),r.skinBar.touchEnabled=!0,r.skinBar.addEventListener(egret.TouchEvent.TOUCH_BEGIN,r.onTouch,r),r.layout(),r.value=0,r}return __extends(i,t),i.prototype.setSkin=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null),this.skinBg=t||e.Skin.sliderBackground,this.skinValue=i||e.Skin.sliderValue},i.prototype.onTouch=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouch,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouch,this),this.dispEvent(e.LayoutEvent.START);break;case egret.TouchEvent.TOUCH_MOVE:this.moveDo(t.stageX,t.stageY),this.dispEvent(e.LayoutEvent.MOVE);break;case egret.TouchEvent.TOUCH_END:this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouch,this),this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouch,this),this.dispEvent(e.LayoutEvent.OVER)}},i.prototype.moveDo=function(t,i){var n,o=this.globalToLocal(t,i);n=this.type==e.Style.HORIZONTAL?o.x/this.skinValue.width:o.y/this.skinValue.width,this.value=n},Object.defineProperty(i.prototype,"value",{get:function(){return this._value},set:function(t){t=0>t?0:t>1?1:t,this._value=t,this.skinValue.scaleX=t,this.type==e.Style.HORIZONTAL?this.skinBar.x=this.skinValue.width*t:this.skinBar.y=this.skinValue.width*t},enumerable:!1,configurable:!0}),i.prototype.layout=function(t,i){if(void 0===t&&(t=e.Style.HORIZONTAL),void 0===i&&(i=0),this.type=t,t==e.Style.VERTICAL){var n=90;this.skinBar.x=-this.skinValue.height>>1}else{var n=0;this.skinBar.y=this.skinValue.height>>1}this.skinBg.rotation=n,this.skinValue.rotation=n,this.value=this._value},i}(e.Progress);e.Slider=t,__reflect(t.prototype,"codeBase.Slider",["ILayout"])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){this.oldX=0,this.oldY=0,this.newX=0,this.newY=0,this.oldAlpha=0,this.newAlpha=0,this.oldRotation=0,this.newRotation=0,this.oldScaleX=0,this.newScaleX=0,this.oldScaleY=0,this.newScaleY=0,this.oldAnchorX=0,this.newAnchorX=0,this.oldAnchorY=0,this.newAnchorY=0,this.isPlay=!1,this.loop=!1}return e}();e.EffectData=t,__reflect(t.prototype,"codeBase.EffectData",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(){}return t.breatheEffect=function(i,n,o,r,a){if(void 0===n&&(n=200),void 0===o&&(o=1),void 0===r&&(r=1),void 0===a&&(a=.03),null!=i&&void 0!=i){var s=null;null==this.effectDic[i.hashCode]||void 0==this.effectDic[i.hashCode]?(s=new e.EffectData,t.saveOldValue(i,s),s.newAnchorX=.5,s.newAnchorY=.8,s.newX=s.oldX+i.width*s.newAnchorX,s.newY=s.oldY+i.height*s.newAnchorY,this.effectDic[i.hashCode]=s):(s=this.effectDic[i.hashCode],s.loop=!0),i.anchorOffsetX=s.newAnchorX*i.width,i.anchorOffsetY=s.newAnchorY*i.height,i.x=s.newX,i.y=s.newY,i.scaleX=1-a,i.scaleY=1+a;var l=function(){s.loop&&egret.Tween.get(i).to({scaleX:1+a,scaleY:1.03+a,alpha:r},n+200).to({scaleX:1-a,scaleY:1+a,alpha:o},n).call(l,this)};egret.Tween.get(i).to({scaleX:1+a,scaleY:1.03+a,alpha:r},n+200).to({scaleX:1-a,scaleY:1+a,alpha:o},n).call(l,this)}},t.pauseBreatheEffect=function(e){if(null!=e&&void 0!=e&&null!=this.effectDic[e.hashCode]&&void 0!=this.effectDic[e.hashCode]){var t=this.effectDic[e.hashCode];e.anchorOffsetX=t.oldAnchorX,e.anchorOffsetY=t.oldAnchorY,e.x=t.oldX,e.y=t.oldY,e.scaleX=t.oldScaleX,e.scaleY=t.oldScaleY,egret.Tween.removeTweens(e),this.effectDic[e.hashCode]=null}},t.upDownEffect=function(i,n){if(void 0===n&&(n=500),null!=i&&void 0!=i){var o=null;null==this.effectDic[i.hashCode]||void 0==this.effectDic[i.hashCode]?(o=new e.EffectData,t.saveOldValue(i,o),o.newAnchorX=.5,o.newAnchorY=.8,o.newX=o.oldX+i.width*o.newAnchorX,o.newY=o.oldY+i.height*o.newAnchorY,this.effectDic[i.hashCode]=o):(o=this.effectDic[i.hashCode],o.loop=!0),i.anchorOffsetX=o.newAnchorX*i.width,i.anchorOffsetY=o.newAnchorY*i.height,i.x=o.newX,i.y=o.newY,i.scaleX=.9,i.scaleY=1.1;var r=function(){o.loop&&egret.Tween.get(i).to({scaleX:1.1,scaleY:.9},n).to({scaleX:.9,scaleY:1.1},n).call(r,this)};egret.Tween.get(i).to({scaleX:1.1,scaleY:.9},n).to({scaleX:.9,scaleY:1.1},n).call(r,this)}},t.pauseUpDownEffect=function(e){if(null!=e&&void 0!=e&&null!=this.effectDic[e.hashCode]&&void 0!=this.effectDic[e.hashCode]){var t=this.effectDic[e.hashCode];e.anchorOffsetX=t.oldAnchorX,e.anchorOffsetY=t.oldAnchorY,e.x=t.oldX,e.y=t.oldY,e.scaleX=t.oldScaleX,e.scaleY=t.oldScaleY,egret.Tween.removeTweens(e),this.effectDic[e.hashCode]=null}},t.paopaoEffect=function(i,n){if(void 0===n&&(n=1500),null!=i&&void 0!=i){var o=null;null==this.effectDic[i.hashCode]||void 0==this.effectDic[i.hashCode]?(o=new e.EffectData,t.saveOldValue(i,o),o.newAnchorX=.5,o.newAnchorY=.8,o.newX=o.oldX+i.width*o.newAnchorX,o.newY=o.oldY+i.height*o.newAnchorY,this.effectDic[i.hashCode]=o):(o=this.effectDic[i.hashCode],o.loop=!0),i.anchorOffsetX=o.newAnchorX*i.width,i.anchorOffsetY=o.newAnchorY*i.height,i.x=o.newX,i.y=o.newY,i.scaleX=.95,i.scaleY=1.05;var r=function(){o.loop&&egret.Tween.get(i).to({scaleX:1.04,scaleY:.96},n).to({scaleX:.95,scaleY:1.05},n).call(r,this)};egret.Tween.get(i).to({scaleX:1.04,scaleY:.96},n).to({scaleX:.95,scaleY:1.05},n).call(r,this)}},t.pausePaopaoEffect=function(e){if(null!=e&&void 0!=e&&null!=this.effectDic[e.hashCode]&&void 0!=this.effectDic[e.hashCode]){var t=this.effectDic[e.hashCode];e.anchorOffsetX=t.oldAnchorX,e.anchorOffsetY=t.oldAnchorY,e.x=t.oldX,e.y=t.oldY,e.scaleX=t.oldScaleX,e.scaleY=t.oldScaleY,egret.Tween.removeTweens(e),this.effectDic[e.hashCode]=null}},t.rockEffect=function(i,n,o){if(void 0===n&&(n=25),void 0===o&&(o=200),null!=i&&void 0!=i){var r=null;null==this.effectDic[i.hashCode]||void 0==this.effectDic[i.hashCode]?(r=new e.EffectData,t.saveOldValue(i,r),r.newAnchorX=.5,r.newAnchorY=.8,r.newX=r.oldX+i.width*r.newAnchorX,r.newY=r.oldY+i.height*r.newAnchorY,this.effectDic[i.hashCode]=r):(r=this.effectDic[i.hashCode],r.loop=!0),i.anchorOffsetX=r.newAnchorX*i.width,i.anchorOffsetY=r.newAnchorY*i.height,i.x=r.newX,i.y=r.newY,i.rotation=0;var a=function(){r.loop&&egret.Tween.get(i).to({rotation:n},o).to({rotation:0},o).to({rotation:-n},o).to({rotation:0},o).to({rotation:n},o).to({rotation:0},o).to({rotation:-n},o).to({rotation:0},o).wait(2e3).call(a,this)};egret.Tween.get(i).to({rotation:n},o).to({rotation:0},o).to({rotation:-n},o).to({rotation:0},o).to({rotation:n},o).to({rotation:0},o).to({rotation:-n},o).to({rotation:0},o).wait(2e3).call(a,this)}},t.pauseRockEffect=function(e){if(null!=e&&void 0!=e&&null!=this.effectDic[e.hashCode]&&void 0!=this.effectDic[e.hashCode]){var t=this.effectDic[e.hashCode];e.anchorOffsetX=t.oldAnchorX,e.anchorOffsetY=t.oldAnchorY,e.x=t.oldX,e.y=t.oldY,e.rotation=0,egret.Tween.removeTweens(e),this.effectDic[e.hashCode]=null}},t.rotationEffect=function(i,n,o){if(void 0===n&&(n=1),void 0===o&&(o=5e3),null!=i&&void 0!=i){var r=null;if(null==this.effectDic[i.hashCode]||void 0==this.effectDic[i.hashCode]?(r=new e.EffectData,t.saveOldValue(i,r),r.newAnchorX=.5,r.newAnchorY=.5,r.newX=r.oldX+i.width*r.newAnchorX*i.scaleX,r.newY=r.oldY+i.height*r.newAnchorY*i.scaleY,this.effectDic[i.hashCode]=r):(r=this.effectDic[i.hashCode],r.loop=!0),i.anchorOffsetX=r.newAnchorX*i.width,i.anchorOffsetY=r.newAnchorY*i.height,i.x=r.newX,i.y=r.newY,1==n){var a=function(){r.loop&&(i.rotation=0,egret.Tween.get(i).to({rotation:360},o).call(a,this))};i.rotation=0,egret.Tween.get(i).to({rotation:360},o).call(a,this)}else if(-1==n){var s=function(){r.loop&&(i.rotation=0,egret.Tween.get(i).to({rotation:-360},o).call(s,this))};i.rotation=0,egret.Tween.get(i).to({rotation:-360},o).call(s,this)}}},t.pauseRotationEffect=function(e){if(null!=e&&void 0!=e&&null!=this.effectDic[e.hashCode]&&void 0!=this.effectDic[e.hashCode]){var t=this.effectDic[e.hashCode];e.anchorOffsetX=t.oldAnchorX,e.anchorOffsetY=t.oldAnchorY,e.x=t.oldX,e.y=t.oldY,e.rotation=0,egret.Tween.removeTweens(e),this.effectDic[e.hashCode]=null}},t.flyObjEffect=function(i,n,o,r,a,s){void 0===n&&(n=200),void 0===o&&(o=50),void 0===r&&(r=1),void 0===a&&(a=1),void 0===s&&(s=1);var l=null;if(null==this.effectDic[i.hashCode]||void 0==this.effectDic[i.hashCode]?(l=new e.EffectData,t.saveOldValue(i,l),this.effectDic[i.hashCode]=l):(l=this.effectDic[i.hashCode],l.loop=!0),egret.Tween.removeTweens(i),1==r){if(0==l.isPlay){var h=function(){l.loop&&egret.Tween.get(i).to({y:l.oldY+o,alpha:s},n).to({y:l.oldY-o,alpha:a},n).call(h,this)};egret.Tween.get(i).to({y:l.oldY+o,alpha:s},n).to({y:l.oldY-o,alpha:a},n).call(h,this),l.isPlay=!1}}else if(0==r&&0==l.isPlay){var h=function(){l.loop&&egret.Tween.get(i).to({x:l.oldX+o,alpha:s},n).to({x:l.oldX-o,alpha:a},n).call(h,this)};egret.Tween.get(i).to({x:l.oldX+o,alpha:s},n).to({x:l.oldX-o,alpha:a},n).call(h,this),l.isPlay=!1}},t.pauseFlyObjEffect=function(e){if(null!=e&&void 0!=e&&null!=this.effectDic[e.hashCode]&&void 0!=this.effectDic[e.hashCode]){var t=this.effectDic[e.hashCode];e.alpha=1,e.x=t.oldX,e.y=t.oldY,egret.Tween.removeTweens(e),this.effectDic[e.hashCode]=null}},t.smallTobig=function(t,i,n){if(void 0===i&&(i=200),void 0===n&&(n=1),null!=t&&void 0!=t){var o=null;null==this.effectDic[t.hashCode]||void 0==this.effectDic[t.hashCode]?(o=new e.EffectData,o.newAnchorX=.5,o.newAnchorY=.5,o.oldX=t.x,o.oldY=t.y,o.newX=o.oldX+t.width*o.newAnchorX*t.scaleX,o.newY=o.oldY+t.height*o.newAnchorY*t.scaleY,this.effectDic[t.hashCode]=o):o=this.effectDic[t.hashCode],t.anchorOffsetX=o.newAnchorX*t.width,t.anchorOffsetY=o.newAnchorY*t.height,t.x=o.newX,t.y=o.newY,1==n?(t.scaleX=0,t.scaleY=0,egret.Tween.get(t).to({scaleX:1,scaleY:1},300,egret.Ease.backOut)):2==n&&(t.scaleX=1,t.scaleY=1,egret.Tween.get(t).to({scaleX:0,scaleY:0},300,egret.Ease.backOut))}},t.playEffect=function(i,n){if(void 0===n&&(n=1),null!=i&&void 0!=i){var o=null;if(null==this.effectDic[i.hashCode]||void 0==this.effectDic[i.hashCode]){o=new e.EffectData,t.saveOldValue(i,o),this.effectDic[i.hashCode]=o;var r=function(){o=this.effectDic[i.hashCode],i.x=o.oldX,i.y=o.oldY,i.scaleX=o.oldScaleX,i.scaleY=o.oldScaleY,egret.Tween.removeTweens(i),this.effectDic[i.hashCode]=null},a=function(){1==n?egret.Tween.get(i).to({scaleX:1,scaleY:1,x:i.x-i.width/4,y:i.y-i.height/4},500,egret.Ease.elasticOut).call(r,this):2==n?egret.Tween.get(i).to({scaleX:1,scaleY:1,x:i.x-i.width/4,y:i.y-i.height/4},500,egret.Ease.backOut).call(r,this):3==n&&egret.Tween.get(i).to({scaleX:1,scaleY:1,x:i.x-i.width/4,y:i.y-i.height/4},100).call(r,this)};egret.Tween.get(i).to({scaleX:.8,scaleY:.8,x:i.x+i.width/4,y:i.y+i.height/4},100,egret.Ease.sineIn).call(a,this)}}},t.saveOldValue=function(e,t){t.oldX=e.x,t.oldY=e.y,t.oldAnchorX=e.anchorOffsetX,t.oldAnchorY=e.anchorOffsetY,t.oldScaleX=e.scaleX,t.oldScaleY=e.scaleY,t.oldAlpha=e.alpha,t.loop=!0},t.effectDic={},t}();e.EffectUtil=t,__reflect(t.prototype,"codeBase.EffectUtil",[])}(i||(i={})),window.codeBase=i},function(module,exports){var codeBase=window.codeBase,codeBase;!function(codeBase){var TweenEffect=function(){function TweenEffect(){}return TweenEffect.setAnchorXY=function(e,t,i){void 0===t&&(t=.5),void 0===i&&(i=.5);var n=t*e.scaleX*e.width,o=i*e.scaleY*e.height;e.anchorOffsetX=n,e.anchorOffsetY=o,e.x+=n,e.y+=o},TweenEffect.magnifyEffect=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:1,attr:{scaleX:1,scaleY:1,alpha:1}}];e.scaleX=e.scaleY=e.alpha=0;var i=i?i:300;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.restoreEffect=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:1,attr:{alpha:1,skewX:0,skewY:0,scaleX:1,scaleY:1,rotation:0}}],i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.shrinkEffect=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:1,attr:{scaleX:0,scaleY:0,alpha:0}}];e.scaleX=e.scaleY=e.alpha=1;var i=i?i:300;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.flutterEffect=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.25,attr:{alpha:0,anchorOffsetX:1*e.width}},{percent:.5,attr:{alpha:1,anchorOffsetX:0}},{percent:.75,attr:{alpha:0,anchorOffsetX:1*e.width}},{percent:1,attr:{alpha:1,anchorOffsetX:0}}];e.anchorOffsetX=e.alpha=0;var i=i?i:6e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.flutterPositionEffect=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.4,attr:{anchorOffsetX:-.3*e.width,anchorOffsetY:-.2*e.height,scaleX:.9,scaleY:.9,alpha:.7}},{percent:.8,attr:{anchorOffsetX:-.2*e.width,anchorOffsetY:-.1*e.height,scaleX:.95,scaleY:.95,alpha:.9}},{percent:1,attr:{anchorOffsetX:0,anchorOffsetY:0,scaleX:1,scaleY:1,alpha:1}}];e.anchorOffsetX=e.anchorOffsetY=0,e.scaleX=e.scaleY=e.alpha=1;var i=i?i:6e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.fadeInEffect=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:1,attr:{alpha:1}}];e.alpha=0;var i=i?i:500;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.fadeInLeft=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:1,attr:{alpha:1,anchorOffsetX:0}}];e.alpha=0,e.anchorOffsetX=50;var i=i?i:800;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.fadeInRight=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:1,attr:{alpha:1,anchorOffsetX:0}}];e.alpha=0,e.anchorOffsetX=-50;var i=i?i:800;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.fadeInUp=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:1,attr:{alpha:1,anchorOffsetY:0}}];e.alpha=0,e.anchorOffsetY=-50;var i=i?i:800;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.fadeInDown=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:1,attr:{alpha:1,anchorOffsetY:0}}];e.alpha=0,e.anchorOffsetY=50;var i=i?i:800;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.fadeOut=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:1,attr:{alpha:0}}];e.alpha=1;var i=i?i:800;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.fadeOutLeft=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:1,attr:{alpha:0,anchorOffsetX:50}}];e.alpha=1;var i=i?i:800;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.fadeOutRight=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:1,attr:{alpha:0,anchorOffsetX:-50}}];e.alpha=1,e.anchorOffsetX=0;var i=i?i:800;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.fadeOutDown=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:1,attr:{alpha:0,anchorOffsetY:-50}}];e.alpha=1,e.anchorOffsetY=0;var i=i?i:800;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.fadeOutUp=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:1,attr:{alpha:0,anchorOffsetY:50}}];e.alpha=1,e.anchorOffsetY=0;var i=i?i:800;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.shake=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.22,attr:{anchorOffsetX:.1*e.width}},{percent:.44,attr:{anchorOffsetX:-.1*e.width}},{percent:.66,attr:{anchorOffsetX:.1*e.width}},{percent:.88,attr:{anchorOffsetX:-.1*e.width}},{percent:1,attr:{anchorOffsetX:0}}],i=i?i:450;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.skip=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.25,attr:{scaleY:.8}},{percent:.5,attr:{scaleY:1.2}},{percent:.75,attr:{scaleY:.8}},{percent:1,attr:{scaleY:1}}];e.scaleY=1;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.arrowDown=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.5,attr:{alpha:1,anchorOffsetY:-.5*e.height}},{percent:1,attr:{alpha:.3,anchorOffsetY:0}}];e.alpha=1,e.anchorOffsetY=0;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.arrowUp=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.5,attr:{alpha:.3,anchorOffsetY:.5*e.height}},{percent:1,attr:{alpha:1,anchorOffsetY:0}}];e.alpha=1,e.anchorOffsetY=0;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.arrowRight=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.5,attr:{alpha:.3,anchorOffsetX:-.5*e.width}},{percent:1,attr:{alpha:1,anchorOffsetX:0}}];e.alpha=1,e.anchorOffsetX=0;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.arrowLeft=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.5,attr:{alpha:1,anchorOffsetX:.5*e.width}},{percent:1,attr:{alpha:.3,anchorOffsetX:0}}];e.alpha=1,e.anchorOffsetX=0,n="backIn";var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.flash=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.25,attr:{alpha:.4}},{percent:.5,attr:{alpha:.9}},{percent:.75,attr:{alpha:.2}},{percent:1,attr:{alpha:1}}];e.alpha=1;var i=i?i:2e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.flashIn=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.25,attr:{alpha:0}},{percent:.5,attr:{alpha:1}},{percent:.75,attr:{alpha:0}},{percent:1,attr:{alpha:1}}];e.alpha=1;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.flashOut=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.25,attr:{alpha:1}},{percent:.5,attr:{alpha:0}},{percent:.75,attr:{alpha:1}},{percent:1,attr:{alpha:0}}];e.alpha=0;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.rotation=function(object,delay,total,easeFunName,isLoop){if(void 0===delay&&(delay=0),void 0===total&&(total=0),void 0===easeFunName&&(easeFunName=""),void 0===isLoop&&(isLoop=!1),egret.Tween.removeTweens(object),total=total?total:1e3,easeFunName)var easeFun=eval("egret.Ease."+easeFunName);else easeFun=null;egret.Tween.get(object,{loop:isLoop}).wait(delay).to({rotation:object.rotation+360},total,easeFun)},TweenEffect.rotationIn=function(object,delay,total,easeFunName,isLoop){if(void 0===delay&&(delay=0),void 0===total&&(total=0),void 0===easeFunName&&(easeFunName=""),void 0===isLoop&&(isLoop=!1),egret.Tween.removeTweens(object),total=total?total:500,codeBase.StringUtil.isUsage(easeFunName))var easeFun=eval("egret.Ease."+easeFunName);else easeFun=null;object.rotation=object.scaleX=object.scaleY=object.alpha=0,egret.Tween.get(object,{loop:isLoop}).wait(delay).to({rotation:object.rotation+360,scaleX:1,scaleY:1,alpha:1},total,easeFun)},TweenEffect.rotationOut=function(object,delay,total,easeFunName,isLoop){if(void 0===delay&&(delay=0),void 0===total&&(total=0),void 0===easeFunName&&(easeFunName=""),void 0===isLoop&&(isLoop=!1),egret.Tween.removeTweens(object),total=total?total:500,codeBase.StringUtil.isUsage(easeFunName))var easeFun=eval("egret.Ease."+easeFunName);else easeFun=null;object.rotation=0,object.scaleX=object.scaleY=object.alpha=1,egret.Tween.get(object,{loop:isLoop}).wait(delay).to({rotation:object.rotation+360,scaleX:0,scaleY:0,alpha:0},total,easeFun)},TweenEffect.rotationInLeft=function(object,delay,total,easeFunName,isLoop){if(void 0===delay&&(delay=0),void 0===total&&(total=0),void 0===easeFunName&&(easeFunName=""),void 0===isLoop&&(isLoop=!1),egret.Tween.removeTweens(object),total=total?total:500,codeBase.StringUtil.isUsage(easeFunName))var easeFun=eval("egret.Ease."+easeFunName);else easeFun=null;object.rotation=30,object.alpha=0,egret.Tween.get(object,{loop:isLoop}).wait(delay).to({rotation:0,alpha:1},total,easeFun)},TweenEffect.rotationInRight=function(object,delay,total,easeFunName,isLoop){if(void 0===delay&&(delay=0),void 0===total&&(total=0),void 0===easeFunName&&(easeFunName=""),void 0===isLoop&&(isLoop=!1),egret.Tween.removeTweens(object),total=total?total:500,codeBase.StringUtil.isUsage(easeFunName))var easeFun=eval("egret.Ease."+easeFunName);else easeFun=null;object.rotation=-30,object.alpha=0,egret.Tween.get(object,{loop:isLoop}).wait(delay).to({rotation:0,alpha:1},total,easeFun)},TweenEffect.rotationOutLeft=function(object,delay,total,easeFunName,isLoop){if(void 0===delay&&(delay=0),void 0===total&&(total=0),void 0===easeFunName&&(easeFunName=""),void 0===isLoop&&(isLoop=!1),egret.Tween.removeTweens(object),total=total?total:500,codeBase.StringUtil.isUsage(easeFunName))var easeFun=eval("egret.Ease."+easeFunName);else easeFun=null;object.rotation=0,object.alpha=1,egret.Tween.get(object,{loop:isLoop}).wait(delay).to({rotation:30,alpha:0},total,easeFun)},TweenEffect.rotationOutRight=function(object,delay,total,easeFunName,isLoop){if(void 0===delay&&(delay=0),void 0===total&&(total=0),void 0===easeFunName&&(easeFunName=""),void 0===isLoop&&(isLoop=!1),egret.Tween.removeTweens(object),total=total?total:500,codeBase.StringUtil.isUsage(easeFunName))var easeFun=eval("egret.Ease."+easeFunName);else easeFun=null;object.rotation=0,object.alpha=1,egret.Tween.get(object,{loop:isLoop}).wait(delay).to({rotation:-30,alpha:0},total,easeFun)},TweenEffect.scaleOutRock=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.1,attr:{scaleY:.9,scaleX:.9,rotation:-3}},{percent:.2,attr:{scaleY:.9,scaleX:.9,rotation:-3}},{percent:.3,attr:{scaleY:1.1,scaleX:1.1,rotation:3}},{percent:.4,attr:{scaleY:1.1,scaleX:1.1,rotation:-3}},{percent:.5,attr:{scaleY:1.1,scaleX:1.1,rotation:3}},{percent:.6,attr:{scaleY:1.1,scaleX:1.1,rotation:-3}},{percent:.7,attr:{scaleY:1.1,scaleX:1.1,rotation:3}},{percent:.8,attr:{scaleY:1.1,scaleX:1.1,rotation:3}},{percent:1,attr:{scaleY:1,scaleX:1,rotation:0}}];e.scaleX=e.scaleY=1;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.rubberBand=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.3,attr:{scaleX:1.25,scaleY:.75}},{percent:.4,attr:{scaleX:.75,scaleY:1.25}},{percent:.5,attr:{scaleX:1.15,scaleY:.85}},{percent:.65,attr:{scaleX:.95,scaleY:1.05}},{percent:.75,attr:{scaleX:1.05,scaleY:.95}},{percent:1,attr:{scaleX:1,scaleY:1}}];e.scaleX=e.scaleY=1;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.bounce=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);
var r=[{percent:.4,attr:{anchorOffsetY:.1*e.height}},{percent:.43,attr:{anchorOffsetY:.2*e.height}},{percent:.7,attr:{anchorOffsetY:.1*e.height}},{percent:.8,attr:{anchorOffsetY:0}},{percent:.9,attr:{anchorOffsetY:.04*e.height}},{percent:1,attr:{anchorOffsetY:0*e.height}}];e.anchorOffsetY=0;var i=i?i:500;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.bounceIn=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.2,attr:{scaleX:1.1,scaleY:1.1}},{percent:.4,attr:{scaleX:.9,scaleY:.9}},{percent:.6,attr:{scaleX:1.03,scaleY:1.03,alpha:1}},{percent:.8,attr:{scaleX:.97,scaleY:.97}},{percent:1,attr:{scaleX:1,scaleY:1,alpha:1}}];e.alpha=0,e.scaleX=e.scaleY=.3;var i=i?i:500;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.bounceInDown=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.6,attr:{anchorOffsetY:25,alpha:1}},{percent:.75,attr:{anchorOffsetY:-10,alpha:1}},{percent:.9,attr:{anchorOffsetY:5,alpha:1}},{percent:1,attr:{anchorOffsetY:0,alpha:1}}];e.alpha=0,e.anchorOffsetY=-3e3;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.bounceInUp=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.6,attr:{anchorOffsetY:25,alpha:1}},{percent:.75,attr:{anchorOffsetY:-10,alpha:1}},{percent:.9,attr:{anchorOffsetY:5,alpha:1}},{percent:1,attr:{anchorOffsetY:0,alpha:1}}];e.alpha=0,e.anchorOffsetY=3e3;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.bounceInLeft=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.6,attr:{anchorOffsetX:25,alpha:1}},{percent:.75,attr:{anchorOffsetX:-10,alpha:1}},{percent:.9,attr:{anchorOffsetX:5,alpha:1}},{percent:1,attr:{anchorOffsetX:0,alpha:1}}];e.alpha=0,e.anchorOffsetX=-3e3;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.bounceInRight=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.6,attr:{anchorOffsetX:25,alpha:1}},{percent:.75,attr:{anchorOffsetX:-10,alpha:1}},{percent:.9,attr:{anchorOffsetX:5,alpha:1}},{percent:1,attr:{anchorOffsetX:0,alpha:1}}];e.alpha=0,e.anchorOffsetX=3e3;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.bounceOut=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.2,attr:{scaleX:.9,scaleY:.9}},{percent:.5,attr:{scaleX:1.1,scaleY:1.1}},{percent:.55,attr:{scaleX:1.1,scaleY:1.1}},{percent:1,attr:{scaleX:.3,scaleY:.3,alpha:0}}];e.alpha=e.scaleX=e.scaleY=1;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.bounceOutUp=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.2,attr:{anchorOffsetY:25,alpha:1}},{percent:.4,attr:{anchorOffsetY:-20,alpha:1}},{percent:.45,attr:{anchorOffsetY:-20,alpha:1}},{percent:1,attr:{anchorOffsetY:2e3,alpha:0}}];e.alpha=1,e.anchorOffsetY=0;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.bounceOutDown=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.2,attr:{anchorOffsetY:-10,alpha:1}},{percent:.4,attr:{anchorOffsetY:20,alpha:1}},{percent:.45,attr:{anchorOffsetY:20,alpha:1}},{percent:1,attr:{anchorOffsetY:-2e3,alpha:0}}];e.alpha=1,e.anchorOffsetY=0;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.bounceOutLeft=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.2,attr:{anchorOffsetX:-25,alpha:1}},{percent:1,attr:{anchorOffsetX:2e3,alpha:0}}];e.alpha=1,e.anchorOffsetX=0;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.bounceOutRight=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.2,attr:{anchorOffsetX:25,alpha:1}},{percent:1,attr:{anchorOffsetX:-2e3,alpha:0}}];e.alpha=1,e.anchorOffsetX=0;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.swing=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.2,attr:{rotation:15}},{percent:.4,attr:{rotation:-10}},{percent:.6,attr:{rotation:5}},{percent:.8,attr:{rotation:-5}},{percent:1,attr:{rotation:0}}];e.rotation=0;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.scaleIn=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:1,attr:{scaleX:1,scaleY:1,alpha:1}}];e.alpha=0,e.scaleX=e.scaleY=1.2;var i=i?i:500;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.scaleOut=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:1,attr:{scaleX:1.2,scaleY:1.2,alpha:0}}];e.alpha=1,e.scaleX=e.scaleY=1;var i=i?i:500;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.scaleInBig=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:1,attr:{scaleX:1,scaleY:1,alpha:1}}];e.alpha=0,e.scaleX=e.scaleY=3;var i=i?i:500;n="quadIn",TweenEffect.start(e,r,t,i,n,o)},TweenEffect.scaleOutBig=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:1,attr:{scaleX:3,scaleY:3,alpha:0}}];e.alpha=1,e.scaleX=e.scaleY=1;var i=i?i:500;n="quadIn",TweenEffect.start(e,r,t,i,n,o)},TweenEffect.rightSpeedIn=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.6,attr:{skewX:20,alpha:1,anchorOffsetX:-.4*e.width}},{percent:.8,attr:{skewX:-5,alpha:1,anchorOffsetX:-.2*e.width}},{percent:1,attr:{skewX:0,alpha:1,anchorOffsetX:0}}];e.skewX=e.alpha=0,e.anchorOffsetX=-1;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.pluse=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.5,attr:{scaleX:1.1,scaleY:1.1}},{percent:1,attr:{scaleX:1,scaleY:1}}];e.scaleX=e.scaleY=1;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.rotationFlash=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.25,attr:{rotation:5}},{percent:.75,attr:{rotation:-5}},{percent:1,attr:{rotation:0}}];e.rotation=0;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.breath=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.25,attr:{scaleX:.92,scaleY:.92,alpha:.7}},{percent:.5,attr:{scaleX:1,scaleY:1,alpha:1}},{percent:.75,attr:{scaleX:.92,scaleY:.92,alpha:.7}},{percent:1,attr:{scaleX:1,scaleY:1,alpha:1}}];e.scaleX=e.scaleY=e.alpha=1;var i=i?i:5e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.shiftUp=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.5,attr:{anchorOffsetY:1*e.height}},{percent:1,attr:{anchorOffsetY:0}}];e.anchorOffsetY=0;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.shiftDown=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.5,attr:{anchorOffsetY:-1*e.height}},{percent:1,attr:{anchorOffsetY:0}}];e.anchorOffsetY=0;var i=i?i:1e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.jump=function(e,t,i,n,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===n&&(n=""),void 0===o&&(o=!1),egret.Tween.removeTweens(e);var r=[{percent:.4,attr:{scaleX:1.1,scaleY:.9,anchorOffsetY:.8*e.height}},{percent:.55,attr:{scaleX:1.8,scaleY:.2,anchorOffsetY:.9*e.height}},{percent:.65,attr:{scaleX:.6,scaleY:1.4,anchorOffsetY:.3*e.height}},{percent:1,attr:{scaleX:1,scaleY:1,anchorOffsetY:0}}];e.anchorOffsetY=0,e.scaleX=e.scaleY=1;var i=i?i:2e3;TweenEffect.start(e,r,t,i,n,o)},TweenEffect.rock=function(e,t,i,n){void 0===t&&(t=25),void 0===i&&(i=200),void 0===n&&(n=!1);var o=e.rotation;egret.Tween.get(e,{loop:n}).to({rotation:t+o},i).to({rotation:o},i).to({rotation:o-t},i).to({rotation:o},i).to({rotation:t+o},i).to({rotation:o},i).to({rotation:o-t},i).to({rotation:o},i).wait(2e3)},TweenEffect.fly=function(e,t,i,n,o){void 0===t&&(t=500),void 0===i&&(i=3),void 0===n&&(n=!0),void 0===o&&(o=1);var r,a;r=e.x,a=e.y,1==o?egret.Tween.get(e,{loop:n}).to({y:a+i},t).to({y:a},t).to({y:a-i},t).to({y:a},t):egret.Tween.get(e,{loop:n}).to({x:r+i},t).to({x:r},t).to({x:r-i},t).to({x:r},t)},TweenEffect.start=function(object,attr,delay,total,easeFunName,isLoop){void 0===delay&&(delay=0),void 0===total&&(total=0),void 0===easeFunName&&(easeFunName=""),void 0===isLoop&&(isLoop=!1),egret.Tween.removeTweens(object);var index=0,attr=attr,total=total,tweenTime=0;if(codeBase.StringUtil.isUsage(easeFunName))var easeFun=eval("egret.Ease."+easeFunName);else easeFun=null;setTimeout(function e(){if(index>=attr.length){if(!isLoop)return;index=0}tweenTime=index>0?(attr[index].percent-attr[index-1].percent)*total:attr[index].percent*total,egret.Tween.get(object).to(attr[index].attr,tweenTime,easeFun).call(e,this),index++},delay)},TweenEffect}();codeBase.TweenEffect=TweenEffect,__reflect(TweenEffect.prototype,"codeBase.TweenEffect",[])}(codeBase||(codeBase={})),window.codeBase=codeBase},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(){}return t.getPacket=function(e,i){void 0===i&&(i=!0);var n=t.packetCachePool[(i?"c_":"s_")+e];if(null==n&&(n=new Array,t.packetCachePool[(i?"c_":"s_")+e]=n),0==n.length){var o=egret.getDefinitionByName("PacketFactory");return o?o.createPacket(e,i):null}return n.shift()},t.releasePacket=function(e){var i=t.packetCachePool[(e.clientSide?"c_":"s_")+e.header.messageId];null==i&&(i=new Array,t.packetCachePool[(e.clientSide?"c_":"s_")+e.header.messageId]=i),i.push(e)},t.getEvent=function(i){var n=t.eventCachePool[i];return null==n&&(n=[],t.eventCachePool[i]=n),0==n.length?new e.MyEvent(i):n.pop()},t.releaseEvent=function(e){var i=t.eventCachePool[e.type];null==i&&(i=[],t.eventCachePool[e.type]=i),e.destory(),i.push(e)},t.addPacketEvent=function(e,i,n){if(null!=i&&!t.isContainerPacketEventListener(e,i,n)){var o=null;o=t.packetEventList[t.PREFIX+e],null==o&&(o=new Array,t.packetEventList[t.PREFIX+e]=o),o.push({func:i,owner:n})}},t.removePacketEvent=function(e,i,n){if(null!=i&&t.isContainerPacketEventListener(e,i,n)){var o=t.packetEventList[t.PREFIX+e];if(o)for(var r=0;r<o.length;r++)if(o[r].func==i&&o[r].owner==n){o.splice(r,1);break}}},t.isContainerPacketEventListener=function(e,i,n){var o=t.packetEventList[t.PREFIX+e];if(null!=o)for(var r=0;r<o.length;r++)if(o[r].func==i&&o[r].owner==n)return!0;return!1},t.dispactchPacket=function(i){null!=i&&(e.Debug.log=i,this.packetSendCacheList.push(i),e.HeartBeat.addListener(t,t.onFireDispactchPacket))},t.onFireDispactchPacket=function(){if(t.packetSendCacheList.length>0){var i=t.packetSendCacheList.shift();e.MessageControler.receivePacket(i);var n=t.packetEventList[t.PREFIX+i.header.messageId];if(null!=n){for(var o=n.length,r=0;o>r;r++)n[r].func.call(n[r].owner,i);t.releasePacket(i)}}0==this.packetSendCacheList.length&&e.HeartBeat.removeListener(t,t.onFireDispactchPacket)},t.dispatch=function(e,i){void 0===i&&(i=null);var n=t.getEvent(e);if(i){var o=null;for(var r in i)"__class__"!=r&&"hashCode"!=r&&"__types__"!=r&&"__proto__"!=r&&(o=i[r],o instanceof Function||n.addItem(r,o))}t.dispatchEvent(n)},t.dispatchEvent=function(i){null!=i&&(t.eventSendCacheList.push(i),e.HeartBeat.addListener(t,t.onFiredispatchEvent))},t.onFiredispatchEvent=function(){if(t.eventSendCacheList.length>0){var i=t.eventSendCacheList.shift();e.MessageControler.receiveEvent(i);var n=t.commEventList[i.type];if(null!=n)for(var o=n.length-1;o>=0;o--)n[o].func.call(n[o].owner,i);t.releaseEvent(i)}0==t.eventSendCacheList.length&&e.HeartBeat.removeListener(t,t.onFiredispatchEvent)},t.removeEventListener=function(e,i,n){var o=t.commEventList[e];if(null!=o)for(var r=0;r<o.length;r++)if(o[r].func==i&&o[r].owner==n){o.splice(r,1);break}},t.addEventListener=function(e,i,n){if(null!=i&&!t.isContainerEventListener(e,i,n)){var o=t.commEventList[e];null==o&&(o=new Array,t.commEventList[""+e]=o),o.push({func:i,owner:n})}},t.isContainerEventListener=function(e,i,n){var o=t.commEventList[""+e];if(null!=o)for(var r=0;r<o.length;r++)if(o[r].func==i&&o[r].owner==n)return!0;return!1},t.PREFIX="PKT_",t.packetEventList={},t.commEventList={},t.eventCachePool={},t.eventSendCacheList=[],t.packetCachePool={},t.packetSendCacheList=[],t}();e.EventManager=t,__reflect(t.prototype,"codeBase.EventManager",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){}return e.SOCKET_CONNECT="SOCKET_CONNECT",e.SOCKET_DISCONNECT_ERROR="SOCKET_DISCONNECT_ERROR",e.SOCKET_DISCONNECT="SOCKET_DISCONNECT",e.SOCKET_SEND_SHOW="SOCKET_SEND_SHOW",e.SOCKET_SEND_HIDE="SOCKET_SEND_HIDE",e.SOCKET_SEND_TIMEOUT="SOCKET_SEND_TIMEOUT",e.STAGE_RESIZE="STAGE_RESIZE",e.UI_CONFIG_VOLUME="UI_CONFIG_VOLUME",e.UI_CONFIG_FULLSCREEN="UI_CONFIG_FULLSCREEN",e.UI_LOADER_COMPLETED="UI_LOADER_COMPLETED",e.MOVIEWCLIP_PLAY="MOVIEWCLIP_PLAY",e.MOVIEWCLIP_PLAY_END="MOVIEWCLIP_PLAY_END",e.UI_DEBUG_OPEN="DEBUG_UI_OPEN",e.UI_DEBUG_CLOSE="DEBUG_UI_CLOSE",e.VOLUME_CHANGED="VOLUME_CHANGED",e.RESOURCE_DOWNLOADED="RESOURCE_DOWNLOADED",e.RESOURCE_PROGRESS="RESOURCE_PROGRESS",e.PROJECT_RES_DOWNLOADED="PROJECT_RES_DOWNLOADED",e.GUIDE_FREEDBACK="GUIDE_FREEDBACK",e.GUIDE_END="GUIDE_END",e.GUIDE_SIMULATE="GUIDE_SIMULATE",e.VIEW_ENTER="VIEW_ENTER",e.VIEW_OUTER="VIEW_OUTER",e.WIN_ENTER="WIN_ENTER",e.WIN_OUTER="WIN_OUTER",e.GUIDE_TASK_TALKING_NOTIFY="GUIDE_TASK_TALKING_NOTIFY",e.GUIDE_PARAM_NOTIFY="GUIDE_PARAM_NOTIFY",e.GUIDE_WIN_CLOSE_NOTIFY="GUIDE_WIN_CLOSE_NOTIFY",e.GUIDE_TASK_CLOSE_NOTIFY="GUIDE_TASK_CLOSE_NOTIFY",e.GUIDE_STOP_ITEM="GUIDE_STOP_ITEM",e.STORY_TALKING="STORY_TALKING",e.STORY_END="STORY_END",e.GUIDE_EVENT_EXE="GUIDE_EVENT_EXE",e.GUIDE_EVENT_END="GUIDE_EVENT_END",e.GUIDE_CHAPTER_END="GUIDE_CHAPTER_END",e.SOUND_COMPLETE="SOUND_COMPLETE",e.SOUND_STOP="SOUND_STOP",e.VIDEO_END="VIDEO_END",e.ERASE_COMPLETE="erase_complete",e.ERASE_CHANGE="erase_change",e.CLOSE_VIDEO="CLOSE_VIDEO",e.LOADINGUI_FINISH="LOADINGUI_FINISH",e}();e.EventType=t,__reflect(t.prototype,"codeBase.EventType",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(e){this.callStack=null,this.type=null,this.datas={},this.type=e}return t.prototype.addItem=function(e,t){this.datas[e]=t},t.prototype.getItem=function(e){return this.datas.hasOwnProperty(e)?this.datas[e]:null},t.prototype.hasItem=function(e){return this.datas.hasOwnProperty(e)},t.prototype.destory=function(){this.callStack=null;for(var e in this.datas)delete this.datas[e]},t.prototype.removeItem=function(e){return this.datas.hasOwnProperty(e)?(delete this.datas[e],!0):!1},t.prototype.send=function(){e.EventManager.dispatchEvent(this)},t.getEvent=function(t){return e.EventManager.getEvent(t)},t.sendEvent=function(t,i){void 0===i&&(i=null),e.EventManager.dispatch(t,i)},t}();e.MyEvent=t,__reflect(t.prototype,"codeBase.MyEvent",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){this.timeout=0,this._url="",this._method="",this.responseType="text",this.withCredentials=!1,this.timeout=3e3}return Object.defineProperty(e.prototype,"responseType",{get:function(){return this._responseType},set:function(e){this._responseType=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"response",{get:function(){if(!this._xhr)return null;if(void 0!=this._xhr.response)return this._xhr.response;if("text"==this._responseType)return this._xhr.responseText;if("arraybuffer"==this._responseType&&/msie 9.0/i.test(navigator.userAgent)){var e=window;return e.convertResponseBodyToText(this._xhr.responseBody)}return"document"==this._responseType?this._xhr.responseXML:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"withCredentials",{get:function(){return this._withCredentials},set:function(e){this._withCredentials=e},enumerable:!1,configurable:!0}),e.prototype.getXHR=function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},e.prototype.open=function(e,t){void 0===t&&(t="GET"),this._url=e,this._method=t,this._xhr&&(this._xhr.abort(),this._xhr=null);var i=this.getXHR();window.XMLHttpRequest?(i.addEventListener("load",this.onload.bind(this)),i.addEventListener("error",this.onerror.bind(this))):i.onreadystatechange=this.onReadyStateChange.bind(this),i.ontimeout=this.onTimeout.bind(this),i.open(this._method,this._url,!0),this._xhr=i},e.prototype.send=function(e){if(null!=this._responseType&&(this._xhr.responseType=this._responseType),null!=this._withCredentials&&(this._xhr.withCredentials=this._withCredentials),this._headerObj)for(var t in this._headerObj)this._xhr.setRequestHeader(t,this._headerObj[t]);this._xhr.timeout=this.timeout,this._xhr.send(e)},e.prototype.abort=function(){this._xhr&&this._xhr.abort()},e.prototype.getAllResponseHeaders=function(){if(!this._xhr)return null;var e=this._xhr.getAllResponseHeaders();return e?e:""},Object.defineProperty(e.prototype,"headerObj",{get:function(){return this.headerObj},set:function(e){this._headerObj=e},enumerable:!1,configurable:!0}),e.prototype.setRequestHeader=function(e,t){this._headerObj||(this._headerObj={}),this._headerObj[e]=t},e.prototype.getResponseHeader=function(e){if(!this._xhr)return null;var t=this._xhr.getResponseHeader(e);return t?t:""},e.prototype.setCallBackFun=function(e,t){var i=this;i.callBack=e,i.funObj=t},e.prototype.loadFinishCall=function(){var e=this;e.callBack&&(e.callBack.call(e.funObj,e),e.callBack=null)},e.prototype.onTimeout=function(){console.log(""+this._url),this.loadFinishCall()},e.prototype.onReadyStateChange=function(){var e=this._xhr;if(4==e.readyState){var t=e.status>=400||0==e.status,i=this._url,n=this;window.setTimeout(function(){n.loadFinishCall(),t&&console.log(""+i)},0)}},e.prototype.updateProgress=function(e){e.lengthComputable},e.prototype.onload=function(){var e=this,t=this._xhr,i=this._url,n=t.status>=400;window.setTimeout(function(){e.loadFinishCall(),n&&console.log(""+i)},0)},e.prototype.onerror=function(){var e=this._url,t=this;window.setTimeout(function(){t.loadFinishCall(),console.log(""+e)},0)},e}();e.HttpLoader=t,__reflect(t.prototype,"codeBase.HttpLoader",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function i(){return t.call(this)||this}return __extends(i,t),i.getInstance=function(){return i.instance||(i.instance=new i),i.instance},i.prototype.load=function(t,i,n,o,r,a,s){void 0===i&&(i=null),void 0===o&&(o="GET"),void 0===r&&(r=null),void 0===a&&(a=!1),void 0===s&&(s=null);var l=this,h=s?s:{},c=i?l.formatParams(i):null,d=t;"get"===o.toLowerCase()?c&&(t.lastIndexOf("?")!=t.length-1&&(d+="?"),d+=c,c=null):h["Content-type"]="application/x-www-form-urlencoded";var u=new e.HttpLoader;return u.setCallBackFun(l.loadFinishCall,l),n.loader=u,u.loadInfo=n,u.open(d,o),u.withCredentials=a,u.responseType=r,u.headerObj=h,u.send(c),u},i.prototype.formatParams=function(e){return e?Object.keys(e).map(function(t){return t+"="+e[t]}).join("&"):null},i.prototype.loadFinishCall=function(e){e.loadInfo&&e.loadInfo.callBack&&e.loadInfo.callBack.call(e.loadInfo.funObj,e.loadInfo)},i}(egret.EventDispatcher);e.Loader=t,__reflect(t.prototype,"codeBase.Loader",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t,t=window.ResourceItem;!function(e){e.TYPE_EXML="exml",e.TYPE_XML="xml",e.TYPE_IMAGE="image",e.TYPE_BIN="bin",e.TYPE_TEXT="text",e.TYPE_JSON="json",e.TYPE_SHEET="sheet",e.TYPE_FONT="font",e.TYPE_SOUND="sound",e.TYPE_TTF="ttf",e.TYPE_ATLAS="atlas",e.TYPE_PKG="pkg";var t=function(){function t(){this._count=0,this.res=null,this.inPool=!1}return t.prototype.getRes=function(){var e=this;return e._count+=1,e.res},t.prototype.relRes=function(){var e=this;e._count-=1,e._count<=0&&console.log(""+e.pathKey)},t.prototype.clear=function(t){var i=this;if(i.type==e.TYPE_IMAGE?i.res.dispose():i.type==e.TYPE_SOUND&&i.res.close(),i.param&&i.param.subRes)for(var n=i.param.subRes.length;--n>-1;)i.param.subRes[n].clear();i.res=null,i.inPool=!0,i._count=0,i.param=null,i.pathKey=null},Object.defineProperty(t.prototype,"count",{get:function(){return this._count},enumerable:!1,configurable:!0}),t.getResObject=function(){var e=new t;return e},t}();e.ResObject=t,__reflect(t.prototype,"codeBase.ResourceItem.ResObject",[]);var i=function(){function e(){this.url=null,this.callBack=null,this.funObj=null,this.responseType="",this.resTag=null,this.loader=null,this.resGroup=null}return e}();e.LoadInfo=i,__reflect(i.prototype,"codeBase.ResourceItem.LoadInfo",[]);var n=function(){function e(){this.groupName=null,this.resNum=0,this.status=0,this.loadInfoArray=[],this.callBack=null,this.funObj=null}return e}();e.ResGroup=n,__reflect(n.prototype,"codeBase.ResourceItem.ResGroup",[])}(t=e.ResourceItem||(e.ResourceItem={})),window.ResourceItem=t;var i=function(i){function n(){var e=i.call(this)||this;return e.resDic={},e.loadPool=[],e.waitPool=[],e._maxLoadNum=5,e.resGroupPool={},e}return __extends(n,i),n.getInstance=function(){return n.inst||(n.inst=new n),n.inst},n.prototype.loadRes=function(e,t,i,o,r){void 0===t&&(t=null),void 0===i&&(i=null),void 0===o&&(o=""),void 0===r&&(r=null);var a=this;n.loadHashCode+=1;var s=a.checkLoadInfo(e);s||(a.loadPool.length<a._maxLoadNum?(s=a.resLoad(e,null,t,i,"get",o,!1,null),a.loadPool.push(s)):a.waitPool.push(s))},n.prototype.checkLoadInfo=function(e){var t=this;if(t.loadPool.length>0)for(var i=0;i<t.loadPool.length;++i){var n=t.loadPool[i];if(n.url===e)return n}if(t.waitPool.length>0)for(var i=0;i<t.waitPool.length;++i){var n=t.waitPool[i];if(n.url===e)return n}return null},Object.defineProperty(n.prototype,"maxLoadNum",{get:function(){return this.maxLoadNum},set:function(e){this.maxLoadNum=e},enumerable:!1,configurable:!0}),n.prototype.resLoad=function(e,n,o,r,a,s,l,h){void 0===n&&(n=null),void 0===a&&(a="GET"),void 0===s&&(s=null),void 0===l&&(l=!1),void 0===h&&(h=null);var c=new t.LoadInfo;return c.url=e,c.callBack=o,c.funObj=r,c.responseType=s,i.prototype.load.call(this,e,n,c,a,s,l),c},n.prototype.resGroupLoad=function(e,n,o,r,a,s,l,h,c){void 0===e&&(e=[]),void 0===o&&(o=null),void 0===s&&(s="GET"),void 0===l&&(l=""),void 0===h&&(h=!1),void 0===c&&(c=null);var d=this;if(d.resGroupPool[n])return void console.log(n+":");var u=new t.ResGroup;u.groupName=n,u.callBack=r,u.funObj=a,d.resGroupPool[n]=u;for(var p=0;p<e.length;++p)if(""!=e[p]){var f=d.typeSelector(e[p]),g=l;(f==t.TYPE_IMAGE||f==t.TYPE_SOUND||f==t.TYPE_BIN)&&(g="arraybuffer");var _=new t.LoadInfo;_.url=e[p],_.callBack=r,_.funObj=a,_.responseType=g,_.resGroup=u,u.loadInfoArray.push(_),u.resNum+=1,i.prototype.load.call(this,e[p],o,_,s,g,h)}},n.prototype.loadFinishCall=function(e){var t=this,i=e.loadInfo,n=i.url,o=t.typeSelector(n),r=t.decodeFunction(o);r?r.call(t,i):console.log(""+n)},n.prototype.decodePackageRes=function(i){var n=this,o=new t.ResGroup;o.groupName=i.url,o.callBack=i.callBack,o.funObj=i.funObj,n.resGroupPool[o.groupName]=o;var r=i.loader.response,a=new egret.ByteArray(r);a.position=0,a.endian=egret.Endian.LITTLE_ENDIAN;var s=a.readUnsignedShort();o.resNum=s;for(var l=0;s>l;++l){a.endian=egret.Endian.LITTLE_ENDIAN;var h=a.readUnsignedShort(),c=a.readUnsignedInt();a.endian=egret.Endian.BIG_ENDIAN;var d=a.readUTFBytes(h);console.log(d);var u=new egret.ByteArray;a.readBytes(u,0,c);var p=new t.LoadInfo;p.url=d,p.callBack=i.callBack,p.funObj=i.funObj,p.resGroup=o,p.loader=new e.HttpLoader;var f=void 0,g=n.typeSelector(d);g==t.TYPE_IMAGE||g==t.TYPE_SOUND||g==t.TYPE_BIN?(f="arraybuffer",p.buffer=u.buffer):p.buffer=u.readUTFBytes(c),p.responseType=f,o.loadInfoArray.push(p);var _=n.decodeFunction(g);_?_.call(n,p):console.log(""+d)}},n.prototype.decodeIMAGE=function(e){var i=this,n=e.loader.response||e.buffer;egret.BitmapData.create("arraybuffer",n,function(o){var r=new egret.Texture;r._setBitmapData(o);var a=t.ResObject.getResObject();a.pathKey=e.url,a.type=t.TYPE_IMAGE,a.res=r,a.buffer=n,i.setRes(a.pathKey,a,e)})},n.prototype.decodeSOUND=function(e){function i(){var i=t.ResObject.getResObject();i.pathKey=e.url,i.type=t.TYPE_SOUND,i.res=r,i.buffer=o,n.setRes(i.pathKey,i,e)}var n=this,o=e.loader.response||e.buffer,r=new egret.Sound,a=new File([o],""),s=window.URL.createObjectURL(a);r.load(s),r.once(egret.Event.COMPLETE,i,n),r.once(egret.IOErrorEvent.IO_ERROR,i,n)},n.prototype.base64ToBlob=function(e,t){for(var i="data:application/"+t+";base64,",n=i+e,o=n.split(","),r=o[0].match(/:(.*?);/),a=(r&&r.length>1?r[1]:t)||t,s=window.atob(o[1]),l=new ArrayBuffer(s.length),h=new Uint8Array(l),c=0;c<s.length;c++)h[c]=s.charCodeAt(c);return new Blob([l],{type:a})},n.prototype.decodeXML=function(e){var i=this,n=e.loader.response||e.buffer,o=egret.XML.parse(n),r=t.ResObject.getResObject();r.pathKey=e.url,r.type=t.TYPE_XML,r.res=o,r.buffer=n,i.setRes(r.pathKey,r,e)},n.prototype.decodeJSON=function(e){var i=this,n=e.loader.response||e.buffer,o=JSON.parse(n),r=t.ResObject.getResObject();r.pathKey=e.url,r.type=t.TYPE_JSON,r.res=o,r.buffer=n,i.setRes(r.pathKey,r,e)},n.prototype.decodeTEXT=function(e){var i=this,n=e.loader.response||e.buffer,o=JSON.parse(n),r=t.ResObject.getResObject();r.pathKey=e.url,r.type=t.TYPE_TEXT,r.res=o,r.buffer=n,i.setRes(r.pathKey,r,e)},n.prototype.decodeFONT=function(){},n.prototype.decodeBIN=function(e){var i=this,n=e.loader.response||e.buffer,o=t.ResObject.getResObject();o.pathKey=e.url,o.type=t.TYPE_BIN,o.res=n,o.buffer=n,i.setRes(o.pathKey,o,e)},n.prototype.decodeATLAS=function(e){var i=this,n=e.loader.response||e.buffer,o=t.ResObject.getResObject();o.pathKey=e.url,o.type=t.TYPE_ATLAS,o.res=n,o.buffer=n,i.setRes(o.pathKey,o,e)},n.prototype.decodeMovieClip=function(e){var t=this,i=JSON.parse(e),n=i.file,o=t.getTexture(n);new egret.MovieClipDataFactory(i,o)},n.prototype.setRes=function(e,t,i){void 0===i&&(i=null);var n=this;n.resDic[e]&&n.resDic[e].clear(),n.resDic[e]=t,i&&(console.log(":"+i.url),i.resGroup?(i.resGroup.resNum-=1,i.resGroup.resNum<=0&&(console.log(":"+i.resGroup.groupName),i.resGroup.status=1,i.resGroup.callBack&&i.resGroup.callBack.call(i.resGroup.funObj,i.resGroup))):i&&i.callBack&&i.callBack.call(i.funObj,i))},n.prototype.getRes=function(e,i){void 0===i&&(i=null);var n=this;void 0===i&&(i=null);var o;if(null==i)o=n.resDic[e];else{if(e=i+"$"+e,o=n.resDic[e],null==o){var r=void 0,a=void 0;if(a=n.resDic[i],a&&null==a.param){var s=n.getRes(i.replace(".png",".json"));if(s){a.param={sheet:new egret.SpriteSheet(a.res),json:s,subRes:[]},r=a.param.sheet;var l=s.res,h=l.frames;for(var c in h){var d=h[c],u=r.createTexture(c,d.x,d.y,d.w,d.h,d.offX,d.offY,d.sourceW,d.sourceH);if(d.scale9grid){var p=d.scale9grid,f=p.split(",");u.scale9Grid=new egret.Rectangle(parseInt(f[0]),parseInt(f[1]),parseInt(f[2]),parseInt(f[3]))}var g=t.ResObject.getResObject();g.res=u,g.pathKey=i+"$"+c,g.type=t.TYPE_IMAGE,a.param.subRes.push(g),n.setRes(g.pathKey,g)}}}}o=n.resDic[e]}return o},n.prototype.getResData=function(e,t){void 0===t&&(t=null)},n.prototype.getTexture=function(e){var t=this,i=t.getRes(e).res;return i},n.prototype.typeSelector=function(e){var i,n=e.substr(e.lastIndexOf(".")+1);switch(n){case t.TYPE_XML:case t.TYPE_JSON:case t.TYPE_SHEET:i=n;break;case"png":case"jpg":case"gif":case"jpeg":case"bmp":i=t.TYPE_IMAGE;break;case"fnt":i=t.TYPE_FONT;break;case"txt":i=t.TYPE_TEXT;break;case"mp3":case"ogg":case"mpeg":case"wav":case"m4a":case"mp4":case"aiff":case"wma":case"mid":i=t.TYPE_SOUND;break;case"mergeJson":case"zip":case"pvr":i=n;break;case"ttf":i=t.TYPE_TTF;break;case"atlas":i=t.TYPE_ATLAS;break;case"pkg":i=t.TYPE_PKG;break;default:i=t.TYPE_BIN}return i},n.prototype.decodeFunction=function(e){var t=this,i={image:t.decodeIMAGE,json:t.decodeJSON,text:t.decodeTEXT,xml:t.decodeXML,font:t.decodeFONT,bin:t.decodeBIN,sound:t.decodeSOUND,movieclip:t.decodeMovieClip,atlas:t.decodeATLAS,pkg:t.decodePackageRes};return i[e]},n.loadHashCode=1,n}(e.Loader);e.ResLoader=i,__reflect(i.prototype,"codeBase.ResLoader",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){this.METHOD_DEF={},this.EVENT_DEF=[],this.initWeekListener()}return e.prototype.initWeekListener=function(){},e.prototype.addHandleEvent=function(e,t){this.EVENT_DEF.indexOf(e)<0&&(this.EVENT_DEF.push(e),this.METHOD_DEF[e]=t)},e.prototype.addHandlePacket=function(e,t){this.METHOD_DEF[""+e]=t},e.prototype.receivePacket=function(e){this.METHOD_DEF.hasOwnProperty(""+e.header.messageId)&&this["onPacket"+this.METHOD_DEF[""+e.header.messageId]].call(this,e)},e.prototype.receiveEvent=function(e){this.EVENT_DEF.indexOf(e.type)>=0&&this.METHOD_DEF.hasOwnProperty(e.type)&&this["onEvent"+this.METHOD_DEF[e.type]].call(this,e)},e}();e.BaseHandle=t,__reflect(t.prototype,"codeBase.BaseHandle",["IHandle"])}(i||(i={})),window.codeBase=i},function(e,t){var i=window.codeBase;window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){}return e.addHandle=function(t){null!=t&&e._handles.indexOf(t)<0&&e._handles.push(t)},e.addEvent=function(t){e._eventHandles.indexOf(t)<0&&e._eventHandles.push(t)},e.receiveEvent=function(e){},e.receivePacket=function(t){var i=0;for(i=0;i<e._handles.length;i++)e._handles[i].receivePacket(t)},e._handles=[],e._eventHandles=[],e}();e.MessageControler=t,__reflect(t.prototype,"codeBase.MessageControler",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t,t=window.easyP2;!function(e){var t=function(){function e(){}return e.createBitmapByName=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t.anchorOffsetX=.5*t.width,t.anchorOffsetY=.5*t.height,t},e.createBall=function(e){var t=new egret.Shape;return t.graphics.lineStyle(1,0),t.graphics.beginFill(16773120),t.graphics.drawCircle(e,e,e),t.graphics.moveTo(e,e),t.graphics.lineTo(2*e,e),t.graphics.endFill(),t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t},e.createBox=function(e,t){console.log("createBox "+e+","+t);var i=new egret.Shape;return i.graphics.lineStyle(1,0),i.graphics.beginFill(16773120),i.graphics.drawRect(0,0,e,t),i.graphics.endFill(),i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i},e.createCapsule=function(e,t){console.log("createCapsule len:"+e+",radius:"+t);var i=new egret.Sprite,n=new egret.Shape;n.graphics.lineStyle(1,0),n.graphics.beginFill(16773120),n.graphics.drawCircle(0,t,t),n.graphics.endFill(),n.graphics.beginFill(16773120),n.graphics.drawCircle(e,t,t),n.graphics.endFill(),n.graphics.beginFill(16773120),n.graphics.drawRect(0,0,e,2*t),n.graphics.endFill();var o=n.getBounds();return n.x=-o.x,n.y=-o.y,i.addChild(n),i.anchorOffsetX=.5*i.width,i.anchorOffsetY=.5*i.height,i},e.createPolygon=function(e){var t,i=new egret.Sprite,n=new egret.Shape;for(n.graphics.lineStyle(1,255),t=0;t<e.length;t++){var o=e[t];n.graphics.moveTo(o[0],o[1]);var r=e[(t+1)%e.length];n.graphics.lineTo(r[0],r[1])}var a=n.getBounds();return n.x=-a.x,n.y=-a.y,i.addChild(n),i},e.createHeightField=function(e){var t,i=new egret.Sprite,n=new egret.Shape;for(n.graphics.lineStyle(1,255),t=0;t<e.length-1;t++){var o=e[t];n.graphics.moveTo(o[0],o[1]);var r=e[(t+1)%e.length];n.graphics.lineTo(r[0],r[1])}var a=n.getBounds();return n.x=-a.x,n.y=-a.y,i.addChild(n),i.anchorOffsetX=-a.x,i.anchorOffsetY=-a.y,i
},e.createTouchTf=function(e,t,i,n,o){var r=new egret.TextField;return r.width=i,r.height=n,r.x=e,r.y=t,r.size=16,r.text=o,r.touchEnabled=!0,r},e}();e.DispUtil=t,__reflect(t.prototype,"codeBase.easyP2.DispUtil",[])}(t=e.easyP2||(e.easyP2={})),window.easyP2=t}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t,t=window.easyP2;!function(e){var t=function(){function e(){}return e.init=function(){var e=this;this.dictKeyDn={},document.onkeydown=function(t){e.onkeydown(t)},document.onkeyup=function(t){e.onkeyup(t)}},e.isDown=function(e){return this.dictKeyDn[e]&&1==this.dictKeyDn[e]},e.onkeydown=function(e){var t=window.event?e.keyCode:e.which;this.dictKeyDn[t]=!0},e.onkeyup=function(e){var t=window.event?e.keyCode:e.which;this.dictKeyDn[t]=!1},e.Shift_L=16,e.Ctrl_L=17,e.Alt_L=18,e.UP=38,e.DOWN=40,e.LEFT=37,e.RIGHT=39,e.W=87,e.S=83,e.A=65,e.D=68,e.SPACE=32,e}();e.KeyManager=t,__reflect(t.prototype,"codeBase.easyP2.KeyManager",[])}(t=e.easyP2||(e.easyP2={})),window.easyP2=t}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function i(i,n,o,r){void 0===r&&(r=!0);var a=t.call(this)||this;return a.stage=i,a.world=o,a.sceneCtn=n,r?(a.mouseBody=e.easyP2.P2Space.addOneBox(a.world,a.sceneCtn,400,400,20,20,0,p2.Body.KINEMATIC),a.mouseBody.shapes[0].collisionMask=0):a.mouseBody=new p2.Body,a.mouseBody.allowSleep=!1,a.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,a.onStageTouchBegin,a),a.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,a.onStageTouchMove,a),a.stage.addEventListener(egret.TouchEvent.TOUCH_END,a.onStageTouchEnd,a),a}return __extends(i,t),i.prototype.onStageTouchBegin=function(t){for(var i=0;i<this.sceneCtn.numChildren;i++){var n=this.sceneCtn.getChildAt(i);if(n.hitTestPoint(t.stageX,t.stageY,!0)){console.log("hit disp");var o=this.getDispP2Body(n);if(o==this.mouseBody)return;if(null==o)return;if(console.log("hit bodyType:"+o.type),o.type==p2.Body.DYNAMIC){o.wakeUp();var r=e.easyP2.P2Space.convertEgretValueToP2(t.stageX),a=e.easyP2.P2Space.convertEgretY_To_P2Y(t.stageY);this.mouseBody.position[0]=r,this.mouseBody.position[1]=a,this.mouseConstraint&&(this.world.removeConstraint(this.mouseConstraint),this.mouseConstraint.bodyA=null,this.mouseConstraint.bodyB=null,this.mouseConstraint=null),this.mouseConstraint=new p2.RevoluteConstraint(this.mouseBody,o,{worldPivot:[r,a]}),this.world.addConstraint(this.mouseConstraint),this.mouseBody.displays&&this.sceneCtn.addChild(this.mouseBody.displays[0])}}}},i.prototype.onStageTouchMove=function(t){if(this.mouseConstraint){var i=e.easyP2.P2Space.convertEgretValueToP2(t.stageX),n=e.easyP2.P2Space.convertEgretY_To_P2Y(t.stageY);this.mouseBody.position[0]=i,this.mouseBody.position[1]=n}},i.prototype.onStageTouchEnd=function(e){this.mouseConstraint&&(this.world.removeConstraint(this.mouseConstraint),this.mouseConstraint.bodyA=null,this.mouseConstraint.bodyB=null,this.mouseConstraint=null)},i.prototype.getDispP2Body=function(e){for(var t,i=0;i<this.world.bodies.length;i++)if(null!=this.world.bodies[i].displays&&this.world.bodies[i].displays[0]==e){t=this.world.bodies[i];break}return t},i}(egret.EventDispatcher);e.MouseJointHelper=t,__reflect(t.prototype,"codeBase.MouseJointHelper",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t,t=window.easyP2;!function(e){var t=function(){function e(){}return e.bodyType_static="static",e.bodyType_dynamic="dynamic",e.bodyType_kinamic="kinamic",e.bodyConnType_ranumber="bodyConnType_ranumber",e.bodyConnType_spring="bodyConnType_spring",e.rigidBodyType_body="body",e.rigidBodyType_concave="concave",e.rigidBodyType_forceField="forceField",e.rigidBodyType_heightField="heightField",e.rigidBodyType_waterField="waterField",e.shapeType_box="shapeType_box",e.shapeType_circle="shapeType_circle",e.shapeType_capsule="shapeType_capsule",e.constraintType_distance="distance",e.constraintType_gear="gear",e.constraintType_lock="lock",e.constraintType_prismatic="prismatic",e.constraintType_revolute="revolute",e.springType_liner="liner",e.springType_rotational="rotational",e}();e.P2Constants=t,__reflect(t.prototype,"codeBase.easyP2.P2Constants",[])}(t=e.easyP2||(e.easyP2={})),window.easyP2=t}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(t,i,n,o){void 0===o&&(o=!0),this.stage=t,this.world=n,this.sceneCtn=i,o?(this.mouseBody=e.easyP2.P2Space.addOneBox(this.world,this.sceneCtn,400,400,20,20,0,p2.Body.KINEMATIC),this.mouseBody.shapes[0].collisionMask=0):this.mouseBody=new p2.Body,this.mouseBody.allowSleep=!1,this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onStageTouchBegin,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onStageTouchMove,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this)}return t.prototype.onStageTouchBegin=function(t){this.clearConstraint();var i=e.easyP2.P2Space.convertEgretValueToP2(t.stageX),n=e.easyP2.P2Space.convertEgretY_To_P2Y(t.stageY),o=this.world.hitTest([i,n],this.world.bodies,5);if(o.length){var r=o[0];this.mouseBody.position[0]=i,this.mouseBody.position[1]=n,this.mouseConstraint=new p2.RevoluteConstraint(this.mouseBody,r,{worldPivot:[i,n]}),this.mouseConstraint.collideConnected=!1,this.world.addConstraint(this.mouseConstraint)}},t.prototype.onStageTouchMove=function(t){if(this.mouseConstraint){var i=e.easyP2.P2Space.convertEgretValueToP2(t.stageX),n=e.easyP2.P2Space.convertEgretY_To_P2Y(t.stageY);this.mouseBody.position[0]=i,this.mouseBody.position[1]=n}},t.prototype.onStageTouchEnd=function(e){this.clearConstraint()},t.prototype.clearConstraint=function(){this.mouseConstraint&&(this.world.removeConstraint(this.mouseConstraint),this.mouseConstraint.bodyA=null,this.mouseConstraint.bodyB=null,this.mouseConstraint=null)},t}();e.P2MouseJointHelper=t,__reflect(t.prototype,"codeBase.P2MouseJointHelper",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t,t=window.easyP2;!function(e){var t=function(){function t(){}return t.checkIfCanJump=function(e,t){for(var i=!1,n=0;n<e.narrowphase.contactEquations.length;n++){var o=e.narrowphase.contactEquations[n];if(o.bodyA===t||o.bodyB===t){var r=p2.vec2.dot(o.normalA,this.yAxis);o.bodyA===t&&(r*=-1),r>.5&&(i=!0)}}return i},t.updateBodySkin=function(e){if(null!=e.displays&&0!=e.displays.length){var t;if(e.concavePath)t=e.displays[0],t.x=this.convertP2ValueToEgret(e.position[0]),t.y=this.convertP2Y_To_EgretY(e.position[1]),t.rotation=this.convertP2BodyAngleToEgret(e);else if(e.shapes&&e.shapes[0]instanceof p2.Heightfield);else for(var i=0;i<e.displays.length;i++)if(t=e.displays[i]){var n=[0,0];e.toWorldFrame(n,e.shapes[i].position),t.x=this.convertP2ValueToEgret(n[0]),t.y=this.convertP2Y_To_EgretY(n[1]),t.rotation=360-180*(e.angle+e.shapes[i].angle)/Math.PI}}},t.convertP2ValueToEgret=function(e){return e*this.factor},t.convertEgretValueToP2=function(e){return e/this.factor},t.convertEgretY_To_P2Y=function(e){return(this.worldRect.height-e)/this.factor},t.convertP2Y_To_EgretY=function(e){return this.worldRect.height-e*this.factor},t.convertEgretPosToP2=function(e,t){return[e/this.factor,(this.worldRect.height-t)/this.factor]},t.convertBodyPosToEgret=function(e){var t=e.position[0],i=e.position[1];return[t*this.factor,this.worldRect.height-i*this.factor]},t.convertP2BodyAngleToEgret=function(e){var t;return t=360-180*e.angle/Math.PI},t.convertEgretAngleToP2=function(e){var t;return t=(360-e)*Math.PI/180},t.getConcaveEgretRect=function(e){var i=t.getConcaveP2Rect(e),n=t.getYAxisMirroredRect(i);return n.left=n.left*this.factor,n.top=n.top*this.factor,n.width=n.width*this.factor,n.height=n.height*this.factor,n},t.getConcaveP2Rect=function(e){var i,n=e.concavePath;return i=t.getRectFromPathPts(n)},t.getRectFromPathPts=function(e){for(var t,i=new egret.Rectangle,n=e.length,o=0;n>o;o++)t=e[o],t[0]<i.left&&(i.left=t[0]),t[0]>i.right&&(i.right=t[0]),t[1]<i.top&&(i.top=t[1]),t[1]>i.bottom&&(i.bottom=t[1]);return i},t.getYAxisMirroredRect=function(e){var t=new egret.Rectangle;return t.left=e.left,t.right=e.right,t.bottom=-e.top,t.top=-e.bottom,t},t.initSpace=function(e,t){this.factor=e,this.worldRect=t},t.addOneBox=function(t,i,n,o,r,a,s,l,h){void 0===h&&(h=null);var c=e.P2Space.convertEgretValueToP2(n),d=e.P2Space.convertEgretY_To_P2Y(o),u=e.P2Space.convertEgretValueToP2(r),p=e.P2Space.convertEgretValueToP2(a),f=e.P2Space.convertEgretAngleToP2(s),g=new p2.Box({width:u,height:p}),_=new p2.Body({mass:1,position:[c,d],angle:f});_.type=l,_.addShape(g),t.addBody(_);var v=[];if(h){for(var y=0;y<h.length;++y)h[y].anchorOffsetX=h[y].width/2,h[y].anchorOffsetY=h[y].height/2;_.displays=h}else v[0]=e.DispUtil.createBox(r,a),_.displays=v;for(var y=0;y<_.displays.length;++y)i.addChild(_.displays[y]);return _},t.addOneCapsule=function(t,i,n,o,r,a,s,l){var h,c=e.P2Space.convertEgretValueToP2(n),d=e.P2Space.convertEgretY_To_P2Y(o),u=e.P2Space.convertEgretValueToP2(r),p=e.P2Space.convertEgretValueToP2(a),f=e.P2Space.convertEgretAngleToP2(s),g=new p2.Capsule({length:u,radius:p}),_=new p2.Body({mass:1,position:[c,d],angle:f});return _.type=l,_.addShape(g),t.addBody(_),h=e.DispUtil.createCapsule(r,a),_.displays=[h],i.addChild(h),_},t.addOneBall=function(t,i,n,o,r,a,s,l){void 0===l&&(l=[]);var h=e.P2Space.convertEgretValueToP2(n),c=e.P2Space.convertEgretY_To_P2Y(o),d=e.P2Space.convertEgretValueToP2(r),u=e.P2Space.convertEgretAngleToP2(a),p=new p2.Circle({radius:d}),f=new p2.Body({mass:1,position:[h,c],angle:u});f.type=s,f.addShape(p),t.addBody(f);var g=[];if(l){for(var _=0;_<l.length;++_)l[_].anchorOffsetX=l[_].width/2,l[_].anchorOffsetY=l[_].height/2;f.displays=l}else g[0]=e.DispUtil.createBall(r),f.displays=g;for(var _=0;_<f.displays.length;++_)i.addChild(f.displays[_]);return f},t.updateWorldBodiesSkin=function(t){for(var i=(egret.MainContext.instance.stage.stageHeight,t.bodies.length),n=0;i>n;n++){var o=t.bodies[n];if(e.P2Space.updateBodySkin(o),null!=o.displays&&0!=o.displays.length)for(var r=0;r<o.displays.length;r++){var a=o.displays[r];o.sleepState==p2.Body.SLEEPING?a.alpha=.5:a.alpha=1}}},t.yAxis=p2.vec2.fromValues(0,1),t}();e.P2Space=t,__reflect(t.prototype,"codeBase.easyP2.P2Space",[])}(t=e.easyP2||(e.easyP2={})),window.easyP2=t}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t,t=window.easyP2;!function(e){var t=function(){function t(t,i){this.factor=50,this.stage=t,this.dispCtn=i,e.P2Space.initSpace(this.factor,new egret.Rectangle(0,0,this.stage.stageWidth,this.stage.stageHeight)),this.world=new p2.World,this.world.gravity=[0,-20],egret.Ticker.getInstance().register(this.p2RunStep,this),this.dummyBody=new p2.Body,this.world.addBody(this.dummyBody),this.world.on("beginContact",this.onBeginContact,this)}return t.prototype.p2RunStep=function(t){10>t||t>1e3||(this.world.step(t/1e3),e.P2Space.updateWorldBodiesSkin(this.world))},t.prototype.createGround=function(){var e=new p2.Plane,t=new p2.Body;t.type=p2.Body.STATIC,t.addShape(e),t.displays=[],this.world.addBody(t)},t.prototype.onBeginContact=function(e){var t=e.bodyA,i=e.bodyB;console.log(t.id),console.log(i.id)},t.prototype.onEndContact=function(e){e.bodyA,e.bodyB},t}();e.SimpleP2Scene=t,__reflect(t.prototype,"codeBase.easyP2.SimpleP2Scene",[])}(t=e.easyP2||(e.easyP2={})),window.easyP2=t}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.dirH_touch=0,e.dirV_touch=0,e.jump_touch=0,e.dirH_keyboard=0,e.dirV_keyboard=0,e.jump_keyboard=0,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddedStage,e),e}return __extends(i,t),i.prototype.onAddedStage=function(t){this.setupUI(),e.easyP2.KeyManager.init(),egret.Ticker.getInstance().register(this.update,this)},i.prototype.setupUI=function(){this.btnHor=e.easyP2.DispUtil.createBitmapByName("rect"),this.btnHor.x=.5*this.btnHor.width,this.btnHor.y=.5*this.btnHor.height+100,this.btnHor.touchEnabled=!0,this.addChild(this.btnHor),this.btnHor.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBtnHorTouchBegin,this),this.btnHor.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onBtnHorTouchMove,this),this.btnHor.addEventListener(egret.TouchEvent.TOUCH_END,this.onBtnHorTouchEnd,this),this.btnHor.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onBtnHorTouchEnd,this),this.btnVer=e.easyP2.DispUtil.createBitmapByName("rect"),this.btnVer.x=this.stage.stageWidth-.5*this.btnHor.width,this.btnVer.y=.5*this.btnVer.height+100,this.btnVer.touchEnabled=!0,this.addChild(this.btnVer),this.btnVer.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBtnVerTouchBegin,this),this.btnVer.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onBtnVerTouchMove,this),this.btnVer.addEventListener(egret.TouchEvent.TOUCH_END,this.onBtnVerTouchEnd,this),this.btnVer.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onBtnVerTouchEnd,this),this.btnJump=e.easyP2.DispUtil.createBitmapByName("rect"),this.btnJump.x=.5*this.btnHor.width,this.btnJump.y=this.btnHor.y+this.btnHor.height+100,this.btnJump.touchEnabled=!0,this.addChild(this.btnJump),this.btnJump.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBtnJumpTouchBegin,this),this.btnJump.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onBtnJumpTouchMove,this),this.btnJump.addEventListener(egret.TouchEvent.TOUCH_END,this.onBtnJumpTouchEnd,this),this.btnJump.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onBtnJumpTouchEnd,this)},i.prototype.onBtnJumpTouchBegin=function(e){this.jump_touch=1},i.prototype.onBtnJumpTouchMove=function(e){this.jump_touch=1},i.prototype.onBtnJumpTouchEnd=function(e){this.jump_touch=0},i.prototype.onBtnHorTouchBegin=function(e){this.updateDirHorizontalValue(e.stageX,e.stageY)},i.prototype.onBtnHorTouchMove=function(e){this.updateDirHorizontalValue(e.stageX,e.stageY)},i.prototype.onBtnHorTouchEnd=function(e){this.dirH_touch=0},i.prototype.updateDirHorizontalValue=function(e,t){var i=this.btnHor.globalToLocal(e,t);i.x>.5*this.btnHor.width?this.dirH_touch=1:this.dirH_touch=-1},i.prototype.onBtnVerTouchBegin=function(e){this.updateDirVerzontalValue(e.stageX,e.stageY)},i.prototype.onBtnVerTouchMove=function(e){this.updateDirVerzontalValue(e.stageY,e.stageY)},i.prototype.onBtnVerTouchEnd=function(e){this.dirV_touch=0},i.prototype.updateDirVerzontalValue=function(e,t){var i=this.btnVer.globalToLocal(e,t);i.y>.5*this.btnVer.height?this.dirV_touch=-1:this.dirV_touch=1},i.prototype.update=function(){e.easyP2.KeyManager.isDown(e.easyP2.KeyManager.UP)?this.dirV_keyboard=1:e.easyP2.KeyManager.isDown(e.easyP2.KeyManager.DOWN)?this.dirV_keyboard=-1:this.dirV_keyboard=0,e.easyP2.KeyManager.isDown(e.easyP2.KeyManager.LEFT)?this.dirH_keyboard=-1:e.easyP2.KeyManager.isDown(e.easyP2.KeyManager.RIGHT)?this.dirH_keyboard=1:this.dirH_keyboard=0,e.easyP2.KeyManager.isDown(e.easyP2.KeyManager.SPACE)?this.jump_keyboard=1:this.jump_keyboard=0;var t;0!=this.dirV_touch&&(t=this.dirV_touch),0!=this.dirV_keyboard&&(t=this.dirV_keyboard);var i;0!=this.dirH_touch&&(i=this.dirH_touch),0!=this.dirH_keyboard&&(i=this.dirH_keyboard);var n;0!=this.jump_touch&&(n=this.jump_touch),0!=this.jump_keyboard&&(n=this.jump_keyboard),null!=this.vehicle&&(this.vehicle.updateSteering(i,t),1==n&&this.vehicle.jump&&this.vehicle.jump())},i}(egret.Sprite);e.VehicleSteeringCtrl=t,__reflect(t.prototype,"codeBase.VehicleSteeringCtrl",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){this.messageId=0,this.code=0}return e}();e.DefaultHeader=t,__reflect(t.prototype,"codeBase.DefaultHeader",["IHeader"])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(){}return t.initPacketDefine=function(i){var n=new i;e.EventManager.releasePacket(n),t.setPacketDefine(n.header.messageId,n.clientSide,i)},t.setPacketDefine=function(e,i,n){t.packetDefineDic[(i?"c_":"s_")+e]=n},t.createPacket=function(i,n){e.Debug.log="header->packet:"+i;var o=t.packetDefineDic[(n?"c_":"s_")+i];if(o){var r=new o;return r.header.messageId=i,e.Debug.log="header->packet:"+egret.getQualifiedClassName(r),r}return e.Debug.log="header->packet:NULL",null},t.removePacketDefine=function(e,i){void 0===i&&(i=!0),delete t.packetDefineDic[e+"_"+(i?0:1)]},t.headerClientClz=e.DefaultHeader,t.headerClientLength=6,t.headerServerClz=e.DefaultHeader,t.headerServerLength=6,t.packetDefineDic={},t}();e.PacketFactory=t,__reflect(t.prototype,"codeBase.PacketFactory",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(){this._isWebSocket=!1,this.host=null,this.port=0,this._webSocket=null,this.rawByteArrayCache=new Array,this.packetByteArrayCache=new Array,this.packetSendCache=new Array,this.decodeClass=e.DefaultDecoder,this.encodeClass=e.DefaultEncoder,this.loginPkt=null,this.autoConnectDuration=0,this._byteRawBuffer=null,this._byteWaitBuffer=null,this._byteWaitReadLength=!1}return t.getInstance=function(){return null==t._instance&&(t._instance=new e.WebSocket),t._instance},t.prototype.send=function(t){t&&(this.autoConnect(),this.packetSendCache.push(t),e.HeartBeat.addListener(this,this.checkPacketByteArray))},t.prototype.autoConnect=function(){this.port>0&&!this.isConnected()&&null!=this.loginPkt&&this.connect(this.host,this.port)},t.prototype.autoRelogin=function(){if(this.isConnected()&&null!=this.loginPkt){this.packetSendCache.unshift(this.loginPkt);var t=e.ObjectPool.getByClass(this.encodeClass),i=t.encoder(this.loginPkt);e.ObjectPool.recycleClass(t),this._webSocket.writeBytes(i,0,i.length),this._webSocket.flush(),i.clear(),e.ObjectPool.recycleClass(i),this.autoConnectDuration=180}},t.prototype.connect=function(t,i,n){return void 0===n&&(n=!0),this._isWebSocket=n,e.Debug.log="@host"+t+", port="+i,this.host=t,this.port=i,this.port<=0||!e.StringUtil.isUsage(this.host)?void(e.Debug.log="[ERROR] port="+this.port+", host="+this.host+",,!"):void(this._isWebSocket?this.connetWebSockt():this.connetSockt())},t.prototype.connetWebSockt=function(){this.closeWebSocketListener(),this._webSocket=new egret.WebSocket,this._webSocket.type=egret.WebSocket.TYPE_BINARY,this._webSocket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onEventWebSocketProgressSocketDataHandler,this),this._webSocket.addEventListener(egret.Event.CONNECT,this.onEventWebSocketConnectHandler,this),this._webSocket.addEventListener(egret.Event.CLOSE,this.onEventWebSocketCloseHandler,this),this._webSocket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onEventWebSocketErrorHandler,this),this._webSocket.connect(this.host,this.port)},t.prototype.onEventWebSocketCloseHandler=function(t){e.MyEvent.sendEvent(e.EventType.SOCKET_DISCONNECT),e.Debug.log="Socket close:"+t.type,this.close()},t.prototype.onEventWebSocketErrorHandler=function(t){e.MyEvent.sendEvent(e.EventType.SOCKET_DISCONNECT_ERROR),e.Debug.log="Socket error:"+t.type},t.prototype.closeWebSocketListener=function(){this._webSocket&&(this._webSocket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onEventWebSocketProgressSocketDataHandler,this),this._webSocket.removeEventListener(egret.Event.CONNECT,this.onEventWebSocketConnectHandler,this),this._webSocket.removeEventListener(egret.Event.CLOSE,this.onEventWebSocketCloseHandler,this),this._webSocket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onEventWebSocketErrorHandler,this),this._webSocket.connected&&this._webSocket.close(),this._webSocket=null)},t.prototype.connetSockt=function(){},t.prototype.onEventWebSocketConnectHandler=function(t){e.Debug.log="@@Socket!";var i=e.MyEvent.getEvent(e.EventType.SOCKET_CONNECT);i.addItem("host",this.host),i.addItem("port",this.port),i.send(),this.autoRelogin()},t.prototype.onEventWebSocketProgressSocketDataHandler=function(i){e.Debug.log="@@--"+egret.getTimer()+"@@---ProgressSocketData="+i,this._byteRawBuffer=null,this._byteRawBuffer=new egret.ByteArray,this._byteRawBuffer.endian=t.ENDIAN,this._webSocket&&this._webSocket.readBytes(this._byteRawBuffer),e.Debug.log="byte.len="+this._byteRawBuffer.length,e.Debug.log=e.HexUtil.dump(this._byteRawBuffer),this._byteRawBuffer.position=0,this.rawByteArrayCache.push(this._byteRawBuffer),e.HeartBeat.addListener(this,this.checkPacketByteArray)},t.prototype.isConnected=function(){return this._webSocket?this._webSocket.connected:!1},t.prototype.close=function(){this._isWebSocket&&this._webSocket&&this.closeWebSocketListener()},t.prototype.splitRawByte=function(){var i=0,n=this.rawByteArrayCache.length,o=null;for(i=0;n>i;i++){for(o=this.rawByteArrayCache.shift();o.bytesAvailable>0;)if(null!=this._byteWaitBuffer&&this._byteWaitReadLength){var r=this._byteWaitBuffer.bytesAvailable>o.bytesAvailable?o.bytesAvailable:this._byteWaitBuffer.bytesAvailable;o.readBytes(this._byteWaitBuffer,this._byteWaitBuffer.position,r),this._byteWaitBuffer.position+=r,this._byteWaitBuffer.length==this._byteWaitBuffer.position&&(this._byteWaitBuffer.position=2,e.Debug.log="--@@------="+this._byteWaitBuffer.length,e.Debug.log=e.HexUtil.dump(this._byteWaitBuffer),this.packetByteArrayCache.push(this._byteWaitBuffer),this._byteWaitBuffer=null,this._byteWaitReadLength=!1)}else null==this._byteWaitBuffer?(this._byteWaitBuffer=new egret.ByteArray,this._byteWaitBuffer.clear(),this._byteWaitBuffer.endian=t.ENDIAN,o.bytesAvailable>=2?(o.readBytes(this._byteWaitBuffer,0,2),this._byteWaitBuffer.position=0,this._byteWaitBuffer.length=this._byteWaitBuffer.readUnsignedShort()+e.PacketFactory.headerClientLength,this._byteWaitReadLength=!0):(this._byteWaitReadLength=!1,o.readBytes(this._byteWaitBuffer,0,o.bytesAvailable),this._byteWaitBuffer.length=o.bytesAvailable)):(this._byteWaitBuffer.length<2&&o.bytesAvailable>=1&&(this._byteWaitBuffer.position=this._byteWaitBuffer.length,o.readBytes(this._byteWaitBuffer,this._byteWaitBuffer.position,1)),2==this._byteWaitBuffer.length&&(this._byteWaitBuffer.position=0,this._byteWaitBuffer.length=this._byteWaitBuffer.readUnsignedShort()+e.PacketFactory.headerClientLength,this._byteWaitReadLength=!0));o.clear(),e.ObjectPool.recycleClass(o)}},t.prototype.checkPacketByteArray=function(){if(this.autoConnectDuration>0&&this.autoConnectDuration--,this.isConnected()&&0==this.autoConnectDuration)for(;this.packetSendCache.length>0;){var t=this.packetSendCache.shift(),i=e.ObjectPool.getByClass(this.encodeClass),n=i.encoder(t);e.ObjectPool.recycleClass(i),this._isWebSocket&&(this._webSocket.writeBytes(n,0,n.length),this._webSocket.flush()),e.Debug.log="@@--"+egret.getTimer()+"--@@- msgid="+t.header.messageId+",="+n.length+","+egret.getQualifiedClassName(t),e.Debug.log=e.HexUtil.dump(n),n.clear(),e.ObjectPool.recycleClass(n),e.EventManager.releasePacket(t)}for(this.splitRawByte();this.packetByteArrayCache.length>0;){var o=this.packetByteArrayCache.shift(),r=e.ObjectPool.getByClass(this.decodeClass),a=r.decode(o);o.clear(),e.ObjectPool.recycleClass(o),e.ObjectPool.recycleClass(r),e.EventManager.dispactchPacket(a)}0==this.packetByteArrayCache.length&&0==this.packetSendCache.length&&e.HeartBeat.removeListener(this,this.checkPacketByteArray)},t.ENDIAN=egret.Endian.BIG_ENDIAN,t._instance=null,t}();e.WebSocket=t,__reflect(t.prototype,"codeBase.WebSocket",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(){}return t.prototype.decode=function(t){var i=this.decodeMessageId(t),n=e.PacketFactory.createPacket(i,!1);return n&&t.bytesAvailable>0&&this.decodeHeader(t,n),n&&t.bytesAvailable>0&&this.decodeBody(t,n),n},t.prototype.decodeMessageId=function(e){var t=e.readUnsignedShort();return e.position=2,t},t.prototype.decodeHeader=function(e,t){t.clientSide?(t.header.messageId=e.readUnsignedShort(),t.header.code=e.readUnsignedShort()):(t.header.messageId=e.readUnsignedShort(),t.header.code=e.readUnsignedShort())},t.prototype.decodeBody=function(t,i){try{var n=0,o=i.define.length;for(n=0;o>n;n++)this.decodeItem(i.define[n],t,i)}catch(r){e.Debug.log="@--decodeError"+r.message}},t.prototype.readByte=function(e,t,i){i[e.id]=t.readByte()},t.prototype.readUByte=function(e,t,i){i[e.id]=t.readUnsignedByte()},t.prototype.readBoolean=function(e,t,i){var n=t.readUnsignedByte();i[e.id]=!1,1==n&&(i[e.id]=!0)},t.prototype.readUShort=function(e,t,i){i[e.id]=t.readUnsignedShort()},t.prototype.readShort=function(e,t,i){i[e.id]=t.readShort()},t.prototype.readUInt=function(e,t,i){i[e.id]=t.readUnsignedInt()},t.prototype.readInt=function(e,t,i){i[e.id]=t.readInt()},t.prototype.readUInt64=function(e,i,n){var o=0,r=0;r=i.readUnsignedInt(),o=i.readUnsignedInt(),n[e.id]=r*t.MATH_POW_2_32+o},t.prototype.readInt64=function(e,i,n){var o=0,r=0;r=i.readInt(),o=i.readUnsignedInt(),n[e.id]=r*t.MATH_POW_2_32+o},t.prototype.readFloat=function(e,t,i){i[e.id]=t.readFloat()},t.prototype.readUFloat=function(e,t,i){i[e.id]=t.readFloat()},t.prototype.readUDouble=function(e,i,n){var o=0,r=0;o=i.readUnsignedInt(),r=i.readUnsignedInt(),n[e.id]=r*t.MATH_POW_2_32+o},t.prototype.readDouble=function(e,i,n){var o=0,r=0;o=i.readUnsignedInt(),r=i.readInt(),n[e.id]=r*t.MATH_POW_2_32+o},t.prototype.readByteArray=function(t,i,n){var o=i.readUnsignedShort(),r=e.ObjectPool.getByClass(egret.ByteArray);o>0&&i.readBytes(r,0,o),n[t.id]=r},t.prototype.readString=function(e,t,i){i[e.id]=t.readUTF()},t.prototype.readArray=function(t,i,n){var o=0;e.Packet.TYPE_ARRAY_CONST==t.type?o=t.length:e.Packet.TYPE_ARRAY==t.type&&(o=i.readUnsignedShort()),n[t.id].length=0;var r=!1;r="string"==typeof t.entity?!1:!0;var a=0;if(r)for(a=0;o>a;a++)this.readEntityToArray(t,i,n[t.id]);else{var s=null;for(a=0;o>a;a++)s={},this.decodeItem({id:"value",type:e.Packet[t.entity]},i,s),n[t.id].push(s.value)}},t.prototype.readEntity=function(t,i,n){var o=e.ObjectPool.getByClass(t.entity),r=o.define,a=0;for(a=0;a<r.length;a++)this.decodeItem(r[a],i,o);n[t.id]=o},t.prototype.readEntityToArray=function(t,i,n){var o=e.ObjectPool.getByClass(t.entity),r=o.define,a=0;for(a=0;a<r.length;a++)this.decodeItem(r[a],i,o);n.push(o)},t.prototype.decodeItem=function(t,i,n){switch(t.type){case e.Packet.TYPE_BYTE:this.readByte(t,i,n);break;case e.Packet.TYPE_USHORT:this.readUShort(t,i,n);break;case e.Packet.TYPE_SHORT:this.readShort(t,i,n);break;case e.Packet.TYPE_UINT:this.readUInt(t,i,n);break;case e.Packet.TYPE_INT:this.readInt(t,i,n);break;case e.Packet.TYPE_INT64:this.readInt64(t,i,n);break;case e.Packet.TYPE_UINT64:this.readUInt64(t,i,n);break;case e.Packet.TYPE_FLOAT:this.readFloat(t,i,n);break;case e.Packet.TYPE_UFLOAT:this.readUFloat(t,i,n);break;case e.Packet.TYPE_DOUBLE:this.readDouble(t,i,n);break;case e.Packet.TYPE_UDOUBLE:this.readUDouble(t,i,n);break;case e.Packet.TYPE_BYTEARRAY:this.readByteArray(t,i,n);break;case e.Packet.TYPE_STRING:this.readString(t,i,n);break;case e.Packet.TYPE_BOOLEAN:this.readBoolean(t,i,n);break;case e.Packet.TYPE_ARRAY:case e.Packet.TYPE_ARRAY_CONST:this.readArray(t,i,n);break;case e.Packet.TYPE_ENTITY:this.readEntity(t,i,n)}e.Debug.log=t.id+"="+n[t.id]},t.MATH_POW_2_32=4294967296,t}();e.DefaultDecoder=t,__reflect(t.prototype,"codeBase.DefaultDecoder",["IDecoder"])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(){}return t.prototype.encoder=function(t){var i=this.encodeBody(t),n=this.encodeHeader(t,i.length);return n.writeBytes(i),i.clear(),e.ObjectPool.recycleClass(i),n},t.prototype.encodeHeader=function(t,i){var n=e.ObjectPool.getByClass(egret.ByteArray);return n.clear(),n.endian=e.WebSocket.ENDIAN,t.clientSide?(n.writeShort(i),n.writeShort(t.header.messageId),n.writeShort(t.header.code)):(n.writeShort(i),n.writeShort(t.header.messageId),n.writeShort(t.header.code)),n},t.prototype.encodeBody=function(t){var i=e.ObjectPool.getByClass(egret.ByteArray);i.clear(),i.endian=e.WebSocket.ENDIAN;var n=0,o=t.define.length;for(n=0;o>n;n++)e.Packet.TYPE_ENTITY==t.define[n].type?this.encodeItem(t.define[n],i,t[t.define[n].id]):this.encodeItem(t.define[n],i,t);return i},t.prototype.writeByte=function(e,t,i){t.writeByte(i[e.id])},t.prototype.writeUByte=function(e,t,i){t.writeByte(i[e.id])},t.prototype.writeBoolean=function(e,t,i){i[e.id]?t.writeByte(1):t.writeByte(0)},t.prototype.writeShort=function(e,t,i){t.writeShort(i[e.id])},t.prototype.writeUShort=function(e,t,i){t.writeShort(i[e.id])},t.prototype.writeInt=function(e,t,i){t.writeInt(i[e.id])},t.prototype.writeUInt=function(e,t,i){t.writeUnsignedInt(i[e.id])},t.prototype.writeUInt64=function(t,i,n){var o=n[t.id],r=parseInt(""+o),a=(o-r)/e.Packet.MATH_POW_2_32;i.writeUnsignedInt(a),i.writeUnsignedInt(r)},t.prototype.writeInt64=function(t,i,n){var o=n[t.id],r=parseInt(""+o),a=parseInt(""+(o-r)/e.Packet.MATH_POW_2_32);i.writeInt(a),i.writeUnsignedInt(r)},t.prototype.writeUFloat=function(e,t,i){t.writeFloat(i[e.id])},t.prototype.writeFloat=function(e,t,i){t.writeFloat(i[e.id])},t.prototype.writeUDouble=function(t,i,n){var o=n[t.id],r=parseInt(""+o),a=(o-r)/e.Packet.MATH_POW_2_32,s=e.ObjectPool.getByClass(egret.ByteArray);s.clear(),s.endian=e.WebSocket.ENDIAN,s.writeUnsignedInt(r),s.writeUnsignedInt(a),i.writeBytes(s,0,s.bytesAvailable),s.clear(),e.ObjectPool.recycleClass(s)},t.prototype.writeDouble=function(t,i,n){var o=n[t.id],r=parseInt(""+o),a=(o-r)/e.Packet.MATH_POW_2_32,s=e.ObjectPool.getByClass(egret.ByteArray);s.clear(),s.endian=e.WebSocket.ENDIAN,s.writeUnsignedInt(r),s.writeInt(a),i.writeBytes(s,0,s.bytesAvailable),s.clear(),e.ObjectPool.recycleClass(s)},t.prototype.writeString=function(e,t,i){t.writeUTF(null==i[e.id]?"":i[e.id])},t.prototype.writeByteArray=function(e,t,i){t.writeShort(i[e.id].length),i[e.id].length>0&&t.writeBytes(i[e.id])},t.prototype.writeArray=function(t,i,n){var o=n[t.id],r=o.length;e.Packet.TYPE_ARRAY_CONST==t.type&&(r=t.length),i.writeShort(r);var a=0,s=!1,l=null;for(s="string"==typeof t.entity?!1:!0,a=0;r>a;a++)s?this.writeEntity(t,i,o[a]):(l={},l.value=o[a],this.encodeItem({id:"value",type:e.Packet[t.entity]},i,l))},t.prototype.writeEntity=function(e,t,i){if(i){var n=i.define,o=0;for(o=0;o<n.length;o++)this.encodeItem(n[o],t,i)}},t.prototype.encodeItem=function(t,i,n){switch(t.type){case e.Packet.TYPE_BYTE:this.writeByte(t,i,n);break;case e.Packet.TYPE_SHORT:this.writeShort(t,i,n);break;case e.Packet.TYPE_USHORT:this.writeUShort(t,i,n);break;case e.Packet.TYPE_UINT:this.writeUInt(t,i,n);break;case e.Packet.TYPE_INT:this.writeInt(t,i,n);break;case e.Packet.TYPE_INT64:this.writeInt64(t,i,n);break;case e.Packet.TYPE_UINT64:this.writeUInt64(t,i,n);break;case e.Packet.TYPE_FLOAT:this.writeFloat(t,i,n);break;case e.Packet.TYPE_UFLOAT:this.writeUFloat(t,i,n);break;case e.Packet.TYPE_UDOUBLE:this.writeUDouble(t,i,n);break;case e.Packet.TYPE_DOUBLE:this.writeDouble(t,i,n);break;case e.Packet.TYPE_BOOLEAN:this.writeBoolean(t,i,n);break;case e.Packet.TYPE_BYTEARRAY:this.writeByteArray(t,i,n);break;case e.Packet.TYPE_STRING:this.writeString(t,i,n);break;case e.Packet.TYPE_ARRAY:case e.Packet.TYPE_ARRAY_CONST:this.writeArray(t,i,n);break;case e.Packet.TYPE_ENTITY:this.writeEntity(t,i,n)}},t}();e.DefaultEncoder=t,__reflect(t.prototype,"codeBase.DefaultEncoder",["IEncoder"])}(i||(i={})),window.codeBase=i},function(e,t){var i=window.codeBase;window.codeBase=i},function(e,t){var i=window.codeBase;window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){this.define=new Array}return e.prototype.destory=function(){},e}();e.BaseEntity=t,__reflect(t.prototype,"codeBase.BaseEntity",[])}(i||(i={})),window.codeBase=i},function(e,t){var i=window.codeBase;window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(e,t){void 0===e&&(e=0),void 0===t&&(t=!0),this.header=null,this.define=new Array,this._clientSide=!0,this.clientSide=t,this.header.messageId=e}return Object.defineProperty(t.prototype,"isSuccess",{get:function(){return 0==this.header.code?!0:!1},enumerable:!1,configurable:!0}),t.prototype.send=function(){this.clientSide?e.WebSocket.getInstance().send(this):e.EventManager.dispactchPacket(this)
},Object.defineProperty(t.prototype,"clientSide",{get:function(){return this._clientSide},set:function(t){this._clientSide=t,this.clientSide?this.header=new e.PacketFactory.headerClientClz:this.header=new e.PacketFactory.headerServerClz},enumerable:!1,configurable:!0}),t.prototype.destory=function(){},t.TYPE_BOOLEAN="boolean",t.TYPE_BYTE="byte",t.TYPE_USHORT="ushort",t.TYPE_SHORT="short",t.TYPE_UINT="uint",t.TYPE_INT="int",t.TYPE_UINT64="uint64",t.TYPE_INT64="int64",t.TYPE_FLOAT="float",t.TYPE_UFLOAT="ufloat",t.TYPE_DOUBLE="double",t.TYPE_UDOUBLE="udouble",t.TYPE_STRING="string",t.TYPE_ARRAY="array",t.TYPE_ARRAY_CONST="array_const",t.TYPE_BYTEARRAY="bytearray",t.TYPE_ENTITY="entity",t.CHARSET_ASCII="ASCII",t.CHARSET_UNICODE="Unicode",t.CHARSET=t.CHARSET_UNICODE,t.MATH_POW_2_32=4294967296,t}();e.Packet=t,__reflect(t.prototype,"codeBase.Packet",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(){}return t.play=function(i,n,o,r,a){if(void 0===n&&(n=0),void 0===o&&(o=1),void 0===r&&(r=null),void 0===a&&(a=null),e.GlobalSetting.VOLUME_OPEN&&e.StringUtil.isUsage(i)){if(0==o&&t._soundDict[i])return t._soundDict[i];var s=RES.getRes(i);if(s){var l=s.play(n,o);return t._soundDict[i]={channel:l,loops:0>=o,num:o,func:r,thisObj:a},l.addEventListener(egret.Event.SOUND_COMPLETE,t.onSoundComplete,t),r&&a&&l.addEventListener(egret.Event.SOUND_COMPLETE,r,a),l}}return null},t.volume=function(i,n){if(e.StringUtil.isUsage(i)&&t._soundDict[i]){var o=t._soundDict[i];o.channel&&(o.channel.volume=n)}},t.onSoundComplete=function(i){var n=i.currentTarget,o=null;for(var r in t._soundDict)if(o.channel==n){if(!o.loops&&(o.num--,0==o.num&&n.hasEventListener(egret.Event.SOUND_COMPLETE))){o=t._soundDict[r];var a=e.MyEvent.getEvent(e.EventType.SOUND_COMPLETE);a.addItem("name",r),a.send(),n.removeEventListener(egret.Event.SOUND_COMPLETE,t.onSoundComplete,t),delete t._soundDict[r],o.func&&o.thisObj&&n.removeEventListener(egret.Event.SOUND_COMPLETE,o.func,o.thisObj),o.func=null,o.thisObj=null,o.channel=null}break}},t.stop=function(i){if(e.StringUtil.isUsage(i)&&t._soundDict[i]){var n=t._soundDict[i];if(n.channel){n.channel.hasEventListener(egret.Event.SOUND_COMPLETE)&&(n.channel.removeEventListener(egret.Event.SOUND_COMPLETE,t.onSoundComplete,t),n.func&&n.thisObj&&n.channel.removeEventListener(egret.Event.SOUND_COMPLETE,n.func,n.thisObj)),n.channel.stop(),n.func=null,n.thisObj=null,n.channel=null;var o=e.MyEvent.getEvent(e.EventType.SOUND_STOP);o.addItem("name",i),o.send(),delete t._soundDict[i]}}},t._soundDict={},t}();e.Sound=t,__reflect(t.prototype,"codeBase.Sound",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(){this.soundRootUrl=e.GameUtil.Instance.remoteResUrl+"/resource/assets/Sound/",this.pauseTime=0,this.soundChannelArr=[],this.musicVolume=1,this.effectVolume=1,this.titleVolume=.5}return Object.defineProperty(t,"Instance",{get:function(){return t.instance||(t.instance=new t,t.instance.modulePath="",t.instance.init()),t.instance},enumerable:!1,configurable:!0}),t.prototype.init=function(){var e=this;document.addEventListener("visibilitychange",function(){"visible"==document.visibilityState&&e.viewIn(),"hidden"==document.visibilityState&&e.viewOut()})},t.prototype.frontBackChange=function(e){if(null!=e){var t=this;e.data&&(1==e.data.type?t.viewOut():2==e.data.type&&t.viewIn())}},t.prototype.viewIn=function(){this.resumeSound()},t.prototype.viewOut=function(){this.pauseSound()},t.prototype.playRightWrongSound=function(e){void 0===e&&(e=0),0==e?this.PlaySoundByName("rightBeep"):this.PlaySoundByName("wrongBeep")},t.prototype.playClickSound=function(){this.PlaySoundByName("click")},t.prototype.PlaySoundByName=function(e,t,i,n,o,r,a){void 0===t&&(t=1),void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=0),void 0===r&&(r=!1),void 0===a&&(a=!1);var s=this;a&&s.stopAllSound();for(var l,h=s.soundChannelArr.length,c=0;h>c&&(l=s.soundChannelArr[c],l.name!==e);++c)l=null;if(null==l){var d=RES.getRes(s.modulePath+"/sound/"+e+".mp3"),u=d.play(0,t);l={name:e,sound:d,soundChannel:u,callBack:i,thisObj:n},s.soundChannelArr.push(l)}else{if(0!=l.soundChannel.position)return void(r&&(l.soundChannel.stop(),l.soundChannel=l.sound.play(0,t)));l.soundChannel=l.sound.play(0,t)}0==o?l.soundChannel.volume=s.effectVolume:l.soundChannel.volume=o,i&&n&&(l.callBack=i,l.thisObj=n,l.soundChannel.addEventListener(egret.Event.SOUND_COMPLETE,s.playEnd,s))},t.prototype.playEnd=function(e){for(var t,i=this,n=e.target,o=i.soundChannelArr.length,r=0;o>r;++r){t=i.soundChannelArr[r];var a=t.sound.originChannel;n==a&&t.callBack&&t.thisObj&&(t.callBack.call(t.thisObj),a.removeEventListener(egret.Event.SOUND_COMPLETE,t.callBack,t.thisObj),t.callBack=null,t.thisObj=null)}},t.prototype.stopAllSound=function(){var e=this;e.stopSoundByName()},t.prototype.pauseSound=function(){for(var e,t=this,i=t.soundChannelArr.length,n=0;i>n;++n){e=t.soundChannelArr[n];var o=e.soundChannel;o&&o.position>0&&(e.callBack&&e.thisObj&&o.hasEventListener(egret.Event.SOUND_COMPLETE)&&o.removeEventListener(egret.Event.SOUND_COMPLETE,e.callBack,e.thisObj),e.pause=!0,e.position=o.position,o.stop(),o=null)}},t.prototype.resumeSound=function(){for(var e,t=this,i=t.soundChannelArr.length,n=0;i>n;++n)e=t.soundChannelArr[n],e.pause&&(e.pause=!1,e.soundChannel=e.sound.play(e.position,e.playTimes),e.callBack&&e.thisObj&&e.soundChannel.once(egret.Event.SOUND_COMPLETE,e.callBack,e.thisObj))},t.prototype.PlaySoundOnce=function(e,t,i){void 0===t&&(t=1),void 0===i&&(i=0);var n=this,o=RES.getRes(n.modulePath+"/sound/"+e+".mp3"),r=o.play(0,t);return 0==i?r.volume=n.effectVolume:r.volume=i,r},t.prototype.stopSoundByName=function(e){void 0===e&&(e=null);for(var t,i=this,n=i.soundChannelArr.length,o=0;n>o;++o)if(t=i.soundChannelArr[o],!e||t.name==e){var r=t.soundChannel;t.callBack&&t.thisObj&&r.hasEventListener(egret.Event.SOUND_COMPLETE)&&(r.removeEventListener(egret.Event.SOUND_COMPLETE,t.callBack,t.thisObj),t.callBack=null,t.thisObj=null),r.stop(),r.position=0}},t.prototype.dispose=function(){for(var e,t=this,i=t.soundChannelArr.length,n=0;i>n;++n){e=t.soundChannelArr[n];var o=e.soundChannel;e.callBack&&e.thisObj&&o.hasEventListener(egret.Event.SOUND_COMPLETE)&&o.removeEventListener(egret.Event.SOUND_COMPLETE,e.callBack,e.thisObj),o.stop(),e.sound.close()}t.soundChannelArr.length=0},t}();e.SoundManager=t,__reflect(t.prototype,"codeBase.SoundManager",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function i(){var n=t.call(this)||this;return n._textureLabel=null,n._textureIcon=null,n._label=null,n._text="",n._texture=null,n._imgDisplay=null,n._imgLabel=null,n._imgIcon=null,n._initDisplayData=!1,n._selected=!1,n._toggleGroup=null,n.stateArray=[i.STATE_UP],n._currentState=i.STATE_UP,n._textureDict={},n._verticalSplit=!0,n._labelMarginLeft=0,n._labelMarginTop=0,n._iconMarginLeft=0,n._iconMarginTop=0,n._autoSize=!1,n._labelColor=e.Style.BUTTON_TEXT,n._labelBold=!1,n._labelItalic=!1,n._labelLineSpacing=0,n._labelMultiline=!1,n._labelStroke=0,n._labelStrokeColor=13136,n._fontSize=12,n._fontName=null,n._scale9GridEnable=!1,n._scale9GridRect=null,n._fillMode="scale",n._soundName="sound_button",n._testPixelEnable=!1,n}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.touchEnabled=!0,this.touchChildren=!1,this._imgDisplay=new egret.Bitmap,this.addChild(this._imgDisplay),this._imgDisplay.width=this.width,this._imgDisplay.height=this.height,this._imgDisplay.fillMode=this._fillMode,this._imgDisplay.touchEnabled=!1,this._label=new e.Label,this._label.autoSize=!0,this._label.clip=!1,this._label.hAlign=egret.HorizontalAlign.CENTER,this._label.vAlign=egret.VerticalAlign.MIDDLE,this._label.showBg=!1,this.addChild(this._label),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchEvent,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEvent,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchRleaseOutside,this),this.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchRleaseOutside,this)},i.prototype.onTouchEvent=function(t){if(!this.enabled)return void t.stopImmediatePropagation();if(e.GlobalSetting.STATS_BTN){var n=egret.getDefinitionByName("StatsUtil");n&&n.trackEvent("btn","touch",this.name,0)}if(t.currentTarget==this){if(this._testPixelEnable&&!this.testPixel32(t.localX,t.localY))return void t.stopImmediatePropagation();e.StringUtil.isUsage(this._toggleGroup)?(t.type==egret.TouchEvent.TOUCH_BEGIN&&(this.selected=!this._selected),this.onPlaySound()):(t.type==egret.TouchEvent.TOUCH_BEGIN?(this._currentState=i.STATE_DOWN,this.callClickFunction(),this.onPlaySound()):t.type==egret.TouchEvent.TOUCH_END?this._currentState=i.STATE_UP:t.type==egret.TouchEvent.TOUCH_MOVE&&(this._currentState=i.STATE_OVER),1==this.statesLength&&this._currentState==i.STATE_DOWN?this.alpha=.8:this.alpha=1)}this.invalidate()},i.prototype.onTouchRleaseOutside=function(t){(!e.StringUtil.isUsage(this._toggleGroup)||e.StringUtil.isUsage(this._toggleGroup)&&!this._selected)&&(this._currentState=i.STATE_UP,this.invalidate(),this.scaleX=1,this.scaleY=1,this.alpha=1)},i.prototype.setClickFunction=function(e,t){this.clickFun=e,this.clickFunObj=t},i.prototype.callClickFunction=function(){this.clickFun&&this.clickFunObj&&this.clickFun.call(this.clickFunObj,this)},Object.defineProperty(i.prototype,"currentState",{get:function(){return this._currentState},set:function(e){this._currentState!=e&&(this._currentState=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture!=e&&(this._initDisplayData=!1,this._texture=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fillMode",{get:function(){return this._fillMode},set:function(e){this._fillMode!=e&&(this._fillMode=e,this.invalidate())},enumerable:!1,configurable:!0}),i.prototype.scale9GridRect=function(){return this._scale9GridRect},i.prototype.scale9Grid=function(e){if(void 0===e&&(e=[]),4==e.length){null==this._scale9GridRect&&(this._scale9GridRect=new egret.Rectangle);var t=e[0],i=e[2],n=this.width-(e[0]+e[1]),o=this.height-(e[2]+e[3]);this._scale9GridRect.x=t,this._scale9GridRect.y=i,this._scale9GridRect.width=n,this._scale9GridRect.height=o}else this._scale9GridRect=null;this.invalidate()},i.prototype.draw=function(){this._initDisplayData||(this._texture||(null==i.DEFAULT_TEXTURE&&this.initDefaultTexture(),this._texture=i.DEFAULT_TEXTURE),this.splitTextureSource()),null!=this._imgDisplay&&(1==this.statesLength&&this._currentState==i.STATE_DOWN?this._imgDisplay.texture=this._textureDict[i.STATE_UP]:this._imgDisplay.texture=this._textureDict[this._currentState],null!=this._scale9GridRect?this._imgDisplay.scale9Grid=this._scale9GridRect:this._imgDisplay.scale9Grid=null,this._imgDisplay.fillMode=this._fillMode,this._imgDisplay.width=this.width,this._imgDisplay.height=this.height,this._imgDisplay.anchorOffsetX=this._imgDisplay.width/2,this._imgDisplay.anchorOffsetY=this._imgDisplay.height/2,this._imgDisplay.x=this.width/2,this._imgDisplay.y=this.height/2,null!=this._textureLabel&&(null==this._imgLabel&&(this._imgLabel=new egret.Bitmap,this._imgLabel.touchEnabled=!1,this.addChild(this._imgLabel)),this._imgLabel.texture=this._textureLabel,isNaN(this._labelMarginLeft)?this._imgLabel.x=(this.width-this._imgLabel.width)/2:this._imgLabel.x=this._labelMarginLeft,isNaN(this._labelMarginTop)?this._imgLabel.y=(this.height-this._imgLabel.height)/2:this._imgLabel.y=this._labelMarginTop),null!=this._textureIcon&&(null==this._imgIcon&&(this._imgIcon=new egret.Bitmap(null),this._imgIcon.touchEnabled=!1,this.addChild(this._imgIcon)),this._imgIcon.texture=this._textureIcon,isNaN(this._iconMarginLeft)?this._imgIcon.x=(this.width-this._imgIcon.width)/2:this._imgIcon.x=this._iconMarginLeft,isNaN(this._iconMarginTop)?this._imgIcon.y=(this.height-this._imgIcon.height)/2:this._imgIcon.y=this._iconMarginTop),this._label&&(this._label.parent||this.addChild(this._label),this._label.text=this._text,this._label.fontSize=this._fontSize,this._label.fontName=this._fontName,this._label.bold=this._labelBold,this._label.italic=this._labelItalic,this._label.lineSpacing=this._labelLineSpacing,this._label.multiline=this._labelMultiline,this._label.stroke=this._labelStroke,this._label.strokeColor=this._labelStrokeColor,this._label.onInvalidate(null),isNaN(this._labelMarginLeft)?this._label.x=(this.width-this._label.width)/2:this._label.x=this._labelMarginLeft,isNaN(this._labelMarginTop)?this._label.y=(this.height-this._label.height)/2:this._label.y=this._labelMarginTop))},i.prototype.initDefaultTexture=function(){if(null==i.DEFAULT_TEXTURE){this.setSize(e.Style.BUTTON_DEFAULT_WIDTH,e.Style.BUTTON_DEFAULT_HEIGHT);var t=new egret.Shape;t.width=this.width,t.height=this.height,t.graphics.beginFill(e.Style.BUTTON_FACE),t.graphics.drawRect(0,0,this.width,this.height),t.graphics.endFill(),t.graphics.lineStyle(1,0),t.graphics.drawRect(0,0,this.width-1,this.height-1);var n=new egret.RenderTexture;n.drawToTexture(t),i.DEFAULT_TEXTURE=n}},i.prototype.splitTextureSource=function(){if(this._texture){this._initDisplayData=!0;var e=0,t=0,i=this._texture.textureWidth,n=this._texture.textureHeight;if(1==this.stateArray.length)e=i,t=n,this._textureDict[this.stateArray[0]]=this._texture;else{var o=0,r=0,a=0;this._verticalSplit?(e=i,t=n/this.statesLength):(e=i/this.statesLength,t=n);var s=new egret.SpriteSheet(this._texture);for(o=0;o<this.stateArray.length;o++)this._verticalSplit?this._textureDict[this.stateArray[o]]=s.createTexture(this.name+Math.round(999999*Math.random())+"_"+this.stateArray[o],r,a+o*t,e,t):this._textureDict[this.stateArray[o]]=s.createTexture(this.name+Math.round(999999*Math.random())+"_"+this.stateArray[o],r+o*e,a,e,t)}this._autoSize&&(this.width=e,this.height=t)}},Object.defineProperty(i.prototype,"upSkin",{get:function(){return this._textureDict[i.STATE_UP]},set:function(e){this.isStateExist(i.STATE_UP)||this.stateArray.push(i.STATE_UP),this._textureDict[i.STATE_UP]=e,this.invalidate()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"overSkin",{get:function(){return this._textureDict[i.STATE_OVER]},set:function(e){this.isStateExist(i.STATE_OVER)||this.stateArray.push(i.STATE_OVER),this._textureDict[i.STATE_OVER]=e,this.invalidate()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"downSkin",{get:function(){return this._textureDict[i.STATE_DOWN]},set:function(e){this.isStateExist(i.STATE_DOWN)||this.stateArray.push(i.STATE_DOWN),this._textureDict[i.STATE_DOWN]=e,this.invalidate()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"disableSkin",{get:function(){return this._textureDict[i.STATE_DISABLE]},set:function(e){this.isStateExist(i.STATE_DISABLE)||this.stateArray.push(i.STATE_DISABLE),this._textureDict[i.STATE_DISABLE]=e,this.invalidate()},enumerable:!1,configurable:!0}),i.prototype.isStateExist=function(e){return-1!=this.stateArray.indexOf(e)?!0:!1},Object.defineProperty(i.prototype,"label",{get:function(){return this._text},set:function(e){this._text=e,this._label&&(this._label.text=this._text),this.invalidate()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"selected",{get:function(){return this._selected},set:function(t){if(this._selected=t,this._currentState=this._selected?i.STATE_DOWN:i.STATE_UP,this._selected&&e.StringUtil.isUsage(this._toggleGroup)){var n=e.MyEvent.getEvent(i.TOGGLE_PREFIX+this._toggleGroup);n.addItem("caller",this),n.addItem("group",this._toggleGroup),n.send()}this.invalidate()},enumerable:!1,configurable:!0}),i.prototype.setStatus=function(e){void 0===e&&(e=[]);var t=0==e.length?1:e.length;switch(t){case 1:this.stateArray=[i.STATE_UP];break;case 2:this.stateArray=[i.STATE_UP,i.STATE_DOWN];break;case 3:this.stateArray=[i.STATE_UP,i.STATE_DOWN,i.STATE_OVER];break;case 4:this.stateArray=[i.STATE_UP,i.STATE_DOWN,i.STATE_OVER,i.STATE_DISABLE]}if(this._initDisplayData=!1,e.length>0){this._initDisplayData=!0;for(var n=0;n<this.stateArray.length;++n){if(!e[n]){this._initDisplayData=!1,console.warn("");break}this._textureDict[this.stateArray[n]]=e[n]}}this._initDisplayData&&this.setSize(e[0].textureWidth,e[0].textureHeight),this.invalidate()},Object.defineProperty(i.prototype,"statesLength",{get:function(){return this.stateArray.length},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"imgLabel",{get:function(){return this._textureLabel},set:function(e){this._textureLabel!=e&&(this._textureLabel=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"imgIcon",{get:function(){return this._textureIcon},set:function(e){this._textureIcon!=e&&(this._textureIcon=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"labelColor",{get:function(){return this._labelColor},set:function(e){this._labelColor!=e&&(this._labelColor=e,this._label&&(this._label.color=e),this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontName",{get:function(){return this._fontName},set:function(e){this._fontName!=e&&(this._fontName=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!=e&&(this._fontSize=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"labelMarginLeft",{get:function(){return this._labelMarginLeft},set:function(e){this._labelMarginLeft!=e&&(this._labelMarginLeft=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"labelMarginTop",{get:function(){return this._labelMarginTop},set:function(e){this._labelMarginTop!=e&&(this._labelMarginTop=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"iconMarginLeft",{get:function(){return this._iconMarginLeft},set:function(e){this._iconMarginLeft!=e&&(this._iconMarginLeft=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"iconMarginTop",{get:function(){return this._iconMarginTop},set:function(e){this._iconMarginTop!=e&&(this._iconMarginTop=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"autoSize",{get:function(){return this._autoSize},set:function(e){this._autoSize!=e&&(this._autoSize=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"toggleGroup",{get:function(){return this._toggleGroup},set:function(t){e.StringUtil.isUsage(this._toggleGroup)&&e.EventManager.removeEventListener(i.TOGGLE_PREFIX+this._toggleGroup,this.onEventToggle,this),this._toggleGroup=t,e.StringUtil.isUsage(this._toggleGroup)&&e.EventManager.addEventListener(i.TOGGLE_PREFIX+this._toggleGroup,this.onEventToggle,this)},enumerable:!1,configurable:!0}),i.prototype.onEventToggle=function(t){e.StringUtil.isUsage(this._toggleGroup)&&t.getItem("group")==this._toggleGroup&&(t.getItem("caller")!=this?(this._selected=!1,this._currentState=i.STATE_UP,this.invalidate()):this.clickFun&&this.clickFunObj&&this.clickFun.call(this.clickFunObj,t))},i.prototype.setSize=function(e,i){t.prototype.setSize.call(this,e,i)},i.prototype.onPlaySound=function(){e.StringUtil.isUsage(this._soundName)&&e.Sound.play(this._soundName)},Object.defineProperty(i.prototype,"sound",{get:function(){return this._soundName},set:function(e){this._soundName=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"drawDelay",{set:function(e){this._label&&(this._label.drawDelay=e)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"labelBold",{get:function(){return this._labelBold},set:function(e){this._labelBold!=e&&(this._labelBold=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"labelItalic",{get:function(){return this._labelItalic},set:function(e){this._labelItalic!=e&&(this._labelItalic=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"labelLineSpacing",{get:function(){return this._labelLineSpacing},set:function(e){this._labelLineSpacing!=e&&(this._labelLineSpacing=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"labelMultiline",{get:function(){return this._labelMultiline},set:function(e){this._labelMultiline!=e&&(this._labelMultiline=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"labelStroke",{get:function(){return this._labelStroke},set:function(e){this._labelStroke!=e&&(this._labelStroke=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"labelStrokeColor",{get:function(){return this._labelStrokeColor},set:function(e){this._labelStrokeColor!=e&&(this._labelStrokeColor=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"testPixelEnable",{get:function(){return this._testPixelEnable},set:function(e){this._testPixelEnable=e},enumerable:!1,configurable:!0}),i.prototype.getPixel32=function(e,t){var i,n=this.globalToLocal(e,t),o=null;this._imgDisplay&&this._imgDisplay.texture&&(o=this._imgDisplay.texture.getPixel32(n.x,n.y));for(var r=0;r<o.length;r++)if(o[r]>0)return i=!0,o;this._imgLabel&&this._imgLabel.texture&&(o=this._imgLabel.texture.getPixel32(e,t));for(var r=0;r<o.length;r++)if(o[r]>0)return i=!0,o;this._imgIcon&&this._imgIcon.texture&&(o=this._imgIcon.texture.getPixel32(e,t));for(var r=0;r<o.length;r++)if(o[r]>0)return i=!0,o;return[]},i.prototype.testPixel32=function(e,t){for(var i=this.getPixel32(e,t),n=0;n<i.length;n++)if(i[n]>0)return!0;return!1},i.TOGGLE_PREFIX="ui#button#toggle_",i.DEFAULT_TEXTURE=null,i.STATE_UP="up",i.STATE_DOWN="down",i.STATE_OVER="over",i.STATE_DISABLE="disable",i}(e.BaseGroup);e.Button=t,__reflect(t.prototype,"codeBase.Button",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t._gap=0,t._hAlign=egret.HorizontalAlign.LEFT,t._vAlign=egret.VerticalAlign.MIDDLE,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.invalidate()},Object.defineProperty(t.prototype,"gap",{get:function(){return this._gap},set:function(e){this._gap!=e&&(this._gap=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hAlign",{get:function(){return this._hAlign},set:function(e){this._hAlign!=e&&(this._hAlign=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vAlign",{get:function(){return this._vAlign},set:function(e){this._vAlign!=e&&(this._vAlign=e,this.invalidate())},enumerable:!1,configurable:!0}),t.prototype.draw=function(){e.prototype.draw.call(this),this.updateLayout(),this._showBg&&this.addChildAt(this._bgImage,0)},t.prototype.updateLayout=function(){var e=0,t=null,i=null,n=0;for(e=0;e<this.numChildren;e++)this.getChildAt(e)!=this._bgImage&&(n+=this.getChildAt(e).width);n+=(this.numChildren-1)*this._gap;var o=!0;for(e=0;e<this.numChildren;e++)t=this.getChildAt(e),t!=this._bgImage&&(o?(o=!1,this._hAlign==egret.HorizontalAlign.LEFT?t.x=0:this._hAlign==egret.HorizontalAlign.CENTER?t.x=(this.width-n)/2:this._hAlign==egret.HorizontalAlign.RIGHT&&(t.x=this.width-n)):(i=this.getChildAt(e-1),t.x=i.x+i.width+this.gap),this._vAlign==egret.VerticalAlign.TOP?t.y=0:this._vAlign==egret.VerticalAlign.MIDDLE?t.y=(this.height-t.height)/2:this._vAlign==egret.VerticalAlign.BOTTOM&&(t.y=this.height-t.height))},t}(e.Group);e.HGroup=t,__reflect(t.prototype,"codeBase.HGroup",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t._bitmap=null,t._texture=null,t._autoSize=!0,t._scale9GridRect=null,t.scale9RectData=[],t._fillMode=egret.BitmapFillMode.SCALE,t._smoothing=!1,t.explicitWidth=0/0,t.explicitHeight=0/0,t._bitmap=new egret.Bitmap,t._bitmap.fillMode=egret.BitmapFillMode.SCALE,t.addChild(t._bitmap),t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},Object.defineProperty(t.prototype,"fillMode",{get:function(){return this._fillMode},set:function(e){this._fillMode!=e&&(this._fillMode=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoSize",{get:function(){return this._autoSize},set:function(e){this._autoSize!=e&&(this._autoSize=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(e){var t=this;t._texture!=e&&(t._texture=e,t.draw(),t.onInvalidatePosition())},enumerable:!1,configurable:!0}),t.prototype.scale9Grid=function(e){void 0===e&&(e=[]);4==e.length?this.scale9RectData=e.concat():this.scale9RectData.length=0,this.invalidate()},t.prototype.scale9Rect=function(){var e=new egret.Rectangle;return e.x=1,e.y=1,e.width=1,e.height=1,e},Object.defineProperty(t.prototype,"smoothing",{get:function(){return this._smoothing},set:function(e){this._smoothing!=e&&(this._smoothing=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.$getWidth()},set:function(t){0>t||t==this.explicitWidth||(this.explicitWidth=t,e.prototype.$setWidth.call(this,t),this.onInvalidatePosition(),this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.$getHeight()},set:function(t){0>t||t==this.explicitHeight||(this.explicitHeight=t,e.prototype.$setHeight.call(this,t),this.onInvalidatePosition(),this.invalidate())},enumerable:!1,configurable:!0}),t.prototype.draw=function(){var e=this;e._bitmap&&null!=e._texture&&(e._bitmap.texture!=e._texture&&(e._bitmap.texture=e._texture,isNaN(e.explicitWidth)&&(e.width=e._bitmap.texture.textureWidth),isNaN(e.explicitHeight)&&(e.height=e._bitmap.texture.textureHeight)),e._bitmap.fillMode=e._fillMode,4==e.scale9RectData.length?(null==e._scale9GridRect&&(e._scale9GridRect=e.scale9Rect()),e._scale9GridRect.x=e.scale9RectData[0],e._scale9GridRect.y=e.scale9RectData[2],e._scale9GridRect.width=e._bitmap.texture.$getTextureWidth()-(e.scale9RectData[0]+e.scale9RectData[1]),e._scale9GridRect.height=e._bitmap.texture.$getTextureHeight()-(e.scale9RectData[2]+e.scale9RectData[3]),e._bitmap.scale9Grid=e._scale9GridRect,e._bitmap.scaleX=1,e._bitmap.scaleY=1):e._bitmap.scale9Grid=null,e._fillMode!=egret.BitmapFillMode.SCALE?(e._bitmap.width=e.width,e._bitmap.height=e.height):(e._bitmap.scaleX=e.width/e._bitmap.texture.textureWidth,this._bitmap.scaleY=e.height/e._bitmap.texture.textureHeight))},t.prototype.getBitmap=function(){return this._bitmap},t.prototype.getPixel32=function(e,t){if(this._bitmap&&this._bitmap.texture){var i=this.globalToLocal(e,t);return this._bitmap.texture.getPixel32(i.x,i.y)}return[]},t.prototype.testPixel32=function(e,t){for(var i=this.getPixel32(e,t),n=0;n<i.length;n++)if(i[n]>0)return!0;return!1},t}(e.BaseGroup);e.Image=t,__reflect(t.prototype,"codeBase.Image",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.numberImages=[],t.numberImagePool=[],t.numberTexture={},t}return __extends(t,e),t.prototype.init=function(e,t,i,n){void 0===t&&(t=""),void 0===i&&(i="top"),void 0===n&&(n="left");var o=this;o.imageAlias=e,o.sheetAlias=t,o.verticalAlign=i.toLowerCase(),o.horizontalAlign=n.toLowerCase()},t.prototype.show=function(e,t,i,n){void 0===n&&(n=null);var o=this;o.parent!=e&&e.addChild(o),o.x=t,o.y=i,o.numberValue=n,o.setNumber()},Object.defineProperty(t.prototype,"text",{get:function(){var e=this;return e.numberValue},set:function(e){var t=this;t.numberValue!=e&&(t.numberValue=e,t.setNumber())},enumerable:!1,configurable:!0}),t.prototype.setNumber=function(){var e=this;if(e.numberImages.length>0){for(var t=0;t<e.numberImages.length;++t)e.removeChild(e.numberImages[t]),e.numberImagePool.push(e.numberImages[t]);e.numberImages.length=0}if(e.numberValue&&e.numberValue.length>0){for(var i,n=e.numberValue.length,o=void 0,r=void 0,a=0,s=0,l=n/2,t=0;n>t;++t)i=e.numberValue[t],o=e.numberImagePool.length>0?e.numberImagePool.pop():new egret.Bitmap,r=e.numberTexture[e.imageAlias+i],r||(r=RES.getRes(e.sheetAlias+("."+(e.imageAlias+i)))),o.texture=r,o&&(e.addChild(o),"left"==e.horizontalAlign?o.x=0+t*o.width:"center"==e.horizontalAlign?o.x=0+(t-l)*o.width:"right"==e.horizontalAlign&&(o.x=0-(t+1)*o.width),"top"==e.verticalAlign?o.y=0:"middle"==e.verticalAlign?o.y=0-o.height/2:"bottom"==e.verticalAlign&&(o.y=0-o.height),e.numberImages.push(o),a+=o.width,s=o.height);e.width=a,e.height=s}},t.prototype.hide=function(){var e=this;e.parent&&e.parent.removeChild(e)},t}(egret.Sprite);e.ImageNumber=t,__reflect(t.prototype,"codeBase.ImageNumber",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function i(){var i=t.call(this)||this;return i._text="",i._textField=null,i._initFlow=null,i._htmlTextParser=null,i._fontSize=e.Style.fontSize,i._color=e.Style.LABEL_TEXT,i._fontName=e.Style.fontName,i._hAlign=egret.HorizontalAlign.LEFT,i._vAlign=egret.VerticalAlign.MIDDLE,i._bold=!1,i._italic=!1,i._lineSpacing=0,i._multiline=!1,i._wordWrap=!1,i._stroke=0,i._strokeColor=13136,i._html=!1,i._autoSize=!0,i._paddingLeft=0,i._paddingRight=0,i._paddingTop=0,i._paddingBottom=0,i._textField=new egret.TextField,i._textField.addEventListener(egret.Event.CHANGE,i.onTextChange,i),i.addChild(i._textField),i}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this)},i.prototype.initData=function(){t.prototype.initData.call(this)},i.prototype.onTextChange=function(e){this._text=this._textField.text},Object.defineProperty(i.prototype,"text",{get:function(){return this._text},set:function(e){this._text!=e&&(this._text=e,this._html?null==this._text?(this._text="",this._initFlow=[]):(null==this._htmlTextParser&&(this._htmlTextParser=new egret.HtmlTextParser),this._initFlow=this._htmlTextParser.parser(this._text)):null==this._text&&(this._text=""),this.draw())},enumerable:!1,configurable:!0}),i.prototype.getTextField=function(){return this._textField},i.prototype.draw=function(){if(null!=this._textField){if(null!=this._fontName&&(this._textField.fontFamily=this.fontName),this._color>=0&&(this._textField.textColor=this._color),this._fontSize>0&&(this._textField.size=this._fontSize),this._textField.bold=this._bold,this._textField.italic=this._italic,this._textField.multiline=this._multiline,this._textField.lineSpacing=this._lineSpacing,this._textField.stroke=this._stroke,this._textField.strokeColor=this._strokeColor,this._textField.wordWrap=this._wordWrap,this._html?(this._initFlow&&(this._textField.textFlow=this._initFlow),this._initFlow=null):this._textField.text=this._text,this._autoSize)this.setSize(this._textField.measuredWidth,this._textField.measuredHeight);else{this._textField.width=this.width,this._textField.height=this.height;var e=this._textField.width-this._paddingLeft-this._paddingRight,i=this._textField.height-this._paddingTop-this._paddingBottom;this._textField.width=e,this._textField.height=i,this._textField.x=this._paddingLeft,this._textField.y=this._paddingTop}this._textField.textAlign=this._hAlign,this._textField.verticalAlign=this._vAlign,t.prototype.draw.call(this)}},Object.defineProperty(i.prototype,"paddingLeft",{get:function(){return this._paddingLeft},set:function(e){this._paddingLeft!=e&&(this._paddingLeft=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"paddingRight",{get:function(){return this._paddingRight},set:function(e){this._paddingRight!=e&&(this._paddingRight=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"paddingTop",{get:function(){return this._paddingTop
},set:function(e){this._paddingTop!=e&&(this._paddingTop=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"paddingBottom",{get:function(){return this._paddingBottom},set:function(e){this._paddingBottom!=e&&(this._paddingBottom=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(e){this._wordWrap!=e&&(this._wordWrap=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"italic",{get:function(){return this._italic},set:function(e){this._italic!=e&&(this._italic=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"bold",{get:function(){return this._bold},set:function(e){this._bold!=e&&(this._bold=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontName",{get:function(){return this._fontName},set:function(e){this._fontName!=e&&(this._fontName=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!=e&&(this._fontSize=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"color",{get:function(){return this._color},set:function(e){this._color!=e&&(this._color=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lineSpacing",{get:function(){return this._lineSpacing},set:function(e){this._lineSpacing!=e&&(this._lineSpacing=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"multiline",{get:function(){return this._multiline},set:function(e){this._multiline!=e&&(this._multiline=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"stroke",{get:function(){return this._stroke},set:function(e){this._stroke!=e&&(this._stroke=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(e){this._strokeColor!=e&&(this._strokeColor=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"autoSize",{get:function(){return this._autoSize},set:function(e){this._autoSize!=e&&(this._autoSize=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"hAlign",{get:function(){return this._hAlign},set:function(e){this._hAlign!=e&&(this._hAlign=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"vAlign",{get:function(){return this._vAlign},set:function(e){this._vAlign!=e&&(this._vAlign=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"html",{get:function(){return this._html},set:function(e){this._html!=e&&(this._html=e,this.invalidate())},enumerable:!1,configurable:!0}),i}(e.Group);e.Label=t,__reflect(t.prototype,"codeBase.Label",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e._text="",e._textureDict={},e._texture=null,e._shape=null,e._initDisplayData=!1,e._chars="0,1,2,3,4,5,6,7,8,9",e._charSplit=",",e._horizontalSplit=!0,e._gapSplit=0,e._soundName=null,e._sound=null,e._rollingEnable=!1,e._rollingZoomEnable=!1,e._rollingZoomValue=1.5,e._rollingZoomAlign=egret.HorizontalAlign.CENTER,e._rollingEffect=null,e._step=0,e._callbackFunc=null,e._callbackFuncThis=null,e}return __extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.setSize(e.Style.TEXTINPUT_WIDTH,e.Style.TEXTINPUT_HEIGHT)},Object.defineProperty(n.prototype,"text",{get:function(){return this._text},set:function(e){this._text!=e&&(this._rollingEnable?(null==this._rollingEffect&&(this._rollingEffect=new i(this),this._rollingEffect.zoomEnable=this._rollingZoomEnable,this._rollingEffect.zoomValue=this._rollingZoomValue,this._rollingEffect.zoomAlign=this._rollingZoomAlign,this._rollingEffect.callbackFunc=this._callbackFunc,this._rollingEffect.callbackFuncThis=this._callbackFuncThis),this._rollingEffect.clean(),this._rollingEffect.setText(e,this._step)):(this._rollingEffect&&this._rollingEffect.clean(e),this.setText(e)))},enumerable:!1,configurable:!0}),n.prototype.setText=function(e){this._text=""+e,null==this._text&&(this._text=""),this.invalidate(),this.onPlaySound()},Object.defineProperty(n.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture!=e&&(this._texture=e,this._initDisplayData=!1,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"chars",{get:function(){return this._chars},set:function(e){this._chars!=e&&(this._chars=e,this._initDisplayData=!1,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"step",{get:function(){return this._step},set:function(e){this._step!=e&&(this._step=e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"horizontalSplit",{get:function(){return this._horizontalSplit},set:function(e){this._horizontalSplit!=e&&(this._horizontalSplit=e,this._initDisplayData=!1,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"gapSplit",{get:function(){return this._gapSplit},set:function(e){this._gapSplit!=e&&(this._gapSplit=e,this._initDisplayData=!1,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"charSplit",{get:function(){return this._charSplit},set:function(e){this._charSplit!=e&&(this._charSplit=e,this._initDisplayData=!1,this.invalidate())},enumerable:!1,configurable:!0}),n.prototype.draw=function(){this._initDisplayData||this.splitTextureSource(),this._bgImage&&this._bgImage.parent&&this._bgImage.parent.removeChild(this._bgImage);for(var i=null,n=this.numChildren-1;n>=0;n--)i=this.getChildAt(n),i.texture=null,i.parent.removeChild(i),e.ObjectPool.recycleClass(i,"labelimg");var o=null;if(e.StringUtil.isUsage(this._text))for(var n=0;n<this._text.length;n++)o=this._textureDict[this._text.charAt(n)],o&&(i=e.ObjectPool.getByClass(egret.Bitmap,"labelimg"),this.addChild(i),i.texture=o,i.width=o.textureWidth,i.height=o.textureHeight,i.visible=!0,i.alpha=1);t.prototype.draw.call(this)},n.prototype.splitTextureSource=function(){if(this._texture&&e.StringUtil.isUsage(this._chars)){var t=e.StringUtil.splitStrArr(this._chars,this._charSplit);if(t.length>0){this._initDisplayData=!0;var i=new egret.SpriteSheet(this._texture),n=0,o=0,r=this._texture.textureWidth,a=this._texture.textureHeight;this._horizontalSplit?(n=(r-t.length*this._gapSplit)/t.length,o=a):(n=r,o=(a-t.length*this._gapSplit)/t.length);for(var s=0;s<t.length;s++)this._horizontalSplit?this._textureDict[t[s]]=i.createTexture(this.name+Math.round(999999*Math.random())+"_"+t[s],s*n+s*this._gapSplit,0,n,o):this._textureDict[t[s]]=i.createTexture(this.name+Math.round(999999*Math.random())+"_"+t[s],0,s*o+s*this._gapSplit,n,o)}}},n.prototype.onPlaySound=function(){null==this._sound&&e.StringUtil.isUsage(this._soundName)&&(this._sound=RES.getRes(this._soundName)),this._sound&&this._sound.play()},Object.defineProperty(n.prototype,"sound",{get:function(){return this._soundName},set:function(e){this._soundName=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rollingEnable",{get:function(){return this._rollingEnable},set:function(e){this._rollingEnable=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rollingZoomEnable",{get:function(){return this._rollingZoomEnable},set:function(e){this._rollingZoomEnable=e,this._rollingEffect&&(this._rollingEffect.zoomEnable=e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rollingZoomValue",{get:function(){return this._rollingZoomValue},set:function(e){this._rollingZoomValue=e,this._rollingEffect&&(this._rollingEffect.zoomValue=e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rollingZoomAlign",{get:function(){return this._rollingZoomAlign},set:function(e){this._rollingZoomAlign=e,this._rollingEffect&&(this._rollingEffect.zoomAlign=e)},enumerable:!1,configurable:!0}),n.prototype.onInvalidatePosition=function(){this._hasInvalidatePosition||(this._hasInvalidatePosition=!0,this.addEventListener(egret.Event.ENTER_FRAME,this.resetPosition,this))},n.prototype.setRollingEndFunc=function(e,t){this._callbackFunc=t,this._callbackFuncThis=e,this._rollingEffect&&(this._rollingEffect.callbackFunc=this._callbackFunc,this._rollingEffect.callbackFuncThis=this._callbackFuncThis)},n.prototype.removeRollingEndFunc=function(){this._callbackFunc=null,this._callbackFuncThis=null,this._rollingEffect&&(this._rollingEffect.callbackFunc=this._callbackFunc,this._rollingEffect.callbackFuncThis=this._callbackFuncThis)},n}(e.HGroup);e.LabelImage=t,__reflect(t.prototype,"codeBase.LabelImage",[]);var i=function(){function t(e){this.zoomEnable=!1,this.zoomValue=1,this.zoomAlign=egret.HorizontalAlign.CENTER,this._isZoom=!1,this._zoomXOld=1,this._zoomYOld=1,this._xScale=1,this._yScale=1,this._xOld=1,this._yOld=1,this._labelImg=null,this._rollingText=[],this.callbackFunc=null,this.callbackFuncThis=null,this._labelImg=e,this._xOld=this._labelImg.x,this._yOld=this._labelImg.y}return t.prototype.clean=function(t){void 0===t&&(t=null),this._rollingText.length>0&&(this._labelImg.setText(this._rollingText[this._rollingText.length-1]),this._lastRollString=this._rollingText[this._rollingText.length-1]),this._rollingText.length=0,e.StringUtil.isUsage(t)&&(this._lastRollString=t)},t.prototype.setText=function(t,i){var n=this._labelImg.text;this._labelLength=parseInt(t);var o=this._labelLength+"";if(o.length==t.length){this._rollingText.length>0?(this._labelImg.setText(this._rollingText[this._rollingText.length-1]),this._lastRollString=this._rollingText[this._rollingText.length-1]):this._lastRollString=n,this._rollingText.length=0;var r,a,s=0;if(s=i>0?i:this.getStepValue(parseInt(this._lastRollString),parseInt(t)),r=parseInt(this._lastRollString)+s,a=r+"",this._rollingText.push(a),s>0)for(;parseInt(this._rollingText[this._rollingText.length-1])<parseInt(t);)s+parseInt(this._rollingText[this._rollingText.length-1])<parseInt(t)?(r+=s,a=r+""):(r=parseInt(t),a=r+""),this._rollingText.push(a);else if(0>s)for(;parseInt(this._rollingText[this._rollingText.length-1])>parseInt(t);)s+parseInt(this._rollingText[this._rollingText.length-1])>parseInt(t)?(r+=s,a=r+""):(r=parseInt(t),a=r+""),this._rollingText.push(a)}this.zoomEnable&&1!=this.zoomValue&&(this._labelImg.scaleX=this.zoomValue,this._labelImg.scaleY=this.zoomValue,this.zoomValue>1?(this._xScale=this._xOld-this._labelImg.width*(this._labelImg.scaleX-1),this._yScale=this._yOld-this._labelImg.height*(this._labelImg.scaleX-1)):this.zoomValue<1&&(this._xScale=this._xOld+this._labelImg.width*(this._labelImg.scaleX-1),this._yScale=this._yOld+this._labelImg.height*(this._labelImg.scaleX-1)),this.zoomValue>1?"center"==this.zoomAlign?(this._labelImg.x=this._xOld-this._labelImg.width*(this._labelImg.scaleX-1)/2,this._labelImg.y=this._yOld-this._labelImg.height*(this._labelImg.scaleY-1)/2):"left"==this.zoomAlign?this._labelImg.y=this._yOld-this._labelImg.height*(this._labelImg.scaleY-1)/2:"right"==this.zoomAlign&&(this._labelImg.x=this._xOld-this._labelImg.width*(this._labelImg.scaleX-1),this._labelImg.y=this._yOld-this._labelImg.height*(this._labelImg.scaleY-1)/2):this.zoomValue<1&&("center"==this.zoomAlign?(this._labelImg.x=this._xOld+this._labelImg.width*(this._labelImg.scaleX-1)/2,this._labelImg.y=this._yOld+this._labelImg.height*(this._labelImg.scaleY-1)/2):"left"==this.zoomAlign?this._labelImg.y=this._yOld+this._labelImg.height*(this._labelImg.scaleY-1)/2:"right"==this.zoomAlign&&(this._labelImg.x=this._xOld+this._labelImg.width*(this._labelImg.scaleX-1),this._labelImg.y=this._yOld+this._labelImg.height*(this._labelImg.scaleY-1)/2)),this._isZoom=!0),e.HeartBeat.addListener(this,this.onChangeText,3)},t.prototype.getStepValue=function(e,t){var i=Math.abs(e-t),n=1;return n=30>i?1:60>i?2:100>i?3:200>i?5:400>i?10:800>i?20:1500>i?30:2500>i?40:3500>i?50:Math.floor(Math.round(i/200)+50),e>t&&(n=-n),console.log("step="+n),n},t.prototype.onChangeText=function(){if(this._rollingText.length>0)this._labelImg.setText(this._rollingText.shift());else{if(e.HeartBeat.removeListener(this,this.onChangeText),this._isZoom){var t={scaleX:this._zoomXOld,scaleY:this._zoomYOld};0==this._labelImg.anchorOffsetX&&(t.x=this._xOld),0==this._labelImg.anchorOffsetY&&(t.y=this._yOld),egret.Tween.get(this._labelImg).to(t,200)}this._isZoom=!1,this.callbackFunc&&this.callbackFuncThis&&this.callbackFunc.call(this.callbackFuncThis)}},t}();__reflect(i.prototype,"codeBase.EffectNumberRolling",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function i(){var i=t.call(this)||this;return i.METHOD_DEF={},i._itemRenderer=e.DefaultRenderer,i._itemContainer=null,i._gap=2,i._direction=e.Style.VERTICAL,i._dataIndexBegin=0,i._dataIndexEnd=0,i._itemDatas=null,i._dataIndexToRender=null,i._autoSize=!1,i._marginTop=4,i._marginBottom=4,i._marginLeft=4,i._marginRight=4,i._line=1,i._lineGap=0,i._effect=null,i._isDragBegin=!1,i._isMoveBegin=!1,i._moveCount=0,i._dragBeginPoint=null,i._dragLastTime=0,i.bounceBack=!1,i._autoScrollGap=0,i._autoScrollStep=0,i._lastTimeNum=0,i._selected=null,i._fixed=!1,i._data_end_func_call=null,i._data_end_func_this=null,i}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.touchEnabled=!0,this._itemContainer=new e.BaseGroup,this._itemContainer.touchEnabled=!0,this.addChild(this._itemContainer),this._itemContainer.scrollRect=new egret.Rectangle(0,0,this.width,this.height),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBeginEvent,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMoveEvent,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEndEvent,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchReleaseOutsideEvent,this),this._dragBeginPoint=new egret.Point,this.addHandleEvent(e.EventType.RESOURCE_DOWNLOADED,"onMyEventResDownloaded"),this.touchNonePixel=!0},i.prototype.addHandleEvent=function(t,i){e.MessageControler.addEvent(t),this.METHOD_DEF[t]=i},i.prototype.receiveEvent=function(e){for(var t=null,i=0;i<this._itemContainer.numChildren;i++)t=this._itemContainer.getChildAt(i),t.refresh&&t.refresh()},i.prototype.onTouchBeginEvent=function(t){this._itemDatas&&0!=this._itemDatas.length&&(this._isDragBegin=!0,this._isMoveBegin=!1,this._lastTimeNum=0,this._moveCount=0,this._dragBeginPoint.x=t.stageX,this._dragBeginPoint.y=t.stageY,this._dragLastTime=egret.getTimer(),e.HeartBeat.removeListener(this,this.onAutoScroll))},i.prototype.onTouchMoveEvent=function(t){if(this._itemDatas&&0!=this._itemDatas.length&&!this.bounceBack){if(this._isDragBegin&&(this._isMoveBegin=!0,this._moveCount++,this.moveItemUIPosition(t.stageX-this._dragBeginPoint.x,t.stageY-this._dragBeginPoint.y)),this._direction==e.Style.VERTICAL){if(this._autoScrollGap=t.stageY-this._dragBeginPoint.y,t.stageY<=this.getGlobalXY().y||t.stageY>=this.getGlobalXY().y+this.height)return void this.onTouchEndEvent(t)}else if(this._autoScrollGap=t.stageX-this._dragBeginPoint.x,t.stageX<=this.getGlobalXY().x||t.stageX>=this.getGlobalXY().x+this.width)return void this.onTouchEndEvent(t);this._lastTimeNum=egret.getTimer()-this._dragLastTime,this._dragBeginPoint.x=t.stageX,this._dragBeginPoint.y=t.stageY,this._dragLastTime=egret.getTimer()}},i.prototype.onTouchReleaseOutsideEvent=function(e){this.onTouchEndEvent(e)},i.prototype.onTouchEndEvent=function(t){var i=this;if(console.log("onTouchEndEvent this._dataIndexBegin="+i._dataIndexBegin+", this._dataIndexEnd="+i._dataIndexEnd),i._isDragBegin&&(!i._isMoveBegin||i._moveCount<4&&Math.abs(t.stageX-i._dragBeginPoint.x)<5&&Math.abs(t.stageY-i._dragBeginPoint.y)<5)){for(var n=null,o=i._itemContainer.globalToLocal(t.stageX,t.stageY),r=0;r<i._itemContainer.numChildren;r++)if(n=i._itemContainer.getChildAt(r),n.x<o.x&&n.y<o.y&&n.x+n.width>o.x&&n.y+n.height>o.y)try{i.selected=n._data,console.log(n.dataIndex);break}catch(a){}return i._isDragBegin=!1,void(i._isMoveBegin=!1)}return i._isDragBegin=!1,i._isMoveBegin=!1,i._lastTimeNum<40&&(i._dataIndexBegin>0&&i._autoScrollGap>0||i._itemDatas&&i._dataIndexEnd<i._itemDatas.length-1&&i._autoScrollGap<0)?(i._autoScrollGap=i._autoScrollGap/i._lastTimeNum*10,void e.HeartBeat.addListener(i,i.onAutoScroll)):void i.checkBounceBack()},i.prototype.onAutoScroll=function(){this._direction==e.Style.VERTICAL?this.moveItemUIPosition(0,this._autoScrollGap):this.moveItemUIPosition(this._autoScrollGap,0),this._autoScrollGap-=this._autoScrollGap/20,(Math.abs(this._autoScrollGap)<.5||0==this._dataIndexBegin||this._dataIndexEnd==this._itemDatas.length-1)&&(e.HeartBeat.removeListener(this,this.onAutoScroll),this.checkBounceBack())},i.prototype.checkBounceBack=function(){if(this._itemContainer.numChildren>0&&this._itemDatas&&this._itemDatas.length>0&&(0==this._dataIndexBegin||this._dataIndexEnd>=this._itemDatas.length-1)){var t=0;if(0==this._dataIndexBegin){if(t=this._direction==e.Style.VERTICAL?this._itemContainer.getChildAt(0).y:this._itemContainer.getChildAt(0).x,0>t&&this._dataIndexEnd!=this._itemDatas.length-1)return}else if(this._dataIndexEnd==this._itemDatas.length-1&&(t=this._direction==e.Style.VERTICAL?this._itemContainer.getChildAt(this._itemContainer.numChildren-1).y+this._itemContainer.getChildAt(this._itemContainer.numChildren-1).height-this._itemContainer.height:this._itemContainer.getChildAt(this._itemContainer.numChildren-1).x+this._itemContainer.getChildAt(this._itemContainer.numChildren-1).width-this._itemContainer.width,t>0&&0!=this._dataIndexBegin))return;0!=t&&(this.bounceBack=!0,this._autoScrollStep=Number((-t/5).toFixed(2)),this._autoScrollGap=Number(Math.abs(t).toFixed(2)),e.HeartBeat.addListener(this,this.doBounceBack))}},i.prototype.doBounceBack=function(){this._autoScrollGap<Math.abs(this._autoScrollStep)&&(this._autoScrollStep=this._autoScrollStep>0?this._autoScrollGap:-this._autoScrollGap),this._direction==e.Style.VERTICAL?this.moveItemUIPosition(0,this._autoScrollStep):this.moveItemUIPosition(this._autoScrollStep,0),this._autoScrollGap-=Math.abs(this._autoScrollStep),this._autoScrollGap<=0&&(this.bounceBack&&(this.bounceBack=!1),this._autoScrollStep=0,this._autoScrollGap=0,e.HeartBeat.removeListener(this,this.doBounceBack))},i.prototype.removeRender=function(t){if(t){for(var i in this._dataIndexToRender)if(this._dataIndexToRender[i]===t){delete this._dataIndexToRender[i];break}try{t.data=null,t.list=null}catch(n){}t&&t.parent&&t.parent.removeChild(t),e.ObjectPool.recycleClass(t,"list_"+this.name)}},i.prototype.moveItemUIPosition=function(t,i){for(var n=null,o=0,r=this._itemContainer.numChildren-1;r>=0;r--)n=this._itemContainer.getChildAt(r),this._direction==e.Style.VERTICAL?(this._fixed||(n.y+=i),0>i?this._dataIndexEnd<this._itemDatas.length-1&&(this._itemContainer.getChildAt(this._itemContainer.numChildren-1).y+this._itemContainer.getChildAt(this._itemContainer.numChildren-1).height+this._gap<this._itemContainer.height&&(o=this.addUIItem(this._dataIndexEnd+1,!1),this._dataIndexEnd+=o),n.y+n.height<0&&(this.removeRender(n),this._dataIndexBegin++)):this._dataIndexBegin>0&&(this._itemContainer.getChildAt(0).y-this._gap>0&&(o=this.addUIItem(this._dataIndexBegin-this._line,!0),this._dataIndexBegin-=o),n.y>this._itemContainer.height&&(this.removeRender(n),this._dataIndexEnd--))):(this._fixed||(n.x+=t),0>t?this._dataIndexEnd<this._itemDatas.length-1&&(this._itemContainer.getChildAt(this._itemContainer.numChildren-1).x+n.width+this._gap<this._itemContainer.width&&(o=this.addUIItem(this._dataIndexEnd+1,!1),this._dataIndexEnd+=o),n.x+n.width<0&&(this.removeRender(this._itemContainer.getChildAt(r)),this._dataIndexBegin++)):this._dataIndexBegin>0&&(this._itemContainer.getChildAt(0).x-this._gap>0&&(o=this.addUIItem(this._dataIndexBegin-this.line,!0),this._dataIndexBegin-=o),n.x>this._itemContainer.width&&(this.removeRender(this._itemContainer.getChildAt(r)),this._dataIndexEnd--)))},i.prototype.addUIItem=function(t,i){var n=this;if(!n._itemDatas||0>t||t>=n._itemDatas.length)return 0;for(var o=0,r=0,a=0;o<n._line&&!(!n._itemDatas||0>t||t>=n._itemDatas.length);){var s=e.ObjectPool.getByClass(n._itemRenderer,"list_"+n.name);try{s.data=n._itemDatas[t],s.dataIndex=t,s.list=n,s.validateNow()}catch(l){}if(n._autoSize&&(n._direction==e.Style.VERTICAL?s.width=(n._itemContainer.width-(n._line-1)*n._gap)/n._line:s.height=(n._itemContainer.height-(n._line-1)*n._gap)/n._line),n._direction==e.Style.VERTICAL){if(a=(s.width+n._lineGap)*o,n._itemContainer.numChildren>0&&0==o&&(i?(r=n._itemContainer.getChildAt(0).y,r-=n._gap+s.height):(r=n._itemContainer.getChildAt(n._itemContainer.numChildren-1).y,r+=(n._gap+n._itemContainer.getChildAt(n._itemContainer.numChildren-1).height)*(o+1))),r>n._itemContainer.height||r<-s.height)return n.removeRender(s),o;s.x=a,s.y=r}else{if(r=(s.height+n._lineGap)*o,n._itemContainer.numChildren>0&&0==o&&(i?(a=n._itemContainer.getChildAt(0).x,a-=n._gap+s.width):(a=n._itemContainer.getChildAt(n._itemContainer.numChildren-1).x,a+=(n._gap+n._itemContainer.getChildAt(n._itemContainer.numChildren-1).width)*(o+1))),a>n._itemContainer.width||a<-s.width)return n.removeRender(s),o;s.x=a,s.y=r}i?n._itemContainer.addChildAt(s,0):n._itemContainer.addChild(s),n._dataIndexToRender[""+t]=s,o++,t++}return t>=n._itemDatas.length&&o>0&&n._data_end_func_call&&n._data_end_func_call.call(n._data_end_func_this),o},i.prototype.initList=function(){if(this._data&&this._data instanceof Array&&this._data.length>0&&!this._itemDatas){this._itemDatas=null,this._dataIndexToRender={},this.setItemContainerSize();for(var e=null;this._itemContainer.numChildren>0;)e=this._itemContainer.removeChildAt(0),e instanceof this._itemRenderer&&this.removeRender(e);if(this._itemDatas=this._data,0==this._itemDatas.length)return;this._dataIndexBegin=0;var t=this.addUIItem(this._dataIndexBegin,!1);for(this._dataIndexEnd=t;0!=t&&this._dataIndexEnd<this._itemDatas.length;)t=this.addUIItem(this._dataIndexEnd,!1),this._dataIndexEnd+=t;this._dataIndexEnd--}},Object.defineProperty(i.prototype,"data",{set:function(e){this._data=e},enumerable:!1,configurable:!0}),i.prototype.append=function(e){e&&(this._itemDatas=this._itemDatas.concat(e))},i.prototype.draw=function(){t.prototype.draw.call(this),0!=this.width&&0!=this.height&&this.initList()},i.prototype.setItemContainerSize=function(){this._itemContainer.width=this.width-this._marginLeft-this._marginRight,this._itemContainer.height=this.height-this._marginTop-this._marginBottom,this._itemContainer.x=this._marginLeft,this._itemContainer.y=this._marginTop,this._itemContainer.scrollRect.width=this._itemContainer.width,this._itemContainer.scrollRect.height=this._itemContainer.height},i.prototype.setHorizontalLayout=function(){this.layout=e.Style.HORIZONTAL},i.prototype.setVerticalLayout=function(){this.layout=e.Style.VERTICAL},Object.defineProperty(i.prototype,"layout",{get:function(){return this._direction},set:function(e){this._direction=e,this.invalidate()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"selected",{get:function(){return this._selected},set:function(e){var t=null;this._selected=e;for(var n=0;n<this._itemContainer.numChildren;n++){t=this._itemContainer.getChildAt(n),t.selected&&(t.selected=!1);try{t._data==e&&(t.selected=!0,this.dispatchEventWith(i.ITEM_SELECTED,!1,{item:t},!1))}catch(o){}}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"selectedIndex",{get:function(){return this._selected?this._data.indexOf(this._selected):-1},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"itemRenderer",{get:function(){return this._itemRenderer},set:function(e){this._itemRenderer!=e&&(this._itemRenderer=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"autoSize",{get:function(){return this._autoSize},set:function(e){this._autoSize!=e&&(this._autoSize=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"marginTop",{get:function(){return this._marginTop},set:function(e){this._marginTop!=e&&(this._marginTop=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"marginBottom",{get:function(){return this._marginBottom},set:function(e){this._marginBottom!=e&&(this._marginBottom=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"marginLeft",{get:function(){return this._marginLeft},set:function(e){this._marginLeft=e,this.invalidate()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"marginRight",{get:function(){return this._marginRight},set:function(e){(this._marginRight=e)&&(this._marginRight=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"gap",{get:function(){return this._gap},set:function(e){this._gap=e,this.invalidate()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"line",{get:function(){return this._line},set:function(e){this._line=e,this._line<1&&(this._line=1),this.invalidate()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lineGap",{get:function(){return this._lineGap},set:function(e){this._lineGap=e,this._lineGap<0&&(this._lineGap=0),this.invalidate()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fixed",{get:function(){return this._fixed},set:function(e){this._fixed!=e&&(this._fixed=e,this.invalidate())},enumerable:!1,configurable:!0}),i.prototype.setDataEndCall=function(e,t){this._data_end_func_call=e,this._data_end_func_this=t},i.ITEM_SELECTED="ITEM_SELECTED",i}(e.Group);e.List=t,__reflect(t.prototype,"codeBase.List",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function i(){var n=t.call(this)||this;return n.METHOD_DEF={},n._dataItems=[],n._itemContainer=null,n._itemRenderer=e.DefaultRenderer,n._itemIndexToRender=null,n._speed=150,n._delay=3e3,n._align=i.ALIGN_BOTTOM,n._gapFactor=1,n._direction=i.SCROLL_LEFT,n._firstGapWidth=0,n._scaleFactor=.1,n._maxTextureWidth=0,n._maxTextureHeight=0,n._totalLength=0,n._middleIndex=0,n._middleItemX=0,n._middleItemY=0,n._firstItemIndex=0,n._gap=2,n._stop=!1,n._delayIndex1=0,n._delayIndex2=0,n._destroyIndex=0,n}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.setSize(300,300),this._itemContainer=new e.Group,this.addChild(this._itemContainer),this._itemContainer.showBg=!1,this._itemContainer.setSize(this.width,this.height),this.addHandleEvent(e.EventType.RESOURCE_DOWNLOADED,"onMyEventResDownloaded")},i.prototype.addHandleEvent=function(t,i){e.MessageControler.addEvent(t),this.METHOD_DEF[t]=i},i.prototype.receiveEvent=function(e){for(var t=null,i=0;i<this._itemContainer.numChildren;i++)t=this._itemContainer.getChildAt(i),t.refresh&&t.refresh()},Object.defineProperty(i.prototype,"data",{get:function(){return this._data},set:function(t){if(t){this._data=t,this._dataItems=null,this._itemIndexToRender={};for(var i=null;this._itemContainer.numChildren>0;)i=this._itemContainer.removeChildAt(0),i.data&&(i.data=null),e.ObjectPool.recycleClass(i,"listad_"+this.name);if(t instanceof Array){if(this._dataItems=t,0==this._dataItems.length)return;this._totalLength=this._dataItems.length,this._totalLength%2==0?this._middleIndex=this._totalLength/2:this._totalLength%2==1&&(this._middleIndex=(this._totalLength-1)/2),this._firstItemIndex=0;for(var n=0;n<this._totalLength;)this.addItem(n),n++;this._dataItems.length<=3}}},enumerable:!1,configurable:!0}),i.prototype.reserveModel=function(){},i.prototype.addItem=function(t){var i=e.ObjectPool.getByClass(this._itemRenderer,"listad_"+this.name);i.setSize(200,200),i.anchorOffsetX=.5*i.width,i.anchorOffsetY=.5*i.height,this._itemContainer.addChild(i),this._itemContainer.removeChild(i),i&&i.validateNow&&i.validateNow(),this._firstGapWidth||(this._firstGapWidth=i.width/2),this._middleItemX=this._itemContainer.width/2,this._middleItemY=this._itemContainer.height/2,Math.abs(t-this._middleIndex)<=1&&(t-this._middleIndex==-1?(this._itemContainer.addChild(i),i.x=(t-this._middleIndex)*this._firstGapWidth+this._middleItemX):t==this._middleIndex?(this._itemContainer.addChild(i),i.x=this._middleItemX):t-this._middleIndex==1&&(this._itemContainer.addChildAt(i,1),i.x=this._middleItemX+(t-this._middleIndex)*this._firstGapWidth,i.bgColor=0),i.scaleY=1-Math.abs(t-this._middleIndex)*this._scaleFactor,i.alpha=1-Math.abs(t-this._middleIndex)*this._scaleFactor,i.y=Math.abs(t-this._middleIndex)*this._scaleFactor*i.height*i.anchorOffsetY*this._gapFactor+this._middleItemY),i.data=this._dataItems[t],this._itemIndexToRender[""+t]=i},i.prototype.start=function(){this._delayIndex2&&egret.clearTimeout(this._delayIndex2);var e=0,t=0,i=0,n=0,o=0,r=0,a=0,s=0,l=0,h=[];a=this._middleIndex-1,0>a&&(a=this._totalLength-1),s=this._middleIndex,l=this._middleIndex+1,l==this._totalLength&&(l=0),h=[a,s,l];for(var c=0;c<h.length;c++)e=this._itemIndexToRender[""+h[c]].x,t=this._itemIndexToRender[""+h[c]].y,i=this._itemIndexToRender[""+h[c]].scaleY,n=this._itemIndexToRender[""+h[c]].alpha,o=this._itemIndexToRender[""+h[c]].height,r=this._itemIndexToRender[""+h[c]].anchorY,"left"==this._direction?(this._destroyIndex=a,0==c?egret.Tween.get(this._itemIndexToRender[""+h[c]]).to({x:e+this._firstGapWidth,y:t+this._scaleFactor*o*r*this._gapFactor,scaleY:i-this._scaleFactor,alpha:0},this._speed):1==c?egret.Tween.get(this._itemIndexToRender[""+h[c]]).to({x:e-this._firstGapWidth,y:t+this._scaleFactor*o*r*this._gapFactor,scaleY:i-this._scaleFactor,alpha:n-this._scaleFactor},this._speed):2==c&&egret.Tween.get(this._itemIndexToRender[""+h[c]]).to({x:e-this._firstGapWidth,y:t-this._scaleFactor*o*r*this._gapFactor,scaleY:i+this._scaleFactor,alpha:n+this._scaleFactor},this._speed)):"right"==this._direction&&(this._destroyIndex=l,0==c?egret.Tween.get(this._itemIndexToRender[""+h[c]]).to({x:e+this._firstGapWidth,y:t-this._scaleFactor*o*r*this._gapFactor,scaleY:i+this._scaleFactor,alpha:n+this._scaleFactor},this._speed):1==c?egret.Tween.get(this._itemIndexToRender[""+h[c]]).to({x:e+this._firstGapWidth,y:t+this._scaleFactor*o*r*this._gapFactor,scaleY:i-this._scaleFactor,alpha:n-this._scaleFactor},this._speed):2==c&&egret.Tween.get(this._itemIndexToRender[""+h[c]]).to({x:e-this._firstGapWidth,y:t-this._scaleFactor*o*r*this._gapFactor,scaleY:i+this._scaleFactor,alpha:0},this._speed));"left"==this._direction?(this._middleIndex++,this._middleIndex==this._totalLength&&(this._middleIndex=0)):"right"==this._direction&&(this._middleIndex--,this._middleIndex<0&&(this._middleIndex=this._totalLength-1)),this.addNewItem(this._direction),this._delayIndex1=egret.setTimeout(this.refreshTree,this,this._speed)},i.prototype.stop=function(){for(var e in this._itemIndexToRender)egret.Tween.removeTweens(this._itemIndexToRender[e]);this._delayIndex1&&egret.clearTimeout(this._delayIndex1),this._delayIndex2&&egret.clearTimeout(this._delayIndex2)},i.prototype.addNewItem=function(e,t){void 0===t&&(t=this._middleIndex),"left"==e?(t++,t==this._totalLength&&(t=0)):"right"==e&&(t--,0>t&&(t=this._totalLength-1));var i=this._itemIndexToRender[""+t];this._itemContainer.addChildAt(i,1),i.alpha=0,i.anchorX=.5,i.anchorY=.5,i.scaleY=1,i.x=this._middleItemX,i.y=this._middleItemY,i.bgColor=0,i.data=i._data,"left"==e?egret.Tween.get(i).to({x:i.x+this._firstGapWidth,y:i.y+this._scaleFactor*i.height*i.anchorY*this._gapFactor,scaleY:1-this._scaleFactor,alpha:1-this._scaleFactor},this._speed):"right"==e&&egret.Tween.get(i).to({x:i.x-this._firstGapWidth,y:i.y+this._scaleFactor*i.height*i.anchorY*this._gapFactor,scaleY:1-this._scaleFactor,alpha:1-this._scaleFactor},this._speed)},i.prototype.refreshTree=function(){for(var e in this._itemIndexToRender)egret.Tween.removeTweens(this._itemIndexToRender[e]);
this._delayIndex1&&egret.clearTimeout(this._delayIndex1),this._itemIndexToRender[""+this._destroyIndex].removeFromParent(),this._itemContainer.addChildAt(this._itemIndexToRender[""+this._middleIndex],this._totalLength),this._delayIndex2=egret.setTimeout(this.start,this,this._delay)},Object.defineProperty(i.prototype,"direction",{get:function(){return this._direction},set:function(e){e&&(this._direction=e)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"align",{get:function(){return this._align},set:function(e){if("bottom"==e)this._align=e,this._gapFactor=1;else{if("center"!=e)return;this._align=e,this._gapFactor=.2}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"speed",{get:function(){return this._speed},set:function(e){!e||0>=e||(this._speed=e)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"delay",{get:function(){return this._delay},set:function(e){!e||0>=e||(this._delay=e)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"itemRenderer",{get:function(){return this._itemRenderer},set:function(e){this._itemRenderer!=e&&(this._itemRenderer=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"gap",{get:function(){return this._gap},set:function(e){this._gap=e,this.invalidate()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"scaleFactor",{get:function(){return this._scaleFactor},set:function(e){this._scaleFactor=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"firstGapWidth",{get:function(){return this._firstGapWidth},set:function(e){e&&(this._firstGapWidth=e)},enumerable:!1,configurable:!0}),i.ALIGN_BOTTOM="bottom",i.ALIGN_CENTER="center",i.SCROLL_UP="up",i.SCROLL_DOWN="down",i.SCROLL_LEFT="left",i.SCROLL_RIGHT="right",i}(e.Group);e.ListAd=t,__reflect(t.prototype,"codeBase.ListAd",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e._moveFunc=null,e._moveFuncThis=null,e._scrollItemArr=[],e._clip=!0,e._running=!1,e._autoplay=!1,e}return __extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this)},n.prototype.setScrollData=function(t,o,r,a){void 0===o&&(o=3),void 0===r&&(r=n.SCROLL_DOWN),void 0===a&&(a=0);var s=e.ObjectPool.getByClass(i);this.addChild(s),this._scrollItemArr.push(s),s.width=this.width,s.height=this.height,s.setScrollData(t,o,r,a),this.invalidate()},n.prototype.delScrollData=function(e){void 0===e&&(e=-1);var t=null;if(-1>=e)for(;this._scrollItemArr.length>0;)t=this._scrollItemArr.pop(),t&&t.removeFromParent();else e<this._scrollItemArr.length&&(t=this._scrollItemArr[e],t&&(t.removeFromParent(),this._scrollItemArr.splice(e,1)))},n.prototype.play=function(t){void 0===t&&(t=-1),this._running=!0,this.setItemState(n.STATE_START,t),e.HeartBeat.addListener(this,this.onHeartBeat)},n.prototype.stop=function(t){void 0===t&&(t=-1),this.setItemState(n.STATE_STOP,t),this._running||e.HeartBeat.removeListener(this,this.onHeartBeat)},n.prototype.pause=function(t){void 0===t&&(t=-1),this.setItemState(n.STATE_STOP,t),this._running||e.HeartBeat.removeListener(this,this.onHeartBeat)},n.prototype.restart=function(t){void 0===t&&(t=-1),this.setItemState(n.STATE_START,t),e.HeartBeat.addListener(this,this.onHeartBeat)},n.prototype.setSpeed=function(e,t){if(void 0===t&&(t=-1),-1>=t)for(var i=0;i<this._scrollItemArr.length;i++)this._scrollItemArr[i].speed=e;else t>=0&&t<=this._scrollItemArr.length-1&&(this._scrollItemArr[t].speed=e)},n.prototype.setDirection=function(e,t){if(void 0===t&&(t=-1),-1>=t)for(var i=0;i<this._scrollItemArr.length;i++)this._scrollItemArr[i].direction=e;else t>=0&&t<=this._scrollItemArr.length-1&&(this._scrollItemArr[t].direction=e)},n.prototype.setItemState=function(e,t){if(void 0===t&&(t=-1),-1>=t)for(var i=0;i<this._scrollItemArr.length;i++)this._scrollItemArr[i]._state=e;else t>=0&&t<=this._scrollItemArr.length-1&&(this._scrollItemArr[t]._state=e);if(e==n.STATE_START)this._running=!0;else{this._running=!1;for(var i=0;i<this._scrollItemArr.length;i++)if(this._scrollItemArr[i]._state==n.STATE_START){this._running=!0;break}}},n.prototype.onHeartBeat=function(){for(var e=0;e<this._scrollItemArr.length;e++)this._scrollItemArr[e].onHeartBeat();this._moveFunc&&this._moveFunc.call(this._moveFuncThis)},n.prototype.draw=function(){if(0!=this.width&&0!=this.height&&(this._clip?null==this.scrollRect?this.scrollRect=new egret.Rectangle(0,0,this.width,this.height):(this.scrollRect.width=this.width,this.scrollRect.height=this.height):this.scrollRect=null,this.width!=e.Style.BASEGROUP_WIDTH||this.height!=e.Style.BASEGROUP_HEIGHT))for(var t=0;t<this._scrollItemArr.length;t++)(this._scrollItemArr[t].width==e.Style.BASEGROUP_WIDTH||0==this._scrollItemArr[t].width)&&(this._scrollItemArr[t].width=this.width),(this._scrollItemArr[t].height==e.Style.BASEGROUP_HEIGHT||0==this._scrollItemArr[t].height)&&(this._scrollItemArr[t].height=this.height),this._scrollItemArr[t]._initData=!1},Object.defineProperty(n.prototype,"clip",{get:function(){return this._clip},set:function(e){e!=this._clip&&(this._clip=e,this.invalidate())},enumerable:!1,configurable:!0}),n.prototype.setMoveCallbackFunc=function(e,t){this._moveFunc=e,this._moveFuncThis=t},Object.defineProperty(n.prototype,"autoplay",{get:function(){return this._autoplay},set:function(e){this._autoplay!=e&&(this._autoplay=e)},enumerable:!1,configurable:!0}),n.SCROLL_UP="up",n.SCROLL_DOWN="down",n.SCROLL_LEFT="left",n.SCROLL_RIGHT="right",n.STATE_START="start",n.STATE_STOP="stop",n}(e.BaseGroup);e.ScrollGroup=t,__reflect(t.prototype,"codeBase.ScrollGroup",[]);var i=function(i){function n(){var e=i.call(this)||this;return e.speed=0,e.gap=0,e.direction=t.SCROLL_DOWN,e._textures=null,e._scrollTextureIndex=0,e._scrollBitmapArr=null,e._state=t.STATE_STOP,e._initData=!1,e._textureWidth=0,e._textureHeight=0,e._totalBitmapLength=0,e._limitDistance=0,e._clip=!0,e._textureIndex=0,e}return __extends(n,i),n.prototype.createChildren=function(){i.prototype.createChildren.call(this)},n.prototype.setScrollData=function(i,n,o,r){void 0===n&&(n=3),void 0===r&&(r=0),this._initData=!1,this.gap=r,this.direction=o,this._textureIndex=0,this._textures=i,this._textureWidth=this._textures[0].textureWidth,this._textureHeight=this._textures[0].textureHeight,this.speed=n;this._textures.length;if(this._scrollBitmapArr&&this._scrollBitmapArr.length>0)for(var a=null;this._scrollBitmapArr.length>0;)a=this._scrollBitmapArr.pop(),a.parent&&a.parent.removeChild(a),e.ObjectPool.recycleClass(a,"scroll_group");if(this._scrollBitmapArr=[],this._totalBitmapLength=0,this._limitDistance=0,this.direction==t.SCROLL_DOWN||this.direction==t.SCROLL_UP)for(;this._limitDistance<this.height;)this._textureIndex>=this._textures.length&&(this._textureIndex=0),this._limitDistance+=this._textures[this._textureIndex].textureHeight+this.gap,this._textureIndex++,this._totalBitmapLength++;else if(this.direction==t.SCROLL_LEFT||this.direction==t.SCROLL_RIGHT)for(;this._limitDistance<this.width;)this._textureIndex>=this._textures.length&&(this._textureIndex=0),this._limitDistance+=this._textures[this._textureIndex].textureWidth+this.gap,this._textureIndex++,this._totalBitmapLength++;for(var s=0;s<this._totalBitmapLength;s++){var l=e.ObjectPool.getByClass(egret.Bitmap,"scroll_group");this._scrollBitmapArr.push(l)}for(var h=0;h<this._scrollBitmapArr.length;h++)this.addChild(this._scrollBitmapArr[h]),this.getTexture(this._scrollBitmapArr[h]),this._scrollBitmapArr[h]&&(this._scrollBitmapArr[h].width=this._scrollBitmapArr[h].texture.textureWidth,this._scrollBitmapArr[h].height=this._scrollBitmapArr[h].texture.textureHeight);this.initScrollBitmapData()},n.prototype.initScrollBitmapData=function(){if(!this._initData)if(this._initData=!0,this.direction==t.SCROLL_UP)for(var e=0;e<this._scrollBitmapArr.length;e++)this._scrollBitmapArr[e].x=0,0==e?this._scrollBitmapArr[0].y=0:e>0&&(this._scrollBitmapArr[e].y=this._scrollBitmapArr[e-1].y+this._scrollBitmapArr[e-1].texture.textureHeight+this.gap);else if(this.direction==t.SCROLL_DOWN)for(var e=0;e<this._scrollBitmapArr.length;e++)this._scrollBitmapArr[e].x=0,0==e?this._scrollBitmapArr[0].y=this.height-this._scrollBitmapArr[0].texture.textureHeight:e>0&&(this._scrollBitmapArr[e].y=this._scrollBitmapArr[e-1].y-this._scrollBitmapArr[e].texture.textureHeight-this.gap);else if(this.direction==t.SCROLL_LEFT)for(var e=0;e<this._scrollBitmapArr.length;e++)this._scrollBitmapArr[e].y=0,0==e?this._scrollBitmapArr[0].x=0:e>0&&(this._scrollBitmapArr[e].x=this._scrollBitmapArr[e-1].x+this._scrollBitmapArr[e-1].texture.textureWidth+this.gap);else if(this.direction==t.SCROLL_RIGHT)for(var e=0;e<this._scrollBitmapArr.length;e++)this._scrollBitmapArr[e].y=0,0==e?this._scrollBitmapArr[0].x=this.width-this._scrollBitmapArr[0].texture.textureWidth:e>0&&(this._scrollBitmapArr[e].x=this._scrollBitmapArr[e-1].x-this._scrollBitmapArr[e].texture.textureWidth-this.gap)},n.prototype.getTexture=function(e){var t=this._textures[this._scrollTextureIndex];return this._scrollTextureIndex++,this._scrollTextureIndex>=this._textures.length&&(this._scrollTextureIndex=0),e.scaleX=1,e.scaleY=1,e.alpha=1,e.rotation=0,e.texture=t,e.width=t.textureWidth,e.height=t.textureHeight,t},n.prototype.onHeartBeat=function(){if(this._state!=t.STATE_STOP)if(this._initData||this.initScrollBitmapData(),this.direction==t.SCROLL_UP){for(var i=0;i<this._scrollBitmapArr.length;i++)this._scrollBitmapArr[i].y-=this.speed;if(this._scrollBitmapArr[this._scrollBitmapArr.length-1].y<=this.height-this._scrollBitmapArr[this._scrollBitmapArr.length-1].texture.textureHeight-this.speed){var n=e.ObjectPool.getByClass(egret.Bitmap,"scroll_group");this.addChild(n),this.getTexture(n),n.x=this._scrollBitmapArr[this._scrollBitmapArr.length-1].x,n.y=this._scrollBitmapArr[this._scrollBitmapArr.length-1].y+this._scrollBitmapArr[this._scrollBitmapArr.length-1].texture.textureHeight+this.gap,this._scrollBitmapArr.push(n)}if(this._scrollBitmapArr[0].y+this._scrollBitmapArr[0].texture.textureHeight<=0){var n=this._scrollBitmapArr.splice(0,1)[0];n.parent&&n.parent.removeChild(n),e.ObjectPool.recycleClass(n,"scroll_group")}}else if(this.direction==t.SCROLL_DOWN){for(var i=0;i<this._scrollBitmapArr.length;i++)this._scrollBitmapArr[i].y+=this.speed;if(this._scrollBitmapArr[this._scrollBitmapArr.length-1].y>=-this.speed){var n=e.ObjectPool.getByClass(egret.Bitmap,"scroll_group");this.addChild(n),this.getTexture(n),n.x=this._scrollBitmapArr[this._scrollBitmapArr.length-1].x,n.y=this._scrollBitmapArr[this._scrollBitmapArr.length-1].y-n.texture.textureHeight-this.gap,this._scrollBitmapArr.push(n)}if(this._scrollBitmapArr[0].y>=this.height){var n=this._scrollBitmapArr.splice(0,1)[0];n.parent&&n.parent.removeChild(n),e.ObjectPool.recycleClass(n,"scroll_group")}}else if(this.direction==t.SCROLL_LEFT){for(var i=0;i<this._scrollBitmapArr.length;i++)this._scrollBitmapArr[i].x-=this.speed;if(this._scrollBitmapArr[this._scrollBitmapArr.length-1].x<=this.width-this._scrollBitmapArr[this._scrollBitmapArr.length-1].texture.textureWidth-this.speed){var n=e.ObjectPool.getByClass(egret.Bitmap,"scroll_group");this.addChild(n),this.getTexture(n),n.y=this._scrollBitmapArr[this._scrollBitmapArr.length-1].y,n.x=this._scrollBitmapArr[this._scrollBitmapArr.length-1].x+this._scrollBitmapArr[this._scrollBitmapArr.length-1].texture.textureWidth+this.gap,this._scrollBitmapArr.push(n)}if(this._scrollBitmapArr[0].x+this._scrollBitmapArr[0].texture.textureWidth<=0){var n=this._scrollBitmapArr.splice(0,1)[0];n.parent&&n.parent.removeChild(n),e.ObjectPool.recycleClass(n,"scroll_group")}}else if(this.direction==t.SCROLL_RIGHT){for(var i=0;i<this._scrollBitmapArr.length;i++)this._scrollBitmapArr[i].x+=this.speed;if(this._scrollBitmapArr[this._scrollBitmapArr.length-1].x>=-this.speed){var n=e.ObjectPool.getByClass(egret.Bitmap,"scroll_group");this.addChild(n),this.getTexture(n),n.y=this._scrollBitmapArr[this._scrollBitmapArr.length-1].y,n.x=this._scrollBitmapArr[this._scrollBitmapArr.length-1].x-n.texture.textureWidth-this.gap,this._scrollBitmapArr.push(n)}if(this._scrollBitmapArr[0].x>=this.width){var n=this._scrollBitmapArr.splice(0,1)[0];n.parent&&n.parent.removeChild(n),e.ObjectPool.recycleClass(n,"scroll_group")}}},n.prototype.draw=function(){0!=this.width&&0!=this.height&&(this._clip?null==this.scrollRect?this.scrollRect=new egret.Rectangle(0,0,this.width,this.height):(this.scrollRect.width=this.width,this.scrollRect.height=this.height):this.scrollRect=null)},Object.defineProperty(n.prototype,"clip",{get:function(){return this._clip},set:function(e){e!=this._clip&&(this._clip=e,this.invalidate())},enumerable:!1,configurable:!0}),n}(e.BaseGroup);__reflect(i.prototype,"codeBase.ScrollItemGroup",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){}return e.setStyle=function(t){switch(t){case e.DARK:e.BACKGROUND=4473924,e.BUTTON_FACE=6710886,e.BUTTON_DOWN=2236962,e.INPUT_TEXT=12303291,e.LABEL_TEXT=13421772,e.PANEL=6710886,e.PROGRESS_BAR=6710886,e.TEXT_BACKGROUND=5592405,e.LIST_DEFAULT=4473924,e.LIST_ALTERNATE=3750201,e.LIST_SELECTED=6710886,e.LIST_ROLLOVER=7829367;break;case e.LIGHT:default:e.BACKGROUND=13421772,e.BUTTON_FACE=16777215,e.BUTTON_DOWN=15658734,e.INPUT_TEXT=3355443,e.LABEL_TEXT=6710886,e.PANEL=15987699,e.PROGRESS_BAR=16777215,e.TEXT_BACKGROUND=16777215,e.LIST_DEFAULT=16777215,e.LIST_ALTERNATE=15987699,e.LIST_SELECTED=13421772,e.LIST_ROLLOVER=14540253}},e.TEXT_BACKGROUND=16777215,e.BACKGROUND=13421772,e.BUTTON_FACE=16777215,e.BUTTON_DOWN=15658734,e.INPUT_TEXT=3355443,e.LABEL_TEXT=0,e.BUTTON_TEXT=6710886,e.DROPSHADOW=0,e.PANEL=15987699,e.PROGRESS_BAR=16777215,e.LIST_DEFAULT=16777215,e.LIST_ALTERNATE=15987699,e.LIST_SELECTED=13421772,e.LIST_ROLLOVER=14540253,e.BUTTON_DEFAULT_WIDTH=100,e.BUTTON_DEFAULT_HEIGHT=32,e.VIDEO_DEFAULT_WIDTH=320,e.VIDEO_DEFAULT_HEIGHT=250,e.embedFonts=!1,e.fontName=null,e.fontSize=26,e.allowDefaultLabelFilter=!0,e.DARK="dark",e.LIGHT="light",e.allowColorFilterButtonEnabled=!1,e.allowButtonDefaultCoolDown=!1,e.defaultCoolDownFrames=2,e.TEXTINPUT_HEIGHT=25,e.TEXTINPUT_WIDTH=100,e.TEXTINPUT_COLOR=16777215,e.HORIZONTAL="horizontal",e.VERTICAL="vertical",e.SLIDER_WIDTH=300,e.SLIDER_HEIGHT=17,e.SCROLLBAR_WIDTH=300,e.SCROLLBAR_HEIGHT=17,e.BASEGROUP_WIDTH=100,e.BASEGROUP_HEIGHT=100,e}();e.Style=t,__reflect(t.prototype,"codeBase.Style",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function i(){var n=t.call(this)||this;return n._text="",n._initFlow=null,n._htmlTextParser=null,n._textField=null,n._fontSize=e.Style.fontSize,n._color=e.Style.LABEL_TEXT,n._fontName=e.Style.fontName,n._hAlign=egret.HorizontalAlign.LEFT,n._vAlign=egret.VerticalAlign.TOP,n._bold=!1,n._italic=!1,n._lineSpacing=0,n._stroke=0,n._strokeColor=13136,n._html=!1,n._editable=!1,n._maxChars=0,n._restrict=null,n._inputType=null,n._followForce=!1,n._follow=i.FOLLOW_NONE,n.isAddScollListener=!1,n._link=null,n._paddingLeft=0,n._paddingRight=0,n._paddingTop=0,n._paddingBottom=0,n._isTouchBegin=!1,n._touchPoint=null,n.moveDelta=0,n}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._textField=new egret.TextField,this._textField.multiline=!0,this._textField.addEventListener(egret.Event.CHANGE,this.onTextChange,this),this.addChild(this._textField),this.touchChildren=!1},i.prototype.initData=function(){t.prototype.initData.call(this)},i.prototype.onSetScrollText=function(e){e&&!this.isAddScollListener?(this.isAddScollListener=!0,this.touchNonePixel=!0,this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancel,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchCancel,this)):!e&&this.isAddScollListener&&(this.isAddScollListener=!1,this.touchNonePixel=!1,this.touchEnabled=!1,this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancel,this),this.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchCancel,this))},i.prototype.onTouchBegin=function(e){this._isTouchBegin=!0,this.moveDelta=0,null==this._touchPoint&&(this._touchPoint=new egret.Point),this._touchPoint.x=e.stageX,this._touchPoint.y=e.stageY},i.prototype.onTouchEnd=function(e){this._isTouchBegin=!1},i.prototype.onTouchMove=function(e){this._isTouchBegin&&(this.moveDelta+=Math.abs(e.stageY-this._touchPoint.y),this.moveDelta>=this._fontSize&&(this.moveDelta-=this._fontSize,e.stageY-this._touchPoint.y>0?this._textField.scrollV>1&&(this._textField.scrollV=this._textField.scrollV-1):this._textField.scrollV<this._textField.numLines-1&&(this._textField.scrollV=this._textField.scrollV+1)),this._touchPoint.x=e.stageX,this._touchPoint.y=e.stageY)},i.prototype.onTouchCancel=function(e){this._isTouchBegin=!1},i.prototype.onTextChange=function(e){this._text=this._textField.text},Object.defineProperty(i.prototype,"paddingLeft",{get:function(){return this._paddingLeft},set:function(e){this._paddingLeft!=e&&(this._paddingLeft=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"paddingRight",{get:function(){return this._paddingRight},set:function(e){this._paddingRight!=e&&(this._paddingRight=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"paddingTop",{get:function(){return this._paddingTop},set:function(e){this._paddingTop!=e&&(this._paddingTop=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"paddingBottom",{get:function(){return this._paddingBottom},set:function(e){this._paddingBottom!=e&&(this._paddingBottom=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"text",{get:function(){return this._text},set:function(e){this._text!=e&&(this._text=e,this._html?null==this._text?(this._text="",this._initFlow=[]):(null==this._htmlTextParser&&(this._htmlTextParser=new egret.HtmlTextParser),this._initFlow=this._htmlTextParser.parser(this._text)):null==this._text&&(this._text=""),this.invalidate())},enumerable:!1,configurable:!0}),i.prototype.append=function(e){var t=this._textField.numLines,n=this._textField.scrollV;if(this._html){null==this._htmlTextParser&&(this._htmlTextParser=new egret.HtmlTextParser);var o=this._htmlTextParser.parser(e);if(this._follow==i.FOLLOW_TOP){o.reverse();for(var r=0;r<o.length;r++)this._textField.textFlow.unshift(o[r]);this._textField.textFlow=this._textField.textFlow,this.draw()}else{for(var r=0;r<o.length;r++)this._textField.appendElement(o[r]);this._textField.textHeight>this.height?this.onSetScrollText(!0):this.onSetScrollText(!1)}}else this._follow==i.FOLLOW_TOP?(this._text=e+this._text,this.draw()):(this._textField.appendText(e),this._textField.textHeight>this.height?this.onSetScrollText(!0):this.onSetScrollText(!1));this._follow!=i.FOLLOW_NONE&&(this._follow==i.FOLLOW_TOP?(1==t||this._followForce)&&this.scrollTo(1):(t==n||this._followForce)&&this.scrollTo(this._textField.numLines))},i.prototype.scrollTo=function(e){this._textField&&(this._textField.scrollV=e)},i.prototype.getTextField=function(){return this._textField},i.prototype.draw=function(){if(t.prototype.draw.call(this),null!=this._textField){null!=this._fontName&&(this._textField.fontFamily=this.fontName),this._color>=0&&(this._textField.textColor=this._color),this._fontSize>0&&(this._textField.size=this._fontSize),this._textField.bold=this._bold,this._textField.italic=this._italic,this._html?(this._initFlow&&(this._textField.textFlow=this._initFlow),this._initFlow=null):this._textField.text=this._text,this._editable?(this.touchChildren=!0,this._textField.type=egret.TextFieldType.INPUT):(this.touchChildren=!1,this._textField.type=egret.TextFieldType.DYNAMIC),this._textField.maxChars=this._maxChars,e.StringUtil.isUsage(this._restrict)&&(this._textField.restrict=this._restrict),e.StringUtil.isUsage(this._inputType)&&(this._textField.inputType=this._inputType),this._textField.lineSpacing=this._lineSpacing,this._textField.stroke=this._stroke,this._textField.strokeColor=this._strokeColor,this._textField.width!=this.width&&(this._textField.width=this.width),this._textField.height!=this.height&&(this._textField.height=this.height);var i=this._textField.width-this._paddingLeft-this._paddingRight,n=this._textField.height-this._paddingTop-this._paddingBottom;this._textField.width=i,this._textField.height=n,this._textField.x=this._paddingLeft,this._textField.y=this._paddingTop,this._textField.textAlign=this._hAlign,this._textField.verticalAlign=this._vAlign,this._textField.textHeight>this.height?this.onSetScrollText(!0):this.onSetScrollText(!1)}},Object.defineProperty(i.prototype,"italic",{get:function(){return this._italic},set:function(e){this._italic!=e&&(this._italic=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"bold",{get:function(){return this._bold},set:function(e){this._bold!=e&&(this._bold=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontName",{get:function(){return this._fontName},set:function(e){this._fontName!=e&&(this._fontName=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!=e&&(this._fontSize=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"color",{get:function(){return this._color},set:function(e){this._color!=e&&(this._color=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lineSpacing",{get:function(){return this._lineSpacing},set:function(e){this._lineSpacing!=e&&(this._lineSpacing=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"stroke",{get:function(){return this._stroke},set:function(e){this._stroke!=e&&(this._stroke=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(e){this._strokeColor!=e&&(this._strokeColor=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"hAlign",{get:function(){return this._hAlign},set:function(e){this._hAlign!=e&&(this._hAlign=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"vAlign",{get:function(){return this._vAlign},set:function(e){this._vAlign!=e&&(this._vAlign=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"followForce",{get:function(){return this._followForce},set:function(e){this._followForce=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"follow",{get:function(){return this._follow},set:function(e){this._follow=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"html",{get:function(){return this._html},set:function(e){this._html!=e&&(this._html=e,this._html?this.touchChildren=!0:this.touchChildren=!1,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"editable",{get:function(){return this._editable},set:function(e){this._editable!=e&&(this._editable=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"maxChars",{get:function(){return this._maxChars},set:function(e){this._maxChars!=e&&(this._maxChars=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"restrict",{get:function(){return this._restrict},set:function(e){this._restrict!=e&&(this._restrict=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"inputType",{get:function(){return this._inputType},set:function(e){this._inputType!=e&&(this._inputType=e,this.invalidate())},enumerable:!1,configurable:!0}),i.FOLLOW_NONE="none",i.FOLLOW_TOP="top",i.FOLLOW_BOTTOM="bottom",i}(e.Group);e.TextArea=t,__reflect(t.prototype,"codeBase.TextArea",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(t){function i(){var i=t.call(this)||this;return i._textField=null,i._text="",i._password=!1,i._fontName=e.Style.fontName,i._fontSize=e.Style.fontSize,i._fontColor=e.Style.TEXTINPUT_COLOR,i._hAlign=egret.HorizontalAlign.LEFT,i._vAlign=egret.VerticalAlign.TOP,i._bold=!1,i._italic=!1,i._lineSpacing=10,i._multiline=!1,i._stroke=0,i._strokeColor=0,i._wordWrap=!0,i._maxChars=0,i._restrict=null,i._inputType=null,i._paddingLeft=0,i._paddingRight=0,i._paddingTop=0,i._paddingBottom=0,i}return __extends(i,t),i.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.bgColor=e.Style.INPUT_TEXT,this.clip=!1,this.touchEnabled=!0,this._textField=new egret.TextField,this._textField.height=this.height,this._textField.width=this.width,this._textField.displayAsPassword=!1,this._textField.type=egret.TextFieldType.INPUT,this._textField.addEventListener(egret.Event.CHANGE,this.onTextChange,this),this._textField.touchEnabled=!0,this.addChild(this._textField)},i.prototype.onTextChange=function(e){this._text=this._textField.text},i.prototype.getTextField=function(){return this._textField},i.prototype.draw=function(){if(t.prototype.draw.call(this),this._textField){null!=this._fontName&&(this._textField.fontFamily=this._fontName),this._textField.width!=this.width&&(this._textField.width=this.width),this._textField.height!=this.height&&(this._textField.height=this.height);var i=this._textField.width-this._paddingLeft-this._paddingRight,n=this._textField.height-this._paddingTop-this._paddingBottom;this._textField.width=i,this._textField.height=n,this._textField.x=this._paddingLeft,this._textField.y=this._paddingTop,this._fontColor>=0&&(this._textField.textColor=this._fontColor),this._fontSize>0&&(this._textField.size=this._fontSize),this._textField.textAlign=this._hAlign,this._textField.verticalAlign=this._vAlign,this._textField.bold=this._bold,this._textField.italic=this._italic,this._textField.multiline=this._multiline,this._textField.lineSpacing=this._lineSpacing,this._textField.stroke=this._stroke,this._textField.strokeColor=this._strokeColor,this._textField.displayAsPassword=this._password,this._textField.text=this._text,this._textField.wordWrap=this._wordWrap,this._textField.maxChars=this._maxChars,e.StringUtil.isUsage(this._restrict)&&(this._textField.restrict=this._restrict),e.StringUtil.isUsage(this._inputType)&&(this._textField.inputType=this._inputType)}},Object.defineProperty(i.prototype,"paddingLeft",{get:function(){return this._paddingLeft},set:function(e){this._paddingLeft!=e&&(this._paddingLeft=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"paddingRight",{get:function(){return this._paddingRight},set:function(e){this._paddingRight!=e&&(this._paddingRight=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"paddingTop",{get:function(){return this._paddingTop},set:function(e){this._paddingTop!=e&&(this._paddingTop=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"paddingBottom",{get:function(){return this._paddingBottom},set:function(e){this._paddingBottom!=e&&(this._paddingBottom=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontName",{get:function(){return this._fontName},set:function(e){this._fontName!=e&&(this._fontName=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"password",{get:function(){return this._password},set:function(e){this._password!=e&&(this._password=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!=e&&(this._fontSize=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"fontColor",{get:function(){return this._fontColor},set:function(e){this._fontColor!=e&&(this._fontColor=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"text",{get:function(){return this._text},set:function(e){this._text!=e&&(this._text=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"lineSpacing",{get:function(){return this._lineSpacing},set:function(e){this._lineSpacing!=e&&(this._lineSpacing=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"multiline",{get:function(){return this._multiline},set:function(e){this._multiline!=e&&(this._multiline=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(e){this._wordWrap!=e&&(this._wordWrap=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"stroke",{get:function(){return this._stroke},set:function(e){this._stroke!=e&&(this._stroke=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(e){this._strokeColor!=e&&(this._strokeColor=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"hAlign",{get:function(){return this._hAlign},set:function(e){this._hAlign!=e&&(this._hAlign=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"vAlign",{get:function(){return this._vAlign},set:function(e){this._vAlign!=e&&(this._vAlign=e,this.invalidate())},enumerable:!1,configurable:!0}),i.prototype.setFocus=function(){this._textField&&this._textField.setFocus()},Object.defineProperty(i.prototype,"maxChars",{get:function(){return this._maxChars},set:function(e){this._maxChars!=e&&(this._maxChars=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"restrict",{get:function(){return this._restrict},set:function(e){this._restrict!=e&&(this._restrict=e,this.invalidate())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"inputType",{get:function(){return this._inputType},set:function(e){this._inputType!=e&&(this._inputType=e,this.invalidate())},enumerable:!1,configurable:!0}),i}(e.Group);e.TextInput=t,__reflect(t.prototype,"codeBase.TextInput",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(){}return t.createImage=function(t,i,n,o,r){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=null),void 0===r&&(r=[]);var a=new e.Image;return t&&(t.addChild(a),a.x=i,a.y=n),a.texture=o,a.scale9Grid(r),a},t.createImageNumber=function(t,i,n,o,r,a,s,l){void 0===r&&(r=""),void 0===a&&(a="top"),void 0===s&&(s="left"),void 0===l&&(l=null);var h=new e.ImageNumber;return h.init(o,r,a,s),h.text=l,t&&h.show(t,i,n),h},t.createButton=function(t,i,n,o){void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null);var r=new e.Button;return r.setStatus(t),r.setClickFunction(i,n),r.sound=o,r},t.createToggleButton=function(t,i,n,o,r){void 0===n&&(n=null),void 0===o&&(o=null),void 0===r&&(r=null);var a=new e.Button;return a.setStatus(t),a.setClickFunction(n,o),a.toggleGroup=i,a.sound=r,a},t.createLabel=function(t,i,n,o,r){void 0===o&&(o=26),void 0===r&&(r="");var a=new e.Label;return t&&(t.addChild(a),a.x=i,a.y=n),a.fontSize=o,a.text=r,a.showBg=!1,a.autoSize=!0,a},t.createTextArea=function(t,i,n,o,r,a){void 0===a&&(a="");var s=new e.TextArea;return t&&(t.addChild(s),s.x=200,s.y=100),s.width=300,s.height=300,s.showBg=!0,s.text=a,s},t.createTextInput=function(t,i,n,o,r){var a=new e.TextInput;
return t&&(t.addChild(a),a.x=i,a.y=n),a.showBg=!0,a.width=o,a.height=r,a},t.createList=function(t,i,n,o,r,a,s,l,h,c,d){void 0===l&&(l=10),void 0===h&&(h=1),void 0===c&&(c=10),void 0===d&&(d=e.Style.VERTICAL);var u=new e.List;return t&&(t.addChild(u),u.x=i,u.y=n),u.width=o,u.height=r,u.itemRenderer=a,u.gap=l,u.line=h,u.lineGap=c,u.data=s,u},t.createBitmap=function(e){var t=new egret.Bitmap,i=RES.getRes(e);return t.texture=i,t},t.getPixel32=function(e,t,i){if(e&&e.texture){var n=e.globalToLocal(t,i);return e.texture.getPixel32(n.x,n.y)}return[]},t.testPixel32=function(e,t,i){for(var n=this.getPixel32(e,t,i),o=0;o<n.length;o++)if(n[o]>0)return!0;return!1},t}();e.UICreator=t,__reflect(t.prototype,"codeBase.UICreator",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){}return e.encode=function(e){var t=new egret.ByteArray;return t.writeUTFBytes(e),this.encodeByteArray(t)},e.encodeByteArray=function(e){var t,i="",n=new Array(4);for(e.position=0;e.bytesAvailable>0;){t=new Array;for(var o=0;3>o&&e.bytesAvailable>0;o++)t[o]=e.readUnsignedByte();n[0]=(252&t[0])>>2,n[1]=(3&t[0])<<4|t[1]>>4,n[2]=(15&t[1])<<2|t[2]>>6,n[3]=63&t[2];for(var r=t.length;3>r;r++)n[r+1]=64;for(var a=0;a<n.length;a++)i+=this.BASE64_CHARS.charAt(n[a])}return i},e.decode=function(e){var t=this.decodeToByteArray(e);return t.readUTFBytes(t.length)},e.decodeToByteArray=function(e){for(var t=new egret.ByteArray,i=new Array(4),n=new Array(3),o=0;o<e.length;o+=4){for(var r=0;4>r&&o+r<e.length;r++)i[r]=this.BASE64_CHARS.indexOf(e.charAt(o+r));n[0]=(i[0]<<2)+((48&i[1])>>4),n[1]=((15&i[1])<<4)+((60&i[2])>>2),n[2]=((3&i[2])<<6)+i[3];for(var a=0;a<n.length&&64!=i[a+1];a++)t.writeByte(n[a])}return t.position=0,t},e.BASE64_CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e.version="1.0.0",e}();e.Base64Util=t,__reflect(t.prototype,"codeBase.Base64Util",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(){}return Object.defineProperty(t,"log",{get:function(){return this._log},set:function(i){e.GlobalSetting.DEV_MODEL&&(console.log(i),t._log+=i+"\n",t.callbackFunc&&this.callbackFunc.call(null))},enumerable:!1,configurable:!0}),t.refresh=function(){t.callbackFunc&&this.callbackFunc.call(null)},t.clean=function(){e.GlobalSetting.DEV_MODEL&&(this._log="",this.callbackFunc&&this.callbackFunc.call(null))},t._log="",t.callbackFunc=null,t}();e.Debug=t,__reflect(t.prototype,"codeBase.Debug",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){this.glowFilter=null}return Object.defineProperty(e,"getInstance",{get:function(){return e.instance||(e.instance=new e,e.instance.init()),e.instance},enumerable:!1,configurable:!0}),e.prototype.init=function(){var e=this;e.InitLightFilter()},e.prototype.InitLightFilter=function(){var e=3394815,t=.6,i=35,n=35,o=6,r=2,a=!1,s=!1;this.glowFilter=new egret.GlowFilter(e,t,i,n,o,r,a,s)},e.prototype.setGlowFilter=function(e,t,i,n){void 0===t&&(t=3394815),void 0===i&&(i=.6),void 0===n&&(n=6);var o=this;o.glowFilter.color=t,o.glowFilter.alpha=i,o.glowFilter.strength=n,e.filters=[this.glowFilter]},e.prototype.cleanFilter=function(e){e.filters=[]},e.prototype.setDisplayColor=function(e,t,i){void 0===i&&(i=1);var n=this,o=n.spliceColor(t),r=[1,0,0,0,40,0,1,0,0,10,0,0,1,0,0,0,0,0,1,0];r[0]=o.r/255,r[6]=o.g/255,r[12]=o.b/255,r[18]=i;var a=new egret.ColorMatrixFilter(r);e.filters=[a]},e.prototype.spliceColor=function(e){var t={r:-1,g:-1,b:-1};return t.b=e%256,t.g=Math.floor(e/256)%256,t.r=Math.floor(e/256/256),t},e.prototype.convertNumberToHex=function(e,t,i){var n="",o=e.toString(16);(1==o.length||"0"===o)&&(o="0"+o);var r=t.toString(16);(1==r.length||"0"===r)&&(r="0"+r);var a=i.toString(16);return(1==a.length||"0"===a)&&(a="0"+a),n="0x"+o+r+a,parseInt(n)},e}();e.FilterUtil=t,__reflect(t.prototype,"codeBase.FilterUtil",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t;!function(e){e[e.Start=0]="Start",e[e.Playing=1]="Playing",e[e.Pause=2]="Pause",e[e.Finished=3]="Finished"}(t=e.GameState||(e.GameState={})),window.GameState=t;var i=function(){function i(){this.remoteResUrl="http://106.52.184.124/TabAndFly_wxgame_remote",this._GameState=t.Playing,this.musicVolume=1,this.effectVolume=1,this.canvasEventListenerArr=[],this.documentEventListenerArr=[],this.mouseMoveListenerArr=[],this.registerMouseMove=!1,this.modulePath=""}return Object.defineProperty(i,"Instance",{get:function(){return null==i.instance&&(i.instance=new i),i.instance},enumerable:!1,configurable:!0}),i.prototype.Init=function(){var e=this;e.canvas||(e.canvas=document.getElementsByTagName("CANVAS")[0]),e.stage=egret.MainContext.instance.stage,mouse.enable(e.stage),e.registerMouseMove=!1,e.modulePath=""},i.prototype.setCursor=function(e){var t=this;t.canvas.style.cursor=e},i.prototype.addCanvasEventListener=function(e,t,i){var n=this,o=t.bind(i);n.canvas.addEventListener(e,o),n.canvasEventListenerArr.push({eventType:e,fun:o,originFun:t,funObj:i})},i.prototype.removeCanvasEventListener=function(e,t,i){for(var n=this,o=n.canvasEventListenerArr.length-1;o>=0;--o){var r=n.canvasEventListenerArr[o];r.type==e&&r.originFun==t&&r.funObj==i&&(n.canvas.removeEventListener(r.eventType,r.fun),n.canvasEventListenerArr.splice(o,1))}},i.prototype.clearCanvasEventListener=function(){for(var e=this,t=e.canvasEventListenerArr.length,i=0;t>i;++i){var n=e.canvasEventListenerArr[i];e.canvas.removeEventListener(n.eventType,n.fun)}e.canvasEventListenerArr.length=0},i.prototype.addDocumentEventListener=function(e,t,i){var n=this,o=t.bind(i);document.addEventListener(e,o),n.documentEventListenerArr.push({eventType:e,fun:o,originFun:t,funObj:i})},i.prototype.removeDocumentEventListener=function(e,t,i){for(var n=this,o=n.documentEventListenerArr.length-1;o>=0;--o){var r=n.documentEventListenerArr[o];r.type==e&&r.originFun==t&&r.funObj==i&&(document.removeEventListener(r.eventType,r.fun),n.documentEventListenerArr.splice(o,1))}},i.prototype.clearDocumentEventListener=function(){for(var e=this,t=e.documentEventListenerArr.length,i=0;t>i;++i){var n=e.documentEventListenerArr[i];document.removeEventListener(n.eventType,n.fun)}e.documentEventListenerArr.length=0},i.prototype.addMouseMoveListener=function(t,i,n){void 0===n&&(n=null);for(var o=this,r=0;r<o.mouseMoveListenerArr.length;++r)if(o.mouseMoveListenerArr[r].callFun==t&&o.mouseMoveListenerArr[r].funObj==i)return;o.registerMouseMove||(o.registerMouseMove=!0,e.isMobile()?o.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,o.onTouchMove,o):(o.onMove=o.onMove.bind(o),o.addCanvasEventListener("mousemove",o.onMove,o))),o.mouseMoveListenerArr.push({callFun:t,funObj:i,target:n})},i.prototype.clearMouseMoveListener=function(){var t=this;t.registerMouseMove&&(t.registerMouseMove=!1,e.isMobile()?t.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,t.onTouchMove,t):t.removeCanvasEventListener("mousemove",t.onMove,t)),t.mouseMoveListenerArr.length=0},i.prototype.onMove=function(e){var t=this;t.doMove(e.x,e.y)},i.prototype.onTouchMove=function(e){var t=this;t.doMove(e.stageX,e.stageY)},i.prototype.doMove=function(e,t){for(var i=this,n=i.mouseMoveListenerArr.length,o=0;n>o;++o)i.mouseMoveListenerArr[o].callFun.call(i.mouseMoveListenerArr[o].funObj,[e,t,i.mouseMoveListenerArr[o].target])},i.prototype.addKeyBoardListener=function(t,i,n,o,r,a,s,l){void 0===r&&(r=null),void 0===a&&(a=0),void 0===s&&(s=0),void 0===l&&(l=0);var h,c=this;return e.isMobile()||(c.addDocumentEventListener("keydown",t,i),c.addDocumentEventListener("keyup",n,o)),h},i.prototype.setTargetMouseMode=function(e,t){mouse.setButtonMode(e,t)},i.prototype.setTargetScale=function(e,t,i){void 0===i&&(i=100),egret.Tween.get(e).to({scaleX:t,scaleY:t},i)},i.prototype.onMouseOver=function(e){i.Instance.setTargetScale(e.currentTarget,1.1)},i.prototype.onMouseOut=function(e){i.Instance.setTargetScale(e.currentTarget,1)},i.prototype.onMouseOverWithFilter=function(t){e.FilterUtil.getInstance.setGlowFilter(t.currentTarget,16768879)},i.prototype.onMouseOutClearFilter=function(t){e.FilterUtil.getInstance.cleanFilter(t.currentTarget)},i.prototype.getTargetPoint=function(e){var t=new egret.Point(e.x,e.y);return t},i.prototype.showQuestionNumber=function(e){var t=this,i=e[1],n=e[0];this.questionNumberImage?this.questionNumberImage.texture=RES.getRes("question_json.question-"+i):(this.questionNumberImage=new egret.Bitmap,this.questionNumberImage.texture=RES.getRes("question_json.question-"+i),this.questionNumberImage.anchorOffsetX=125,this.questionNumberImage.anchorOffsetY=60,n.addChild(this.questionNumberImage)),this.questionNumberImage.x=n.width/2,this.questionNumberImage.y=n.height/2,this.questionNumberImage.scaleX=0,this.questionNumberImage.scaleY=0,egret.Tween.removeTweens(this.questionNumberImage),egret.Tween.get(this.questionNumberImage).to({scaleX:1.5,scaleY:1.5},250).to({scaleX:1.2,scaleY:1.2},250).to({scaleX:1.5,scaleY:1.5},250).to({scaleX:1.2,scaleY:1.2},250).to({scaleX:1.5,scaleY:1.5},250).to({scaleX:1.2,scaleY:1.2},250).wait(100).call(function(){n.removeChild(t.questionNumberImage),t.questionNumberImage=null},this)},i.prototype.shakeObject=function(e,t){if(0==t)egret.Tween.get(e).to({rotation:8},100).to({rotation:-8},200).to({rotation:8},200).to({rotation:-8},200).to({rotation:8},200).to({rotation:0},100);else if(1==t){var i=e.x;egret.Tween.get(e).to({x:i+30},150).to({x:i},150).to({x:i+30},150).to({x:i},150).to({x:i+30},150).to({x:i},150)}},i.prototype.showRightOrWrong=function(e,t,i,n){void 0===n&&(n=!1);var o=new egret.Bitmap,r=this;0==t?n?o.texture=RES.getRes(r.modulePath+"/img/commonRes/right_wrong_big.right_big"):o.texture=RES.getRes(r.modulePath+"/img/commonRes/rightAndWrong.right"):1==t&&(n?o.texture=RES.getRes(r.modulePath+"/img/commonRes/right_wrong_big.wrong_big"):o.texture=RES.getRes(r.modulePath+"/img/commonRes/rightAndWrong.wrong")),e.addChild(o),o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,o.x=i.x,o.y=i.y,egret.Tween.get(o).wait(1500).to({scaleX:0,scaleY:0},200).call(function(){e.removeChild(o)},e)},i.prototype.setScreenAuto=function(e){e.left=0,e.right=0,e.top=0,e.bottom=0},i.prototype.showHandTip=function(e,t,i,n,o){void 0===o&&(o=!1);var r=this,a=new egret.Bitmap;return a.texture=RES.getRes("comRes_1_json.hand"),a.touchEnabled=!1,e.addChild(a),a.x=t,a.y=i,r.showHandTipAction(a,n,o),a},i.prototype.showHandTipAction=function(e,t,i){void 0===i&&(i=!1),0==t?egret.Tween.get(e,{loop:i}).to({rotation:-15},500).to({rotation:0},500).to({rotation:-15},500).to({rotation:0},500).wait(500):1==t&&egret.Tween.get(e,{loop:i}).to({x:e.x-10,y:e.y-10},1e3).wait(200).to({x:e.x,y:e.y},1e3)},i.prototype.removeTargetTweenAction=function(e){e&&egret.Tween.removeTweens(e)},i.prototype.deepCopyObj=function(e){var t=Array.isArray(e)?[]:{};for(var i in e)e.hasOwnProperty(i)&&("object"==typeof e[i]&&null!==e[i]?t[i]=this.deepCopyObj(e[i]):t[i]=e[i]);return t},i.prototype.uniqueArr=function(e){var t=this,i=e.filter(function(e,t,i){return i.indexOf(e,0)===t?!0:!1},t);return i},i.prototype.measureText=function(e,t,i,n,o){return egret.sys.measureText(e,t,i,n,o)},i.convertStringToHashCode=function(e){if(0===e.length)return 0;for(var t=0,i=0,n=e.length;n>i;++i){var o=e.charCodeAt(i);t=(t<<5)-t+o,t|=0}return t},i.prototype.setDesignSize=function(e,t){var i=this;i.stage.setContentSize(e,t)},i.prototype.renderNode=function(e){e&&(e.$renderDirty=!0)},i.prototype.splitMatrix=function(e){var t=e.replace(/[^0-9\-,]/g,""),i=t.split(",");return i},i.prototype.getMatrixRotation=function(e,t,i,n,o,r){var a=Math.round(180*Math.asin(e)/Math.PI),s=Math.round(180*Math.acos(t)/Math.PI),l=Math.round(180*Math.asin(i)/Math.PI),h=Math.round(180*Math.acos(n)/Math.PI),c=0;return a==s||-a==s?c=h:-a+s==180?c=180+l:a+s==180&&(c=360-l||360-h),c>=360?0:c},i.prototype.dispose=function(){var t=this;t.clearCanvasEventListener(),t.clearDocumentEventListener(),e.isMobile(),t.clearMouseMoveListener(),i.instance=null},i.keyCodes={space:32,up:38,down:40,right:39,left:37},i}();e.GameUtil=i,__reflect(i.prototype,"codeBase.GameUtil",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){function t(){var e=window.navigator.userAgent.toLowerCase(),t=""+e.match(/MicroMessenger/i);return"null"==t?!1:"micromessenger"==t?!0:void 0}function i(){return document.body.clientHeight/document.body.clientWidth>1.32}function n(){return egret.Capabilities.isMobile?!0:!1}function o(){var e=window.navigator.userAgent.toLowerCase();""+e.match(/MicroMessenger/i);return""+e.match(/windows nt/i)=="windows nt"?"windows":""+e.match(/iphone/i)=="iphone"?"ios":""+e.match(/android/i)=="android"?"android":""+e.match(/ipad/i)=="ipad"?"ipad":""+e.match(/linux/i)=="linux"?"linux":""+e.match(/mac/i)=="mac"?"mac":""+e.match(/ucbrower/i)=="ucbrower"?"ucbrower":void console.log("")}function r(){var e=window.navigator.userAgent.toLowerCase();return""+e.match(/micromessenger/i)=="micromessenger"?"micromessenger":""+e.match(/qzone/i)=="qzone"?"qzone":""+e.match(/weibo/i)=="weibo"?"weibo":""+e.match(/qq/i)=="qq"?"qq":""+e.match(/renren/i)=="renren"?"renren":""+e.match(/txmicroblog/i)=="txmicroblog"?"txmicroblog":""+e.match(/douban/i)=="douban"?"douban":"other"}function a(e,t){var i=new RegExp("(\\?|&)"+e+"=([^&#]*)"),n=i.exec(t?t:window.location.href);return null!=n?decodeURIComponent(n[2]):null}function s(){return egret.MainContext.instance.stage}function l(){return egret.MainContext.instance.stage.stageWidth}function h(){return egret.MainContext.instance.stage.stageHeight}function c(){return egret.Capabilities.boundingClientWidth}function d(){return egret.Capabilities.boundingClientHeight}function u(){var e,t=s();return e.drawToTexture(t,new egret.Rectangle(0,0,t.stageWidth,t.stageHeight)),e}function p(){return window.location.href}e.TextColors={white:16777215,milkWhite:16511407,grayWhite:13547170,yellow:16776960,lightYellow:16765813,orangeYellow:16750848,red:15799040,green:58624,blue:1742039,grayBlue:3101047,purple:15284466,pink:16724016,black:3026221,golden:16766720},e.LabelFontSize={littleSize:12,middleSize:18,normalSize:24,bigSize:36},e.isWeiXin=t,e.isBigScreen=i,e.isMobile=n,e.systemType=o,e.platformType=r,e.getUrlParam=a,e.curStage=s,e.curStageWidth=l,e.curStageHeight=h,e.curClientWidth=c,e.curCientHeight=d,e.getScreen=u,e.getCurUrl=p,e.curAngle=Number(window.orientation)}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(){}return t.initData=function(){t.RUNTIME=egret.Capabilities.runtimeType,t.STAGE=egret.MainContext.instance.stage,e.Debug.log="---- GlobalSetting init ----",e.Debug.log="runtimeType="+egret.Capabilities.runtimeType+", deviceType="+egret.MainContext.deviceType,e.Debug.log="RUNTIME="+t.RUNTIME,t.initInfoSize()},t.initInfoSize=function(){console.log("stage resize w="+t.STAGE.stageWidth+", h="+t.STAGE.stageHeight),t.STAGE_WIDTH=t.STAGE.stageWidth,t.STAGE_HEIGHT=t.STAGE.stageHeight,t.DISPLAY_WIDTH=t.STAGE_WIDTH,t.DISPLAY_HEIGHT=t.STAGE_HEIGHT,t.DEV_MODEL&&(e.Debug.log="---- GlobalSetting Info Size ----",e.Debug.log="STAGE_WIDTH="+t.STAGE_WIDTH+", STAGE_HEIGHT="+t.STAGE_HEIGHT)},t.isNative=function(){return t.RUNTIME==t.RUNTIME_NATIVE},t.DEV_MODEL=!0,t.SYSTEM_DATE=0,t.VOLUME_OPEN=!0,t.FRAME_RATE=30,t.STAGE=null,t.STAGE_WIDTH=1920,t.STAGE_HEIGHT=1080,t.DISPLAY_WIDTH=1920,t.DISPLAY_HEIGHT=1080,t.VIEW_MINI_WIDTH=300,t.VIEW_MINI_HEIGHT=300,t.LOADING_THREAD_MAX=5,t.CHECK_IDLE_LOADING=15,t.REPORT=!1,t.REPORT_UI=!1,t.REPORT_URL="",t.APP_NAME="",t.APP_PRODUCT="",t.APP_DEVICE="",t.APP_RATE=0,t.APP_RATE_NAME=0,t.APP_CHANNEL="",t.APP_VERSION="",t.APP_PROVIDE=0,t.APP_STORAGE="local",t.STORAGE_LOCAL="local",t.STORAGE_NET="net",t.STORAGE_LOCAL_NET="local_net",t.RUNTIME="web",t.RUNTIME_WEB="web",t.RUNTIME_NATIVE="native",t.STATS_VIEW=!1,t.STATS_WIN=!1,t.STATS_BTN=!1,t.STATS_MC=!1,t.STATS_LIST=!1,t.CDN_RES="resource/",t}();e.GlobalSetting=t,__reflect(t.prototype,"codeBase.GlobalSetting",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(){}return t.onEnterFrame=function(i){var n=0,o=0,r=null,a=1;if(t._lastTime>0&&t._eplasedTime>0){var s=Math.floor(egret.getTimer()-t._lastTime-t._eplasedTime);s>0&&(t._cumulativeTime+=s,t._cumulativeTime>t._eplasedTime&&(a+=Math.floor(t._cumulativeTime/t._eplasedTime),t._cumulativeTime=t._cumulativeTime%t._eplasedTime))}for(var l=0;a>l;l++)for(o=t._listeners.length-1,n=o;n>=0;n--)r=t._listeners[n],r.frameIndex++,r.del?(t._listeners.splice(n,1),e.ObjectPool.recycleClass(r)):(r.frameCount<=1||r.frameIndex%r.frameCount==0)&&(r.loopcount++,r.loop>0&&r.loopcount>=r.loop&&(r.del=!0),t._functionCallList.unshift(r));for(o=t._functionCallList.length,n=0;o>n;n++)r=t._functionCallList.pop(),t.executeFunCall(r);0==t._listeners.length&&e.GlobalSetting.STAGE.removeEventListener(egret.Event.ENTER_FRAME,t.onEnterFrame,t),t._lastTime=egret.getTimer()},t.executeFunCall=function(e){e.param&&e.param.length>0?e.func.apply(e.thisArg,e.param):0==e.func.length?e.func.call(e.thisArg):e.func.call(e.thisArg,e.del)},t.addListener=function(n,o,r,a,s,l,h){if(void 0===r&&(r=1),void 0===a&&(a=-1),void 0===s&&(s=0),void 0===l&&(l=null),void 0===h&&(h=!1),null==o||t.hasListener(n,o))return!1;var c=e.ObjectPool.getByClass(i);return 0>=r&&(r=1),c.setData(n,o,r,a,s,l),t._listeners.push(c),h&&(c.loopcount++,t.executeFunCall(c)),t._lastTime=egret.getTimer(),e.GlobalSetting.STAGE.addEventListener(egret.Event.ENTER_FRAME,t.onEnterFrame,t),!0},t.removeListener=function(e,i){var n=0;for(n=0;n<t._listeners.length;n++)if(t._listeners[n].func==i&&t._listeners[n].thisArg==e){t._listeners[n].del=!0;break}},t.hasListener=function(e,i){var n=0;for(n=0;n<t._listeners.length;n++)if(t._listeners[n].thisArg==e&&t._listeners[n].func==i&&!t._listeners[n].del)return!0;return!1},t.getHearBeatLenght=function(){return t._listeners.length},t.init=function(){0==t._eplasedTime&&(t._eplasedTime=1e3/e.GlobalSetting.FRAME_RATE)},t.dispose=function(){var i,n=0;for(e.GlobalSetting.STAGE.removeEventListener(egret.Event.ENTER_FRAME,t.onEnterFrame,t),n=0;n<t._listeners.length;n++)i=t._listeners[n],e.ObjectPool.recycleClass(i);t._listeners.length=0,t._functionCallList.length=0,t._lastTime=0,t._eplasedTime=0,t._cumulativeTime=0},t.getHearBeatTrace=function(){var e=0,i="",n=null;for(i+=":"+t._listeners.length+"\n",i+="========================================================\n",e=0;e<t._listeners.length;e++)n=t._listeners[e],n&&(i+=" ("+e+"): ",i+="del="+n.del+", count="+n.frameCount+", index="+n.frameIndex+", loop="+n.loop+", loopCount="+n.loopcount+"\n",i+="------------------------------------\n");return i+="========================================================\n"},t._listeners=new Array,t._functionCallList=new Array,t._MAX_EXECUTE_COUNT=20,t.isInit=!1,t._lastTime=0,t._eplasedTime=0,t._cumulativeTime=0,t.nowTime=0,t.realFrame=0,t.item=null,t.endCall=!1,t}();e.HeartBeat=t,__reflect(t.prototype,"codeBase.HeartBeat",[]);var i=function(){function e(){this.func=null,this.thisArg=null,this.param=null,this.frameCount=0,this.frameIndex=0,this.loop=0,this.loopcount=0,this.delay=0,this.del=!1,this.traceMsg=null}return e.prototype.setData=function(e,t,i,n,o,r){this.thisArg=e,this.func=t,this.frameCount=i,this.loop=n,this.delay=o,this.frameIndex=0,this.loopcount=0,this.del=!1,this.param=r},e}();__reflect(i.prototype,"codeBase.BeatItem",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){}return e.dump=function(e){var t=e.position,i="",n="";e.position=0;for(var o=0;o<e.length;o++){o%16==0&&(i+=("0000"+o.toString(16)).substr(-4,4)+" "),o%8==0&&(i+=" ");var r=e.readByte();i+=("0"+r.toString(16)).substr(-2,2)+" ",n+=32>r||r>126?".":String.fromCharCode(r),((o+1)%16==0||o==e.length-1)&&(i+=" |"+n+"|\r\n",n="")}return e.position=t,i},e}();e.HexUtil=t,__reflect(t.prototype,"codeBase.HexUtil",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){}return e.setLocalData=function(e,t){egret.localStorage.setItem(e,t)},e.getLocalData=function(e){return egret.localStorage.getItem(e)},e.deleteLocalData=function(e){egret.localStorage.removeItem(e)},e.clearLocalData=function(){egret.localStorage.clear()},e}();e.LocalStorage=t,__reflect(t.prototype,"codeBase.LocalStorage",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){this.mapObj={}}return e.prototype.setValue=function(e,t){var i=this;""!=e?i.mapObj[e]=t:console.log("key!")},e.prototype.getValue=function(e){return""!=e?this.mapObj[e]:null},e.prototype.dispose=function(){var e,t=this;for(e in t.mapObj)t.mapObj[e]&&(delete t.mapObj[e],t.mapObj[e]=null);t.mapObj={}},e}();e.MapUtil=t,__reflect(t.prototype,"codeBase.MapUtil",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(){}return t.random=function(e,t,i){void 0===i&&(i=0);var n=t-e,o=Math.random(),r=e+o*n;return parseFloat(r.toFixed(i))},t.changeObjectRotation=function(e,t){var i;i="x"==t?360-e.rotation:180-e.rotation,e.rotation=i},t.lookTo=function(e,i){var n=i.localToGlobal(i.anchorOffsetX,i.anchorOffsetY);n=e.parent.globalToLocal(n.x,n.y);var o=Math.atan2(n.y-e.y,n.x-e.x),r=o*t.RADIAN_TO_ANGEL;e.rotation=r+90},t.lookToPosition=function(e,i,n){var o=e.parent.localToGlobal(e.x,e.y),r=Math.atan2(n-o.y,i-o.x),a=r*t.RADIAN_TO_ANGEL;e.rotation=a+90},t.prototype.clampRotation=function(e){return e%=360,e>180?e-=360:-180>e&&(e+=360),e},t.calculateAngle=function(e,t,i,n){return i==e&&n==t?0:Math.atan2(n-t,i-e)},t.distance=function(e,t,i,n){var o,r;return o=n-t,r=i-e,Math.sqrt(o*o+r*r)},t.hitTest=function(e,t){var i=e.getBounds(),n=t.getBounds();return i.x=e.x,i.y=e.y,n.x=t.x,n.y=t.y,i.intersects(n)},t.cos=function(e){return egret.NumberUtils.cos(e)},t.sin=function(e){return egret.NumberUtils.sin(e)},t.speedXY=function(t,i,n){var o=egret.Point.distance(t,i),r=Math.floor(e.GlobalSetting.FRAME_RATE*o/n)-1;r=0>=r?1:r;var a=i.y-t.y,s=i.x-t.x;return new egret.Point(Math.round(s/r*100)/100,Math.round(a/r*100)/100)},t.DOUBLE_PI=2*Math.PI,t.TRIBLE_PI=3*Math.PI,t.HALF_PI=Math.PI/2,t.TRIBLE_HALF_PI=3*t.HALF_PI,t.QUATER_PI=Math.PI/4,t.QUATER_TRIBLE_PI=t.TRIBLE_PI/4,t.ANGEL_TO_RADIAN=Math.PI/180,t.RADIAN_TO_ANGEL=180/Math.PI,t}();e.MathUtil=t,__reflect(t.prototype,"codeBase.MathUtil",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(){}return t.start=function(t,i,n,o,r){if(void 0===i&&(i=!0),void 0===n&&(n=0),void 0===o&&(o=9999),void 0===r&&(r=!0),!this._moveObject||this._moveObject!=t){if(this._moveObject=t,i){var a=egret.MainContext.instance.stage;a.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.mouseDown,this),a.addEventListener(egret.TouchEvent.TOUCH_END,this.mouseUp,this),a.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this)}else this._moveObject.touchEnabled=!0,this._moveObject.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.mouseDown,this),this._moveObject.addEventListener(egret.TouchEvent.TOUCH_END,this.mouseUp,this),this._moveObject.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.mouseMove,this);r&&e.TweenEffect.setAnchorXY(this._moveObject),this._minScale=n,this._maxScale=o}},t.mouseDown=function(e){if(null==this._touchPoints[e.touchPointID]&&(this._touchPoints[e.touchPointID]=new egret.Point(e.stageX,e.stageY),this._touchPoints.names.push(e.touchPointID)),this._touchCount++,1==this._touchCount){var t=(this._touchPoints.names,this._moveObject.parent.globalToLocal(e.stageX,e.stageY));this._oldX=t.x-this._moveObject.x,this._oldY=t.y-this._moveObject.y,this._firstTouchId=e.touchPointID}2==this._touchCount&&(this._distance=this.getTouchDistance(),this._angle=this.getTouchAngle(),console.log("_distance:"+this._distance))},t.mouseMove=function(e){if(this._touchPoints[e.touchPointID].x=e.stageX,this._touchPoints[e.touchPointID].y=e.stageY,e.touchPointID==this._firstTouchId){var t=this._moveObject.parent.globalToLocal(e.stageX,e.stageY);this._moveObject.x=t.x-this._oldX,this._moveObject.y=t.y-this._oldY}if(2==this._touchCount){var i=this.getTouchDistance(),n=Math.abs(i/this._distance-1);n*=.1,console.log("tempScale:"+n),this.currentScale+=i>this._currentDistance?n:-n;var o=this.currentScale;o<this._minScale&&(o=this._minScale),o>this._maxScale&&(o=this._maxScale),this.currentScale=o,this._currentDistance=i,console.log("scale:"+o),this._moveObject.scaleX=o,this._moveObject.scaleY=o;var r=this.getTouchAngle();this._moveObject.rotation=r-this._angle+this._currentRotation}},t.mouseUp=function(e){delete this._touchPoints[e.touchPointID];var t=this._touchPoints.names.indexOf(e.touchPointID);t>=0&&this._touchPoints.names.splice(t,1),this._touchCount--,this.currentScale=this._moveObject.scaleX,this._currentRotation=this._moveObject.rotation},t.getTouchDistance=function(){var e=this._touchPoints.names,t=0;return t=egret.Point.distance(this._touchPoints[e[e.length-1]],this._touchPoints[e[e.length-2]])},t.getTouchAngle=function(){var e=0,t=this._touchPoints.names,i=this._touchPoints[t[t.length-1]],n=this._touchPoints[t[t.length-2]];return e=180*Math.atan2(i.y-n.y,i.x-n.x)/Math.PI},t._touchPoints={names:[]},t._distance=0,t._angle=0,t._touchCount=0,t._currentRotation=0,t._currentDistance=0,t._moveObject=null,t._isMiddle=!0,t._minScale=0,t.currentScale=1,t._maxScale=0,t._oldX=0,t._oldY=0,t._firstTouchId=0,t}();e.MoreTouch=t,__reflect(t.prototype,"codeBase.MoreTouch",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){}return e.dump=function(e){for(var t="",i="",n=0;n<e.length;n++){n%16==0&&(t+=("0000"+n.toString(16)).substring(-4,4)+" "),n%8==0&&(t+=" ");var o=e[n];t+=("0"+o.toString(16)).substring(-2,2)+" ",((n+1)%16==0||n==e.length-1)&&(t+=" |"+i+"|\n",i="")}return t},e.isUsage=function(e){return void 0==e||null==e||""==e||"undefined"==e||""==e.trim()?!1:!0},e.randomRange=function(e,t){return void 0===t&&(t=0),Math.floor(e+Math.random()*(t-e))},e.changToMoney=function(e,t){void 0===t&&(t=!1);var i=0,n=0,o="";for(t&&e.charCodeAt(0)>=48&&e.charCodeAt(0)<=57&&(e="+"+e),i=e.length-1;i>=0;i--)o=e.charAt(i)+o,e.charCodeAt(i)>=48&&e.charCodeAt(i)<=57?e.charCodeAt(i-1)>=48&&e.charCodeAt(i-1)<=57&&(n++,3==n&&(o=","+o,n=0)):n=0;return o},e.getMatchesCount=function(e,t){var i=0,n=t.lastIndexOf(e),o=t.indexOf(e);if(o==n&&n>=0)return 1;if(o!=n&&n>=0)for(++i;o!=n;)o=t.indexOf(e,o+e.length-1),-1!=o&&++i;return i},e.changeIntToText=function(e){void 0===e&&(e=0);var t="";return t+=e>=1e4?Math.ceil(e/1e4).toFixed(0)+"":0>e?"0":e.toFixed(0)},e.convertColor2Html=function(e){void 0===e&&(e=0);var t="#000000",i="";try{for(i=e.toString(16);i.length<6;)i="0"+i;t="#"+i}catch(n){}return t},e.htmlESC=function(t){if(e.isUsage(t)){var i=/&/g,n=/</g,o=/>/g;return t=t.replace(i,"&amp;"),t=t.replace(n,"&lt;"),t=t.replace(o,"&gt;")}return null},e.replaceNumberToArray=function(e){for(var t=new Array,i=e.toString(),n=i.length,o=0;n>o;o++)t.push(i.charAt(o));return t},e.replace=function(t,i,n){if(!e.isUsage(t))return"";for(;t.indexOf(i)>=0;)t=t.replace(i,n);return t},e.splitStrArr=function(t,i){var n=[];if(e.isUsage(t))for(var o=t.split(i),r=0;r<o.length;r++)e.isUsage(o[r])&&n.push(o[r]);return n},e.parserStrToObj=function(t,i,n,o){void 0===i&&(i=null),void 0===n&&(n="@"),void 0===o&&(o=";");var r={};if(i&&(r=i),!e.isUsage(t))return r;for(var a=e.splitStrArr(t,o),s=null,l=0;l<a.length;l++)if(s=e.splitStrArr(a[l],n),2==s.length){var h=typeof r[s[0]];"number"==h?r[s[0]]=parseInt(s[1]):"boolean"==h?r[s[0]]="true"==s[1]:r[s[0]]instanceof Array?r[s[0]]=e.splitStrArr(s[1],","):r[s[0]]=s[1]}return r},e.parserObjToStr=function(e,t,i){void 0===t&&(t="@"),void 0===i&&(i=";");var n="";for(var o in e)"__class__"!=o&&"hashCode"!=o&&"__types__"!=o&&"__proto__"!=o&&(e[o]instanceof Function||(n+=o+t+e[o]+i));return n},e.isPhone=function(t){if(e.isUsage(t)&&11==t.length){var i=parseInt(t);if(""+i==t)return!0}return!1},e.formatTime=function(e,t){void 0===t&&(t=":");var i="",n=Math.floor(e/60);i=10>n?"0"+n:""+n,i+=t;var o=Math.floor(e%60);return i+=10>o?"0"+o:""+o},e.dateFormat=function(e,t){var i={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in i)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[n]:("00"+i[n]).substr((""+i[n]).length)));return t},e}();e.StringUtil=t,__reflect(t.prototype,"codeBase.StringUtil",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function e(){this.hexcase=0,this.b64pad=""}return e.prototype.hex_md5=function(e){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(e)))},e.prototype.b64_md5=function(e){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(e)))},e.prototype.any_md5=function(e,t){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(e)),t)},e.prototype.hex_hmac_md5=function(e,t){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.prototype.b64_hmac_md5=function(e,t){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.prototype.any_hmac_md5=function(e,t,i){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)),i)},e.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},e.prototype.rstr_md5=function(e){return this.binl2rstr(this.binl_md5(this.rstr2binl(e),8*e.length))},e.prototype.rstr_hmac_md5=function(e,t){var i=this.rstr2binl(e);i.length>16&&(i=this.binl_md5(i,8*e.length));for(var n=Array(16),o=Array(16),r=0;16>r;r++)n[r]=909522486^i[r],o[r]=1549556828^i[r];var a=this.binl_md5(n.concat(this.rstr2binl(t)),512+8*t.length);return this.binl2rstr(this.binl_md5(o.concat(a),640))},e.prototype.rstr2hex=function(e){try{this.hexcase}catch(t){this.hexcase=0}for(var i,n=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",o="",r=0;r<e.length;r++)i=e.charCodeAt(r),o+=n.charAt(i>>>4&15)+n.charAt(15&i);return o},e.prototype.rstr2b64=function(e){try{this.b64pad}catch(t){this.b64pad=""}for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",o=e.length,r=0;o>r;r+=3)for(var a=e.charCodeAt(r)<<16|(o>r+1?e.charCodeAt(r+1)<<8:0)|(o>r+2?e.charCodeAt(r+2):0),s=0;4>s;s++)n+=8*r+6*s>8*e.length?this.b64pad:i.charAt(a>>>6*(3-s)&63);return n},e.prototype.rstr2any=function(e,t){var i,n,o,r,a,s=t.length,l=Array(Math.ceil(e.length/2));for(i=0;i<l.length;i++)l[i]=e.charCodeAt(2*i)<<8|e.charCodeAt(2*i+1);var h=Math.ceil(8*e.length/(Math.log(t.length)/Math.log(2))),c=Array(h);for(n=0;h>n;n++){for(a=Array(),r=0,i=0;i<l.length;i++)r=(r<<16)+l[i],o=Math.floor(r/s),r-=o*s,(a.length>0||o>0)&&(a[a.length]=o);c[n]=r,l=a}var d="";for(i=c.length-1;i>=0;i--)d+=t.charAt(c[i]);return d},e.prototype.str2rstr_utf8=function(e){for(var t,i,n="",o=-1;++o<e.length;)t=e.charCodeAt(o),i=o+1<e.length?e.charCodeAt(o+1):0,t>=55296&&56319>=t&&i>=56320&&57343>=i&&(t=65536+((1023&t)<<10)+(1023&i),o++),127>=t?n+=String.fromCharCode(t):2047>=t?n+=String.fromCharCode(192|t>>>6&31,128|63&t):65535>=t?n+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):2097151>=t&&(n+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return n},e.prototype.str2rstr_utf16le=function(e){for(var t="",i=0;i<e.length;i++)t+=String.fromCharCode(255&e.charCodeAt(i),e.charCodeAt(i)>>>8&255);return t},e.prototype.str2rstr_utf16be=function(e){for(var t="",i=0;i<e.length;i++)t+=String.fromCharCode(e.charCodeAt(i)>>>8&255,255&e.charCodeAt(i));return t},e.prototype.rstr2binl=function(e){for(var t=Array(e.length>>2),i=0;i<t.length;i++)t[i]=0;for(var i=0;i<8*e.length;i+=8)t[i>>5]|=(255&e.charCodeAt(i/8))<<i%32;
return t},e.prototype.binl2rstr=function(e){for(var t="",i=0;i<32*e.length;i+=8)t+=String.fromCharCode(e[i>>5]>>>i%32&255);return t},e.prototype.binl_md5=function(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var i=1732584193,n=-271733879,o=-1732584194,r=271733878,a=0;a<e.length;a+=16){var s=i,l=n,h=o,c=r;i=this.md5_ff(i,n,o,r,e[a+0],7,-680876936),r=this.md5_ff(r,i,n,o,e[a+1],12,-389564586),o=this.md5_ff(o,r,i,n,e[a+2],17,606105819),n=this.md5_ff(n,o,r,i,e[a+3],22,-1044525330),i=this.md5_ff(i,n,o,r,e[a+4],7,-176418897),r=this.md5_ff(r,i,n,o,e[a+5],12,1200080426),o=this.md5_ff(o,r,i,n,e[a+6],17,-1473231341),n=this.md5_ff(n,o,r,i,e[a+7],22,-45705983),i=this.md5_ff(i,n,o,r,e[a+8],7,1770035416),r=this.md5_ff(r,i,n,o,e[a+9],12,-1958414417),o=this.md5_ff(o,r,i,n,e[a+10],17,-42063),n=this.md5_ff(n,o,r,i,e[a+11],22,-1990404162),i=this.md5_ff(i,n,o,r,e[a+12],7,1804603682),r=this.md5_ff(r,i,n,o,e[a+13],12,-40341101),o=this.md5_ff(o,r,i,n,e[a+14],17,-1502002290),n=this.md5_ff(n,o,r,i,e[a+15],22,1236535329),i=this.md5_gg(i,n,o,r,e[a+1],5,-165796510),r=this.md5_gg(r,i,n,o,e[a+6],9,-1069501632),o=this.md5_gg(o,r,i,n,e[a+11],14,643717713),n=this.md5_gg(n,o,r,i,e[a+0],20,-373897302),i=this.md5_gg(i,n,o,r,e[a+5],5,-701558691),r=this.md5_gg(r,i,n,o,e[a+10],9,38016083),o=this.md5_gg(o,r,i,n,e[a+15],14,-660478335),n=this.md5_gg(n,o,r,i,e[a+4],20,-405537848),i=this.md5_gg(i,n,o,r,e[a+9],5,568446438),r=this.md5_gg(r,i,n,o,e[a+14],9,-1019803690),o=this.md5_gg(o,r,i,n,e[a+3],14,-187363961),n=this.md5_gg(n,o,r,i,e[a+8],20,1163531501),i=this.md5_gg(i,n,o,r,e[a+13],5,-1444681467),r=this.md5_gg(r,i,n,o,e[a+2],9,-51403784),o=this.md5_gg(o,r,i,n,e[a+7],14,1735328473),n=this.md5_gg(n,o,r,i,e[a+12],20,-1926607734),i=this.md5_hh(i,n,o,r,e[a+5],4,-378558),r=this.md5_hh(r,i,n,o,e[a+8],11,-2022574463),o=this.md5_hh(o,r,i,n,e[a+11],16,1839030562),n=this.md5_hh(n,o,r,i,e[a+14],23,-35309556),i=this.md5_hh(i,n,o,r,e[a+1],4,-1530992060),r=this.md5_hh(r,i,n,o,e[a+4],11,1272893353),o=this.md5_hh(o,r,i,n,e[a+7],16,-155497632),n=this.md5_hh(n,o,r,i,e[a+10],23,-1094730640),i=this.md5_hh(i,n,o,r,e[a+13],4,681279174),r=this.md5_hh(r,i,n,o,e[a+0],11,-358537222),o=this.md5_hh(o,r,i,n,e[a+3],16,-722521979),n=this.md5_hh(n,o,r,i,e[a+6],23,76029189),i=this.md5_hh(i,n,o,r,e[a+9],4,-640364487),r=this.md5_hh(r,i,n,o,e[a+12],11,-421815835),o=this.md5_hh(o,r,i,n,e[a+15],16,530742520),n=this.md5_hh(n,o,r,i,e[a+2],23,-995338651),i=this.md5_ii(i,n,o,r,e[a+0],6,-198630844),r=this.md5_ii(r,i,n,o,e[a+7],10,1126891415),o=this.md5_ii(o,r,i,n,e[a+14],15,-1416354905),n=this.md5_ii(n,o,r,i,e[a+5],21,-57434055),i=this.md5_ii(i,n,o,r,e[a+12],6,1700485571),r=this.md5_ii(r,i,n,o,e[a+3],10,-1894986606),o=this.md5_ii(o,r,i,n,e[a+10],15,-1051523),n=this.md5_ii(n,o,r,i,e[a+1],21,-2054922799),i=this.md5_ii(i,n,o,r,e[a+8],6,1873313359),r=this.md5_ii(r,i,n,o,e[a+15],10,-30611744),o=this.md5_ii(o,r,i,n,e[a+6],15,-1560198380),n=this.md5_ii(n,o,r,i,e[a+13],21,1309151649),i=this.md5_ii(i,n,o,r,e[a+4],6,-145523070),r=this.md5_ii(r,i,n,o,e[a+11],10,-1120210379),o=this.md5_ii(o,r,i,n,e[a+2],15,718787259),n=this.md5_ii(n,o,r,i,e[a+9],21,-343485551),i=this.safe_add(i,s),n=this.safe_add(n,l),o=this.safe_add(o,h),r=this.safe_add(r,c)}return[i,n,o,r]},e.prototype.md5_cmn=function(e,t,i,n,o,r){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(t,e),this.safe_add(n,r)),o),i)},e.prototype.md5_ff=function(e,t,i,n,o,r,a){return this.md5_cmn(t&i|~t&n,e,t,o,r,a)},e.prototype.md5_gg=function(e,t,i,n,o,r,a){return this.md5_cmn(t&n|i&~n,e,t,o,r,a)},e.prototype.md5_hh=function(e,t,i,n,o,r,a){return this.md5_cmn(t^i^n,e,t,o,r,a)},e.prototype.md5_ii=function(e,t,i,n,o,r,a){return this.md5_cmn(i^(t|~n),e,t,o,r,a)},e.prototype.safe_add=function(e,t){var i=(65535&e)+(65535&t),n=(e>>16)+(t>>16)+(i>>16);return n<<16|65535&i},e.prototype.bit_rol=function(e,t){return e<<t|e>>>32-t},e}();__reflect(t.prototype,"codeBase.md5",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(e){function t(i,n,o,r){void 0===n&&(n=!0);var a=e.call(this)||this;a.videoWidth=580,a.videoHeight=444,a.videoURL="",a.autoPlay=!0;var s=a;return t.rewrite||(t.rewrite=!0,s.rewriteFunction()),s.videoURL=i,s.autoPlay=n,s.videoWidth=o||580,s.videoHeight=r||444,a}return __extends(t,e),t.prototype.rewriteFunction=function(){egret.Video.prototype.checkFullScreen=function(e){var t=this.video;e?(null==t.parentElement&&(t.removeAttribute("webkit-playsinline"),document.body.appendChild(t)),egret.stopTick(this.markDirty,this),this.goFullscreen()):(null!=t.parentElement&&t.parentElement.removeChild(t),t.setAttribute("webkit-playsinline","true"),this.setFullScreenMonitor(!1),egret.startTick(this.markDirty,this)),this.videoPlay()},Object.defineProperty(egret.Video.prototype,"fullscreen",{get:function(){return this._fullscreen},set:function(e){this._fullscreen=!!e,this.video&&0==this.video.paused&&this.checkFullScreen(this._fullscreen)},enumerable:!0,configurable:!0})},t.prototype.show=function(e,t,i,n,o,r){void 0===n&&(n=null),void 0===o&&(o=null),void 0===r&&(r=!1);var a=this;a._egretVideo=new egret.Video,a._egretVideo.width=a.videoWidth,a._egretVideo.height=a.videoHeight,a._egretVideo.fullscreen=!1,a.calllFun=n,a.funObj=o,a.addChild(a._egretVideo),a._egretVideo.x=0,a._egretVideo.y=0,a.width=a.videoWidth,a.height=a.videoHeight,a._loop=r,e.addChild(a),a.x=t,a.y=i,a.loadVideo(a.videoURL,a._loop)},t.prototype.hide=function(){var e=this;e.parent&&(e.parent.removeChild(e),e.dispose())},t.prototype.loadVideo=function(e,t){void 0===t&&(t=!1);var i=this;i._loop=t,i._pauseTime=0,i.videoURL=e;var n=new egret.URLLoader;n.dataFormat=egret.URLLoaderDataFormat.BINARY;var o=new egret.URLRequest;o.url=i.videoURL,n.load(o),n.addEventListener(egret.Event.COMPLETE,i.urlLoaderComplete,i)},t.prototype.urlLoaderComplete=function(e){var t=this,i=new File([e.target.data],"");t.obj_url&&(URL.revokeObjectURL(t.obj_url),t.obj_url=null),t.obj_url=window.URL.createObjectURL(i),t._egretVideo.load(t.obj_url),t._egretVideo.addEventListener(egret.Event.COMPLETE,t.loadCompleted,t)},t.prototype.loadCompleted=function(e){var t=this;t._egretVideo.removeEventListener(egret.Event.COMPLETE,t.loadCompleted,t),t.autoPlay&&t.playVideo(t._loop,t._pauseTime)},t.prototype.playVideo=function(e,t){void 0===t&&(t=0);var i=this;i._egretVideo&&(i._egretVideo.play(t,e),i._egretVideo.addEventListener(egret.Event.ENDED,i.onComplete,i))},t.prototype.onComplete=function(e){var t=this;t._egretVideo.removeEventListener(egret.Event.ENDED,t.onComplete,t),t.calllFun&&t.funObj&&t.calllFun.call(t.funObj)},t.prototype.pauseVideo=function(){var e=this;e._pauseTime=e._egretVideo.position,e._egretVideo.pause()},t.prototype.stopVideo=function(){var e=this;e._pauseTime=0,e._egretVideo.pause(),e._egretVideo.removeEventListener(egret.Event.ENDED,e.onComplete,e)},t.prototype.dispose=function(){var e=this;e._egretVideo&&e._egretVideo.close(),e.obj_url&&(URL.revokeObjectURL(e.obj_url),e.obj_url=null)},t.prototype.switchVideo=function(e,t){void 0===t&&(t=!1);var i=this;i.stopVideo(),i.loadVideo(e,t)},t.prototype.setTransform=function(e,t,i,n){var o=this;o.x=e,o.y=t,o.width=i,o.height=n,o._egretVideo.x=0,o._egretVideo.y=0,o._egretVideo.width=i,o._egretVideo.height=n},t.rewrite=!1,t}(egret.Sprite);e.EgretVideo=t,__reflect(t.prototype,"codeBase.EgretVideo",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(){this.videoWidth=0,this.videoHeight=0,this.validVideo=!1}return t.prototype.show=function(e,t,i,n,o,r,a){void 0===r&&(r=null),void 0===a&&(a=null);var s=this;s.stage=egret.MainContext.instance.stage,s.canvas=document.body.getElementsByTagName("canvas")[0],s.videoWidth=i,s.videoHeight=n,s.videoURL=o,s.px=e,s.py=t,s.relyDisplayObject=r,s.offsetPoint=a,s.validVideo=!1,egret.setTimeout(function(){s.createVideo(e,t,i,n,o),s.stage.addEventListener(egret.Event.RESIZE,s.resetVideo,s),s.resetVideo()},s,50)},t.prototype.setFinishCallBack=function(e,t){var i=this;i.finishFun=e,i.finishFunObj=t},t.prototype.closeVideo=function(){var e=this;e.hide(),e.finishFun&&e.finishFunObj&&e.finishFun.call(e.finishFunObj)},t.prototype.playFinish=function(){var e=this;e.closeVideo()},t.prototype.createVideo=function(e,t,i,n,o){var r=this,a=document.createElement("video");document.body.appendChild(a),r.video=a;var s=new egret.URLLoader;s.dataFormat=egret.URLLoaderDataFormat.BINARY;var l=new egret.URLRequest;l.url=o,s.load(l),s.addEventListener(egret.Event.COMPLETE,r.onLoadDataComplete,r)},t.prototype.onLoadDataComplete=function(e){var t=this,i=new File([e.target.data],"");t.obj_url&&(URL.revokeObjectURL(t.obj_url),t.obj_url=null),t.obj_url=window.URL.createObjectURL(i);var n=t.video;n.src=t.obj_url,n.setAttribute("autoplay","autoplay"),n.setAttribute("webkit-playsinline","true"),n.setAttribute("muted","false"),n.setAttribute("crossorigin","anonymous"),t.playVideo=t.playVideo.bind(t),n.addEventListener("canplay",t.playVideo),t.playFinish=t.playFinish.bind(t),n.addEventListener("ended",t.playFinish),n.controls=!1,n.style.position="absolute",n.style.zIndex="100000",n.style.pointerEvents="none"},t.prototype.playVideo=function(){var e=this;e.video&&e.video.play()},t.prototype.resetVideo=function(){var t=this;egret.setTimeout(function(){var i=t.video,n=1/egret.sys.DisplayList.$canvasScaleFactor,o=t.canvas.width*n/e.SceneManager.instance.designWidth,r=t.canvas.height*n/e.SceneManager.instance.designHeight,a=1;a=r>o?o:r;var s=t.videoWidth*a,l=t.videoHeight*a;i.style.width=s+"px",i.style.height=l+"px";var h=t.px,c=t.py;if(t.relyDisplayObject&&t.relyDisplayObject.parent){var d=t.relyDisplayObject.parent.localToGlobal(t.relyDisplayObject.x,t.relyDisplayObject.y);t.offsetPoint&&(d.x+=t.offsetPoint.x*e.SceneManager.instance.gameScale,d.y+=t.offsetPoint.y*e.SceneManager.instance.gameScale),h=d.x,c=d.y}else h*=o,c*=r;var u=e.GameUtil.Instance.splitMatrix(t.canvas.style.transform),p=e.GameUtil.Instance.getMatrixRotation(u[0],u[1],u[2],u[3],u[4],u[5]);i.style.transform="rotate("+p+"deg)",90==p?(i.style.left=t.canvas.height-c-l+(l-s>>1)+"px",i.style.top=h+(s-l>>1)+"px"):(i.style.left=h+"px",i.style.top=c+"px")},t,50)},t.prototype.hide=function(){var e=this;e.obj_url&&(URL.revokeObjectURL(e.obj_url),e.obj_url=null),e.video&&(e.video.removeEventListener("canplay",e.playVideo),e.video.removeEventListener("ended",e.playFinish),e.video.parentNode&&e.video.parentNode.removeChild(e.video)),e.validVideo=!1},t}();e.NativeVideo=t,__reflect(t.prototype,"codeBase.NativeVideo",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(e){function t(t){var i=e.call(this)||this;return i.loaded=!1,i.closed=!1,i.heightSet=0/0,i.widthSet=0/0,i.waiting=!1,i.userPause=!1,i.userPlay=!1,i.isPlayed=!1,i._fullscreen=!0,i.onVideoLoaded=function(){i.video.removeEventListener("canplay",i.onVideoLoaded);var e=i.video;i.loaded=!0,i.posterData&&(i.posterData.width=i.getPlayWidth(),i.posterData.height=i.getPlayHeight()),e.width=e.videoWidth,e.height=e.videoHeight,window.setTimeout(function(){i.dispatchEventWith(egret.Event.COMPLETE)},200)},i.$renderNode=new egret.sys.BitmapNode,i.src=t,i.once(egret.Event.ADDED_TO_STAGE,i.loadPoster,i),t&&i.load(),i}return __extends(t,e),t.prototype.load=function(e){var t=this;if(e=e||this.src,this.src=e,!this.video||this.video.src!=e){var i;!this.video||egret.Capabilities.isMobile?(i=document.createElement("video"),this.video=i,i.controls=null):i=this.video,i.src=e,i.setAttribute("autoplay","autoplay"),i.setAttribute("webkit-playsinline","true"),i.setAttribute("playsinline","true"),i.setAttribute("muted","false"),i.setAttribute("crossorigin","anonymous"),i.setAttribute("x5-video-player-type","h5-page"),i.addEventListener("canplay",this.onVideoLoaded),i.addEventListener("error",function(){return t.onVideoError()}),i.addEventListener("ended",function(){return t.onVideoEnded()}),i.load(),i.style.position="absolute",i.style.top="0px",i.style.zIndex="-88888",i.style.left="0px",i.height=1,i.width=1}},t.prototype.play=function(e,t){var i=this;if(void 0===t&&(t=!1),0==this.loaded)return this.load(this.src),void this.once(egret.Event.COMPLETE,function(n){return i.play(e,t)},this);if(!this.isPlayed){var n=this.video;void 0!=e&&(n.currentTime=+e||0),n.loop=!!t,egret.Capabilities.isMobile?n.style.zIndex="-88888":n.style.zIndex="9999",n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.height=n.videoHeight,n.width=n.videoWidth,"Windows PC"!=egret.Capabilities.os&&"Mac OS"!=egret.Capabilities.os&&window.setTimeout(function(){n.width=0},1e3),this.video.play(),this.isPlayed=!0,egret.startTick(this.markDirty,this)}},t.prototype.onVideoEnded=function(){this.pause(),this.isPlayed=!1,this.dispatchEventWith(egret.Event.ENDED)},t.prototype.onVideoError=function(){console.error("video errorCode:",this.video.error.code),this.dispatchEventWith(egret.IOErrorEvent.IO_ERROR)},t.prototype.close=function(){var e=this;this.closed=!0,this.video.removeEventListener("canplay",this.onVideoLoaded),this.video.removeEventListener("error",function(){return e.onVideoError()}),this.video.removeEventListener("ended",function(){return e.onVideoEnded()}),this.pause(),this.isPlayed=!1,egret.stopTick(this.markDirty,this),0==this.loaded&&this.video&&(this.video.src=""),this.video&&this.video.parentElement&&(this.video.parentElement.removeChild(this.video),this.video=null),this.loaded=!1},t.prototype.pause=function(){this.isPlayed&&(this.video.pause(),this.isPlayed=!1,egret.stopTick(this.markDirty,this))},Object.defineProperty(t.prototype,"volume",{get:function(){return this.video?this.video.volume:1},set:function(e){this.video&&(this.video.volume=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.video?this.video.currentTime:0},set:function(e){this.video&&(this.video.currentTime=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullscreen",{get:function(){return this._fullscreen},set:function(e){egret.Capabilities.isMobile||(this._fullscreen=!!e,this.video&&0==this.video.paused)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bitmapData",{get:function(){return this.video&&this.loaded?(this._bitmapData||(this.video.width=this.video.videoWidth,this.video.height=this.video.videoHeight,this._bitmapData=new egret.BitmapData(this.video),this._bitmapData.$deleteSource=!1),this._bitmapData):null},enumerable:!1,configurable:!0}),t.prototype.loadPoster=function(){var e=this,t=this.poster;if(t){var i=new egret.ImageLoader;i.once(egret.Event.COMPLETE,function(t){e.posterData=i.data,e.$renderDirty=!0,e.posterData.width=e.getPlayWidth(),e.posterData.height=e.getPlayHeight()},this),i.load(t)}},t.prototype.$measureContentBounds=function(e){var t=this.bitmapData,i=this.posterData;t?e.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):i?e.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):e.setEmpty()},t.prototype.getPlayWidth=function(){return isNaN(this.widthSet)?this.bitmapData?this.bitmapData.width:this.posterData?this.posterData.width:0/0:this.widthSet},t.prototype.getPlayHeight=function(){return isNaN(this.heightSet)?this.bitmapData?this.bitmapData.height:this.posterData?this.posterData.height:0/0:this.heightSet},t.prototype.$updateRenderNode=function(){var e=this.$renderNode,t=this.bitmapData,i=this.posterData,n=this.getPlayWidth(),o=this.getPlayHeight();this.isPlayed&&!egret.Capabilities.isMobile||!i?this.isPlayed&&t&&(e.image=t,e.imageWidth=t.width,e.imageHeight=t.height,egret.WebGLUtils.deleteWebGLTexture(t.webGLTexture),t.webGLTexture=null,e.drawImage(0,0,t.width,t.height,0,0,n,o)):(e.image=i,e.imageWidth=n,e.imageHeight=o,e.drawImage(0,0,i.width,i.height,0,0,n,o))},t.prototype.markDirty=function(){return this.$renderDirty=!0,!0},t.prototype.$setHeight=function(t){if(this.heightSet=t,this.paused){var i=this;this.$renderDirty=!0,window.setTimeout(function(){i.$renderDirty=!1},200)}e.prototype.$setHeight.call(this,t)},t.prototype.$setWidth=function(t){if(this.widthSet=t,this.paused){var i=this;this.$renderDirty=!0,window.setTimeout(function(){i.$renderDirty=!1},200)}e.prototype.$setWidth.call(this,t)},Object.defineProperty(t.prototype,"paused",{get:function(){return this.video?this.video.paused:!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){if(this.video)return this.video.duration;throw new Error("Video not loaded!")},enumerable:!1,configurable:!0}),t}(egret.DisplayObject);e.VideoBox=t,__reflect(t.prototype,"codeBase.VideoBox",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t;!function(e){e[e.kids=1]="kids",e[e.pupil=2]="pupil"}(t||(t={})),window.InteractionType=t;var i=function(i){function n(){var e=i.call(this)||this;return e.interactionType=t.pupil,e.currentDragTarget=null,e.currentDragTargetRenderIndex=0,e.currentDragTargetIndex=-1,e.dragTargetLeavePos=new egret.Point,e._distance=new egret.Point(0,0),e.gameStage=0,e.wrongCounter=0,e.counter=0,e}return __extends(n,i),n.prototype.initData=function(){i.prototype.initData.call(this),this.showScene()},n.prototype.showScene=function(){var t=this;t.bg=new e.Image,t.bg.texture=RES.getRes("bg_png"),t.bg.width=1920,t.bg.height=1080,t.addChild(t.bg),e.GameUtil.Instance.setScreenAuto(t.bg),t.group_play=new e.Group,t.addChild(t.group_play),t.group_play.width=1920,t.group_play.height=1080,t.group_play.horizontalCenter=0,t.group_play.verticalCenter=0;var i=new e.Group;i.width=300,i.height=200,i.x=600,i.y=600,t.group_play.addChild(i),i.showBg=!0,i.border=!0;var n=new e.Label;n.text="",t.group_play.addChild(n),n.left=50,n.top=500,n.showBg=!0,console.log("label.width:"+n.width+"  label.height:"+n.height),egret.setTimeout(function(){n.text="00000000000"},t,100);var o=new e.Image;o.texture=RES.getRes("comRes_1_json.hand"),t.group_play.addChild(o),o.left=0,o.top=300,console.log("hand.width:"+o.width+"  hand.height:"+o.height);var r=new e.TextInput;r.width=100,r.height=60,t.group_play.addChild(r),r.x=1e3,r.y=650,r.showBg=!0,r.paddingLeft=10,r.paddingTop=5,r.paddingRight=10,r.paddingBottom=5,r.vAlign=egret.VerticalAlign.MIDDLE;var a=new e.TextArea;a.width=300,a.height=300,t.group_play.addChild(a),a.x=50,a.y=100,a.showBg=!0,a.text="11";var s=new e.Button;t.group_play.addChild(s),s.setStatus([RES.getRes("A_png"),RES.getRes("A_png")]),s.setClickFunction(function(){e.EffectUtil.playEffect(o,1)},t),s.x=0,s.y=t.group_play.height-s.height,console.log("button.width:"+s.width+"  button.height:"+s.height),e.EffectUtil.breatheEffect(s);var l=e.UICreator.createBitmap("A_png");t.group_play.addChild(l),l.x=500,l.y=t.group_play.height-l.height,e.EffectUtil.breatheEffect(l);for(var h=new e.BaseGroup,c=[RES.getRes("A_png"),RES.getRes("A_png")],d=function(i){s=e.UICreator.createToggleButton(c,"abc",function(e){console.log(i),console.log(e)},t),h.addChild(s),s.x=0,s.y=0+i*(s.height+20)},u=0;3>u;++u)d(u);h.width=s.width,h.height=s.y+s.height+50;var p=new e.Image;p.texture=RES.getRes("slider_bar_v_png");var f=new e.Scroller(h.width,500,h,e.Style.VERTICAL,p,!0);f.x=1e3,f.y=600,t.group_play.addChild(f),f.setMouseWheelEnable(!0);var g=[{res:"A_png"},{res:"A_png"},{res:"A_png"},{res:"A_png"},{res:"A_png"},{res:"A_png"},{res:"A_png"},{res:"A_png"},{res:"A_png"},{res:"A_png"},{res:"A_png"},{res:"A_png"}],_=new e.List;t.group_play.addChild(_),_.x=1300,_.y=0,_.width=700,_.height=600,_.itemRenderer=e.ListItemRenderer,_.gap=100,_.line=2,_.lineGap=20,_.data=g,_.addEventListener(e.List.ITEM_SELECTED,function(e){console.log(e.data)},t);var v=new e.ListGroup(322,600,e.Style.VERTICAL,20);v.renderList(e.ListItemRenderer,g,!0),t.group_play.addChild(v),v.x=600,v.y=0,v.scrollBar.sliderBarSkins(e.UICreator.createBitmap("slider_bar_v_png"),e.UICreator.createBitmap("slider_bar_h_png"));var y=e.UICreator.createBitmap("A_png");t.group_play.addChild(y),y.x=0,y.y=0},n.prototype.virtualKeyBoardCall=function(e){var t=this;"up"==e?t.keyUp(38):"down"==e&&t.keyUp(40)},n.prototype.virtualKeyBoardBeginCall=function(e){var t=this;"up"==e?t.keyDown(38):"down"==e&&t.keyDown(40)},n.prototype.tweeObjectAlpha=function(e,t,i,n,o,r){void 0===o&&(o=null),void 0===r&&(r=null),e.scaleX=1,e.scaleY=1,e.alpha=t,o&&r?egret.Tween.get(e).to({alpha:i},n).call(o.bind(r),this):egret.Tween.get(e).to({alpha:i},n)},n.prototype.gameStart=function(){},n.prototype.restart=function(){},n.prototype.selectOptions=function(e){},n.prototype.hide=function(){i.prototype.hide.call(this);var t=this;t.isClear||(t.isClear=!0,t.removeEventListener(egret.Event.ENTER_FRAME,t.update,t),e.isMobile()||(document.removeEventListener("keydown",t.onkeydown),document.removeEventListener("keyup",t.onkeyup)))},n.prototype.gameFinished=function(){var e=this;e.gameStage>0||(e.gameStage=1,e.hide(),e.removeEventListener(egret.Event.ENTER_FRAME,e.update,e),egret.setTimeout(function(){},this,2500))},n.prototype.update=function(){},n.prototype.onkeydown=function(e){var t=this;t.keyDown(e.keyCode)},n.prototype.keyDown=function(e){},n.prototype.keyUp=function(e){},n.prototype.onkeyup=function(e){var t=this;t.keyUp(e.keyCode)},n.prototype.mouseMoveOver=function(e){},n.prototype.mouseMoveOut=function(e){},n.prototype.comfirmButtonCall=function(){},n.prototype.notifyVideoClose=function(){this.restart()},n.prototype.onMove=function(e){},n.prototype.sceneTouchMoveCall=function(e){var t=this;if(null!=t.currentDragTarget){var i=t.group_play.globalToLocal(e.stageX,e.stageY);t.currentDragTarget.x=i.x-t._distance.x,t.currentDragTarget.y=i.y-t._distance.y}},n.prototype.dragTargetBeginCall=function(e){var t=this,i=e.target;t.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,t.sceneTouchMoveCall,t),t.stage.addEventListener(egret.TouchEvent.TOUCH_END,t.dragTargetEndCall,t),t.currentDragTarget=i,t.dragTargetLeavePos.x=t.currentDragTarget.x,t.dragTargetLeavePos.y=t.currentDragTarget.y,t._distance.x=e.localX,t._distance.y=e.localY},n.prototype.dragTargetEndCall=function(e){var t=this;t.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,t.sceneTouchMoveCall,t),t.stage.removeEventListener(egret.TouchEvent.TOUCH_END,t.dragTargetEndCall,t)},n}(e.BaseScene);e.MainScene=i,__reflect(i.prototype,"codeBase.MainScene",[])}(i||(i={})),window.codeBase=i},function(e,t){var i,i=window.codeBase;!function(e){var t=function(){function t(){this.gameScale=1,this.designWidth=1920,this.designHeight=1080,this.fixDisplayArr=[]}return Object.defineProperty(t,"instance",{get:function(){return this._instance||(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.Init=function(){var t=this;t._stage=e.curStage(),t.gameLayer=new egret.Sprite,t.gameLayer.width=t.designWidth,t.gameLayer.height=t.designHeight,t._stage.addChildAt(t.gameLayer,0),t._stage.addEventListener(egret.Event.RESIZE,t.contentSizeChanged,t,!1,1e3),t.contentSizeChanged()},t.prototype.contentSizeChanged=function(){var e=this,t=e._stage.stageWidth,i=e._stage.stageHeight,n=t/e.designWidth,o=i/e.designHeight;o>n?e.gameScale=n:e.gameScale=o,e.gameLayer&&(e.gameLayer.width=e.designWidth,e.gameLayer.height=e.designHeight,e.gameLayer.scaleX=e.gameLayer.scaleY=e.gameScale,e.gameLayer.x=(t-e.gameLayer.width*e.gameScale)/2,e.gameLayer.y=(i-e.gameLayer.height*e.gameScale)/2),e.fixLayout()},t.prototype.fixListen=function(t,n,o,r,a,s){void 0===n&&(n=0/0),void 0===o&&(o=0/0),void 0===r&&(r=0/0),void 0===a&&(a=0/0),void 0===s&&(s=null);for(var l,h=this,c=-1,d=0;d<h.fixDisplayArr.length;++d)if(h.fixDisplayArr[d].display==t){c=d,l=h.fixDisplayArr[d];break}n!=n&&o!=o&&r!=r&&a!=a?l&&(h.fixDisplayArr.splice(c,1),e.ObjectPool.recycleClass(l)):(l||(l=e.ObjectPool.getByClass(i),h.fixDisplayArr.push(l)),l.display=t,l.left=n,l.right=o,l.top=r,l.bottom=a,l.relativeParent=s),h.fixLayout()},t.prototype.fixLayout=function(){for(var e,t,i,n,o,r,a,s,l,h,c=this,d=c.fixDisplayArr.length,u=0;d>u;++u)e=c.fixDisplayArr[u],r=e.relativeParent?e.relativeParent:c._stage,t=r==c._stage?c._stage.stageWidth:r.width,i=r==c._stage?c._stage.stageHeight:r.height,n=e.display.width,n=e.display.height,(isNaN(t)||void 0==i)&&(t=0),(isNaN(i)||void 0==i)&&(i=0),(isNaN(n)||void 0==n)&&(n=0),(isNaN(o)||void 0==o)&&(n=0),!isNaN(e.left)&&isNaN(e.right)?(h=r.localToGlobal(e.left,0),l=e.display.parent.globalToLocal(h.x,h.y),a=l.x):!isNaN(e.right)&&isNaN(e.left)?(h=r.localToGlobal(t-e.right,0),l=e.display.parent.globalToLocal(h.x,h.y),a=l.x):isNaN(e.left)||isNaN(e.right)||(h=r.localToGlobal(e.left,0),l=e.display.parent.globalToLocal(h.x,h.y),a=l.x,h=r.localToGlobal(t-e.right,0),l=e.display.parent.globalToLocal(h.x,h.y),n=l.x-a),!isNaN(e.top)&&isNaN(e.bottom)?(h=r.localToGlobal(0,e.top),l=e.display.parent.globalToLocal(h.x,h.y),s=l.y):!isNaN(e.bottom)&&isNaN(e.top)?(h=r.localToGlobal(0,i-e.bottom),l=e.display.parent.globalToLocal(h.x,h.y),s=l.y):isNaN(e.top)||isNaN(e.bottom)||(h=r.localToGlobal(0,e.top),l=e.display.parent.globalToLocal(h.x,h.y),s=l.y,h=r.localToGlobal(0,i-e.bottom),l=e.display.parent.globalToLocal(h.x,h.y),o=l.y-s),e.display.x=a,e.display.y=s,e.display.width!=n&&(e.display.width=n),e.display.height!=o&&(e.display.height=o)},t.prototype.showScene=function(e){var t=this;e&&(t.gameLayer.addChild(e),t.setCurrentScene(e))},t.prototype.setCurrentScene=function(e){var t=this;t.currentScene&&(t.removeScene(t.currentScene),t.fixListen(t.currentScene,0/0,0/0,0/0,0/0)),t.currentScene=e,t.fixListen(t.currentScene,0,0,0,0)},t.prototype.removeScene=function(e){var t=this;e&&e.parent==t.gameLayer&&(t.gameLayer.removeChild(e),e=null)},t.prototype.dispose=function(){for(var t=this,i=t.gameLayer.numChildren;i>0;){var n=t.gameLayer.getChildAt(0);n instanceof e.BaseScene?t.removeScene(n):t.gameLayer.removeChild(n),i-=1}t.gameLayer&&t.gameLayer.parent==t._stage&&(t._stage.removeChild(t.gameLayer),t.gameLayer=null),t.currentScene=null,t._stage.removeEventListener(egret.Event.RESIZE,t.contentSizeChanged,t)},t}();e.SceneManager=t,__reflect(t.prototype,"codeBase.SceneManager",[]);var i=function(){function e(){}return e}();__reflect(i.prototype,"codeBase.FixDisplay",[])}(i||(i={})),window.codeBase=i}]);

